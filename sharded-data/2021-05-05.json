[
    {
        "author": "nashatyrev",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'm rather concerning about timing here. If a blob (plus its header) is broadcasted at slot N, then it's header needs to be included to the block N and attesters should attest this blob and broadcast the attestation within the same N slot time frame. Sounds a bit tight on timing to me. Probably I'm missing something here?",
        "created_at": "2021-05-05T11:01:17.670000+00:00",
        "attachments": []
    },
    {
        "author": "nashatyrev",
        "category": "Cross-layer",
        "parent": "",
        "content": "May be it makes sense to:\n1. Allow blob publication for a slot up to `M` slots in the future. I.e. peers should forward Gossip messages on `shard_blob` and `shard_header` topics which are up to `M` slots in the future\n2. Allow future (up to `N` slots)  `shard_header` inclusion to a block. I.e. the `shard_header` for slot `K + N` could be included earlier to the block `K`",
        "created_at": "2021-05-05T11:10:27.321000+00:00",
        "attachments": []
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "Attestations and headers can still be included late like they can now",
        "created_at": "2021-05-05T12:02:21.260000+00:00",
        "attachments": []
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "And thanks to the new sharding design, if any shard blob header arrives a bit late on chain, or is not immediately confirmed, then later in-flight shard blobs can still be confirmed first. And the slow shard blob can be confirmed as soon as all those attestations surface.",
        "created_at": "2021-05-05T12:06:36.907000+00:00",
        "attachments": []
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "So the non-happy case where everything is delayed is not likely a problem. The happy case, with the 1-slot window, is where timing gets tricky",
        "created_at": "2021-05-05T12:08:39.217000+00:00",
        "attachments": []
    },
    {
        "author": "nashatyrev",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e And the slow shard blob can be confirmed as soon as all those attestations surface.\nNot sure I'm getting how the blob for a slot `N` can be confirmed 'later'. From my understanding of the current spec the blob at slot `N` could only be confirmed with attestations at slot `N` . Attestations for slot `N + 1` or later no more can confirm that blob (is that correct assumption?)\n\nSo if a blob `N` is published with some (not too significant) delay it has all the chances to be never accepted as attesters would rather produce attestations for the slot `N` with empty blob than would wait for this blob to potentially arrive.",
        "created_at": "2021-05-05T13:06:35.730000+00:00",
        "attachments": []
    },
    {
        "author": "nashatyrev",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e  if any shard blob header arrives a bit late on chain\nJust to be exact, under 'arriving on chain' do you mean including a blob header to a block ?",
        "created_at": "2021-05-05T13:09:48.152000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e  attesters would rather produce attestations for the slot N with empty blob than would wait for this blob to potentially arrive.\nthis is worth looking into more closely but we could conceivably paper over this w/ rewards, so that it becomes rational for validators to wait",
        "created_at": "2021-05-05T15:16:30.067000+00:00",
        "attachments": []
    },
    {
        "author": "nashatyrev",
        "category": "Cross-layer",
        "parent": "",
        "content": "Attester needs to attest both beacon block and shard blob in a single `Attestation` and thus excessive waiting for a potential blob would delay beacon chain attestation.",
        "created_at": "2021-05-05T16:21:22.108000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah i don't think we want to encourage it",
        "created_at": "2021-05-05T16:22:43.477000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "but possible to scale rewards so you ideally attest in the same slot",
        "created_at": "2021-05-05T16:23:04.041000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "reduced rewards the further away you are",
        "created_at": "2021-05-05T16:23:11.775000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "same thing w/ attesting today and beacon head votes",
        "created_at": "2021-05-05T16:23:44.868000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "but, in line w/ what i think you are getting at, validators will just put the incorrect head in order to be more timely",
        "created_at": "2021-05-05T16:24:22.551000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "worth noting the attestation reward for \"timely head\" actually gets tighter in `altair`",
        "created_at": "2021-05-05T16:28:24.578000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "implying its more of an issue",
        "created_at": "2021-05-05T16:28:57.820000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "I would say that if 12 seconds it too tight it may well be more worthwhile to just increase the slot duration",
        "created_at": "2021-05-05T21:42:48.373000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "What's the point of ultrafast headers if shard data takes multiple slots to arrive anyway",
        "created_at": "2021-05-05T21:43:10.344000+00:00",
        "attachments": []
    }
]
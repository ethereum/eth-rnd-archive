[
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "What the honest validator should do when struggles to get blobs? Can he start attesting as soon as he has validated blobs of the chain head? or should he have validated blobs for all post-finalized blocks?\nIt would be an realistic situation in case we had a fully decoupled block-sidecar networking and an optimistic sidecar handling",
        "created_at": "2022-11-11T10:45:36.885000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@159152274659082240\u003e \u003c@898563924440543283\u003e Re \u003chttps://github.com/mdehoog/go-ethereum/pull/47#discussion_r1019393426\u003e The idea from the new crypto API is to just use bytes on the client side, so you will never use BLSFieldElement or bls.Fr on the client side, even for the precompiles",
        "created_at": "2022-11-11T17:25:04.961000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdannyryan\u003e *Blob availability* in 4844 and in full-sharding with DAS is a validity condition of a chain. fully verifying would mean to know that within the pruning period that blobs are available (fully downloaded in 4844).\n\nYou could potentially argue for a node that just comes online to only require a shorter period ‚Äî e.g. from when their checkpoint state began or from most recent finalized. These are arguably safe but imo chain attestation availbility run *must* be the same as a user's chain availability rule",
        "created_at": "2022-11-11T17:33:02.367000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdannyryan\u003e within the fork-choice document we should make a rule clear",
        "created_at": "2022-11-11T17:33:25.730000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdannyryan\u003e as it pertains not only to validators but to users as well. and the fork choice will ripple up to the validator doc",
        "created_at": "2022-11-11T17:33:55.230000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdannyryan\u003e imo, we should have avail checked for the full pruning period unless a strong argument for what the network might fail at those depths is presented",
        "created_at": "2022-11-11T17:34:25.749000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdannyryan\u003e at which point we should evaluate (1) the fork choice avail rule for those depths and (2) changing the pruning depth due to some sort of p2p issue",
        "created_at": "2022-11-11T17:34:53.020000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "It might make sense to expose both APIs since the conversion to bls.Fr will have to take place somewhere (\u0026 clients can then choose whats' most convenient)?",
        "created_at": "2022-11-11T19:02:08.073000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "(The latest Precompile impl just accepts one blob of bytes fwiw, so it doesn't have to know anything about bls package)",
        "created_at": "2022-11-11T19:03:39.586000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think that could work well : have a primary bytes API, which is just a types translation layer to the bls APIs. Question is if there's benefit to expose the bls apis publicly once we have that.",
        "created_at": "2022-11-11T19:07:50.384000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "FYI potential minor issue w/ the consensus spec? https://github.com/ethereum/consensus-specs/pull/3096",
        "created_at": "2022-11-11T19:12:40.917000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Cross-layer",
        "parent": "",
        "content": "Hmm right, I don't think there will be",
        "created_at": "2022-11-11T19:14:39.137000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "was concerned there might be some excessive conversion going on, but haven't thought it all the way through.",
        "created_at": "2022-11-11T19:15:24.984000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "On it though! bytes API incoming.",
        "created_at": "2022-11-11T19:16:33.132000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Cross-layer",
        "parent": "",
        "content": "Thanks!",
        "created_at": "2022-11-11T19:42:22.079000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think it should be fine, since that method is doing a permutation and not modifying the original elements; so its the same set.\n\nIn code, it will be doing the check that you noted though",
        "created_at": "2022-11-11T19:42:31.621000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "seems to be bit shifting the elements as well?",
        "created_at": "2022-11-11T19:43:03.557000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Cross-layer",
        "parent": "",
        "content": "There is some bit magic being done, but I think its still a permutation",
        "created_at": "2022-11-11T19:47:15.410000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "it is indeed magical then! I guess there's some symmetry in there?",
        "created_at": "2022-11-11T19:48:09.240000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yep, you can double check in your go code by applying the permutation and checking that each element in one is in the other üòÑ (set should be distinct)",
        "created_at": "2022-11-11T19:58:19.849000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "you think it's at least worth a comment? I think others may end up similarly surprised that it works!",
        "created_at": "2022-11-11T19:58:46.080000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "I guess the function name implies it is indeed just a permutation.",
        "created_at": "2022-11-11T20:00:32.030000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "I was thinking though within the implementation to leave a comment that the bit shifts indeed preserve permutation property",
        "created_at": "2022-11-11T20:00:59.229000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah, I think it would make sense to comment it in implementations, maybe someone changes the name in golang for example ü§∑‚Äç‚ôÇÔ∏è",
        "created_at": "2022-11-11T20:03:31.164000+00:00",
        "attachments": []
    },
    {
        "author": "roberto.bayardo",
        "category": "Cross-layer",
        "parent": "",
        "content": "Oh I think it's mostly my lack of familiarity with python why this looks weird. Now that I look at the golang impl it's pretty clear it's just a simple perm.",
        "created_at": "2022-11-11T20:08:06.467000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@898563924440543283\u003e \n\n- It was my understanding that `hash` denotes sha256\n- So here, where we are doing version hashing, I would expect it to use sha256 \u003chttps://github.com/ethereum/consensus-specs/blob/dev/specs/eip4844/beacon-chain.md#kzg_commitment_to_versioned_hash\u003e\n- In the geth code, it seems to be using Keccak256 \u003chttps://github.com/mdehoog/go-ethereum/blob/eip-4844/core/types/data_blob.go#L67\u003e\n\nAm I misunderstanding something here?",
        "created_at": "2022-11-11T20:48:44.717000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "seems like a bug in that geth fork -- you are correct that `hash` is sha256",
        "created_at": "2022-11-11T22:18:04.964000+00:00",
        "attachments": []
    }
]
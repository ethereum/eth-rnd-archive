[
    {
        "author": "nashatyrev",
        "category": "Cross-layer",
        "parent": "",
        "content": "Hello! \nDidn't understand the following check in `update_pending_votes`:\n```python\n    # Check if the PendingShardHeader is eligible for expedited confirmation\n    # Requirement 1: nothing else confirmed\n    all_candidates = [\n        c for c in pending_headers if\n        (c.slot, c.shard) == (pending_header.slot, pending_header.shard)\n    ]\n    if True in [c.confirmed for c in all_candidates]:\n        return\n```\nhttps://github.com/ethereum/eth2.0-specs/blob/d09a0c2bce8c663571d855e743b6a24c98604707/specs/sharding/beacon-chain.md#update_pending_votes\n\nShouldn't the `ShardHeader` be unique with respect to `(slot, shard)`? There is just one shard proposer for `(slot, shard)` who may publish just one `ShardHeader` (else he is subject to be slashed). Why we are looking for other `pending_header`s with the same `(slot, shard)` then? \n\nPlease point me what I'm missing",
        "created_at": "2021-04-22T09:37:36.084000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@!425567222635954178\u003e not sure, that code is older than the shard-blob slashings, so we may be able to improve it indeed. I'll look into it, thanks",
        "created_at": "2021-04-22T12:35:37.361000+00:00",
        "attachments": null
    },
    {
        "author": "nashatyrev",
        "category": "Cross-layer",
        "parent": "",
        "content": "Oh, probably I was missing another possible candidate: `default empty ShardHeader` which could become confirmed (voted for with 2/3 of attesters) earlier. That way I suppose  `all_candidates` could contain only 2 elements: the `pending_header` itself and `default empty ShardHeader`\nDoes it make sense?",
        "created_at": "2021-04-22T18:05:50.677000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "Good point about the no-header case. We don't have shard rewards yet, but we should ensure the design makes reward calculations easy. I think we can move to a more direct state representation (e.g. a vector with reserved spots for each slot/shard combination) if we track the right data (e.g. inclusion slot) for rewards. The current thing works, but it makes merkle-proofs for early confirmation data difficult, and it's just messy to search for candidates during the state transition.",
        "created_at": "2021-04-22T19:05:49.730000+00:00",
        "attachments": null
    },
    {
        "author": "nashatyrev",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yep, agree üëç  \nThe similar redesign ideas were flying around for me.",
        "created_at": "2021-04-22T19:14:11.678000+00:00",
        "attachments": null
    }
]
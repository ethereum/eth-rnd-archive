[
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Is there a humanized version of the blob gas costing formula anywhere?",
        "created_at": "2022-07-30T07:04:40.489000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'm not a fan of this:\n```py\n    if actual_total_blobs \u003c targeted_total_blobs:\n        return 0\n    else:\n        2 ** ((actual_total_blobs - targeted_total_blobs) / 64)\n```",
        "created_at": "2022-07-30T07:25:33.642000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "This feels like an enshrining of Goodhart's Law.  It ensures that we always have at least target_total_blobs, even if there is absolutely nothing valuable to put into blobs which isn't what we *actually* want.\n\nIf someone has a blob that isn't quite ready, but will be ready next block, this code is saying that someone should throw garbage data at Ethereum in the form of blobs in the current block just so we hit our target, even though next block there may be more than enough demand to make up for the loss in the current block.",
        "created_at": "2022-07-30T07:27:53.778000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Our goal shouldn't be \"to ensure that we have a certain number of blobs on-chain\".  Our goal should be to ensure that we blobs are priced appropriately by the market such that those who demand blob space the most get in.",
        "created_at": "2022-07-30T07:30:33.004000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "It shouldn't be that we are simply trying to guarantee that we hit a particular target.",
        "created_at": "2022-07-30T07:30:44.999000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "So are you also not a fan of the EIP 1559 rule?",
        "created_at": "2022-07-30T07:35:32.673000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "Like, if we don't aim for a target, then the only alternative is to set some minimum fee, and that minimum fee is denominated in ETH or gas, and gas itself is set based on a target",
        "created_at": "2022-07-30T07:37:01.149000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "ok on second thought, if blob usage is very low, then the blob fee will just hug 0",
        "created_at": "2022-07-30T07:39:17.235000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "And priority fees will be the rate limiting factor",
        "created_at": "2022-07-30T07:39:23.683000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e Moving from using contract to block header to storing base fee -\u003e seems everyone is in agreement (except Vitalik ðŸ˜…)  PR for the change: https://github.com/ethereum/EIPs/pull/5353",
        "created_at": "2022-07-30T07:39:25.504000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'm fine with removing the contract is people really dislike it",
        "created_at": "2022-07-30T07:39:34.600000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "Added a couple comments to https://github.com/ethereum/EIPs/pull/5353/files",
        "created_at": "2022-07-30T07:47:26.160000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "1559 scales up and down, while 4844 goes to 0 immediately.",
        "created_at": "2022-07-30T07:56:13.240000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "How does it \"go to 0 immediately\"?",
        "created_at": "2022-07-30T07:56:22.628000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "```py\n    if actual_total_blobs \u003c targeted_total_blobs:\n        return 0\n```",
        "created_at": "2022-07-30T07:56:32.979000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "Right beside 0 is 1",
        "created_at": "2022-07-30T07:56:34.935000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "So if you're at actual = targeted + 1, then the blob fee is 1 wei",
        "created_at": "2022-07-30T07:56:49.672000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "There is  no discontinuity",
        "created_at": "2022-07-30T07:56:55.698000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "I agree there isn't discontinuity, but it functionally disallows \"banking\".",
        "created_at": "2022-07-30T07:57:41.720000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "That is, the system is effectively not allowed to go below the target, even if there is no legitimate use for blobs at the moment.",
        "created_at": "2022-07-30T07:58:09.679000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Another angle to approach this: Even if there is no demand for blobs, there is still a cost to the network for processing them and blobs shouldn't ever be free (relative to other things that could happen on-chain).",
        "created_at": "2022-07-30T07:59:23.370000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "So do you want a minimum price for blobs?",
        "created_at": "2022-07-30T07:59:36.987000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "We could just rely on prio fees for that",
        "created_at": "2022-07-30T07:59:51.734000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think there should be a minimum gas cost for blobs, just like we have for every opcode.",
        "created_at": "2022-07-30T07:59:54.614000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "btw I forget, have we decided to go with charging for blobs in gas rather than ETH?",
        "created_at": "2022-07-30T08:00:31.900000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah.",
        "created_at": "2022-07-30T08:00:39.535000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "And their gas cost goes to 0.",
        "created_at": "2022-07-30T08:00:45.184000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "I know both options  are available; are we just passively sliding toward gas, or were there good arguments for it",
        "created_at": "2022-07-30T08:00:46.937000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think this problem would be alleviated if we actually split operational pricing into different units rather than trying to do this weird hybrid thing.",
        "created_at": "2022-07-30T08:01:00.092000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "what do you mean by \"split operational pricing into different units\"",
        "created_at": "2022-07-30T08:01:16.301000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "I would *love* to see multiple units of operational cost: storage, network, cpu.",
        "created_at": "2022-07-30T08:01:20.070000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "So like option 2 in https://ethresear.ch/t/multidimensional-eip-1559/11651 ?",
        "created_at": "2022-07-30T08:01:42.361000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "Or option 1?",
        "created_at": "2022-07-30T08:01:51.779000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Any given opcode would have a `storage_cost, network_cost, cpu_cost` and in any given block we have `price_per_storage, price_per_network, price_per_cpu`.",
        "created_at": "2022-07-30T08:01:53.421000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Closer to option 2 I think, but I disagree on the priority fee being a percentage (though I don't have a concrete argument against it at the moment, and it is tangential to this discussion).",
        "created_at": "2022-07-30T08:03:45.976000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Blobs would have a network_cost and a cpu_cost associated with them, and maybe some kind of transient_storage_cost.  Many other resources would also have these costs, and so you can't really end up with blobs being free while the `add` opcode still has a cost (because both have an associated cpu_cost).",
        "created_at": "2022-07-30T08:05:41.506000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "hehe prio fees are tough in a multidimensional context",
        "created_at": "2022-07-30T08:06:09.669000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Luckily, they shouldn't really change over time so wallets can largely abstract them away from the user (if they do things right).",
        "created_at": "2022-07-30T08:07:02.101000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'm not super opposed to blobs having a fixed cost on top of the exponential cost, though I guess I don't mind much in either directio",
        "created_at": "2022-07-30T08:07:05.585000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah, agree",
        "created_at": "2022-07-30T08:07:09.028000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Priority fee for network is probably fairly high (relatively speaking), while priority fee for CPU is low and priority fee for storage is likely epsilon since block builders/proposers aren't the class of users who are negatively impacted by state growth.",
        "created_at": "2022-07-30T08:08:39.911000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Circling back to my complaint above, I think the root of it is that it seems a bit ridiculous to me that an `ADD` operation can be more expensive than a blob.  The fact that this is possible suggests to me that something is fundamentally wrong with the incentives.",
        "created_at": "2022-07-30T08:11:04.155000+00:00",
        "attachments": null
    }
]
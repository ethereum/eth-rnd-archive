[
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e @inphi fwiw, your comment about mempool and aggregated proof yesterday was accurate. however, it seems like there is momentum to switch the mempool to accept only a single blob per transaction in which case the aggregated proof technique is moot as well. seems like that momentum started by Peter's mempool session in Austria.",
        "created_at": "2023-02-08T13:00:06.027000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cinphi\u003e 1 blob per transaction will increase the global verification cost. The data gas used per block will most likely saturate the target once users start using blob transactions. So why aren't we trying to allow for amortized blob verification by allowing multiple blobs?\n\nThe only benefit in doing this is the murky decoupled blobs assumption that the smaller blob transactions propagate better. But since we're only announcing these blob transactions, this won't matter.",
        "created_at": "2023-02-08T14:14:24.791000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cinphi\u003e This problem only worsens if we later decide to increase the data gas limit.",
        "created_at": "2023-02-08T14:16:35.805000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e people said in the call yesterday that multi-blob txes will get in through private mempools",
        "created_at": "2023-02-08T14:18:30.534000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e i'm not sure if this is supposed to be a permanent solution",
        "created_at": "2023-02-08T14:18:36.187000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e and i dont pretend to understand peter's anti-DoS mempool design",
        "created_at": "2023-02-08T14:18:51.789000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e (i'm also not sure where to find a document about it)",
        "created_at": "2023-02-08T14:19:06.290000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cinphi\u003e doesn't seem sustainable to rely on private mempools. What's even the point of having an anti-DoS mempool if only private mempools will be used for blob transactions",
        "created_at": "2023-02-08T14:26:04.253000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cinphi\u003e \u003e \u003cinphi\u003e  https://gist.github.com/karalabe/e1c4e4c2a226926498cc9816d383cecb (re @asn_d6: (i'm also not sure where to find a document about it))",
        "created_at": "2023-02-08T14:26:11.053000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e seems like it's @dankrad's suggestion \"Restricting at transaction pool level however seems like a very good idea and I would actually suggest allowing only blob transactions with exactly 1 blob in the mempool\"",
        "created_at": "2023-02-08T14:27:19.332000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e i dont have a strong opinion on this matter",
        "created_at": "2023-02-08T14:30:00.961000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e but it seems like the current trajectory of \"no aggregate proof. only individual proofs\", locks us into the \"1 blob per transaction\" design. \n\nbecause if in the future we want to increase the blobs per tx in the mempool, we will also have to change the tx format to include aggregate proofs (assuming we want the fastest verification possible).",
        "created_at": "2023-02-08T14:31:14.932000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cinphi\u003e Yeah.\nI suppose we can always add the proofs in the future as needed. The aggregate proofs aren't part of consensus so it'll be a clean upgrade.\nBut I'd rather not create unnecessary disincentives for even private mempools to accept blob txs",
        "created_at": "2023-02-08T15:15:58.166000+00:00",
        "attachments": []
    },
    {
        "author": "winnsterx",
        "category": "Cross-layer",
        "parent": "",
        "content": "is there a recording yet?",
        "created_at": "2023-02-08T19:43:06.328000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdankrad\u003e \u003e \u003cdankrad\u003e  I just don't see that because the overhead of verifying individual proofs is very small. it's only 100s of us per blob. So why exactly would we need aggregate proofs? (re @asn_d6: but it seems like the current trajectory of \"no aggregate proof. only individual proofs\", locks us into the \"1 blob per transaction\" design. \n\nbecause if in the future we want to increase the blobs per tx in the mempool, we will also have to change the tx format to include aggregate proofs (assuming we want the fastest verification possible).)",
        "created_at": "2023-02-08T20:47:18.253000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdankrad\u003e But I still believe that the mempool should only include 1 blob transactions. The reason is that I can't see any way of making the mempool DOS resistant otherwise, because you could cancel and n-blob transaction with a 1-blob transaction",
        "created_at": "2023-02-08T20:49:39.328000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Cross-layer",
        "parent": "",
        "content": "I pinged \u003c@206016661470314496\u003e about this yesterday and he didn't seem to think we should actually ban \u003e1 blob txns from the mempool. His view was that the blob transactions are still relatively small, and you can create larger non-blob transactions today which the mempool must deal with. That said, this might stop holding in a world of much larger blobs (although we can cross that bridge when we get there).",
        "created_at": "2023-02-08T21:01:11.793000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Cross-layer",
        "parent": "",
        "content": "will get it uploaded now üëç",
        "created_at": "2023-02-08T21:01:21.911000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Cross-layer",
        "parent": "",
        "content": "There you go üôÇ https://youtu.be/vQGk9FDs_CM",
        "created_at": "2023-02-08T21:03:40.840000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e \u003e \u003casn_d6\u003e  i think it's closer to something between 1ms and 2ms per blob for a modern laptop according to these benches: https://gist.github.com/jtraglia/735a921d18fb64f3eb2c77eefd7c1ee0 (re @dankrad: I just don't see that because the overhead of verifying individual proofs is very small. it's only 100s of us per blob. So why exactly would we need aggregate proofs?)",
        "created_at": "2023-02-08T21:16:32.051000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e and those benches work on `verify_kzg_proof` which doesn't do the barycentric or the FS as the new `verify_blob_kzg_proof()` does",
        "created_at": "2023-02-08T21:17:29.457000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e justin's laptop (new mac Arm) does it in 1ms, and my laptop (i7 linux) does it in 1.7ms",
        "created_at": "2023-02-08T21:18:14.122000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e this probably doesn't change your argument",
        "created_at": "2023-02-08T21:18:23.142000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e but i'm just saying",
        "created_at": "2023-02-08T21:18:25.818000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdankrad\u003e \u003e \u003cdankrad\u003e  wait I thought the current mempool already has a 128 kB limit (re @sharded_data_bot: \u003ctimbeiko\u003e I pinged \u003c@206016661470314496\u003e about this yesterday and he didn't seem to think we should actually ban \u003e1 blob txns from the mempool. His view was that the blob transactions are still relatively small, and you can create larger non-blob transactions today which the mempool must deal with. That said, this might stop holding in a world of much larger blobs (although we can cross that bridge when we get there).)",
        "created_at": "2023-02-08T21:18:28.060000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdankrad\u003e \u003e \u003cdankrad\u003e  I don't understand how this would be true, so would be good to understand in detail where that time is spent (re @asn_d6: justin's laptop (new mac Arm) does it in 1ms, and my laptop (i7 linux) does it in 1.7ms)",
        "created_at": "2023-02-08T21:18:53.498000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e 0.6-0.7ms is just the pairing",
        "created_at": "2023-02-08T21:19:21.731000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e there might be some FFI cost because it's benching the golang bindings",
        "created_at": "2023-02-08T21:19:37.417000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e and golang is notoriously bad at this",
        "created_at": "2023-02-08T21:19:42.610000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e the rest i'm not sure where.",
        "created_at": "2023-02-08T21:19:51.827000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdankrad\u003e but you don't need one pairing per blob",
        "created_at": "2023-02-08T21:25:46.359000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdankrad\u003e you can aggregate them",
        "created_at": "2023-02-08T21:25:46.595000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cdankrad\u003e where in those benchmarks is the new version with one proof per blob?",
        "created_at": "2023-02-08T21:25:46.793000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e \u003e \u003casn_d6\u003e  agreed. i'm now writing the C code to benchmark that. (re @dankrad: you can aggregate them)",
        "created_at": "2023-02-08T21:26:16.530000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e \u003e \u003casn_d6\u003e  those benchmarks only benchmark the current code. not the new version.\n\nbut from the `VerifyKZGProof` line which benchmarks `verify_kzg_proof()` you can get info about the non-amortized performance of verifying a KZG proof (re @dankrad: where in those benchmarks is the new version with one proof per blob?)",
        "created_at": "2023-02-08T21:27:42.764000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003ctimbeiko\u003e \u003e \u003ctimbeiko\u003e  I believe this is to broadcast, but not accept a transaction? (re @dankrad: wait I thought the current mempool already has a 128 kB limit)",
        "created_at": "2023-02-08T21:30:08.328000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e \u003c@555483069038198827\u003e I implemented your PR in C here: https://github.com/ethereum/c-kzg-4844/pull/123\n\nThe benchmark results are not that nice. I added some remarks here: https://github.com/ethereum/c-kzg-4844/pull/123#issuecomment-1423384889\nI will also ask Justin to run the benchmarks since they are generally 2x times faster on his laptop...",
        "created_at": "2023-02-08T23:52:12.903000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003casn_d6\u003e at some point we will need to do some flame graph analysis. c-kzg is not that optimized in general, and we need to start weeding out the low hanging fruits.",
        "created_at": "2023-02-08T23:57:00.622000+00:00",
        "attachments": []
    }
]
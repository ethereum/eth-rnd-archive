[
    {
        "author": "gumb00",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "EIP states that global refund is used\n\u003e 7. Add PER_EMPTY_ACCOUNT_COST - PER_AUTH_BASE_COST gas to the global refund counter if authority exists in the trie.\n\nand I think there're tests for that",
        "created_at": "2024-10-18T13:04:47.697000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes so its subject to the 20% refund cap of total tx gas used right? This is how EthJS implemented it (and this should be covered by tests)",
        "created_at": "2024-10-18T13:05:44.685000+00:00",
        "attachments": null
    },
    {
        "author": "daniellehrner",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I have a doubt regarding the emptiness check for accounts with delegation (again):\n\nFor `EXTCODEHASH` we check the emptiness of the target of the delegation. But what about the emptiness check when sending ETH via `CALL` operations? When we send any amount greater than 0 ETH with a `CALL` we charge extra gas for the account creation if the recipient is empty.\n\nSo in the following scenario:\nAccount A: sends ETH via CALL -\u003e Account B\nAccount B: has set a 7702 authorization to account C\nAccount C: has no code and is empty\n\nWhich account do other clients check for emptiness? Is it B or C? In Besu it's currently C, the same as for `EXTCODEHASH`, but this means we are effectively charging too much gas, because we charge gas for creating an account when account B already exists.",
        "created_at": "2024-10-18T13:17:34.292000+00:00",
        "attachments": null
    }
]
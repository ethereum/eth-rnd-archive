[
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@687974325072035882\u003e this is you yeah? \n\nhttps://x.com/giuliorebuffo/status/1850564869503742440?s=46\n\nI'm curious how one would be able to find the content they are looking for in this type of network?  Suppose I want block 1,000,000.  How would I go about finding the node that has it?",
        "created_at": "2024-10-27T17:02:14.532000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "just rotate peers and check the bitlist",
        "created_at": "2024-10-27T17:02:58.751000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "like",
        "created_at": "2024-10-27T17:02:59.852000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this is what we do on CL for attestations",
        "created_at": "2024-10-27T17:03:08.501000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this is a very basic network rotation",
        "created_at": "2024-10-27T17:03:17.339000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "say you have 64 max peers okay? you are at 64 and you want block 1 million, this is in bit 11 or whatever, now go to query your peers bitlist until you find one with that bit set to 1. if you find it, query, if not you disconnect some peers and use the discovery until you find some N peers with that bit set to on",
        "created_at": "2024-10-27T17:05:01.195000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So enumerate the whole network until you find the peer that is advertising the right bitlist?",
        "created_at": "2024-10-27T17:05:19.028000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yep",
        "created_at": "2024-10-27T17:05:23.045000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this is not anything new btw",
        "created_at": "2024-10-27T17:05:27.427000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it is already how CL works with attestations",
        "created_at": "2024-10-27T17:05:40.108000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "then you have supernodes like in peerdas that keep the entire history and always return 11111s",
        "created_at": "2024-10-27T17:06:21.366000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Seems like there would be issues with nodes having a full connection pool? Does this happen much? \n\nSeems like in a growing network this solution would hit scaling problems. Long enough history and large enough network and discovery of the necessary peers becomes cumbersome and difficult.",
        "created_at": "2024-10-27T17:14:08.966000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "pppft idk, did not really think much but it depends how much history you plan to store per node",
        "created_at": "2024-10-27T17:14:43.607000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "like with 100k long shards and say 2 shard peer node, right now with 20mn block. you have a 1% chance that one node has the shard you want",
        "created_at": "2024-10-27T17:15:40.013000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "if you make it 1 million that grows to 10%",
        "created_at": "2024-10-27T17:15:51.909000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and 10% is a lot - it means that if you have 64 peers, you are almost guranteed to have any shard",
        "created_at": "2024-10-27T17:16:18.641000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i mean 1% is still not horrible btw",
        "created_at": "2024-10-27T17:16:44.966000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "if you make the math it should be more than enough even at 0.5%",
        "created_at": "2024-10-27T17:17:03.856000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it is all a matter of probability distribution really",
        "created_at": "2024-10-27T17:17:32.475000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "if you pick your shard with a uniform probability distribution then it does not matter how big your network is. probability is probability",
        "created_at": "2024-10-27T17:18:36.109000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "the actual issue is big enough history which theorically could \"dilute\" the amount of shards, but for that to be significant it is a loooong way. and still an improvement over \"all nodes keep history\" approach",
        "created_at": "2024-10-27T17:19:52.669000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "btw this is already proven to work - IPFS and Bittorent works like this at fundamental level and there is plenty of research on the effectiveness of this too, just google it. i am not sure however, what core-devs were saying when \u003c@226589605816696832\u003e was shilling the approach (nor do I care and have a say in it as Erigon has 4444s figured out already)",
        "created_at": "2024-10-27T17:21:20.399000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "IPFS uses DHT’s like Portal to find the content. Bittorrent use DHTs to find the node which contains a list of peers for that content",
        "created_at": "2024-10-27T18:09:49.489000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Most of a Portal implementation is copy paste from a Discv5 implementation",
        "created_at": "2024-10-27T18:10:25.340000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "what I am saying is that choosing a shard at random is a used and well-understood approach",
        "created_at": "2024-10-27T18:10:48.871000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "then yeah i mean discv5 shard discovery is the most obvious thing on this earth for doing history sharding. if i had to close myself in a room for 1 day to fix the history growth problem, this would be my first intuition (kind of surprised nobody thought of it of doing it directly in the EL subnet-style)",
        "created_at": "2024-10-27T18:11:25.577000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think one of the selling points of Portal is not needing to download the whole header chain to validate data is valid",
        "created_at": "2024-10-27T18:13:28.626000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "pft, not even all of it if you get smart about it",
        "created_at": "2024-10-27T18:14:21.594000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "if each one million block you embed an hash in the client you can use that hash to reverse download the chain",
        "created_at": "2024-10-27T18:14:45.043000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it requires one pr every 2 months per client",
        "created_at": "2024-10-27T18:14:55.331000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "idk - eth is a very specific use-case so 99% of the problems in general purpose protocol do not appear here",
        "created_at": "2024-10-27T18:15:26.717000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That doesn’t avoid needing to download tons of headers if you only want to access 1 block",
        "created_at": "2024-10-27T18:16:41.573000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You no longer have to download 21m",
        "created_at": "2024-10-27T18:17:08.414000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i mean history is avaiable though",
        "created_at": "2024-10-27T18:17:08.689000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so no wait this is wrong - history avaiability is a different thing than proving it. proving history is not difficult just use the historical summaries cl-side",
        "created_at": "2024-10-27T18:17:52.067000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "verification has been fixed already - it is history avaibility the issue imo",
        "created_at": "2024-10-27T18:18:23.310000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is only for Capella onward",
        "created_at": "2024-10-27T18:18:37.061000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The historical summaries don’t include the proof",
        "created_at": "2024-10-27T18:19:09.535000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "pppft idk - header chain is not big and honestly lightclients will need headerchain probably",
        "created_at": "2024-10-27T18:19:23.347000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "They are block hashes you can prove to",
        "created_at": "2024-10-27T18:19:32.561000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "in anycase - header chain seems like a non-isuse",
        "created_at": "2024-10-27T18:19:33.641000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "then idk - feel free to disagree",
        "created_at": "2024-10-27T18:19:45.157000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It just kind sounds like your naming history accumulaters off without reading how they are used",
        "created_at": "2024-10-27T18:20:31.159000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Portal remove this need",
        "created_at": "2024-10-27T18:20:45.063000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i mean - this sounds like a non-issue",
        "created_at": "2024-10-27T18:20:53.354000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it sounds like we are making a big deal out of nothing",
        "created_at": "2024-10-27T18:21:01.722000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "like 500MB of history growth is fine",
        "created_at": "2024-10-27T18:21:10.143000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "like idk ram gets cheaper than that over each year lol",
        "created_at": "2024-10-27T18:21:31.129000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Over what period?",
        "created_at": "2024-10-27T18:21:49.269000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "1 year",
        "created_at": "2024-10-27T18:21:56.231000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "just take current 8 GB and divide by 11",
        "created_at": "2024-10-27T18:22:10.685000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "each header is fixed in size too",
        "created_at": "2024-10-27T18:22:20.292000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "History is not only headers",
        "created_at": "2024-10-27T18:22:46.224000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ugh - there is a difference beetwen bodies and headers",
        "created_at": "2024-10-27T18:23:23.821000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "a body is txs which 99% of history",
        "created_at": "2024-10-27T18:23:30.583000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "if you can shard those it is enough",
        "created_at": "2024-10-27T18:23:35.767000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "also full nodes can get smart about it too a little bit",
        "created_at": "2024-10-27T18:24:06.045000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "as long as I can get history... imo, it is enough",
        "created_at": "2024-10-27T18:24:31.754000+00:00",
        "attachments": null
    }
]
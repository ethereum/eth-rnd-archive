[
    {
        "author": "poojaranjan",
        "category": "Execution Layer",
        "parent": "",
        "content": "As per the discussion in the ACD meeting today, proposing a breakout room meeting.",
        "created_at": "2020-11-13T15:37:53.595000+00:00",
        "attachments": null
    },
    {
        "author": "poojaranjan",
        "category": "Execution Layer",
        "parent": "",
        "content": "Topic: EIP-2718 discussion contd.",
        "created_at": "2020-11-13T15:38:02.260000+00:00",
        "attachments": null
    },
    {
        "author": "poojaranjan",
        "category": "Execution Layer",
        "parent": "",
        "content": "Date \u0026 Time: Nov 16, 2020 at 1500 UTC",
        "created_at": "2020-11-13T15:38:10.034000+00:00",
        "attachments": null
    },
    {
        "author": "poojaranjan",
        "category": "Execution Layer",
        "parent": "",
        "content": "Duration: 60 mins",
        "created_at": "2020-11-13T15:38:17.674000+00:00",
        "attachments": null
    },
    {
        "author": "poojaranjan",
        "category": "Execution Layer",
        "parent": "",
        "content": "I will send out a calendar invite tomorrow at 1400 UTC if there is no disagreement in date and time.",
        "created_at": "2020-11-13T15:39:32.446000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Main topic of discussion I think is the Transaction format specifics for 2930 and 2972.",
        "created_at": "2020-11-13T15:39:46.073000+00:00",
        "attachments": null
    },
    {
        "author": "poojaranjan",
        "category": "Execution Layer",
        "parent": "",
        "content": "Okay! I'll update the topic and create an agenda.",
        "created_at": "2020-11-13T15:40:37.048000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Topic is OK, just wanted to use that statement as a jumping off point.  üôÇ",
        "created_at": "2020-11-13T15:42:17.623000+00:00",
        "attachments": null
    },
    {
        "author": "poojaranjan",
        "category": "Execution Layer",
        "parent": "",
        "content": "https://github.com/ethereum/pm/issues/223",
        "created_at": "2020-11-13T15:54:20.743000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution Layer",
        "parent": "",
        "content": "Thanks \u003c@!642887713246150666\u003e !",
        "created_at": "2020-11-13T15:57:25.186000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "2972 as currently written:\n```js\n// transaction - using SSZ-compatible format so we don't have to decode-extract-encode in order to validate signature\n0x00 || yParity || r || s || 0x65000000 || rlp(nonce, gasPrice, gasLimit, to, value, data)\n// which is identical to\n0x00 || ssz([yParity, r, s, rlp(nonce, gasPrice, gasLimit, to, value, data)])\n// which is identical to\nssz([0x00, yParity, r, s, rlp(nonce, gasPrice, gasLimit, to, value, data)])\n\n// receipt - SSZ encoded\n0 || status || cumulativeGasUsed || logsBloom || 0x09010000 || ssz(logs)\n// which is identical to\n0 || ssz([status, cumulativeGasUsed, logsBloom, logs])\n// which is identical to\nssz([0, status, cumulativeGasUsed, logsBloom, logs])\n```",
        "created_at": "2020-11-13T16:33:09.351000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Per feedback on 2930, I suspect there will be pushback on this (as \u003c@!543900561460822016\u003e implied in the call).",
        "created_at": "2020-11-13T16:33:37.994000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "The minimal change from legacy encoding would look like this:\n```js\n// transaction - mostly rlp encoded\n0x00 || rlp([nonce, gasPrice, gasLimit, to, value, data, v, r, s])\n\n// receipt - mostly rlp encoded\n0x00 || rlp([status, cumulativeGasUsed, logsBloom, logs])\n```",
        "created_at": "2020-11-13T16:35:32.492000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "In the minimal-change case, we are still bit packing stuff into `v` here (not separating out `chainId`) and verification is \"annoying\" in that you have to decode, parse, encode, validate.  You also cannot validate without speaking RLP (unlike SSZ, where you can validate without SSZ due to the fact that SSZ is basically a fixed offset encoding for the most part).\n\nUnfortunately, for the receipt we can't do \"SSZ-like\", we have to *actually* use SSZ.",
        "created_at": "2020-11-13T16:37:19.305000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "Couldn't make the call this morning. I'll listen to the recording. However it's there a concise summary of what the push back is on 2718",
        "created_at": "2020-11-13T16:40:10.429000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "No pushback on 2718 really.  Just a general agreement that we should include 2972 in Berlin.",
        "created_at": "2020-11-13T16:40:44.412000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "But that means we have to decide on the format of transactions in 2972 ASAP.  üôÇ",
        "created_at": "2020-11-13T16:40:54.135000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "To SSZ or not to SSZ.",
        "created_at": "2020-11-13T16:41:03.479000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "If advocate for us to not assume people will push back on ssz unless someone actually is",
        "created_at": "2020-11-13T16:41:15.335000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "There has been some light pushback on SSZ mainly because it is a change, and change is risky, especially when we are in a hurry to get Berlin out.",
        "created_at": "2020-11-13T16:41:44.481000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Does anyone know offhand what the variable length data pointer formatting is in SSZ?",
        "created_at": "2020-11-13T16:42:46.434000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Is it number of bytes from start of fixed portion, or number of bytes from end of fixed portion, and is it prefixed with a sentinel byte?",
        "created_at": "2020-11-13T16:43:40.137000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Ah, right.  Little endian format as well.",
        "created_at": "2020-11-13T16:44:32.346000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "(answer is: the offset is in bytes from beginning of payload)",
        "created_at": "2020-11-13T16:46:08.436000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Is `cumulativeGasUsed` a `uint256`?",
        "created_at": "2020-11-13T16:46:55.440000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Seems a bit ridiculous to have it be as such.",
        "created_at": "2020-11-13T16:47:03.573000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "That extra padding for SSZ in the legacy wrapped transaction I guess is negligible, and could go through. But what if any subsequent format would become rather complex to maintain SSZ compatibility and therefore it is decided not to be SSZ compatible.\n\nWhat happens in that case?",
        "created_at": "2020-11-13T16:47:10.453000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "I like having SSZ compatibility, but it would be really good to have some general buy-in and not a sneaky approach.",
        "created_at": "2020-11-13T16:48:03.596000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "What kind of thing would ssz not be able to support?",
        "created_at": "2020-11-13T16:48:23.292000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e I like having SSZ compatibility, but it would be really good to have some general buy-in and not a sneaky approach.\n\u003c@!425279588009246720\u003e I agree.  I *think* there is general buy in on SSZ eventually, and my (weak) argument is \"why not now\".",
        "created_at": "2020-11-13T16:49:15.888000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "It is not about SSZ not being able to support something, albeit people can argue whether it can efficiently encode everything needed.\n\nIt is rather about the fact that the transaction format is **not** ssz encoded in the eyes of the client. It just happens to be compatible.",
        "created_at": "2020-11-13T16:49:17.812000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "The counterargument to \"why not now\" is because \"we are in a hurry now and it isn't critical now\".",
        "created_at": "2020-11-13T16:49:34.341000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "I don't think SSZ vs rlp makes this go any faster",
        "created_at": "2020-11-13T16:50:07.643000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Each transaction type can use its own encoding, so deciding on RLP for 2930 and 2972 wouldn't prevent us from using SSZ in 1559 or 2711.",
        "created_at": "2020-11-13T16:50:21.391000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think that is even less ideal to have both RLP and SSZ encoded new transactions.",
        "created_at": "2020-11-13T16:51:04.077000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "I could see a lot of pushback to adding SSZ versions once RLP versions are already out.",
        "created_at": "2020-11-13T16:51:16.999000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think ETH1.x will *eventually* have to include SSZ libraries?  Is this correct?",
        "created_at": "2020-11-13T16:51:35.976000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "That is, ETH1 and ETH2 cannot merge until ETH1 clients have SSZ support?",
        "created_at": "2020-11-13T16:51:45.929000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "I don't think there's such a strict requirement. It depends on the not-yet-decided method how eth1 gets data from eth2.",
        "created_at": "2020-11-13T16:52:11.268000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "That does strengthen the \"stick with RLP\" argument then.",
        "created_at": "2020-11-13T16:52:29.316000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "I personally would be totally in favour of getting rid of RLP!",
        "created_at": "2020-11-13T16:52:51.119000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Though, it is a tad frustrating because it does seem like most people agree that RLP is not a good fit for transaction/receipt encoding.",
        "created_at": "2020-11-13T16:52:53.705000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "Nobody likes rlp... Who's actually pushing back and saying \"no\"",
        "created_at": "2020-11-13T16:53:04.868000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "And there are supposedly some cool things we can do with proofs if we move to SSZ (that I don't understand).",
        "created_at": "2020-11-13T16:53:07.973000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "But that is a personal preference only. And I think the only way to get it achieved if there is some buy-in and not through the backdoors.",
        "created_at": "2020-11-13T16:53:24.324000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!364458974906548225\u003e there was some pushback a couple of ACDs ago when the discussion shifted to the transaction receipts / blocks. Where one would need to consider introducing some sort of new encoding as well for hashing.",
        "created_at": "2020-11-13T16:54:16.465000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "I don't see this as a backdoor. Nobody is sneaking this in.",
        "created_at": "2020-11-13T16:54:16.472000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think introducing SSZ will significantly delay 2718+2930",
        "created_at": "2020-11-13T16:55:21.048000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "That is under the assumption that adding SSZ support isn't as simple as including some package that was already developed and tested by the ETH2 team?",
        "created_at": "2020-11-13T16:56:50.502000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I don't know what languages already have SSZ support (for various reasons), or whether that support is in a nice easy-to-consume package.",
        "created_at": "2020-11-13T16:57:13.272000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "The geth team would need to weigh in, but I would expect them to want to develop it themselves",
        "created_at": "2020-11-13T16:57:18.265000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "Implementing full SSZ support vs the support needed to decode a known transaction format with a known schema should be less than a day of work.",
        "created_at": "2020-11-13T16:58:09.066000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "https://github.com/ethereum/eth2.0-specs/blob/dev/ssz/simple-serialize.md#implementations",
        "created_at": "2020-11-13T16:58:51.904000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e Implementing full SSZ support vs the support needed to decode a known transaction format with a known schema should be less than a day of work.\n\u003c@!364458974906548225\u003e Unfortunately, I think that may not be true for receipts.  üò¢",
        "created_at": "2020-11-13T16:59:01.808000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "right, they have more complexity",
        "created_at": "2020-11-13T16:59:21.740000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "In particular, receipts have `logs` as the last item, and each log is variable width itself I believe.",
        "created_at": "2020-11-13T16:59:22.640000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "And it seems weird to have a transaction SSZ encoded and its receipt RLP encoded.",
        "created_at": "2020-11-13T16:59:40.251000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "But maybe that is an acceptable compromise to people?",
        "created_at": "2020-11-13T16:59:46.282000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "even still, SSZ isn't that complex",
        "created_at": "2020-11-13T16:59:51.845000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think we should stop assuming there is pushback and actually find out",
        "created_at": "2020-11-13T17:00:15.738000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "You should come to the breakout meeting \u003c@!364458974906548225\u003e, you can champion SSZ!",
        "created_at": "2020-11-13T17:00:41.173000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "(so I don't have to)",
        "created_at": "2020-11-13T17:00:45.409000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "i prefer to not support SSZ",
        "created_at": "2020-11-13T17:01:00.802000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003chttps://discordapp.com/channels/595666850260713488/751450632543535236/776833293495959555\u003e\n\u003e Date \u0026 Time: Nov 16, 2020 at 1500 UTC\n\u003c@!364458974906548225\u003e ‚òùÔ∏è",
        "created_at": "2020-11-13T17:01:10.707000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "Found it, yeah, I can do that.  Is there a calendar invite?",
        "created_at": "2020-11-13T17:01:37.886000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Calendar invite going out tomorrow.  I don't know how to get on the list.  Probably just tell \u003c@!642887713246150666\u003e.",
        "created_at": "2020-11-13T17:01:56.650000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!543900561460822016\u003e Your reasoning is because you suspect that people will want extended testing of the encoder/decoder which will delay things?",
        "created_at": "2020-11-13T17:03:00.876000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e could you put an SSZ schema for the transactions and the receipt in some appendix?",
        "created_at": "2020-11-13T17:03:10.303000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!425279588009246720\u003e Yeah, that is a good idea.",
        "created_at": "2020-11-13T17:03:23.548000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e I am not convinced that the benefits (although might be able to be convinced with a compelling use case) outweigh cost of including another serialization library in eth1 clients. I think it should be added to the wish list (along with no SELFDESTRUCT) for evm2.0",
        "created_at": "2020-11-13T17:05:17.409000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "`uint64` or `uint32` for `cumulativeGasUsed`?",
        "created_at": "2020-11-13T17:09:33.641000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "64",
        "created_at": "2020-11-13T17:09:40.338000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "So we are pessimistic.  üòÑ",
        "created_at": "2020-11-13T17:09:53.898000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "I have been pursuing two EIPs to set limits to these things, but they are still somewhat in limbo.",
        "created_at": "2020-11-13T17:10:18.501000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "what's the hold up?",
        "created_at": "2020-11-13T17:10:29.734000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Lack of time lol üôÇ",
        "created_at": "2020-11-13T17:10:34.606000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Same hold up for most of the good EIPs.  üòõ",
        "created_at": "2020-11-13T17:10:45.904000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Is there a limit on the number of logs in a transaction?",
        "created_at": "2020-11-13T17:11:11.316000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "But basically it was one monster EIP which tried to do it for both the EVM and the protocol. Then we split that EIP to only be concerned with the EVM. Then finally I started to write individual EIPs for each protocol element. It was in essence agreed, but still need to execute on it.",
        "created_at": "2020-11-13T17:11:19.707000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "~~Hmm, SSZ doesn't support more than 32 byte fixed width fields.  So I guess logsBloom has to be in variable width section \u003c@!364458974906548225\u003e?~~ Nevermind, bitvector is what I need.",
        "created_at": "2020-11-13T17:11:59.568000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "https://eips.ethereum.org/EIPS/eip-1985 and https://eips.ethereum.org/EIPS/eip-2681 are the two merged ones. I can pursue these further if we need them due to SSZ in transactions.",
        "created_at": "2020-11-13T17:12:22.798000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "The suggestion on 2681 was to apply it retroactively from genesis. That would be the case for the gas limit too, etc.",
        "created_at": "2020-11-13T17:14:14.383000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I'm a fan of those EIPs.  Wish someone had the time to push them through.",
        "created_at": "2020-11-13T17:14:37.218000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "1985 and 2681 would be awesome to get incorperated into the core protocol",
        "created_at": "2020-11-13T17:15:16.274000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "I can champion 2681, it seems like not much left to bring it over the finish line",
        "created_at": "2020-11-13T17:15:47.799000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "It seems SSZ lists are required to have a max length, which means we need to assert a max number of events in a single transaction.",
        "created_at": "2020-11-13T17:16:08.013000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Most of these limits are the limits in practice because geth implements them.",
        "created_at": "2020-11-13T17:16:08.854000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "If gas limit is uint64, then we can safely assume that event list max is uint64.max üò¨",
        "created_at": "2020-11-13T17:16:48.150000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e there is very little overhead to setting the limit to something that we know we'll never bump up against",
        "created_at": "2020-11-13T17:16:50.303000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "So I guess uint64.max is the number to beat?  üòõ",
        "created_at": "2020-11-13T17:17:07.118000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I feel bad putting in a spec that \"this array can be as big as uint64.max items long\".",
        "created_at": "2020-11-13T17:17:29.949000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "A `LOG` is 200 gas at the minimum, right?",
        "created_at": "2020-11-13T17:17:31.218000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Because that seems *obviously* wrong to me (such an array would crash any machine Ethereum runs on today).",
        "created_at": "2020-11-13T17:17:35.808000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "It is 200 *right now*.  I don't think it necessarily has to be that high forever.",
        "created_at": "2020-11-13T17:17:48.385000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Well, off you go writing a new EIP setting a hard limit for the number of logs in a tx. I suggest 65k üò¨",
        "created_at": "2020-11-13T17:18:19.075000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I don't know that I could bring myself to fight for 65k.  Feels too much like \"256k of memory is all anyone will ever need\".",
        "created_at": "2020-11-13T17:19:10.009000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Hm, 65k is only 13M gas at the minimum cost. Perhaps there is potential for more logs.",
        "created_at": "2020-11-13T17:19:15.779000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "I would say pick a big ass number like uint32.max or uint64.max.  The implications on things like SSZ proof sizes and things should be on the order of a few extra bytes.",
        "created_at": "2020-11-13T17:21:09.603000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Pragmatically uint32.max sounds good. Does this size make any significant difference on the SSZ encoding?",
        "created_at": "2020-11-13T17:21:16.173000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "No, the encoding is the same",
        "created_at": "2020-11-13T17:21:24.556000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "```\nlogs: List[{}, 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff]\n```",
        "created_at": "2020-11-13T17:21:30.022000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "the merkle proofs end up having longer paths but that stuff can all be mostly compressed away",
        "created_at": "2020-11-13T17:21:59.796000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Oh, just like the zeroes out of calldata can be compressed. üòè",
        "created_at": "2020-11-13T17:22:20.845000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Max of 4 topics in a log, right?",
        "created_at": "2020-11-13T17:23:58.575000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Currently.",
        "created_at": "2020-11-13T17:24:07.410000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "```\n  Log:\n    address: uint160\n    topics: List[uint256, 4]\n    data: List[uint8, 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff]\n  Receipt0:\n    type: uint8\n    status: boolean\n    cumulativeGasUsed: uint64\n    logsBloom: BitVector[2048]\n    logs: List[Log, 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff]\n```",
        "created_at": "2020-11-13T17:24:41.231000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "I just did a bunch of work in Alexandria using SSZ merkle proofs for doing provable multipart transmission of data from multiple peers (basically special purpose bitttorrent).  The merkle trees are dense (all the data on the left, all padding on the right, no \"sparse\" sections with a mixture of data/empty/data/empty.   The proofs compress quite nicely.",
        "created_at": "2020-11-13T17:25:21.379000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "You mean just using something off the shelf like gzip?",
        "created_at": "2020-11-13T17:26:05.956000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e would it make sense having status as a number to be forward compatible?",
        "created_at": "2020-11-13T17:26:11.402000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Up to `uint8` is \"free\".",
        "created_at": "2020-11-13T17:26:28.944000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Beyond that and we are paying for extra space.",
        "created_at": "2020-11-13T17:26:33.969000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e You mean just using something off the shelf like gzip?\nno, this: `https://notes.ethereum.org/oUJE4ZX2Q6eMOgEMiQPkpQ?view#Path-Serialization`",
        "created_at": "2020-11-13T17:26:47.780000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think `uint8` is plenty. Well, more than the 2 states of `bool`.",
        "created_at": "2020-11-13T17:26:54.898000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "But `0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff` seems to be `2^256-1` ?",
        "created_at": "2020-11-13T17:27:21.098000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "address maybe as `bytes20` since we tend to treat it as bytes instead of a number (encoding is the same).",
        "created_at": "2020-11-13T17:27:23.430000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "or does the official spec not recognize the `bytesxx` types?",
        "created_at": "2020-11-13T17:27:39.703000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e But `0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff` seems to be `2^256-1` ?\n\u003c@!425279588009246720\u003e I lost count and just kept going... will fix.",
        "created_at": "2020-11-13T17:28:01.868000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e address maybe as `bytes20` since we tend to treat it as bytes instead of a number (encoding is the same).\n\u003c@!364458974906548225\u003e All of my code treats addresses and hashes as numbers, since they are.  üò¨",
        "created_at": "2020-11-13T17:28:58.268000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "The underlying cryptograph spits out numbers, it seems silly to cast them to bytes since you likely just have to turn it back into a number later to use it.",
        "created_at": "2020-11-13T17:29:41.050000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "secp256k1 spits out a number (private key), which you can use to get another number (public key), which you can hash to get another number, which you can mask to get another number (address).",
        "created_at": "2020-11-13T17:30:18.176000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "The only thing that *actually* works on byte arrays is the *input* into hashing functions, but even that spits out a number.",
        "created_at": "2020-11-13T17:30:35.863000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "One could argue that public key to address is actually working with bytes I suppose, but the hashing algorithm spits out a number none the less.",
        "created_at": "2020-11-13T17:31:36.250000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Also, working with bigints (assuming native language support) I find to be a bit easier.",
        "created_at": "2020-11-13T17:32:07.246000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "That rant all being said, I don't feel strongly if people really want bytes20.",
        "created_at": "2020-11-13T17:32:19.774000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "I retract my suggestion üòÑ",
        "created_at": "2020-11-13T17:32:55.748000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Clients and specific tools do make a distinction, because they may be handled very differently byte order wise. That be said, both addresses, hashes (storage keys) are stored as-is and numbers are big endian.",
        "created_at": "2020-11-13T17:33:02.020000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "SSZ is little endian, so that matters.",
        "created_at": "2020-11-13T17:33:50.090000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "We have to decide `bytes20` vs `uint160`, but it doesn't matter which we decide I think.",
        "created_at": "2020-11-13T17:34:22.097000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Once the decision is made we cannot change it though.",
        "created_at": "2020-11-13T17:34:31.058000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Well wouldn't `uint160` be written out as a little-endian number?",
        "created_at": "2020-11-13T17:34:48.914000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yes, on the wire the low bits will be first.",
        "created_at": "2020-11-13T17:35:04.529000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "If it was `bytes20` then the high bits would be first on the wire.",
        "created_at": "2020-11-13T17:35:12.350000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "So we all have to agree which one we are going to use, otherwise people will decode each other's messages incorrectly.",
        "created_at": "2020-11-13T17:35:42.726000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Which is why BigEndian should be used everywhere, so it doesn't matter.",
        "created_at": "2020-11-13T17:36:17.665000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Exactly. Addresses are not considered as numbers in most of Eth \"protocols\", iirc. And it makes a big difference whether the client is using an SSZ implementation to hide this fact, or whether they manually serialise -- and in the latter case this breaks the assumption of every number is serialised big endian (as per RLP).",
        "created_at": "2020-11-13T17:36:34.891000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Bleh, the Big/Little endian thing makes me realize that I can't just say `0 || yParity || r || s || ...`.  I have to specify that `r` and `s` are little endian, which goes against the defacto standard that network protocols are big endian.  üò¢",
        "created_at": "2020-11-13T17:37:30.849000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "SSZ probably went with little endian for the ability of writing without byteswapping on x86/arm.",
        "created_at": "2020-11-13T17:37:31.592000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Computers *like* little endian, and humans like big endian ü§∑‚Äç‚ôÇÔ∏è",
        "created_at": "2020-11-13T17:38:14.722000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "*x86 computers like",
        "created_at": "2020-11-13T17:38:27.675000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "ARM for life!  üòõ",
        "created_at": "2020-11-13T17:38:36.181000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "(I think it is ARM)",
        "created_at": "2020-11-13T17:38:44.130000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "```\nIn [14]: x\nOut[14]: b'\\x00\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\t\\n\\x0b\\x0c\\r\\x0e\\x0f\\x10\\x11\\x12\\x13'\n\nIn [15]: ssz.encode(x, sedes=bytes20)\nOut[15]: b'\\x00\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\t\\n\\x0b\\x0c\\r\\x0e\\x0f\\x10\\x11\\x12\\x13'\n```\n\n`bytes20` might be less of a footgun",
        "created_at": "2020-11-13T17:38:45.225000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "99% of deployed arm is little endian. It can operate in big endian mode too, but most manufacturers chose the little endian verison.",
        "created_at": "2020-11-13T17:38:59.986000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Oh, maybe I'm thinking of RISK?",
        "created_at": "2020-11-13T17:39:23.255000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "(probably dating myself here)",
        "created_at": "2020-11-13T17:39:27.674000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "pretty much everything outside of x86/arm is big endian",
        "created_at": "2020-11-13T17:39:37.452000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "(talking about 32/64-bit processors, 8/16-bit ones are a different breed)",
        "created_at": "2020-11-13T17:40:03.120000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Someone made the argument to me a while back that was convincing and saddening: most humans like BigEndian only because right-to-left languages stole their numbers from left-to-right languages but didn't turn them around.  üò¢",
        "created_at": "2020-11-13T17:41:08.030000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "If those people would have correctly flipped numbers around, then humans and computers would all find little endian easier and none of these problems 10s of thousands of years later would be plaguing us.",
        "created_at": "2020-11-13T17:41:45.314000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e because right-to-left languages stole their numbers from left-to-right languages but didn't turn them around.\n\nDon't you mean the opposite?",
        "created_at": "2020-11-13T17:42:11.935000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Numbers came from Arabic IIRC.",
        "created_at": "2020-11-13T17:42:23.100000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "But Arabic numerals supposedly originate from the Indian subcontinent.",
        "created_at": "2020-11-13T17:42:36.114000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "That is, Persians (I think) were the first to develop a number writing system.",
        "created_at": "2020-11-13T17:42:38.437000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Was Indian subcontinent left to right (back then)?",
        "created_at": "2020-11-13T17:43:11.335000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "And did the Persians not flip?",
        "created_at": "2020-11-13T17:43:30.717000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "It is weird though getting from ssz in transactions to where did numbers came from üò¨",
        "created_at": "2020-11-13T17:43:44.221000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "One could argue that when Arabia stole the numbers from India, they *correctly* didn't flip them.  üòâ",
        "created_at": "2020-11-13T17:45:31.028000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "So bytes20/bytes32 for everything?",
        "created_at": "2020-11-13T17:46:03.943000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Exception for `uint8`, because it doesn't matter.",
        "created_at": "2020-11-13T17:46:37.696000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "What about `cumulativeGasUsed`?  That is definitely a number, not bytes.",
        "created_at": "2020-11-13T17:46:48.701000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "But as `uint64` we now have the endian problem.",
        "created_at": "2020-11-13T17:46:57.386000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Maybe I should just give up on trying to push the \"you don't need a decoder!\" angle?",
        "created_at": "2020-11-13T17:47:20.104000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "https://github.com/ethereum/EIPs/pull/3116/files with the schemas \u003c@!425279588009246720\u003e",
        "created_at": "2020-11-13T17:51:14.376000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Thanks! is the `0x65000000` the fixed length?",
        "created_at": "2020-11-13T17:53:59.222000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "I assume the ssz `bytes` type has a length prefix.",
        "created_at": "2020-11-13T17:54:08.946000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "It is a little endian offset.",
        "created_at": "2020-11-13T17:54:26.802000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "0x65 bytes from the start of the payload is where the signed data lives.",
        "created_at": "2020-11-13T17:54:50.569000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "and the length of it is not stored by ssz?",
        "created_at": "2020-11-13T17:55:03.545000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Hmm, good question on length... let me double check.",
        "created_at": "2020-11-13T17:55:08.111000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!364458974906548225\u003e may be able to answer faster than I can do a refresher (wrote that a while ago).",
        "created_at": "2020-11-13T17:56:26.578000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "https://raw.githubusercontent.com/protolambda/eth2-docs/master/eth2-ssz.png is what I use as a reference.",
        "created_at": "2020-11-13T17:56:53.360000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "It is weird though ssz opted to follow the footsteps of the contract abi, if that is indeed an offset.",
        "created_at": "2020-11-13T17:56:57.538000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "That *is* an offset, like the ABI.",
        "created_at": "2020-11-13T17:57:12.997000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I don't know if there is a length prefix I'm missing though, now that you mention it.",
        "created_at": "2020-11-13T17:57:22.839000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "So then we need to specify a canonical shortest ssz encoding?",
        "created_at": "2020-11-13T17:57:58.154000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Because if transactions are turned to be SSZ by definition (and not a strictly defined serialised version of it), then it is possible to add padding between the offset and the `bytes`.",
        "created_at": "2020-11-13T17:58:29.176000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Ah, I don't know if padding is allowed in SSZ.",
        "created_at": "2020-11-13T17:58:57.804000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "Length is implicitely encoded by the offsets",
        "created_at": "2020-11-13T17:59:18.814000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Either \"to end of stream\" or \"until next item start\"?",
        "created_at": "2020-11-13T17:59:37.363000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "Everything that is variable size is stored at the end, with a section in the middle where the offsets all live.",
        "created_at": "2020-11-13T17:59:38.907000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Ugh. So one needs to know the total length or be certain about eof?",
        "created_at": "2020-11-13T17:59:44.741000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yes, total length of the stream is needed",
        "created_at": "2020-11-13T18:00:23.267000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "You can wrap your SSZ in RLP if you want \u003c@!425279588009246720\u003e.  üòâ",
        "created_at": "2020-11-13T18:00:39.964000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "So it doesn't seem to be suitable at replacing RLP at the devp2p level üôÇ",
        "created_at": "2020-11-13T18:00:43.083000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Hence why people wave for libp2p.",
        "created_at": "2020-11-13T18:00:55.878000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "beacon chain is using it in production in less than 30 days....",
        "created_at": "2020-11-13T18:01:00.115000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e So it doesn't seem to be suitable at replacing RLP at the devp2p level üôÇ\nI don't understand this. can you elaborate?",
        "created_at": "2020-11-13T18:01:24.001000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "devp2p is just a byte stream.  There are no message boundaries built into the protocol aside from what RLP currently provides.",
        "created_at": "2020-11-13T18:01:57.421000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "One cannot rely on streaming decoding on the wire unless the message is prefixed with total length. I imagine there is a message wrapping already, with RLP likely.",
        "created_at": "2020-11-13T18:02:25.172000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "`rlp([ssz(transaction0), ssz(transaction1), ..., ssz(transactionN)]`  üò¨",
        "created_at": "2020-11-13T18:02:41.731000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "If we introduce SSZ with one of these new transactions, that is how it'll come across devp2p.",
        "created_at": "2020-11-13T18:03:15.449000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "And we cannot switch that outere RLP to SSZ.",
        "created_at": "2020-11-13T18:03:24.980000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "I must be missing something, digging around in our DevP2P implementations, messages have a header... seems to have a message length burried in there...",
        "created_at": "2020-11-13T18:05:12.617000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "I haven't touched devp2p the past 3 years and I don't remember whether the outer wrapper just has a fixed 32-bit length field, or everything is RLP wrapped.",
        "created_at": "2020-11-13T18:06:28.382000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "RLPx",
        "created_at": "2020-11-13T18:06:39.513000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e This specification defines the RLPx transport protocol, a TCP-based transport protocol used for communication among Ethereum nodes. The protocol carries encrypted messages belonging to one or more 'capabilities' which are negotiated during connection establishment. RLPx is named after the RLP serialization format. The name is not an acronym and has no particular meaning.",
        "created_at": "2020-11-13T18:06:47.406000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "So I guess *technically* it isn't RLP encoded at the outer layer.  It is sent over RLPx transport.  It isn't a byte stream transport.",
        "created_at": "2020-11-13T18:07:13.888000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "https://github.com/ethereum/devp2p/blob/master/rlpx.md#framing\n\nthere's a `frame-size` which seems to tell us exactly how big the message is...",
        "created_at": "2020-11-13T18:07:32.616000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "```\nframe-data = msg-id || msg-data\nframe-size = length of frame-data, encoded as a 24bit big-endian integer\n```\n\nSo 24-bit.",
        "created_at": "2020-11-13T18:07:49.280000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Heh, I guess that means that we can cap logs to 24-bit.max.  üôÇ",
        "created_at": "2020-11-13T18:08:12.835000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e Note that the frame-size of compressed messages refers to the compressed size of msg-data. Since compressed messages may inflate to a very large size after decompression, implementations should check for the uncompressed size of the data before decoding the message. This is possible because the snappy format contains a length header. Messages carrying uncompressed data larger than 16 MiB should be rejected by closing the connection.\n~~Hmm, maybe not.  I guess ~16,000,000 bytes is the max?~~ oops, that is 2^24",
        "created_at": "2020-11-13T18:09:45.022000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "I remember that discussion, it was added as explicit note to the EIP.",
        "created_at": "2020-11-13T18:10:15.711000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "https://eips.ethereum.org/EIPS/eip-706#avoiding-dos-attacks",
        "created_at": "2020-11-13T18:11:32.289000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Changed to 24-bits for those arbitrarily large fields.",
        "created_at": "2020-11-13T18:13:24.634000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "I guess I can use this in EIP-1985 üòâ",
        "created_at": "2020-11-13T18:14:12.265000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Bleh.  So I just realized that `0 || ssz(variable_length)` is not the same as `ssz(0, variable_length)`",
        "created_at": "2020-11-13T18:14:58.232000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "The offset will change.",
        "created_at": "2020-11-13T18:15:06.012000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Updated my comment in magicians thread.  I still prefer SSZ Duped, but I'm losing conviction given the above realization.",
        "created_at": "2020-11-13T18:25:01.951000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "And RLP single pass is not really that bad when I look at it compared to SSZ Duped.",
        "created_at": "2020-11-13T18:25:47.796000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "Well, we kind of said the type is considered outside of the encoding. Would be cool though to still have it working.",
        "created_at": "2020-11-13T18:55:41.104000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution Layer",
        "parent": "",
        "content": "So the problem is the `bytes` offset would be differnet?",
        "created_at": "2020-11-13T18:55:49.599000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yeah.",
        "created_at": "2020-11-13T19:04:32.954000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "It just ruins one of my stronger arguments in favor of SSZ.",
        "created_at": "2020-11-13T19:04:57.580000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "I'm missing something.  What's the problem?",
        "created_at": "2020-11-13T19:07:04.137000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I just misunderstood something about SSZ and was arguing an incorrect argument.",
        "created_at": "2020-11-13T19:09:28.457000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I thought `ssz(fixed, variable)` was the same as `fixed || ssz(variable)`, but it isn't I believe.",
        "created_at": "2020-11-13T19:10:08.068000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yeah, I think it's something like `fixed || little_endian_4_byte(len(fixed) + 4) || ssz(variable)`",
        "created_at": "2020-11-13T19:11:07.231000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "It would be nice if the variable width offset was from the offset's position, rather than the beginning of the payload.",
        "created_at": "2020-11-13T19:11:10.270000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "That probably comes with its own problems/complexities I suppose.",
        "created_at": "2020-11-13T19:12:06.058000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e It would be nice if the variable width offset was from the pointer, rather than the beginning of the payload.\nI feel like there was a reason for this.  One of the goals of SSZ was being able to quickly find nested data without needing to decode the whole payload....  but that doesn't seem to preclude either choice for offset values (beginning or relative).",
        "created_at": "2020-11-13T19:13:00.075000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Is it allowed to have a gap between fixed width items and variable width items?",
        "created_at": "2020-11-13T19:14:00.649000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "No, must be tightly packed (I think)",
        "created_at": "2020-11-13T19:14:12.655000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Is that actually defined, or just assumed?",
        "created_at": "2020-11-13T19:14:28.019000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "I have a vague memory of a discussion, looking to try and find it in the spec now",
        "created_at": "2020-11-13T19:14:54.844000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Solidity's ABI for example doesn't explicitly specify it and people have exploited that fact.",
        "created_at": "2020-11-13T19:14:58.752000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Many tools assume stuff is tightly packed and break when it isn't.",
        "created_at": "2020-11-13T19:15:25.323000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "Looking at the spec it specifically categorizes SSZ serialization as an \"Injective Function\": https://en.wikipedia.org/wiki/Injective_function\n\nSo that says that there is exactly one correct serialization for any object.  No injection of extra bytes.",
        "created_at": "2020-11-13T19:19:48.294000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "The spec isn't as clear about this as I'd like but I think it's clear enough with careful reading",
        "created_at": "2020-11-13T19:20:35.345000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Execution Layer",
        "parent": "",
        "content": "that seems like a prereq for hashing anyway - if you can represent the same object with different byte serializations, your hashing won't match",
        "created_at": "2020-11-13T19:21:18.446000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "SSZ implements hashing using merklization so it isn't based on the serialization (but for this context I don't think that actually matters since I don't think we're talking about using SSZ hashing.",
        "created_at": "2020-11-13T19:22:01.621000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Execution Layer",
        "parent": "",
        "content": "but the merkleization is based off the serialized bytes right",
        "created_at": "2020-11-13T19:22:26.433000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Execution Layer",
        "parent": "",
        "content": "yeah sorry to barge in on your convo üôÇ",
        "created_at": "2020-11-13T19:23:01.419000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e but the merkleization is based off the serialized bytes right\nNo, it uses a different scheme which chunks things into 32 byte chunks and doesn't do any of the offset encoding",
        "created_at": "2020-11-13T19:23:37.827000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Execution Layer",
        "parent": "",
        "content": "alright",
        "created_at": "2020-11-13T19:24:13.056000+00:00",
        "attachments": null
    },
    {
        "author": "poojaranjan",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e Calendar invite going out tomorrow.  I don't know how to get on the list.  Probably just tell \u003c@!642887713246150666\u003e.\nI am using emails from earlier breakout room meeting calendar to create an invite for this meeting. If this is your first meeting and you'd like to be added on the invite, please DM me your email. Thanks!",
        "created_at": "2020-11-13T19:59:03.951000+00:00",
        "attachments": null
    }
]
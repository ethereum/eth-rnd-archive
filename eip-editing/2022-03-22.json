[
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "What has worked best for me and some others is implementing and testing new proposals in _working_ clients, in whatever language works for the author.  I don't think Core EIPs should get very far past CFI without an implementation. I think that shakes out problems with the spec and turns the job into \"just a port\" for the other teams.  I'd expect this new spec team to do a fair amount of the work getting the EIP into their chosen language, just like any other team.  And I'd expect the champion to help.\n\nAnd again, this doesn't really affect the editors.  It's about how EIP authors can best work with the Core Devs.  It could be _more_ work for the editors if we are supposed to edit Python.",
        "created_at": "2022-03-22T05:00:42.605000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!905058765022310460\u003e said in \u003c#745077610685661265\u003e \n\u003e While creating a PR for a change is maybe too much work, what about insisting on test cases as a compromise. Defining specific inputs and their respective desired output helps already a lot in implementing a change and avoiding misunderstandings.\nre-posting it just so I can emoji react üëç üéâ to it.",
        "created_at": "2022-03-22T12:50:05.026000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "When we get to a place of having a complete spec for a client in this new form we can talk about whether and how to get EIPs into it and who is going to do that work.",
        "created_at": "2022-03-22T13:20:31.465000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think there is value in figuring out our trajectory in advance because we need to figure out how to deal with execution and consensus specifications *today*.",
        "created_at": "2022-03-22T14:54:09.169000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "And it would be nice to not have to pivot solutions shortly after solving that problem.",
        "created_at": "2022-03-22T14:54:27.645000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution Layer",
        "parent": "",
        "content": "So maybe it‚Äôs a combination of making the inline spec optional (and if missing, a link to the executable spec), and requiring tests?",
        "created_at": "2022-03-22T14:57:05.533000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution Layer",
        "parent": "",
        "content": "The one thing is that EIP editors can‚Äôt really gauge if the sting coverage is sufficient without a deep dive in the EIP",
        "created_at": "2022-03-22T14:57:27.683000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "The reference implementation - inline or not - is already optional.  As is the language - and hopefully client - in which it is implemented.  The trajectory I'd envision is that it's the job of those  maintaining the execution spec to work with the author to get it right - in that respect they are no different than any other client team.  Ideally the execution spec, the clients, and the EIP all hit the mainnet and go Final at the same time.",
        "created_at": "2022-03-22T15:12:42.321000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "That said, \u003c@!425279588009246720\u003e and team are already using Python to express data structures and validation algorithms in recent EIPs.  So the transition may happen over time of its own accord.",
        "created_at": "2022-03-22T15:15:34.188000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think we disagree about the purpose of the execution spec, though",
        "created_at": "2022-03-22T15:16:15.165000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution Layer",
        "parent": "",
        "content": "You seem to see it as just another client, but I think it has most of the value when it is, early in the process, the canonical implementation from which we can then generate tests and discuss edge cases",
        "created_at": "2022-03-22T15:16:53.115000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "It's not the best analogy.  If it exists that early the execution spec is very useful, but it's likely that what the author has is in the language of the client they're working in ... Go, C++, Rust ...  (Re-)writing in language of the execution spec (or the Yellow Paper) is more like a port in that case.\n\nMy pushback is that writing an EIP is already a hard job.  And this doesn't make the Editors' job any easier.  So it's really up to core devs what quality of spec they demand.",
        "created_at": "2022-03-22T16:05:59.158000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "What?",
        "created_at": "2022-03-22T16:08:03.748000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "unknown.png",
                "content": "9847da963a6e80f7bd4b73f751e5a6518c07ac79a9cece64d10ef5d29236b2ce"
            }
        ]
    },
    {
        "author": "m.kalinin",
        "category": "Execution Layer",
        "parent": "",
        "content": "Something weird is happening on GH. I couldn't apply a suggestion from the code review, then it got applied but without any effect. Probably it's a GH issue you're facing with",
        "created_at": "2022-03-22T16:12:08.472000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "Well, \u003c@!291925846556540928\u003e, this is the link you need:\nhttps://github.com/runtimeverification/deposit-contract-verification",
        "created_at": "2022-03-22T16:13:38.853000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Odd... GitHub outage maybe?",
        "created_at": "2022-03-22T19:21:18.020000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "If we have a hard requirement that when the status is changed to Review the EIP must include a link to a diff of the executable spec (or whatever form we expect it to take) then I think it actually makes editor job slightly easier because there is a consistent and simple to validate requirement.  Author job I suspect will be easier for many because expressing their change through a PR is likely easier than expressing a change via English.",
        "created_at": "2022-03-22T19:24:19.549000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "Ideally it'll be way easier to implement an EIP in the `execution-spec` repo than it will be to implement in a production client.",
        "created_at": "2022-03-22T19:31:18.768000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "If it isn't, I'd say the specs project has failed.",
        "created_at": "2022-03-22T19:32:38.559000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "The effect of an EVM opcode can generally be expressed in a few mathematical expressions or an English paragraph whose meaning is clear in the context of the Yellow Paper, or even just a general understanding of how the EVM works.  A PR on a particular client would be much more verbose and likely not readable outside the context of that client.  I suspect PRs for other changes would have similar issues.\n\nThere really is a point to this canonical spec.  It comes down to at what point in the process, if at all, does it become a requirement, and who enforces it?",
        "created_at": "2022-03-22T19:33:52.282000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think the execution spec needs to track the Yellow Paper very closely.",
        "created_at": "2022-03-22T19:35:31.295000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "Using an excerpt from EIP-3074:\n\n\u003e The context variable authorized shall indicate the active account for AUTHCALL instructions in the current frame of execution. [...]\n\u003e \n\u003e The variable has the same scope as the program counter ‚Äì authorized persists throughout a single frame of execution of the contract, but is not passed through any calls (including DELEGATECALL). If the same contract is being executed in separate execution frames (ex. a CALL to self), both frames shall have independent values for authorized. Initially in each frame of execution, authorized is always unset, even if a previous execution frame for the same contract has a value.\n\nCompared to the diff:\n\n```patch\ndiff --git a/src/ethereum/byzantium/vm/__init__.py b/src/ethereum/byzantium/vm/__init__.py\nindex ee57b6e60..71f29e2d4 100644\n--- a/src/ethereum/byzantium/vm/__init__.py\n+++ b/src/ethereum/byzantium/vm/__init__.py\n@@ -67,6 +67,7 @@ class Evm:\n     \"\"\"The internal state of the virtual machine.\"\"\"\n \n     pc: Uint\n+    authorized: Optional[Address]\n     stack: List[U256]\n     memory: bytearray\n     code: Bytes\n```",
        "created_at": "2022-03-22T19:37:19.339000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "(removed some context, to make it a fair comparison)",
        "created_at": "2022-03-22T19:38:07.642000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003e RETURNSUB (0x??)\n\u003e Returns control to the caller of a subroutine.\n\u003e *   Pop the return stack to PC.\n\u003e The cost is verylow.",
        "created_at": "2022-03-22T19:44:46.096000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "How to say this?",
        "created_at": "2022-03-22T19:44:59.991000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "You'd be surprised how much code that is in Geth.",
        "created_at": "2022-03-22T19:45:29.154000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "Roughly something like:\n\n```python\ndef returnsub(evm: Evm) -\u003e None:\n    evm.gas_left = subtract_gas(evm.gas_left, GAS_VERY_LOW)\n    jump_dest = pop(evm.return_stack)\n\n    if jump_dest not in evm.valid_jump_destinations:\n        raise InvalidJumpDestError\n\n    evm.pc = Uint(jump_dest)\n```",
        "created_at": "2022-03-22T19:46:54.700000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "ouch",
        "created_at": "2022-03-22T19:47:22.024000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "(not sure if we need the valid jump check)",
        "created_at": "2022-03-22T19:47:22.531000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "The checks come in the validation phase.  As with Wasm they can be specified entirely declaratively.",
        "created_at": "2022-03-22T19:48:10.823000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "I do very much appreciate declarative specifications! What does Wasm use for their computer-tractable declarative specs?",
        "created_at": "2022-03-22T19:51:13.405000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "We wanted the specs to be approachable, so we went with a procedural style.",
        "created_at": "2022-03-22T19:51:36.873000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "But I'd be open to something else!",
        "created_at": "2022-03-22T19:51:43.340000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "What are your complaints?",
        "created_at": "2022-03-22T19:52:06.135000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "English and some standard notation (not sure which.). THey promise that the two mean exactly the same thing.",
        "created_at": "2022-03-22T19:52:20.507000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "We should hire whoever keeps that promise ü§£",
        "created_at": "2022-03-22T19:53:54.450000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "Wasm has a formal organization with a remit to keep it.",
        "created_at": "2022-03-22T19:54:26.277000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "My worry is that you can state declaratively - formally or in English - things that you can't say in a procedural language.  Or at least that you can't say concisely.",
        "created_at": "2022-03-22T19:54:49.113000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "I'm also concerned about that...",
        "created_at": "2022-03-22T19:55:13.326000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "The Yellow Paper uses mathematics that way.",
        "created_at": "2022-03-22T19:55:54.642000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "Easy math, actually.",
        "created_at": "2022-03-22T19:56:01.882000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "The Yellow Paper is certainly more succinct and accessible to its intended audience.",
        "created_at": "2022-03-22T19:57:07.796000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "But I wouldn't say it's more accessible to devs than the python spec.",
        "created_at": "2022-03-22T19:57:23.537000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "It depends.  It's more accessible to formalists.",
        "created_at": "2022-03-22T19:58:01.511000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "Are core devs formalists?",
        "created_at": "2022-03-22T19:58:14.875000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "Their work product could stand to be formally verified - the execution spec might help.",
        "created_at": "2022-03-22T19:59:15.770000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "Have you seen the formal verification of the Deposit Contract I linked to above?",
        "created_at": "2022-03-22T19:59:53.111000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "Having a spec for formal verification would be sweet",
        "created_at": "2022-03-22T19:59:53.973000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "It's based on K spec of the EVM.",
        "created_at": "2022-03-22T20:00:08.343000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "Note:  I can read the Yellow Papers spec of the EVM pretty easily.  I can't read the K.",
        "created_at": "2022-03-22T20:01:30.821000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "We lose general accessibility there üò¶",
        "created_at": "2022-03-22T20:01:37.953000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "The math that the Yellow Paper uses really is pretty easy.  Tuples.  Simple logic.  It's just badly written.",
        "created_at": "2022-03-22T20:02:40.100000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "No argument here",
        "created_at": "2022-03-22T20:03:51.259000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "The notation is a bit obtuse, but yeah, it could be fixed.",
        "created_at": "2022-03-22T20:04:10.748000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "No differential equations ...",
        "created_at": "2022-03-22T20:05:02.079000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "No Hilbert spaces ...",
        "created_at": "2022-03-22T20:05:19.900000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "üòâ",
        "created_at": "2022-03-22T20:05:30.645000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "What I think we want from our next-generation EIP process is:\n\n - Accessible: EIP authors/editors and core devs need to be able to read and contribute to the spec.\n - Specific: There should be little guesswork for core devs to figure out what needs to be implemented.\n - Succinct: No one wants to review thousands of lines to figure out what's happening.\n - Testable: Should be able to check the specification against concrete test inputs/outputs (and it should be able to fill tests.)\n\nThose are my goals, and I'd be very open to feedback on those points and suggestions for more.",
        "created_at": "2022-03-22T20:10:07.101000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "The current EIP process is Accessible and Specific, but often times not Succinct and definitely not Testable.",
        "created_at": "2022-03-22T20:10:30.580000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "Writing something in K would be Specific, Succinct, and Testable, but extremely not Accessible.",
        "created_at": "2022-03-22T20:11:16.293000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "Exactly.  Runtime Verification is making a business of it.  Academics are making theses and careers of it.",
        "created_at": "2022-03-22T20:12:13.088000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yep. The first group that makes a normal looking language (see https://steveklabnik.com/writing/the-language-strangeness-budget) that adds good formal verification tooling is gonna make bank.",
        "created_at": "2022-03-22T20:14:05.429000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "dafny looks... tempting.",
        "created_at": "2022-03-22T20:14:17.545000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "C",
        "created_at": "2022-03-22T20:14:33.131000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "I kid you not.",
        "created_at": "2022-03-22T20:14:48.371000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yeeeaaah, but you lose too many features that way.",
        "created_at": "2022-03-22T20:14:59.825000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "This doesn't need to descend into a discussion about language design though lmao",
        "created_at": "2022-03-22T20:15:16.942000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "First you write an interpreter for the language you really want...",
        "created_at": "2022-03-22T20:15:28.906000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "Those descents are so fun ... üòâ",
        "created_at": "2022-03-22T20:15:44.353000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "10,000% agree.",
        "created_at": "2022-03-22T20:15:58.976000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "_needs to save this somewhere so I don't create a completely different set of goals in the future ü§£_",
        "created_at": "2022-03-22T20:16:49.652000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "hehe  I think my main pushback remains - make it too hard to propose improvements and they won't get proposed.  And if you really want things to be done in a language besides English be prepared to do them - to a large extent - yourselves. (That will motivate Succint too.)",
        "created_at": "2022-03-22T20:19:09.850000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution Layer",
        "parent": "",
        "content": "So I guess your argument, in terms of the goals above, is that python falls short of the Accessibility goal?",
        "created_at": "2022-03-22T20:23:21.355000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yes.",
        "created_at": "2022-03-22T21:08:15.983000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution Layer",
        "parent": "",
        "content": "Might not too Succint either.  Which is OK - nothing is accessible to everyone for every purpose - so long as the maintainers of the Python spec can take the lead on getting it right.",
        "created_at": "2022-03-22T21:11:07.978000+00:00",
        "attachments": null
    }
]
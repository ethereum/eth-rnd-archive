[
    {
        "author": "anetteth",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'm proposing to rework the ERCs approval process, I wrote down more on FEM forum. Comments are welcomed https://ethereum-magicians.org/t/rework-erc-process-from-eips/6488",
        "created_at": "2021-06-15T09:51:58.270000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "cc \u003c@250259755484839957\u003e maybe?  I don't know who has write access to the EIPs repository, but my inbox is filling with spam from this one user account.",
        "created_at": "2021-06-15T11:08:48.873000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@!689161464829050960\u003e \u003c@!543900561460822016\u003e \nWhat is the reason behind using an auto generator for rendering files in `eth1.0-specs`? \nA few problem/concerns that I have:\n- IIUC, our ultimate goal is to merge this into the `eth2.0-specs` repo . In `eth2.0-specs` repo markdown is manually written by the dev. This will cause compatibility  problems for formatting.\n- There's no way I can organise the content in a meaningful way. I can't write table of contents in a nested way . \n- Whenever I desire to add custom formatting it's not possible. eg. I don't know how to add description for Constants declared in a file. eg. https://github.com/ethereum/eth2.0-specs/blob/dev/specs/phase0/weak-subjectivity.md#custom-types",
        "created_at": "2021-06-15T16:10:35.041000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think we prefer to generate the documentation from the code rather than the reverse (the way the eth2 specs does it). Formatting will be a bit more challenging than with the eth2 specs repo, but i expect everything else will be more pleasant (e.g. don't need to also maintain a markdown-\u003epython transpiler).",
        "created_at": "2021-06-15T16:18:04.448000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "With sphinx we should have complete control over how the generated documentation looks, it's just a matter of getting it setup",
        "created_at": "2021-06-15T16:18:40.899000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "And what do we do when we merge the two projects?\nHave part generated by sphinx and part generated manually?",
        "created_at": "2021-06-15T16:29:56.397000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "i'm not sure how or when we'll merge the two repositories, but yes if we do merge them then we'll generate the execution level with sphinx and the eth2 markdown will be as-is",
        "created_at": "2021-06-15T16:31:00.108000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "Just curious: Has this discussion already taken place? And does everyone agree with this approach?",
        "created_at": "2021-06-15T16:32:32.653000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@!291925846556540928\u003e what are your thoughts on us taking the code -\u003e docs approach?",
        "created_at": "2021-06-15T16:33:25.323000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "imo, regardless of whether we eventually convert it to the markdown format or not - we have to start with the code so we can build and test the spec",
        "created_at": "2021-06-15T16:34:47.968000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@!543900561460822016\u003e I think it's an easier question to ask if you had an example of the code inlining that you and I explored last week.",
        "created_at": "2021-06-15T16:35:27.681000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e imo, regardless of whether we eventually convert it to the markdown format or not - we have to start with the code so we can build and test the spec\nFair enough. I can do with that. I won't care too much about generating a meaningful doc in that case.",
        "created_at": "2021-06-15T16:38:37.483000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "We basically have complete control and can pluck whatever we want from the code and use it however we like in the docs. For example, the rendered `Env` info (https://quilt.github.io/eth1.0-specs/autoapi/eth1spec/evm/index.html#environment) comes from the `Env` docstring https://github.com/quilt/eth1.0-specs/blob/pyspec/src/eth1spec/evm/__init__.py#L20",
        "created_at": "2021-06-15T16:41:11.769000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "that's a simple example, but we can also write plugins that interpret the docstrings however we want",
        "created_at": "2021-06-15T16:41:58.355000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "the overall file layout comes from: https://raw.githubusercontent.com/quilt/eth1.0-specs/pyspec/doc/_templates/autoapi/python/module.rst",
        "created_at": "2021-06-15T16:43:11.319000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "but we can tailor the layout files be more narrative rather than more documentation focused (sort of like the eth2 repo)",
        "created_at": "2021-06-15T16:43:45.537000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@!543900561460822016\u003e Any idea how I could add description to constants/global attributes?",
        "created_at": "2021-06-15T16:59:08.589000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Cross-layer",
        "parent": "",
        "content": "Im happy with our approach due to spec rendering as first class as well as any magic being hidden in setup.py (e.g. overriding functions and cache implementations)\n\nFor your current project, getting functionality is 10x more important than debating format. I think it'd be best to conform on a format in the long term if possible but if necessary we can delay that conversation for now.  Heh\n\nThe thing we'd first do on eth2 side is important the eth1 execution engine as a lib for end to end tests and experiments which means the projects can be rendered independently\n\nBut long term itd be cool to agree and have the projects maintained similarly\n\nI also  acknowledge my bias. I like the way we do it because its the way we've done it. I havent spent much time debating the merits of different spec formats for years now and am happy give it more thought and discussion",
        "created_at": "2021-06-15T16:59:53.779000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "Sounds good, i also agree we shouldn't get too caught up in the format until things are more functional. Thanks for weighing in!",
        "created_at": "2021-06-15T17:00:59.670000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "Place the docstring after the assignment:\n\n```\nSOME_CONSTANT = \"foo\"\n\"\"\"\nThis is the docstring for SOME_CONSTANT\n\"\"\"\n```",
        "created_at": "2021-06-15T17:05:24.644000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "From my somewhat limited understanding of sphinx, we get complete control over the generated documentation. If we want to go 100% manual, we can hand write every line of the docs in reStructuredText if we want to.\n\nI've chosen to go with autoapi for this first pass,because, like \u003c@!543900561460822016\u003e has said, we want to prioritize getting a complete specification without bikeshedding too much on the documentation itself. The downside to autoapi is that we lose some control over the autogenerated pages.",
        "created_at": "2021-06-15T17:10:19.495000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "That said, there are quite a few upsides to using sphinx+autoapi, like:\n\n - Auto-linking to types and functions.\n - Uniform look and feel.\n - Less chance of documentation getting out-of-sync with the code.\n - Uses traditional python tooling instead of custom markdown linkers.",
        "created_at": "2021-06-15T17:11:43.349000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "I have a fairly strong preference for autogenerating the documentation from the code, but I'm open to being convinced otherwise ðŸ˜„",
        "created_at": "2021-06-15T17:14:20.722000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "My biggest complaint so far is that reStructuredText is _really_ foreign.",
        "created_at": "2021-06-15T17:14:43.054000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "My concern is that I don't want to over engineer when  we come across a case where some desired formatting is not handled by sphinx out of the box.\neg. I'm not sure how to auto inline/nest table of contents other than writing a decorator like `depends_on`\nI don't want to ever inspect the AST just to generate a doc. \n\nAnyway, I will leave this conversation here as other suggested that getting a working is far more important than generating the doc",
        "created_at": "2021-06-15T17:27:40.729000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "Where are you looking to put a table of contents, and what would the sections be?",
        "created_at": "2021-06-15T17:28:21.055000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "here's an eg og table of contents in the eth2.0 repo: https://github.com/ethereum/eth2.0-specs/blob/dev/specs/phase0/fork-choice.md#table-of-contents",
        "created_at": "2021-06-15T17:29:40.345000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "That already is autogenerated, no?",
        "created_at": "2021-06-15T17:30:43.067000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "unknown.png",
                "content": "8fb5d1f439990ad937296dc3cc23154f3228a5ddd0b74239114cbe67d152ecd0"
            }
        ]
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "Eg for validating headers I have a couple of related methods: \n- verify header:\n     - validate_gas_limit\n     - calculate_block_difficulty",
        "created_at": "2021-06-15T17:31:56.609000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "I don't see any nesting",
        "created_at": "2021-06-15T17:32:22.037000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "I can't see a way to group methods this way using a table. Also, how do you decide dependency? The only way I can think of doing this is by using a decorator: lets call it `related_to`",
        "created_at": "2021-06-15T17:36:07.900000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "Dependency? Not sure I follow.",
        "created_at": "2021-06-15T17:42:24.709000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "Ah, like you'd want to group several methods together by topic, but have them appear on the same HTML page?",
        "created_at": "2021-06-15T17:43:04.726000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@!497280885645639691\u003e was using a class with the `@classmethod` attribute to do that, but we went with just bare functions instead.",
        "created_at": "2021-06-15T17:45:01.101000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "Unfortunately the templates for `@classmethod` would need some work, but I think we could use them to implement the kind of nesting you want.\n\nHonestly, I'm not sure how much value dividing things into subsections like that really brings.\n\nCould try playing with the `.. contents::` directive, and see what it outputs too: https://docutils.sourceforge.io/docs/ref/rst/directives.html#table-of-contents",
        "created_at": "2021-06-15T17:52:30.543000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e Dependency? Not sure I follow.\nSince all methods are separate, there needs to be a way to tell sphinx that  some methods need to be grouped together.",
        "created_at": "2021-06-15T17:52:35.132000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "Give me a few minutes to render an example. (Was trying to do it quickly, but I may as well do the whole thing and take a screenshot)",
        "created_at": "2021-06-15T17:59:46.564000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@!689161464829050960\u003e Appreciate it! But Let's put our efforts on getting a working version first. We can change the formatting later.",
        "created_at": "2021-06-15T18:01:52.271000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "The only reason I was asking was because I was trying to replicate the  `eth2.0-spec`  formatting.",
        "created_at": "2021-06-15T18:03:06.189000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "Trust me, I'm way more useful on the tooling side than the specification side ðŸ˜‰",
        "created_at": "2021-06-15T18:07:57.476000+00:00",
        "attachments": null
    },
    {
        "author": "voith",
        "category": "Cross-layer",
        "parent": "",
        "content": "As you wish. I was just making sure that I don't waste your time.",
        "created_at": "2021-06-15T18:10:40.959000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "I put up a PR that makes the sphinx documentation look more like the eth2.0-specs format.",
        "created_at": "2021-06-15T21:55:06.964000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "WithMinorTemplateFixes.png",
                "content": "53a40e851ebc5615c15ca95e3796d7bc07fe29d37e000d6f79c59300d9bdea99"
            }
        ]
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "And here's what we can do if we sacrifice a little bit of automation: https://samwilsn.github.io/eth1.0-specs/autoapi/eth1spec/fork_choice/index.html",
        "created_at": "2021-06-15T21:58:05.651000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Cross-layer",
        "parent": "",
        "content": "(I did that latter version pretty quickly and it has some glitches ^^;;)",
        "created_at": "2021-06-15T22:08:12.086000+00:00",
        "attachments": null
    }
]
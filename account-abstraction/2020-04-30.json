[
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "As I mentioned it earlier, it might be worth briefly talking about separately: The current plan at least for our AA MVP is to have AA contracts be normal contracts with a fixed code prefix that asserts the contract was called from a special `ENTRY_POINT` address.",
        "created_at": "2020-04-30T00:27:46.575000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We are for now working with the prefix mentioned above:\n\u003e which is\n\u003e `0x3373ffffffffffffffffffffffffffffffffffffffff14601e57600080fd5b`",
        "created_at": "2020-04-30T00:28:55.304000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I have also written a little tool to inject that prefix into any contract creation bytecode, which effectively turns the deployed contract into an AA test contract:",
        "created_at": "2020-04-30T00:30:45.143000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "https://github.com/adietrichs/aa-tools",
        "created_at": "2020-04-30T00:30:46.358000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The tool basically injects the prefix at the beginning of the contract code and fixes all resulting `JUMPDEST` offset problems. It is obviously purely for testing purposes - before AA ever reaches mainnet we would have proper support for it directly in Solidity.",
        "created_at": "2020-04-30T00:32:34.098000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But if you replace the `ENTRY_POINT` address with one you control, you can already play around with the tool and see it working on-chain ðŸ™‚",
        "created_at": "2020-04-30T00:33:23.561000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Besides that I have just written up a short list of some of the open questions around AA that we as Quilt have been discussing internally:",
        "created_at": "2020-04-30T00:35:26.081000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "https://hackmd.io/@KuiKHwIPT4e8_VWfnKLHvw/Byd91DvKI",
        "created_at": "2020-04-30T00:35:27.868000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Always happy about feedback!",
        "created_at": "2020-04-30T00:35:55.115000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think we will probably start sharing more of our progress here in this channel as our MVP implementation in geth is coming along.",
        "created_at": "2020-04-30T00:38:36.470000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I propose something like:\n\n```\nCALLER\nGETPC\nADD\nPUSH1 0x1e  ; Needs to be updated\nJUMPI\n```\n\nInstead of the current AA check.",
        "created_at": "2020-04-30T01:22:13.531000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "_laughs in codegolf._",
        "created_at": "2020-04-30T01:22:31.508000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "interesting, probably something we would do for production, \"find the shortest / cheapest bytecode sequence with the same effect\"",
        "created_at": "2020-04-30T01:23:26.051000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Hm, nope.",
        "created_at": "2020-04-30T01:24:11.318000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "obv. the second part (revert if no jump and then the jumpdest) is missing, and you would have to adjust the jump target - but apart from that it should work",
        "created_at": "2020-04-30T01:24:19.497000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Address is 160 bits, wraps at 256",
        "created_at": "2020-04-30T01:24:20.891000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ah, good point",
        "created_at": "2020-04-30T01:24:30.515000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "well, nice try then ðŸ˜‰",
        "created_at": "2020-04-30T01:24:50.162000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We might have to change the prefix anyway though, to allow for incoming ETH transfers",
        "created_at": "2020-04-30T01:28:01.804000+00:00",
        "attachments": null
    },
    {
        "author": "ansgar.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e https://hackmd.io/@KuiKHwIPT4e8_VWfnKLHvw/Byd91DvKI\nI think I mention that in here. Also still not sure if the prefix is even the way to go, but of course for the MVP we will stick to it.",
        "created_at": "2020-04-30T01:29:08.842000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e which is\n\u003e `0x3373ffffffffffffffffffffffffffffffffffffffff14601e57600080fd5b`\n\u003c@415548822983278593\u003e Why not `PUSH1 2 PUSH1 160 EXP PUSH1 1 SUB`? Fewer bytes",
        "created_at": "2020-04-30T20:26:40.401000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Or I think `PUSH1 2 PUSH1 160 EXP NEG NOT` works too and is a byte shorter",
        "created_at": "2020-04-30T20:27:41.146000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Oh oh `PUSH1 32 DUP EXP NEG NOT`",
        "created_at": "2020-04-30T20:28:51.209000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ðŸ¤£",
        "created_at": "2020-04-30T20:28:59.784000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "cheapest for 160bits of ones: `0 NOT 12 SHR` (maybe took the wrong SHR operand order)",
        "created_at": "2020-04-30T20:31:38.574000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Aah right SHR got included",
        "created_at": "2020-04-30T20:31:56.262000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "OK you win",
        "created_at": "2020-04-30T20:32:05.772000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And NEG doesn't exist it turns out so mine is 1 longer than youurs ðŸ˜©",
        "created_at": "2020-04-30T20:32:51.533000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Though `2**160 = 32**32` is a fun coincidence",
        "created_at": "2020-04-30T20:33:07.019000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e OK you win\n\n:celebrating:",
        "created_at": "2020-04-30T20:35:52.054000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If the arg order of SHR was the reverse `PUSH1 12 DUP NOT SHR` would win but it's not ðŸ˜¢",
        "created_at": "2020-04-30T20:36:48.953000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Oh oh `PC NOT PUSH1 12 SHR` OK finally 5 bytes",
        "created_at": "2020-04-30T20:38:12.909000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "oh its starting at PC=0",
        "created_at": "2020-04-30T20:39:31.070000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(Had no idea what the code is about just jumped in arguing)",
        "created_at": "2020-04-30T20:40:12.340000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Any PC under `2**96` would give a correct answer ðŸ¤£",
        "created_at": "2020-04-30T20:40:50.163000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Could also use `MSIZE` (just for the fact I'm toying with the idea proposing to remove `PC` opcode)",
        "created_at": "2020-04-30T20:41:18.483000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e Any PC under 2**96 would give a correct answer ðŸ¤£\n\nFair point ðŸ™‚",
        "created_at": "2020-04-30T20:49:29.318000+00:00",
        "attachments": null
    }
]
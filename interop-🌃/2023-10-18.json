[
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@\u0026595683609080365088\u003e you guys might wanna have a look here: https://dora.dencun-devnet-9.ethpandaops.io/slots\n\nPrysm basically forked off into its own thing. The trigger is known, its from blobber(https://github.com/marioevz/blobber/), ill let \u003c@892053833121923094\u003e explain what exactly it did. \n\nLogs are attached, but `ssh devops@167.99.43.168` will also work.",
        "created_at": "2023-10-18T16:55:00.880000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "message.txt",
                "content": "04c80ae60d7842f56a430bf57f562c9483cfe92ac3ef6a3a66dcd2a3296db4dc"
            }
        ]
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "It's basically this issue described here: https://discord.com/channels/595666850260713488/1161380667632910476/1162088841927200958\n\nThe blobber broadcasted two different blobs with the same blob index, correct signature, correct kzg, to different peers",
        "created_at": "2023-10-18T16:56:33.584000+00:00",
        "attachments": null
    },
    {
        "author": "sauliusgrigaitis",
        "category": "Testing",
        "parent": "",
        "content": "why such behaviour is not slashed?",
        "created_at": "2023-10-18T17:03:41.404000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "Oh, that seems like a legitimately slashable thing. There have been many suggestions of \"slashing\" criteria, and many of them involve ... sort of a subjective judgement of less than ideal behavior, but not unambiguously incorrect behavior. This though.",
        "created_at": "2023-10-18T17:09:39.516000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "(to be fair, some of it's just misunderstanding, and people conflate \"penalties\" with \"slashing\")",
        "created_at": "2023-10-18T17:10:49.872000+00:00",
        "attachments": null
    },
    {
        "author": "sauliusgrigaitis",
        "category": "Testing",
        "parent": "",
        "content": "not sure I understood the reason ðŸ™‚ But this seems like an objective slashing case",
        "created_at": "2023-10-18T17:11:16.917000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "yeah, I agree",
        "created_at": "2023-10-18T17:11:41.241000+00:00",
        "attachments": null
    },
    {
        "author": "sauliusgrigaitis",
        "category": "Testing",
        "parent": "",
        "content": "it looks pretty much like alternative block case",
        "created_at": "2023-10-18T17:12:14.545000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "I guess the theory is it gets caught elsewhere? as in, it won't correspond to the block",
        "created_at": "2023-10-18T17:12:19.715000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "we donâ€™t run any slashers now",
        "created_at": "2023-10-18T17:12:19.998000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e blob sidecars are not slashable",
        "created_at": "2023-10-18T17:12:42.658000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "we might wanna start running one tho",
        "created_at": "2023-10-18T17:12:42.904000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e the protocol does not know anything about these signed sidecars",
        "created_at": "2023-10-18T17:12:52.923000+00:00",
        "attachments": null
    },
    {
        "author": "sauliusgrigaitis",
        "category": "Testing",
        "parent": "",
        "content": "slashers would not help as it's not in the protocol",
        "created_at": "2023-10-18T17:12:53.984000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e this is handled primarily through just gossip anti-dos considerations as well as the disincentive of orphaning your blolck â€” in the event of double signing here, you are primarily just reducing your ability for your block to be attested to in a timely manner",
        "created_at": "2023-10-18T17:13:47.734000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e this could be elevated to an in-protocol slashing condition but won't be for deneb at this point",
        "created_at": "2023-10-18T17:14:19.040000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e that said â€” prysm and others should be able to resolve conflicts that are created in this manner. Realyl valuable that mario and co are now performing these types of network tests/",
        "created_at": "2023-10-18T17:14:56.367000+00:00",
        "attachments": null
    },
    {
        "author": "sauliusgrigaitis",
        "category": "Testing",
        "parent": "",
        "content": "ok, I get the motivation, slashing just feels safer ðŸ™‚",
        "created_at": "2023-10-18T17:23:28.805000+00:00",
        "attachments": null
    },
    {
        "author": "sauliusgrigaitis",
        "category": "Testing",
        "parent": "",
        "content": "I need to think a bit more about it, but it's kinda an attack surface that may lead to a chain split, especially if some scenario makes some client to not fetch the right blob. With slashing this would at least cost something.",
        "created_at": "2023-10-18T17:27:55.154000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "There's definitely more going on: https://dora.dencun-devnet-9.ethpandaops.io/slots\nnimbus-nethermind is now on its own fork too. \nWe now have 3 forks:\n- the canonical fork with everyone\n- fork with prysm-geth-1\n- fork with nimbus-nethermind-1 (seems like it atleast)\n\nThe dora slots page visualizes it for us. You can also see the clients page for a mini forkmon on the CL side: https://dora.dencun-devnet-9.ethpandaops.io/clients",
        "created_at": "2023-10-18T17:59:19.234000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "so under some conditions clients can fork off completely and don't seem to recover, even in a finalizing network",
        "created_at": "2023-10-18T17:59:40.412000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "checking LH nodes",
        "created_at": "2023-10-18T18:03:21.752000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Looking Pari, is the first block with invalid DA the one you linked here? in slot 138840?",
        "created_at": "2023-10-18T18:13:50.956000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "I think it was on 138835, conflicting blobs are:\n ```\ntime=\"2023-10-18T16:47:00Z\" level=debug msg=\"Broadcasting signed blob sidecar\" block_root=de01f5bffd3d221b5b83e9896cda92172b09b2d3b847bc18ff1a4a13ec5385f2 id=1 index=0 kzg_commitment=9132d9b91260cc1218ebd0ec8c8ea283ea1197c6ea4e9f2f6519d7b592783825d1b645590242d681442e8d59bbfb290e message_id=c40d0395708f0876427e85e48a8faccb41d4631f signature=b955d55edfb7faa83d9a756df92db01edd42812ee059caec185d4e7014f94aa95882d8478784b0a9272280f5a18d414616e0cbb286e6503213568c0ea3d37699581aeff7238d5fb4a73afef5dc65e627a265cb587770e8792de9f1cc96403ecc slot=138835 topic=/eth2/833cea70/blob_sidecar_0/ssz_snappy\ntime=\"2023-10-18T16:47:00Z\" level=debug msg=\"sending message to peers\" data-length=120042 peers=\"[16Uiu2HAkzHaDMFnKsNujV9QMFqBbgRnZUhmBif2v7x7wCfw9X6WU 16Uiu2HAmFVu2btKuoGBZm27oz458LtuUvQPo3RsRxVicgWuFpf12]\" topic=/eth2/833cea70/blob_sidecar_0/ssz_snappy\n\ntime=\"2023-10-18T16:47:00Z\" level=debug msg=\"Broadcasting signed blob sidecar\" block_root=de01f5bffd3d221b5b83e9896cda92172b09b2d3b847bc18ff1a4a13ec5385f2 id=2 index=0 kzg_commitment=947ec21b9edcbcee75ae74577ae6cc1900fadb749686f8ec58e8ff3de3ccc0cf12a60fb57a1ae0069736b68782fd5327 message_id=044f578609c4a3f0d55cb894b9021c4ccf4ad620 signature=88e5ce29623c92c64b068111e509f624656edb351e2fb6612e4c48c9259cc992a26a89114a15059c653fb82cf3c4d23818008ef06b5a4da280b2ed5dce8170661a732ffcc643d4d1ebf5e4fb220e37fefab14758043c9687de8a8e0528d60a06 slot=138835 topic=/eth2/833cea70/blob_sidecar_0/ssz_snappy\ntime=\"2023-10-18T16:47:00Z\" level=debug msg=\"sending message to peers\" data-length=131356 peers=\"[16Uiu2HAmEedcnc9cFKku2SheDUYsFxDDHHbX6p5FMgLTKTrNjVvN]\" topic=/eth2/833cea70/blob_sidecar_0/ssz_snappy\n```",
        "created_at": "2023-10-18T18:14:57.342000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Ah thanks, so I need to get the previous logs, will see if I'm in those machines",
        "created_at": "2023-10-18T18:15:23.180000+00:00",
        "attachments": null
    },
    {
        "author": "pk910",
        "category": "Testing",
        "parent": "",
        "content": "https://dora.dencun-devnet-9.ethpandaops.io/slots?s=138880\u0026c=50\n prysm-geth-1 forked off at 138839 \nthat's the last canonical block where the fork started.  first non-canonical block was 138847",
        "created_at": "2023-10-18T18:17:01.578000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "We process correctly that block",
        "created_at": "2023-10-18T18:20:09.379000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "We only fail 5 slots later in 40",
        "created_at": "2023-10-18T18:21:01.448000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "right, we canÂ´t import 40",
        "created_at": "2023-10-18T18:21:21.212000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@686695036733227017\u003e do you know if 40 had bad proofs?",
        "created_at": "2023-10-18T18:21:57.570000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "I only have logs for the 35, it could be that the blobber proposed again at 40",
        "created_at": "2023-10-18T18:24:08.118000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "~~I think not, the only proposal I'm seeing is on 138835~~",
        "created_at": "2023-10-18T18:26:02.426000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Ah thanks, anyway, I think we are aware that we are vulnerable to this, prysm will not be able to sync that block because we only have the bad blobs on db",
        "created_at": "2023-10-18T18:26:09.967000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "we need a refactor to fix this attack",
        "created_at": "2023-10-18T18:26:16.505000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Wait yes, there is indeed another proposal at 138840 from the same client and I guess the blobber too",
        "created_at": "2023-10-18T18:27:56.390000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "It kept proposing for an hour: https://dora.dencun-devnet-9.ethpandaops.io/slots/filtered?f\u0026f.missing=1\u0026f.orphaned=1\u0026f.pname=lighthouse-nethermind-1\nBut the last ones have been orphaned so there's probably some clients already banning it",
        "created_at": "2023-10-18T18:29:20.963000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Surprising we haven't been fully banned yet tbh. There's a decent proposal frequency on that nodes validator",
        "created_at": "2023-10-18T18:31:17.630000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Yeah, I refreshed and the blocks don't appear as orphaned anymore, it's still going",
        "created_at": "2023-10-18T18:31:59.266000+00:00",
        "attachments": null
    },
    {
        "author": "pk910",
        "category": "Testing",
        "parent": "",
        "content": "yea, can't fully trust the orphaned/proposed mark there at the moment.  The explorer uses the last block with highest slot number as canonical head and goes back from there.\nI've already improved that logic, will be shipped soon ðŸ™‚",
        "created_at": "2023-10-18T18:34:07.379000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "we can also get forky on for the next devnet ðŸ˜„",
        "created_at": "2023-10-18T18:36:51.696000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "No one should be banning it, this may be indeed be a problem. You have no way of knowing the blobs are bad until you get the block in which case you have already forgotten who gave you the blob. The only reason it may be being banned by some nodes is that those nodes forked off a while ago and then the validator running that proposer is on a wrong fork from their view. Prysm will definitely fork off in this case, 40 will never be possible to sync until we passed the retention window",
        "created_at": "2023-10-18T18:36:57.226000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I presume if Nimbus went on it's own fork they are also subject to it.",
        "created_at": "2023-10-18T18:37:41.013000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "will check the Nimbus node in question",
        "created_at": "2023-10-18T18:40:31.832000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "but I don't think Nimbus has any special protections against this",
        "created_at": "2023-10-18T18:40:52.138000+00:00",
        "attachments": null
    },
    {
        "author": "__kasey__",
        "category": "Testing",
        "parent": "",
        "content": "re lack of ban, maybe because it's being added as a trusted peer (because it doesn't implement full consensus)",
        "created_at": "2023-10-18T18:40:56.852000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "we're not using trusted peers in this case ðŸ˜„",
        "created_at": "2023-10-18T18:42:16.796000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "fyi, stopped blobber for now. We're at like 72% participation now and i think since we know the root cause, more chaos won't help.",
        "created_at": "2023-10-18T18:56:07.330000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Testing",
        "parent": "",
        "content": "Thanks for this. On a short vacation. I'll look into this tonight ðŸ™‚",
        "created_at": "2023-10-18T21:21:47.853000+00:00",
        "attachments": null
    }
]
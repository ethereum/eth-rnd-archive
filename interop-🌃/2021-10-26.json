[
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cparithoshj\u003e just sent you a bunch, you are now a whale :P\n0x181a91d33fdccc5f145663298993d83a94a0982b4b3d3f2737174cbdd02f13c6 (re @amphora_interop_bot: \u003cMariusVanDerWijden\u003e\u003c@199561711278227457\u003e I could create some big blocks if you can send me some eth to test: 0xb02A2EdA1b317FBd16760128836B0Ac59B560e9D)",
        "created_at": "2021-10-26T11:24:13.461000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cparithoshj\u003e I don't think it took that long to sync up when i tried it in other EL/CL combos. I can recreate it later on to re-confirm though - Only have vague memories right now. (re @amphora_interop_bot: \u003cterence\u003eCurious how many slots / s for syncing on other CL implementations. Prysm is currently under optimized as we disabled batch sync. Since CL has to synchronously call to EL in the current interop API spec, CL batch block validation makes less sense)",
        "created_at": "2021-10-26T11:24:52.874000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Hi, where can I read the EL/CL API and the expected behavior of clients?, \u003chttps://github.com/ethereum/consensus-specs/blob/dev/specs/merge/p2p-interface.md\u003e is mainly a stub. Concretely I want to understand this: If I leave the execution client running and wipe prysm's dbase, it start syncing from scratch and sends the full execution payload to the execution client. Then the latter (geth in this case) logs that it's syncing an already known block. I wonder if this is the expected behavior or if the beacon should have first asked if execution already knew the payload hash and avoid sending the whole thing if it got a reply.",
        "created_at": "2021-10-26T13:22:57.070000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e The api‚Äôs live here under the engine namespace\nhttps://github.com/ethereum/execution-APIs",
        "created_at": "2021-10-26T13:30:44.500000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e they are being iterated on in smoe functionality",
        "created_at": "2021-10-26T13:30:52.992000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e currently",
        "created_at": "2021-10-26T13:30:55.763000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Thanks, so browsing in \u003chttps://github.com/ethereum/execution-apis/blob/main/src/engine/interop/specification.md\u003e couldn't find anything that would work like asking the execution engine if it already has the block. Perhaps for an initial sync this may be useful? or is it already there?",
        "created_at": "2021-10-26T13:46:24.188000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!755590043632140352\u003e That was what I was talking about here...",
        "created_at": "2021-10-26T13:48:30.167000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "It doesn't ask about it. It just sends `executePayload` and according to current design if EL doesn't have a parent it initiates the sync process and responds with `SYNCING`",
        "created_at": "2021-10-26T13:48:39.666000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I thought you meant executing it again. I think during syncing we can avoid even sending the block",
        "created_at": "2021-10-26T13:49:56.151000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "if we assume trust in our execution client, we can ask if it has it already, or even better ask what's the hash at a given height, and not send anything up to that height",
        "created_at": "2021-10-26T13:50:30.780000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "EL may take a short path and do not execute already executed block",
        "created_at": "2021-10-26T13:50:38.888000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "yeah, that I assumed already happen, what I mean is that the CL not clog the wire with not needed blocks",
        "created_at": "2021-10-26T13:51:02.941000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "why do an extra roundrip if it just may respond with `VALID` in this case?",
        "created_at": "2021-10-26T13:51:09.836000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "so I suggest not even sending the execution payload",
        "created_at": "2021-10-26T13:51:11.236000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "This is probably worth doing if we'd like to reduce the traffic between CL and EL",
        "created_at": "2021-10-26T13:51:57.333000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I mean the following workflow: 1) Hello, I am a consensus client, about to start syncing 2) Hello, I am your execution engine, already have blocks up to this height with this hash, just send me the hashes to confirm you are on the right track",
        "created_at": "2021-10-26T13:52:28.088000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "and then resume usual operation once that height is reached.",
        "created_at": "2021-10-26T13:52:43.272000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "yeah, that's what I mean",
        "created_at": "2021-10-26T13:52:55.725000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "Also, it could reduce database look ups on EL side as to verify each block it has to query it in order to check the status of this block. But I don't think that traffic and database lookups are really the things we would like to optimise by introducing extra messages to the Engine API. Not sure if frequency of real use cases for this addition worth the complexity",
        "created_at": "2021-10-26T13:55:32.245000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "This will be useful every time that a new validator spins up in a pool that centralizes execution (for example for MEV) or for any client that uses a third party execution. Without entering into an argument about proof of custody, I think we can safely assume there will be plenty of validators that will not run an execution client",
        "created_at": "2021-10-26T16:21:23.428000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I think I hit something on pithos... My node seems to be out of sync with the network and the explorer might be down",
        "created_at": "2021-10-26T17:31:08.547000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I send a few (thousand) transactions",
        "created_at": "2021-10-26T17:31:28.853000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e \u003e Without entering into an argument about proof of custody, I think we can safely assume there will be plenty of validators that will not run an execution client\nthis might be the case until we brick such a configuration because laziness is  unsafe.\nbut we can argue about that some other time",
        "created_at": "2021-10-26T17:32:10.430000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e I don‚Äôt really see much issue in CL just inserting and getting ‚ÄúVALID‚Äù in return if the EL has already validated",
        "created_at": "2021-10-26T17:32:39+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e in a local setting, it‚Äôs extremely low amount of work, especially because CL will liekly start from a state less than a week or two old",
        "created_at": "2021-10-26T17:33:00.859000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2021-10-26T17:33:28.377000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "message.txt",
                "content": "e4a5f69b4d93956bb5e1c9040d92cf9865e34da7c6ac6d72a8cf5b5458ff886a"
            }
        ]
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e and given execution PoC is critical for security, I don‚Äôt think it valuable (and maybe detrimental) to optimize the API for third-party ELs",
        "created_at": "2021-10-26T17:33:44.638000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "explorer definitely doesn't look healthy..",
        "created_at": "2021-10-26T17:34:34.145000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "although progress still seems to be occurring here\nhttps://pithos.consensus-monitor.stokes.io/",
        "created_at": "2021-10-26T17:35:32.681000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "actually explorer looks fine",
        "created_at": "2021-10-26T17:37:54.970000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "which slot was the invalid payload in?",
        "created_at": "2021-10-26T17:38:12.670000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "The explorer doesn't properly index blocks with TXs in them",
        "created_at": "2021-10-26T17:38:52.933000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "so I think we are seeing that with all the Missed",
        "created_at": "2021-10-26T17:38:59.059000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "but then the prysm/geth rejection is more concerning",
        "created_at": "2021-10-26T17:39:07.799000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I think 88000 +-2",
        "created_at": "2021-10-26T17:39:08.122000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "my node just crashed and now I can' t find peers, but I think my crash had nothing to do witht the testnet",
        "created_at": "2021-10-26T17:40:13.492000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cvdWijden\u003e I'm compiling lh to see if I fried my geth or my prysm node",
        "created_at": "2021-10-26T17:41:42.691000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "the explorer shows missed the blocks 87016 -- 88050",
        "created_at": "2021-10-26T17:47:46.723000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "And the explorer shows the last proposed block with an execution block 73027 and then 73122 is the next proposed block in the proposer. But I have exactly after the last proposed block in the explorer, a sequence of execution blocks that included transactions:  starting in 73028",
        "created_at": "2021-10-26T17:51:43.100000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "73044 is the last execution block my geth node synced with hash `0xaacc16c551b72c0debdf...`",
        "created_at": "2021-10-26T17:53:36.593000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "So prysm synced up to block 87940 here that included the execution block 73044 and that was the last one I managed to sync",
        "created_at": "2021-10-26T17:56:59.102000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "this is a bit before you \u003c@!360491619402776577\u003e",
        "created_at": "2021-10-26T17:57:19.623000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cterencechain\u003e At 88103, on Prysm, I got execution engine is syncing\nOn the Geth, I got blockhash mismatch, want a87af1f8d8abf7a983acad147a57ad765dea35bffcfddd198b119a0f435fd2f1, got 0ba0bcf8219a58d9d74f17faf59c9974e0ae53c1a685ad02ea0eb35345bd4d0a\"\nWill look more into this when I get home",
        "created_at": "2021-10-26T17:58:48.152000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I started a the spamming roughly around block 73027",
        "created_at": "2021-10-26T17:59:53.388000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "yeah the first block with transactions was the next one",
        "created_at": "2021-10-26T18:00:25.642000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "My latest block is 73067",
        "created_at": "2021-10-26T18:00:32.084000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "with hash 0xe986e84c52d32fdaf3909e9978f68cdf5da0ca4ca7722cc5e77c26ebe0abc6e6",
        "created_at": "2021-10-26T18:00:51.549000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "ok, so my geth and prysm died before both of you",
        "created_at": "2021-10-26T18:00:53.241000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "and I can't peer anylonger",
        "created_at": "2021-10-26T18:01:03.663000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Testing",
        "parent": "",
        "content": "interestingly they managed to sync to the head of the chain despite the errors",
        "created_at": "2021-10-26T18:01:13.713000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Is this an issue on prysm, geth, or other clients are experiencing the same?",
        "created_at": "2021-10-26T18:01:26.862000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cMarekM25\u003e I checked our logs (Nethermind + Teku, Lighthouse, Lodestar) are looking fine. The last forkchoiceUpdated message from Nethermind + Prysm I had around 19:20.",
        "created_at": "2021-10-26T18:06:29.363000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I'm checking on Teku+geth and it has the latest blocks",
        "created_at": "2021-10-26T18:09:56.775000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cvdWijden\u003e I've been sending all kind of weird transactions, maybe there was another issue with ssz for 1559 or AccessList transactions",
        "created_at": "2021-10-26T18:11:42.733000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cparithoshj\u003e Afaik the explorer had issues and it displayed blocks with transactions as missing. I think proto is at dinner, but he might be able to chime in on that later on. \nThe forkmon seems to show some nodes with issues, but most of them still look fine.  SSH'ed into pithos-lighthouse-geth-15 and the logs don't show anything out of the ordinary. (re @amphora_interop_bot: \u003cpotuz\u003ethe explorer shows missed the blocks 87016 -- 88050)",
        "created_at": "2021-10-26T18:16:37.387000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Just got a bad block on pithos",
        "created_at": "2021-10-26T18:47:56.809000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2021-10-26T18:48:00.093000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "message.txt",
                "content": "451d381f2238d24c3d81ef593c508cb0bbe3794d933bccc893e489bfc7be6f30"
            }
        ]
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "geth-lh",
        "created_at": "2021-10-26T18:48:23.542000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Alright something is weird üòÑ",
        "created_at": "2021-10-26T18:49:27.680000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2021-10-26T18:51:21.028000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "message.txt",
                "content": "f444e6c16059df92402f5c87fc1f962b72105a30656f7b122286f7a3e40e3455"
            }
        ]
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "Is it a common validator node type producing he bad blocks?",
        "created_at": "2021-10-26T18:58:22.629000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "I can confirm, i see that on the lighthouse-geth-15 node as well, it happened around block `88418` and again later on `88421`",
        "created_at": "2021-10-26T19:26:33.538000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "message.txt",
                "content": "70e4562a84fda8de799b513e0dc2cd826cc30a4e40ec2823961726cad60c04c4"
            }
        ]
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "88418 was supposed to be proposed by validator #19025 - so lodestar-besu\n88421 was supposed to be proposed by validator #12720 - so lighthouse-geth",
        "created_at": "2021-10-26T19:29:22.001000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "side note, i setup a new teku-geth node just to ensure peering, sync works - it took ~50mins to sync to head and still had 12 peers at the end",
        "created_at": "2021-10-26T19:30:20.902000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "validator number to combo mapping for reference:\n```\n#0-15000 lighthouse-geth\n#15000-16000 lighthouse-nethermind\n#16000-17000 lighthouse-besu\n#17000-18000 lodestar-geth\n#18000-19000 lodestar-nethermind\n#19000-20000 lodestar-besu\n#20000-21000 nimbus-geth\n#21000-22000 nimbus-nethermind\n#22000-23000 nimbus-besu\n#23000-38000 teku-geth\n#38000-39000 teku-nethermind\n#39000-40000 teku-besu\n```",
        "created_at": "2021-10-26T19:40:51.548000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cvdWijden\u003e Lh-geth took ~20 min to sync but had some problems with loosing peers",
        "created_at": "2021-10-26T19:43:20.516000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I can't find peers at all  üò¶ and don't want to wipe the dbase cause that will take the whole day to resync",
        "created_at": "2021-10-26T20:29:14.055000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Testing",
        "parent": "",
        "content": "i have optimizations that make prysm sync speed x5 if you are interested, didnt care to push it until the API gets more finalized and the next testnet",
        "created_at": "2021-10-26T20:30:48.124000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "but are you currently following head with prysm?",
        "created_at": "2021-10-26T20:31:11.248000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "It's fine \u003c@!363800010518822915\u003e no need to push over this, anyway tomorrow this  box was going to be down to look into the fork. I have here the blocks that Marius sent so I can also look to see if it's an ssz issue.",
        "created_at": "2021-10-26T20:33:11.468000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Testing",
        "parent": "",
        "content": "Im following head without any issue. Maybe you can just peer with me and see if that works",
        "created_at": "2021-10-26T20:34:39.420000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Testing",
        "parent": "",
        "content": "Will DM you",
        "created_at": "2021-10-26T20:34:44.247000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "hello, do the beacon chain has the ability to submit multiple payloads in one go?",
        "created_at": "2021-10-26T21:24:47.025000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "i saw from the spec that executePayload only takes one payload",
        "created_at": "2021-10-26T21:25:11.773000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e as of now, no\nThe idea is that after EL and CL are in sync (and normally just following the head) that you insert in lockstep in a 1:1 basis\nWhen EL is syncing, they can employ existing network sync methods to more quickly and optimally sync historic data",
        "created_at": "2021-10-26T21:26:46.080000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e some discussion on how CL will utilize the API when EL is SYNCING\nhttps://github.com/sigp/lighthouse/issues/2691",
        "created_at": "2021-10-26T21:27:03.597000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "the beacon chain submits the blocks to execution layer, but after EL syncs up to \"The Merge\" block, then it must wait and do everything on a 1:1 basis. at least as it is specified",
        "created_at": "2021-10-26T21:32:03.365000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "just trying to make things clear",
        "created_at": "2021-10-26T21:32:13.774000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "it is actually critical that CL does not block when EL says SYNCING\n\nbecause continually updated info about the recent head is critical to most EL sync methods. (the parallel is to keep getting PoW block headers that have a good PoW seal so that you know which chain you should be trying to sync (state sync or block sync asside)",
        "created_at": "2021-10-26T21:33:40.542000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "\u003e at least as it is specified\n\nThe consensus spec does specify this. And from a full validation standpoint, this is true. But from a practical standpoint wrt the engine API, the expectation is for CL to \"optimistically\" keep transitioning forward on the beacon chain even if EL is \"SYNCING\".",
        "created_at": "2021-10-26T21:34:29.647000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "This allows for EL to be in charge of getting to the head when initially syncing and also allows EL to employ any technique at it's disposal for failure recovery",
        "created_at": "2021-10-26T21:35:00.330000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "imagine this for a thought experiment:\n\n* CL is stable\n* An annoying script locally switchs EL-1 on and EL-2 off every 100 blocks (and then vice versa) \n\nIn such a case, every 100 blocks, EL will get a payload from a branch it hasn't seen and say... `SYNCING` (I don't know enough to resolve this).\nEL will then  attempt to patch that branch in while CL gives a few more blocks (still getting `SYNCING` in response) until a few bocks later EL can respond with `VALID` (or `INVALID`) at which point on subsequent inserts, the CL and EL just operate in lockstep\n\n^ until of course your local script switches the underlying EL node 100 blocks laer",
        "created_at": "2021-10-26T21:37:58.512000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "the API could be designed to have CL try to patch EL when blocks are missing, but any such design would heavily imply how EL should do sync of various lengths when EL is already an expert at it's own sync",
        "created_at": "2021-10-26T21:39:51.973000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "[side note, you could add a singular method back to CL from EL that would allow for fetching of payloads from CL. This is a nice-to-have optimization that would allow EL to work the local CL into it's recovery/sync methods]",
        "created_at": "2021-10-26T21:40:32.755000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "essentially -- when EL gets a payload it doesn't have info to resolve, EL is best suited to employ techniques to fill in the gaps -- p2p sync, torrent download, fetching from CL, etc. So the API is designed to enable EL to do so rather than force a single method of CL doing so",
        "created_at": "2021-10-26T21:41:57.867000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "no, okay i get that CL syncs while EL syncs. my question is different: CL will basically supply payloads to EL and expect an answer from it. does that mean that during a first sync, once we reach the top of POW and we switch to POS, execution will process one payload at a time?",
        "created_at": "2021-10-26T21:50:35.909000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "that is not necessarily the case. And we can't even assume that CL will necessarily execute from genesis (or the point of the pos transition)\n\nFor a full block sync on EL, the following is the current design --\n* CL would start from a recent checkpoint and begin sending payloads and forkchoice info to EL \n* EL would see that it isn't synced and respond with `SYNCING`\n* EL would use the recent calls from CL to ascertain info about the current head of the chain\n* EL would reverse header sync from p2p based on these heads\n* EL would forward block sync from there\n* CL continues to try to insert payloads, EL rturns `SYNCING` while syncing, then eventually returns `VALID` once it got to the head. lockstep from there (unless failure from there)",
        "created_at": "2021-10-26T21:54:02.434000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "okay, now the process is more clear to me",
        "created_at": "2021-10-26T21:57:21.495000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "sorry, the expected usage of the engine API is poorly documented atm",
        "created_at": "2021-10-26T21:58:02.556000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "working a lot on that currently",
        "created_at": "2021-10-26T21:58:06.896000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "thank you that helped clear some of my doubts",
        "created_at": "2021-10-26T21:58:53.402000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "The engine API is attempted to be designed to be agnostic  to how an EL node is managed/optimized during sync and failure recovery\n\nThus, the CL continues to give head info to EL so that EL can decide how it wants to resolve any such issues.",
        "created_at": "2021-10-26T22:00:14.140000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "do you know at what rate you'd expect to be querying blobs during range sync?",
        "created_at": "2023-06-21T00:10:25.405000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "I think pawan meant 768 total blobs per 10 seconds, not 768 requests",
        "created_at": "2023-06-21T00:11:10.799000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "same for blocks",
        "created_at": "2023-06-21T00:11:24.352000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "looks like most validator balances have been drained, and now we are down from 1550 to 250 active validators.",
        "created_at": "2023-06-21T06:59:51.831000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "```Epoch 1108:\n  Proposals: 30/32 (93.75%)\n    Slot 35484 (28/32) validator 1143 not proposed or not included\n    Slot 35485 (29/32) validator 1137 not proposed or not included\n  Attestations: 225/250 (90.00%)\n    Source timely: 225/250 (90.00%)\n    Target correct: 225/250 (90.00%)\n    Target timely: 225/250 (90.00%)\n    Head correct: 225/250 (90.00%)\n    Head timely: 209/250 (83.60%)\n```",
        "created_at": "2023-06-21T07:00:03.259000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "Doing the math correctly, at maximum, with current setting, we request maximum 200 blocks and 200\\*6 blobs per minute for a given peer. But we do sync in 5 parallel batches of 50 slots (so 50\\*6 = 300 blobs max) selecting random peers, so we may reach the limit only if we peek same peer 3 times (out of 5) as source of batch.\nDo you rate limit on actual blobs sent or based on the request only? (I don't think there are so many blobs actually)",
        "created_at": "2023-06-21T07:23:56.637000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@607055410104500244\u003e is it possible that lighthouse trucates blob response data",
        "created_at": "2023-06-21T10:10:25.147000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "for e.g. from logs we get this response (we request blocks and blobs for a particular epoch in our range requests)",
        "created_at": "2023-06-21T10:10:51.217000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "blocks we get: ```\nblocks [\n  { slot: 160, commitments: 0 },\n  { slot: 161, commitments: 0 },\n  { slot: 162, commitments: 0 },\n  { slot: 163, commitments: 0 },\n  { slot: 165, commitments: 0 },\n  { slot: 166, commitments: 0 },\n  { slot: 167, commitments: 0 },\n  { slot: 168, commitments: 0 },\n  { slot: 169, commitments: 0 },\n  { slot: 170, commitments: 0 },\n  { slot: 171, commitments: 0 },\n  { slot: 172, commitments: 0 },\n  { slot: 174, commitments: 0 },\n  { slot: 175, commitments: 0 },\n  { slot: 176, commitments: 0 },\n  { slot: 177, commitments: 0 },\n  { slot: 178, commitments: 0 },\n  { slot: 179, commitments: 0 },\n  { slot: 180, commitments: 0 },\n  { slot: 181, commitments: 0 },\n  { slot: 182, commitments: 0 },\n  { slot: 183, commitments: 0 },\n  { slot: 184, commitments: 4 },\n  { slot: 185, commitments: 6 },\n  { slot: 186, commitments: 6 },\n  { slot: 187, commitments: 6 },\n  { slot: 188, commitments: 6 },\n  { slot: 190, commitments: 6 }\n]\n```",
        "created_at": "2023-06-21T10:11:07.382000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "blobs we get: ```\nblobs [\n  { slot: 184, index: 0 }, { slot: 184, index: 1 },\n  { slot: 184, index: 2 }, { slot: 184, index: 3 },\n  { slot: 185, index: 0 }, { slot: 185, index: 1 },\n  { slot: 185, index: 2 }, { slot: 185, index: 3 },\n  { slot: 185, index: 4 }, { slot: 185, index: 5 },\n  { slot: 186, index: 0 }, { slot: 186, index: 1 },\n  { slot: 186, index: 2 }, { slot: 186, index: 3 },\n  { slot: 186, index: 4 }, { slot: 186, index: 5 },\n  { slot: 187, index: 0 }, { slot: 187, index: 1 },\n  { slot: 187, index: 2 }, { slot: 187, index: 3 },\n  { slot: 187, index: 4 }, { slot: 187, index: 5 },\n  { slot: 188, index: 0 }, { slot: 188, index: 1 },\n  { slot: 188, index: 2 }, { slot: 188, index: 3 },\n  { slot: 188, index: 4 }, { slot: 188, index: 5 },\n  { slot: 190, index: 0 }, { slot: 190, index: 1 },\n  { slot: 190, index: 2 }, { slot: 190, index: 3 }\n]\n```",
        "created_at": "2023-06-21T10:11:29.857000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "so clearly blobs by range do not have all the blobs in response for this epoch",
        "created_at": "2023-06-21T10:12:09.316000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "is the truncation also followed by other clients?",
        "created_at": "2023-06-21T10:12:43.686000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "(our req/resp handler throws error if there is mismatch and reject the entire response) as our batch download utility works on epoch by epoch",
        "created_at": "2023-06-21T10:13:33.940000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "peer info: `Jun-21 10:26:19.001[network]       verbose: Req  done method=beacon_blocks_by_range, version=2, encoding=ssz_snappy, client=Lighthouse, peer=16...RGhFwV, requestId=25537\n`",
        "created_at": "2023-06-21T10:26:38.183000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "this is the error we throw: ```\nun-21 10:26:19.002[sync]          verbose: Batch download error id=Finalized, startEpoch=5, status=Downloading Missing blobSidecars for blockSlot=190 with blobKzgCommitmentsLen=6 blobSidecars=4\nError: Missing blobSidecars for blockSlot=190 with blobKzgCommitmentsLen=6 blobSidecars=4\n    at matchBlockWithBlobs (file:///usr/app/packages/beacon-node/src/network/reqresp/beaconBlocksMaybeBlobsByRange.ts:95:7)\n    at beaconBlocksMaybeBlobsByRange (file:///usr/app/packages/beacon-node/src/network/reqresp/beaconBlocksMaybeBlobsByRange.ts:46:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at wrapError (file:///usr/app/packages/beacon-node/src/util/wrapError.ts:18:32)\n```",
        "created_at": "2023-06-21T10:27:52.934000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "what would teku do in such a scenaio \u003c@504202741933932544\u003e",
        "created_at": "2023-06-21T10:42:16.121000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "as client, while syncing, in this scenario we fail importing the batch and disconnect from the peer. As a server we should not do that, if we accept the request we give all blobs",
        "created_at": "2023-06-21T11:16:35.264000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "As client we do not trigger any missing blobs downloading in that case because we assume that server gives all blobs",
        "created_at": "2023-06-21T11:18:34.377000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "i wonder how can teku sync to head from lighthouse nodes if lighthouse nodes give such a response",
        "created_at": "2023-06-21T11:34:48.632000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "there was also a similar issue in previous run of devnet when lodestar again couldn't sync off the lighthouse nodes because of similar blob missing response, and i think we should resolve this before moving to next run of the devnet",
        "created_at": "2023-06-21T11:43:31.171000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "(and hopefully resolve before the genesis moves out of blob retention window of 4096 epochs  = 18 days since then blobs previous to this window will be cleaned out then forcing us to do checkpoint sync)",
        "created_at": "2023-06-21T11:45:20.168000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@412614104222531604\u003e how many days old is the genesis?",
        "created_at": "2023-06-21T11:46:04.067000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "if teku is synced to head does teku has the blobs? \u003c@412614104222531604\u003e \u003c@504202741933932544\u003e how can we check this for slot 190",
        "created_at": "2023-06-21T11:46:57.108000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "MIN_GENESIS_TIME: 1686904463",
        "created_at": "2023-06-21T11:47:51.399000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "in days? ðŸ˜†",
        "created_at": "2023-06-21T11:48:04.187000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "GMT: Friday, 16 June 2023 08:34:23",
        "created_at": "2023-06-21T11:48:28.358000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "5.1 d",
        "created_at": "2023-06-21T11:48:47.172000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "awesome, so still time to comfortably debug",
        "created_at": "2023-06-21T11:49:24.390000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Yes",
        "created_at": "2023-06-21T11:49:30.465000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003ctbenr\u003e I'll check it once back from lunch. We implemented getBlobs API",
        "created_at": "2023-06-21T11:49:50.263000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Is there an api call to query blob data?",
        "created_at": "2023-06-21T11:49:58.839000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "looking into this now, thanks this is very useful we've been trying to find an example of where this might be happening",
        "created_at": "2023-06-21T11:52:19.359000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "i guess like this?\n`/eth/v1/beacon/blob_sidecars/{block_id}`",
        "created_at": "2023-06-21T11:52:23.255000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "yes",
        "created_at": "2023-06-21T11:53:45.310000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "yes, we have that endpoint implemented I just queried it. At slot 190 we have all 6 blobs on the node that served that request, so they are in the db. It must be an issue of when we're constructing the rpc response",
        "created_at": "2023-06-21T11:53:52.520000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "awesome great to hear!",
        "created_at": "2023-06-21T11:54:14.170000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Everyone can query all endpoints with the basic auth username and password btw",
        "created_at": "2023-06-21T11:54:55.200000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@277500722655002624\u003e could you make the blob publish thing's image public? i can't seem to pull it",
        "created_at": "2023-06-21T12:22:25.044000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "and it refuses to build in a reasonable time on my machine",
        "created_at": "2023-06-21T12:22:40.518000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "docker build fails with this:\n```\n =\u003e ERROR [build 3/3] RUN dotnet publish ./src/Nethermind/Nethermind.SendBlobs/Nethermind.SendBlobs.csproj --sc -o out        1.5s\n------\n \u003e [build 3/3] RUN dotnet publish ./src/Nethermind/Nethermind.SendBlobs/Nethermind.SendBlobs.csproj --sc -o out:\n#0 1.357 MSBuild version 17.6.3+07e294721 for .NET\n#0 1.357 MSBUILD : error MSB1009: Project file does not exist.\n#0 1.357 Switch: ./src/Nethermind/Nethermind.SendBlobs/Nethermind.SendBlobs.csproj\n------\nDockerfile:6\n--------------------\n   4 |     FROM mcr.microsoft.com/dotnet/sdk:7.0-jammy AS build\n   5 |     COPY . .\n   6 | \u003e\u003e\u003e RUN dotnet publish ./src/Nethermind/Nethermind.SendBlobs/Nethermind.SendBlobs.csproj --sc -o out\n   7 |\n   8 |\n--------------------\nERROR: failed to solve: process \"/bin/sh -c dotnet publish ./src/Nethermind/Nethermind.SendBlobs/Nethermind.SendBlobs.csproj --sc -o out\" did not complete successfully: exit code: 1\n```",
        "created_at": "2023-06-21T12:32:35.490000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Could you try to pull it? Appears I did not publish it properly, should work now.",
        "created_at": "2023-06-21T12:33:45.789000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "meanwhile I check the build",
        "created_at": "2023-06-21T12:34:01.282000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "As for the build, there is an ugly thing that you need to build from repository root(not exactly from send-blob project dir)",
        "created_at": "2023-06-21T12:35:20.080000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "pull works now, thanks ðŸ˜„",
        "created_at": "2023-06-21T12:38:41.832000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "it should be based on blobs sent, but I'll have to verify that's actually the case",
        "created_at": "2023-06-21T12:40:40.472000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "ok let us know. Teku is currently limiting on requested, not sent blobs count.",
        "created_at": "2023-06-21T13:00:26.064000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "I've a private local devnet, I've submitted blobs successfully with \u003c@277500722655002624\u003e 's blobSender tool. It outputs the hash `0x9e6f574508dc6b2526235a558ba0baf3375dd9c3138377439b87a4896a252dba` as a result. \n\nI then ran a curl request with `eth_getTransactionByHash` for that hash, it returns a block with a field `blobVersionedHashes`. Can i then fetch the blob that was included in from the CL? If so, how do i go about that? I'm assuming `/eth/v1/beacon/blob_sidecars` isn't the call I'm looking for. Or is this exactly like a transaction and i can't expect to fetch info about a tx from the CL?",
        "created_at": "2023-06-21T14:26:28.378000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "we definitely have all 6 blobs in all teku nodes",
        "created_at": "2023-06-21T15:23:47.835000+00:00",
        "attachments": null
    },
    {
        "author": "__kasey__",
        "category": "Testing",
        "parent": "",
        "content": "for devnet6, how do I get the geth `--bootnodes` address? it's not in boot_enr.txt or bootstrap_nodes.txt here https://github.com/ethpandaops/4844-testnet/tree/master/network-configs/devnet-6",
        "created_at": "2023-06-21T17:02:15.986000+00:00",
        "attachments": null
    },
    {
        "author": "__kasey__",
        "category": "Testing",
        "parent": "",
        "content": "oh it's in the inventory, isn't it. `enode://aca516c9a2b78d0d0b20b9f565a8f781fefbc206f0b45a3803c209bf5bdd5d20b1948a29e720ef4b423f8d1e7a647524bff46efe5adc505ad632867bea2fe80b@159.223.15.126:30303?discport=30303`",
        "created_at": "2023-06-21T17:05:03.230000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Yup, and https://4844-devnet-6.ethpandaops.io/ has useful hint how to query it \n`curl -s https://config.4844-devnet-6.ethpandaops.io/api/v1/nodes/inventory | jq -r '.ethereum_pairs[] | .execution.enode'`",
        "created_at": "2023-06-21T17:25:52.394000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "ok, so can we try syncing off teku nodes \u003c@412614104222531604\u003e",
        "created_at": "2023-06-21T18:26:45.822000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "may be lighthouse hits some edge case on our epoch by epoch request",
        "created_at": "2023-06-21T18:28:53.197000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Teku nodes are also in the enr list that is passed to the lodestar nodes.",
        "created_at": "2023-06-21T19:30:08.567000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "WRT the issue mentioned by Sean about multiple sidecar for same (block_root,index):\nsince block root is fixed, there can be only one sidecar that pass the kzg check. So in case we pick the wrong one, the validation fails and in teku we drop block and all blobs. So we will redownload block and sidecars if the next block builds on top of that.",
        "created_at": "2023-10-03T07:09:10.144000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "ah but i just noticed a funny thing: we mark the block as invalid! So we won't be able to follow the chain anymore.. üëé",
        "created_at": "2023-10-03T07:14:13.146000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "üêõ",
        "created_at": "2023-10-03T07:15:00.849000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "https://github.com/ethereum/consensus-specs/issues/3261 For those that are missing context ^",
        "created_at": "2023-10-03T08:01:22.227000+00:00",
        "attachments": null
    },
    {
        "author": "lukaszrozmej",
        "category": "Testing",
        "parent": "",
        "content": "applying something on error sounds like a side-effect code smell, and maybe coupling FCU with payload creation was an error?",
        "created_at": "2023-10-03T09:51:02.730000+00:00",
        "attachments": null
    },
    {
        "author": "lukaszrozmej",
        "category": "Testing",
        "parent": "",
        "content": "still this screams bad API design",
        "created_at": "2023-10-03T09:51:48.423000+00:00",
        "attachments": null
    },
    {
        "author": "lukaszrozmej",
        "category": "Testing",
        "parent": "",
        "content": "this now backfires on further payload validations",
        "created_at": "2023-10-03T09:53:23.586000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Testing",
        "parent": "",
        "content": "this has been my stance as well, but there were security reasons for needing to bind them together. \u003c@425572898787426305\u003e has been able to steelman that argument better than I.",
        "created_at": "2023-10-03T11:20:59.006000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "we just merged a PR that should fix the bug and avoid client stall. new develop image will be published soon.",
        "created_at": "2023-10-03T12:25:23.408000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Testing",
        "parent": "",
        "content": "btw blockscount has been stalled 4 days: https://explorer.dencun-devnet-9.ethpandaops.io/",
        "created_at": "2023-10-03T12:40:08.437000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "pls use beaconchain or dora. Blockscout hasn't updated their image to support 4844 stuff yet",
        "created_at": "2023-10-03T12:40:28.953000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "https://dora.dencun-devnet-9.ethpandaops.io\nhttps://dencun-devnet-9.beaconcha.in",
        "created_at": "2023-10-03T12:41:03.818000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Testing",
        "parent": "",
        "content": "beaconchain links to blocks are not working, was trying to pull some block/tx RLP",
        "created_at": "2023-10-03T12:49:13.841000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "paste example pls",
        "created_at": "2023-10-03T12:50:53.498000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "image has been published. Teku can be refreshed",
        "created_at": "2023-10-03T12:51:52.270000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "rolling",
        "created_at": "2023-10-03T12:52:12.700000+00:00",
        "attachments": null
    },
    {
        "author": "ppf.",
        "category": "Testing",
        "parent": "",
        "content": "we have problems with el-clients right now (erigon stuck downloading, geth not finding peers) - will try to fix it in the next few hours",
        "created_at": "2023-10-03T13:12:15.701000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Testing",
        "parent": "",
        "content": "https://dencun-devnet-9.beaconcha.in/block/28256 but any of 'em",
        "created_at": "2023-10-03T13:18:26.015000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "merging payload building request with fcU was done on purpose, this way it avoids race conditions where CL requests payload built atop of a block that isn't the head of the chain, or the head of the chain is being changed during the active payload built process. One of the inputs to this decision was Erigon (and other EL clients with similar state management approach) not capable of building a payload atop of a block that is not the head of canonical chain.\n\nI can see the pain you're sharing but considering the above making deal with error handling looks like a reasonable trade off. could you please provide more details on what exactly the issue is? Is it about the order of the checks and unexpected error returned in Hive?",
        "created_at": "2023-10-03T14:49:47.054000+00:00",
        "attachments": null
    },
    {
        "author": "lukaszrozmej",
        "category": "Testing",
        "parent": "",
        "content": "I dislike that we return an error and still some state is changed. Maybe we should return 2 statuses, one for FCU, 2nd for payload attributes",
        "created_at": "2023-10-03T15:12:11.883000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "applying forkchoice state when the attributes are invalid is basically an optimisation. the thing is that if forckchoice failed to be applied the built process can't be started at all. so returning a single error kind of fits naturally into the pipeline we have there. could you please provide an example of the case when returning two explicit errors can help?",
        "created_at": "2023-10-03T15:17:15.316000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "or if you observe any case when applying a new forkchoice state when attributes are invalid can be detrimental",
        "created_at": "2023-10-03T15:20:02.995000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "I created an evil teku https://github.com/tbenr/teku/tree/evil-blobs that when proposes, it first publishes a modified blobSidecar with a random KZGProof, after 500ms publishes block and all valid blobs",
        "created_at": "2023-10-03T16:20:02.653000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "helped me testing the fix for the multiple sidecars discussed above. I set up a 2 node interop network, where the evil was the only validating node, the other was a follower. The fixed follower should have been able to follow the chain by looking up by root block and blobs (but refusing to import blocks\\blobs when received via gossip)",
        "created_at": "2023-10-03T16:25:11.596000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Nicee! üòÑ\n\nYou can also use this content saved in a file called `evil_blobs.json`:\n```\n{\n  \"participants\": [\n    {\n      \"el_client_type\": \"geth\",\n      \"el_client_image\": \"ethpandaops/geth:lightclient-devnet-9-ae44519\",\n      \"cl_client_type\": \"teku\",\n      \"cl_client_image\": \"consensys/teku:develop\",\n      \"count\": 1\n    },\n    {\n      \"el_client_type\": \"geth\",\n      \"el_client_image\": \"ethpandaops/geth:lightclient-devnet-9-ae44519\",\n      \"cl_client_type\": \"teku\",\n      \"cl_client_image\": \"ethpandaops/teku:evil-blobs-fb6275a\",\n      \"count\": 1\n    },\n    {\n      \"el_client_type\": \"geth\",\n      \"el_client_image\": \"ethpandaops/geth:lightclient-devnet-9-ae44519\",\n      \"cl_client_type\": \"\u003cENTER CL HERE\u003e\",\n      \"cl_client_image\": \"\u003cCL DOCKER IMAGE HERE\u003e\",\n      \"count\": 1\n    }\n  ],\n  \"network_params\": {\n    \"seconds_per_slot\": 12,\n    \"deneb_fork_epoch\": 3\n  },\n  \"launch_additional_services\": true,\n  \"snooper_enabled\": true,\n  \"global_client_log_level\": \"info\"\n}\n```\n\nand `kurtosis run --enclave eth2 github.com/kurtosis-tech/ethereum-package  \"$(cat ./evil_blobs.json)\"`. It'll spin up one healthy teku node, one evil teku node and a CL of choice.",
        "created_at": "2023-10-03T17:34:38.572000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Lh-geth-1 is being used to test mev builder right now. If you see it being off (not proposing blocks, or missing attestations) this is the reason for it.",
        "created_at": "2023-10-03T18:38:21.197000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "Note: evil requires at least 1 blob and less than 6 blobs  to be provided by EL  to effectively produce the bad behavior",
        "created_at": "2023-10-03T22:18:12.130000+00:00",
        "attachments": null
    }
]
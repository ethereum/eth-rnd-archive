[
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "We do remove any invalid block from forkchoice no matter if it's on fcu or new payload. And yeah not checking blockhash unless we go with something like syncing without an EL that I'm trying to avoid",
        "created_at": "2023-02-14T00:17:05.683000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "So you can handle the case where a block goes from INVALID -\u003e VALID?",
        "created_at": "2023-02-14T00:17:52.431000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Not at all, if the EL gives us an invalid block we will not sync it again until a restart. And I think this is the right behavior so I'm with you on this one. The only reason we haven't hit this yet is that we are still implementing back filling",
        "created_at": "2023-02-14T00:19:17.855000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I think the dangers of using a method like what Martin is suggesting could backfire badly on pos",
        "created_at": "2023-02-14T00:20:38.567000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "Yeah, in the case I documented the EL was invalidating the whole chain from the head back to the Capella transition, including many finalized blocks. This is basically a death knell for Lighthouse, as we don't allow the local view of finality to be reverted without a DB wipe",
        "created_at": "2023-02-14T00:25:26.806000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Indeed, at some point I advocated shutting down as gracefully as possible if finalized checkpoint is invalid. Precisely to avoid a db wipe. Honestly I don't know where we stand on that one now, it became low priority with checkpoint sync. Db wipes are not that much of a problem",
        "created_at": "2023-02-14T00:27:34.953000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "Testing",
        "parent": "",
        "content": "Your ansible template looks correct to me:  `{{inventory_hostname}}:{{ethstats_password}}@{{ethstats_url}}:3000` is the format that the besu log is expecting a validates using a regex.\nOnly way I can see this happening is if one of the values contains a ':' character...the password maybe?",
        "created_at": "2023-02-14T06:26:46.605000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "The underlying issue in this case is that the hasher does have a collision. Nil and [] are hashing to the same value",
        "created_at": "2023-02-14T06:42:14.675000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Testing",
        "parent": "",
        "content": "Is that an RLP specification thing or a Geth hasher thing?",
        "created_at": "2023-02-14T06:46:42.969000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Its neither, the derive sha algorithm (the merkle patricia tree implementation) has this problem. So the header itself is good, the problem is the withdrawals root",
        "created_at": "2023-02-14T06:50:06.270000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Testing",
        "parent": "",
        "content": "I might be venturing outside of my lane, but having different bytes that hash to the same thing where that difference can easily modify block validity sounds like the setup for a whole class of vulnerabilities. \n\nMaybe this is something that happens in EE land and y'all have strategies to deal with it, but it's something that SSZ does not/will not do.",
        "created_at": "2023-02-14T06:53:54.779000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "Testing",
        "parent": "",
        "content": "Should this be clarified in the EIP then? At the moment it just says \"do the same thing as transactions root\" https://eips.ethereum.org/EIPS/eip-4895#new-field-in-the-execution-payload-header-withdrawals-root\nbut there are no \"Nil\" transaction blocks like with withdrawals.\n\nIn besu, we avoid calculating the withdrawalsRoot if withdrawals are Nil",
        "created_at": "2023-02-14T07:10:14.623000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Well we do the same thing as the transaction root. Transactions being nil is just filtered earlier (we do the sam filtering for withdrawals now too, we just didn't back then)",
        "created_at": "2023-02-14T07:13:06.618000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "Testing",
        "parent": "",
        "content": "We always have an empty list of transactions, maybe that's just an implementation detail though",
        "created_at": "2023-02-14T07:15:40.744000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Nope, the pass and all other vars are is in group_vars all.yml",
        "created_at": "2023-02-14T07:44:26.881000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "Testing",
        "parent": "",
        "content": "ok, I don't get that error with those vars on a local besu...want to try to enable again on one box and I'll try to debug?",
        "created_at": "2023-02-14T07:50:53.050000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "ok",
        "created_at": "2023-02-14T07:53:23.442000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "Testing",
        "parent": "",
        "content": "was it previously working btw? This code hasn't changed in a long time",
        "created_at": "2023-02-14T07:54:48.492000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "yup",
        "created_at": "2023-02-14T07:54:56.189000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "its something very recent",
        "created_at": "2023-02-14T07:55:01.342000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "Testing",
        "parent": "",
        "content": "ah I was testing on zhejiang, but I get the error for withdrawals-devnet-7...seems our regex doesn't like dashes in the password, will fix up üëç",
        "created_at": "2023-02-14T08:05:12.434000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "Testing",
        "parent": "",
        "content": "When this gets merged in, you'll be able to pull the 'develop' tag again: https://github.com/hyperledger/besu/pull/5090\nEither that, or avoid a password with dashes in the meantime üôÇ",
        "created_at": "2023-02-14T08:16:26.900000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Awesome thanks for the hot fix",
        "created_at": "2023-02-14T08:18:53.995000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "and we have genesis on devnet 7",
        "created_at": "2023-02-14T09:01:19.084000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@755590043632140352\u003e \u003c@476250636548308992\u003e prysm is really struggling!",
        "created_at": "2023-02-14T09:04:33.669000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "https://forkmon.withdrawal-devnet-7.ethpandaops.io",
        "created_at": "2023-02-14T09:04:40.165000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "What's wrong?",
        "created_at": "2023-02-14T09:05:03.519000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Still trying to get out of bed",
        "created_at": "2023-02-14T09:05:28.422000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "```time=\"2023-02-14 09:05:28\" level=error msg=\"Failed to find peers\" error=\"unable to find requisite number of peers for topic /eth2/04175da9/sync_committee_2/ssz_snappy - only 1 out of 1 peers were able to be found\" prefix=p2p```",
        "created_at": "2023-02-14T09:05:42.266000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "looks like massive peering issue",
        "created_at": "2023-02-14T09:05:49.479000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "can't keep up to head",
        "created_at": "2023-02-14T09:05:52.194000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "```time=\"2023-02-14 09:05:28\" level=warning msg=\"Sync Committee Message is too old to broadcast, discarding it\" error=\"sync message time 2023-02-14 09:05:12 +0000 UTC (slot 26) not within allowable range of 2023-02-14 09:05:24 +0000 UTC (slot 27) to 2023-02-14 09:05:28.94105825 +0000 UTC m=+65742.999051624 (slot 27)\" prefix=p2p```",
        "created_at": "2023-02-14T09:06:03.337000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "committee messages are expiring",
        "created_at": "2023-02-14T09:06:09.476000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "looks like its the same issue on erigon/geth/besu/nethermind",
        "created_at": "2023-02-14T09:06:26.051000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Those are consequences not causes it seems",
        "created_at": "2023-02-14T09:06:37.402000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "```time=\"2023-02-14 09:03:12\" level=debug msg=\"Invalid status message from peer\" error=\"wrong fork digest version\" handler=status peer=16Uiu2HAmLT5t9YLbrJvboKVwikP6sQQcBvujvRMDcRM3cKQqQswP prefix=sync```",
        "created_at": "2023-02-14T09:07:16.559000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Oh man if it's not my kids it's a devnet, seems I'm never going to enjoy reading time in bed üôÇ",
        "created_at": "2023-02-14T09:07:24.731000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "devnets are like kids",
        "created_at": "2023-02-14T09:07:38.376000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "üòÇ",
        "created_at": "2023-02-14T09:07:42.823000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "That looks like a setup issue, will grab a quick coffee and log in that server",
        "created_at": "2023-02-14T09:07:54.578000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "any reason you are running a slasher too ?",
        "created_at": "2023-02-14T09:08:33.199000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "I can get rid of it",
        "created_at": "2023-02-14T09:08:47.096000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "is this for all our nodes ?",
        "created_at": "2023-02-14T09:08:54.488000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "yes",
        "created_at": "2023-02-14T09:08:58.841000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "I had slasher running so we can also test some slashing events",
        "created_at": "2023-02-14T09:09:05.997000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "but not urgently needed",
        "created_at": "2023-02-14T09:09:10.571000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "ok then that is probably it, you could try reducing it to only a few nodes",
        "created_at": "2023-02-14T09:09:16.215000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "instead of all",
        "created_at": "2023-02-14T09:09:19.640000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "I get rid of all slashers for now",
        "created_at": "2023-02-14T09:09:29.465000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "will later include it on a few",
        "created_at": "2023-02-14T09:09:34.763000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "My guess is `  --grpc-max-msg-size=43000000` might be still a bit too small",
        "created_at": "2023-02-14T09:09:48.036000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "for 600k validators",
        "created_at": "2023-02-14T09:09:51.985000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "how do you calculate msg size?",
        "created_at": "2023-02-14T09:09:57.717000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "just do \n```\n1000000000\n```",
        "created_at": "2023-02-14T09:10:44.638000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "and it should be fine",
        "created_at": "2023-02-14T09:10:49.739000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "ok",
        "created_at": "2023-02-14T09:11:03.424000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "updating with those now.",
        "created_at": "2023-02-14T09:11:12.470000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Isn't it just a given that slashers are non validating nodes?",
        "created_at": "2023-02-14T09:11:12.681000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Its not really needed right now. So I'll get rid of all slashers",
        "created_at": "2023-02-14T09:12:17.226000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "wasn't aware that its a very heavy process",
        "created_at": "2023-02-14T09:12:28.170000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "we looking a lot better",
        "created_at": "2023-02-14T09:14:24.883000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@755590043632140352\u003e time to go back to bed and read, sorry for the noise.",
        "created_at": "2023-02-14T09:14:35.783000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I'm now leaking on mainnet so that got me finally awake lol",
        "created_at": "2023-02-14T09:16:02.887000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "lol",
        "created_at": "2023-02-14T09:16:37.291000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "we now have all nodes up to head",
        "created_at": "2023-02-14T09:21:24.111000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "attestation rates are looking very good too now",
        "created_at": "2023-02-14T09:21:34.896000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "you just need 1-2 slashers on a network this size üòÑ\njust setup the bootnode as a slasher, lighthouse has it implimented as well and we should be good. the slashing stuff will be broadcasted anyway.",
        "created_at": "2023-02-14T09:21:39.599000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "All of our tooling is available: https://withdrawal-devnet-7.ethpandaops.io",
        "created_at": "2023-02-14T09:22:52.050000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "getting some bad blocks with besus",
        "created_at": "2023-02-14T11:15:36.313000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "Screenshot_2023-02-14_at_12.15.27.png",
                "content": "0c42d851edbd01cba1bfa98ecfbb6f2ff6a8d362bd66020fe957e18e282408f4"
            }
        ]
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "do we know the proposer? These blocks are reported by besu, but it doesn't mean that they were produced by besu",
        "created_at": "2023-02-14T12:19:59.589000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "lodestar-besu-2 is broken on devnet 7 \u003c@792822129019584562\u003e",
        "created_at": "2023-02-14T13:36:20.809000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "```Feb-14 13:35:19.453[chain]           error: Error pushing notifyForkchoiceUpdate() headBlockHash=0x9cdb531277181bcaeed7544ef4f305c994789500eaa2813e9f4007dff14e42b3, finalizedBlockHash=0xb02d8e8cbbd9e7b25f5a33664b54ed426e1f051357ec62e718eb7c8277611a7d Invalid forkchoice request, validationError=BlockHeader{hash=0x9cdb531277181bcaeed7544ef4f305c994789500eaa2813e9f4007dff14e42b3, parentHash=0x9002248f8c6bd59e649230445360b5563229696d32674d00e2412ddf9e675404, ommersHash=0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347, coinbase=0xf97e180c050e5ab072211ad2c213eb5aee4df134, stateRoot=0x3e273c53e2f1540660a320a3b86f19c54fb46de7b4ed1d198661475966330db7, transactionsRoot=0x5db32517eb3de8ef0e1843f730bcdc805d257909036b14310f0bbb2d8bc88234, receiptsRoot=0x39a987052f286aeab6fe82c783742e7ba15b6bd703e4ef07c70fd60c282f76ce, logsBloom=0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000, difficulty=0x0000000000000000000000000000000000000000000000000000000000000000, number=369, gasLimit=29872988, gasUsed=265075, timestamp=1676369892, extraData=0x, baseFee=0x0000000000000000000000000000000000000000000000000000000000000007, mixHashOrPrevRandao=0x157bcfbbcc9cb2e1b736bd20cc922a0424fe1a054895192c4397bd66fac51a05, nonce=0, } did not descend from terminal block```",
        "created_at": "2023-02-14T13:36:31.721000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "looks to be besu issue",
        "created_at": "2023-02-14T13:36:58.237000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "ok \u003c@341574016160497665\u003e",
        "created_at": "2023-02-14T13:37:07.289000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "would be cool to have slot number instead of block number listed in forkmon",
        "created_at": "2023-02-14T13:38:24.428000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "Agreed, one problem - EL clients don't have this information about the slot (only based on timestampü§î ) \u0026 proposer. On the other hand, EL clients report bad blocks to forkmon",
        "created_at": "2023-02-14T14:27:08.326000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "based on genesis time, and timestamp, the slot number can be calculated",
        "created_at": "2023-02-14T14:27:34.591000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I've been saying that forever",
        "created_at": "2023-02-14T16:18:47.164000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "The slot is generally more useful than execution block, cause you have the execution block embedded anyway",
        "created_at": "2023-02-14T16:19:45.400000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "While going through the failing withdrawal tests on geth I stumbled upon the following thing: `INVALID_BLOCK_HASH status value is supplanted by INVALID.` (https://github.com/ethereum/execution-apis/blob/main/src/engine/shanghai.md#request). Implementing this in a backwards compatible way will make our code complexity (which is already __really__ bad) in the engine api blow up even more. Can we just change the V1 as well, s.th. we can return either INVALID or INVALID_BLOCK_HASH? I don't think clients care either way \u003c@425572898787426305\u003e",
        "created_at": "2023-02-14T16:23:12.693000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "just checking Nimbus,\n```\nnimbus-eth2$ rg invalid_block_hash\nbeacon_chain/consensus_object_pools/consensus_manager.nim\n240:  of PayloadExecutionStatus.invalid, PayloadExecutionStatus.invalid_block_hash:\n\nbeacon_chain/gossip_processing/block_processor.nim\n251:  of PayloadExecutionStatus.invalid, PayloadExecutionStatus.invalid_block_hash:\n352:      of PayloadExecutionStatus.invalid, PayloadExecutionStatus.invalid_block_hash:\n```\nit treats them interchangeably",
        "created_at": "2023-02-14T16:25:12.320000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Do execution clients have information about the genesis time?",
        "created_at": "2023-02-14T16:56:41.817000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "Testing",
        "parent": "",
        "content": "Except the lodestar-besu-2 issue, these bad blocks are the known issue where we misreport when we invalidate our own proposals. Root cause of the invalid block is a bonsai concurrency bug which prysm tends to exacerbate for some reason, along with doing lots of proposals, so only really see this on devnets. The PR code to fix the misreporting that we tested on devnet-4 seemed to work, so we're working on getting this merged into main now.",
        "created_at": "2023-02-14T19:27:18.707000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "only EL block genesis timestamp, EL doesn't know beacon chain genesis",
        "created_at": "2023-02-14T19:28:47.136000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Testing",
        "parent": "",
        "content": "If EL reports INVALID/VALID, that verdict is considered final by CL, not just prysm, that's just how the spec works. Please don't report INVALID on internal concurrency bugs from besu.",
        "created_at": "2023-02-14T19:33:07.701000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "Testing",
        "parent": "",
        "content": "In this case, this block never leaves besu. During the proposal window, we repeatedly build a block until CL calls getPayload. Sometimes we build an invalid one due to a bug, we invalidate it ourselves and retry, going on to build a valid block which gets returns to the CL.\nThe bug is adding this type of invalidation to the bad block report. As far as the engine API is concerned, it's an internal error that we recover from, so it never reaches the API level.",
        "created_at": "2023-02-14T19:35:30.151000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "Testing",
        "parent": "",
        "content": "I restarted besu and it appears to be syncing now. Will look into what happened this morning.",
        "created_at": "2023-02-14T19:40:31.951000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Testing",
        "parent": "",
        "content": "If the internal bug doesn't surface to the API level, I don't really understand how it is possible that prysm \"tends to exacerbate\" the bonsai concurrency bug. \nBut, sounds like you are aware of the inner cause and that the cause has been identified üôÇ",
        "created_at": "2023-02-14T19:47:13.098000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "Testing",
        "parent": "",
        "content": "In that it is a source of work for besu leading to concurrency issues. Besu is probably trying to build a block while the state is changing due to processing newPayload/FCU concurrently with the block building thread. Note, this is unique to our bonsai storage mechanism.\n\nThe surface level error: misreporting bad block is unrelated to prysm.\n\nSorry pre-coffee so probably not explaining myself very well üôÉ",
        "created_at": "2023-02-14T20:11:13.073000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Testing",
        "parent": "",
        "content": "Ah, gotcha. I misunderstood this and was assuming the opposite cause, where Besu triggers something in Prysm, instead of the other way around. Thanks for clarifying!",
        "created_at": "2023-02-14T20:37:32.201000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "We've done builder testing, mock on devnet 5 and we got the setup ready for devnet 6 last night. Yet to analyse the outcome.",
        "created_at": "2025-02-06T02:44:41.713000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Testing",
        "parent": "",
        "content": "Nice nice. We should make sure the blind block body has execution requests. I think that's where bugs can happen",
        "created_at": "2025-02-06T03:31:03.910000+00:00",
        "attachments": null
    },
    {
        "author": "rohitrjn",
        "category": "Testing",
        "parent": "",
        "content": "Shouldn't a client throw an error with the error code (-32602: Invalid Parameters) if the number of requests are more than 3, I noticed this from the eest test: `tests/prague/eip7685_general_purpose_el_requests/test_deposits_withdrawals_consolidations.py::test_invalid_deposit_withdrawal_consolidation_requests_engine[fork_Prague-extra_invalid_type_request_with_data_0xff-blockchain_test_engine-correct_requests_hash_in_header_True]`",
        "created_at": "2025-02-06T10:45:14.424000+00:00",
        "attachments": null
    },
    {
        "author": "rohitrjn",
        "category": "Testing",
        "parent": "",
        "content": "```\n_ tests/prague/eip7685_general_purpose_el_requests/test_deposits_withdrawals_consolidations.py::test_invalid_deposit_withdrawal_consolidation_requests_engine[fork_Prague-extra_invalid_type_request_with_data_0xff-blockchain_test_engine-correct_requests_hash_in_header_True]-nethermind _\n[gw0] linux -- Python 3.10.16 /execution-spec-tests/.venv/bin/python\nsrc/pytest_plugins/consume/hive_simulators/engine/test_via_engine.py:56: in test_via_engine\n    payload_response = engine_rpc.new_payload(\nsrc/ethereum_test_rpc/rpc.py:276: in new_payload\n    **self.post_request(f\"newPayloadV{version}\", *[to_json(param) for param in params])\nsrc/ethereum_test_rpc/rpc.py:271: in post_request\n    return super().post_request(method, *params, extra_headers=extra_headers)\nsrc/ethereum_test_rpc/rpc.py:85: in post_request\n    raise JSONRPCError(**response_json[\"error\"])\nE   ethereum_test_rpc.types.JSONRPCError: JSONRPCError(code=-32602, message=Execution requests must have less than or equal to 3 items, has 4 items)\n\nThe above exception was the direct cause of the following exception:\nsrc/pytest_plugins/consume/hive_simulators/engine/test_via_engine.py:72: in test_via_engine\n    raise Exception(f\"unexpected error: {e.code} - {e.message}\") from e\nE   Exception: unexpected error: -32602 - Execution requests must have less than or equal to 3 items, has 4 items\n- Generated html report: file:///execution-spec-tests/cached_downloads/pectra-devnet-6%2540v1.0.0/fixtures_pectra-devnet-6/fixtures/.meta/report_consume.html -\n============================== 1 failed in 10.57s ==============================\n```",
        "created_at": "2025-02-06T10:45:16.455000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "that's currently invalid to respond with more than 3, yeah. future forks might change the execution requests but more than 3 isn't possible right now",
        "created_at": "2025-02-06T11:05:07.323000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "either for `newPayload` or `getPayload`",
        "created_at": "2025-02-06T11:05:27.961000+00:00",
        "attachments": null
    },
    {
        "author": "rohitrjn",
        "category": "Testing",
        "parent": "",
        "content": "But for the test: `tests/prague/eip7685_general_purpose_el_requests/test_deposits_withdrawals_consolidations.py::test_invalid_deposit_withdrawal_consolidation_requests_engine[fork_Prague-extra_invalid_type_request_with_data_0xff-blockchain_test_engine-correct_requests_hash_in_header_True]`\n\nthe expected response is not that a client responds with `InvalidParams` error",
        "created_at": "2025-02-06T11:28:20.109000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "it's not just that there are more than 3, it's that one is not valid",
        "created_at": "2025-02-06T11:35:45.903000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "https://github.com/ethereum/execution-spec-tests/blob/83942b0011e32625ec8e74598673b1cce7b3db16/tests/prague/eip7685_general_purpose_el_requests/test_deposits_withdrawals_consolidations.py#L487-L494",
        "created_at": "2025-02-06T11:36:28.470000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "i.e. everything in https://github.com/ethereum/execution-spec-tests/blob/83942b0011e32625ec8e74598673b1cce7b3db16/tests/prague/eip7685_general_purpose_el_requests/test_deposits_withdrawals_consolidations.py#L524-L557 should fail according to my understanding of the spec",
        "created_at": "2025-02-06T11:38:30.041000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "so I don't know why it would be `Exception: unexpected error: -32602` ...",
        "created_at": "2025-02-06T11:39:45.082000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "FYI lighthouse is not returning the consensus version in JSON or header for the `/eth/v2/validator/aggregate_attestation` endpoint.   We have raised this at https://github.com/sigp/lighthouse/issues/6925 but flagging it here in case someone stumbles into this issue.",
        "created_at": "2025-02-06T12:10:34.779000+00:00",
        "attachments": null
    },
    {
        "author": "rohitrjn",
        "category": "Testing",
        "parent": "",
        "content": "yeah it should fail, but in this case client shouldn't raise expected Engine API error code: `-32602` ?  It seems if the client raises this exception, the test fails",
        "created_at": "2025-02-06T15:26:51.321000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "yeah, I'm not familiar enough with the tests to say what the correct failure is",
        "created_at": "2025-02-06T16:34:44.921000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "some orphaned nimbus slots now \u003c@654267572107083777\u003e",
        "created_at": "2025-02-06T18:31:39.123000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "915686c09b63520d85a8be87a1e6fe8cc9a5cea846bdf5c3225da322e05997fd"
            }
        ]
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "yeah I see",
        "created_at": "2025-02-06T19:20:54.242000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "It's following the second bullet point from this list: https://github.com/ethereum/execution-apis/blob/main/src/engine/prague.md#specification-1\n\nThe error should be returned if the elements are out of order or any element is one-byte or shorter, or there's more than one element for a given request type, for everything else it should return `INVALID`",
        "created_at": "2025-02-06T19:30:24.151000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "The logic for that one was that you don't need to know the forks requests' rules (e.g. max request type that is valid for the active fork) to return the Engine API error.",
        "created_at": "2025-02-06T19:33:57.003000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "oh the orphaned blocks are because Nimbus in those is attempting basically reorgs because it's not fully in sync",
        "created_at": "2025-02-06T19:36:25.260000+00:00",
        "attachments": null
    },
    {
        "author": "pk910",
        "category": "Testing",
        "parent": "",
        "content": "These orphaned slots from nimbus pairs started after one of my validators did a double proposal at slot 21876:\nhttps://dora.pectra-devnet-6.ethpandaops.io/slot/21876\nhttps://dora.pectra-devnet-6.ethpandaops.io/slot/0x8e59659975c567108907fa1540a1e56e8036331ce1bb07bf107ee771581115a8\n\nwe're not running a slasher yet, so these 20 keys that are intentionally running on 2 nodes are not slashed yet",
        "created_at": "2025-02-06T20:31:57.749000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "interesting, that explains why they weren't properly resolving the blobs. and they've apparently recovered",
        "created_at": "2025-02-06T20:42:12.777000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "but obviously still a bug/issue",
        "created_at": "2025-02-06T20:42:26.453000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@808969530608451584\u003e also, do you happen to know what fuzzing you might have been doing around epochs 4803 through 4921 of devnet-5, related to missed nimbus-eth2 blocks around that period? that pretty abruptly started then stopped",
        "created_at": "2025-02-06T20:58:08.678000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "it's a different failure mode, I don't think related",
        "created_at": "2025-02-06T20:59:30.884000+00:00",
        "attachments": null
    },
    {
        "author": "pk910",
        "category": "Testing",
        "parent": "",
        "content": "it looks like nimbis-reth-1 got stuck with el block 20524. \nSeems to be a reth problem, hash mismatch in the logs.\ncc \u003c@519796549279023105\u003e",
        "created_at": "2025-02-06T21:53:19.690000+00:00",
        "attachments": null
    }
]
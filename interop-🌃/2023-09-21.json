[
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "EthereumJS in Nimbus/EthereumJS has been returning `SYNCING` since\n```\nSep 20 22:04:00.062 2023 REQUEST\n{\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"engine_newPayloadV3\",\n  \"params\": [\n    {\n      \"parentHash\": \"0xd252507f926761f8fa0a658d6c23a76efd4d146ffd0395f286d12492333f4a53\",\n      \"feeRecipient\": \"0xf97e180c050e5ab072211ad2c213eb5aee4df134\",\n      \"stateRoot\": \"0x7a07df1f5852758d36e0da8fda222e7a1a254780f81c677cbf312b5a0b504aa4\",\n      \"receiptsRoot\": \"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\n      \"logsBloom\": \"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\n      \"prevRandao\": \"0x4534792ad89e6b92abbfe8b5ab0f400cb06e0bfc993d74a1510a14398cae7ed5\",\n      \"blockNumber\": \"0x3702C\",\n      \"gasLimit\": \"0x1C9C380\",\n      \"gasUsed\": \"0x0\",\n      \"timestamp\": \"0x650B6C50\",\n      \"extraData\": \"0x\",\n      \"baseFeePerGas\": \"0x7\",\n      \"blockHash\": \"0x8a1da3da5289b31b03a306a35d6e203ca2eae6d6626f9ee9d47d9b907e6ab984\",\n      \"transactions\": [],\n      \"withdrawals\": [],\n      \"blobGasUsed\": \"0x0\",\n      \"excessBlobGas\": \"0x0\"\n    },\n    [],\n    \"0x031bfbbcf75237d6469713b71cb465ea461d3f1e4f66e1745e00aeeb3b1a76f8\"\n  ],\n  \"id\": 503772\n}\n\nSep 20 22:04:00.062 2023 RESPONSE\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 503772,\n  \"result\": {\n    \"status\": \"VALID\",\n    \"latestValidHash\": \"0x8a1da3da5289b31b03a306a35d6e203ca2eae6d6626f9ee9d47d9b907e6ab984\",\n    \"validationError\": null\n  }\n}\n```\nand the accompanying fcU.",
        "created_at": "2023-09-21T08:17:11.286000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "restarted \u003c@\u0026836981603216654336\u003e and Nimbus containers in `nimbus-besu-1` to at least get things running again, but basically the fallout from the false-`INVALID` thing (because descendant of `INVALID` cannot be `VALID`) had been preventing Nimbus from keeping up with head for a week now, as noted in https://discord.com/channels/595666850260713488/892088344438255616/1152264274991911015\n\nELs really should not be returning false `INVALID`s.\n\nIt's now synced again\n```\nINF 2023-09-21 08:47:48.002+00:00 Slot start                                 topics=\"beacnde\" slot=258639 epoch=8082 sync=\"00h00m (99.23%) 68.8462slots/s (QQQQPQDDQD:256639)/opt - lc: 11b0a64a:258637\" peers=31 head=22a7ac65:256745 finalized=8021:1ed559b9 delay=2ms510us802ns\nINF 2023-09-21 08:48:00.001+00:00 Slot start                                 topics=\"beacnde\" slot=258640 epoch=8082 sync=\"00h00m (99.52%) 69.0385slots/s (DQQDDPDDDD:257407)/opt - lc: 1acd8d5f:258638\" peers=31 head=dbdb9b85:257483 finalized=8044:255e1773 delay=1ms580us138ns\nINF 2023-09-21 08:48:12.002+00:00 Slot start                                 topics=\"beacnde\" slot=258641 epoch=8082 sync=\"00h00m (99.82%) 68.7723slots/s (QQQQQQDQQP:258175)/opt - lc: 1acd8d5f:258638\" peers=31 head=1b6931b1:258264 finalized=8068:1282b126 delay=2ms824us898ns\nINF 2023-09-21 08:48:24.000+00:00 Slot start                                 topics=\"beacnde\" slot=258642 epoch=8082 sync=\"00h00m (100.00%) 68.8697slots/s (ssssRssRsR:258639)\" peers=31 head=4197546f:258639 finalized=8080:a52a68ef delay=795us906ns\nINF 2023-09-21 08:48:36.000+00:00 Slot start                                 topics=\"beacnde\" slot=258643 epoch=8082 sync=synced peers=31 head=1fa81635:258642 finalized=8080:a52a68ef delay=969us906ns\nINF 2023-09-21 08:48:48.001+00:00 Slot start                                 topics=\"beacnde\" slot=258644 epoch=8082 sync=synced peers=31 head=f8770ad8:258643 finalized=8080:a52a68ef delay=1ms76us578ns\n```",
        "created_at": "2023-09-21T08:49:34.183000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "Also in https://forkmon.dencun-devnet-8.ethpandaops.io/ and  https://dencun-devnet-8.beaconcha.in/slots?q=nimbus where just now nimbus-besu-1 started proposing again, now that Nimbus isn't rejecting the correct canonical chain because it had been told it was `INVALID`",
        "created_at": "2023-09-21T08:51:28.708000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "wouldn't this be caught on the hive tests? cc \u003c@892053833121923094\u003e",
        "created_at": "2023-09-21T08:51:42.313000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "https://dencun-devnet-8.beaconcha.in/slot/258651 nimbus-besu-1 block",
        "created_at": "2023-09-21T08:52:18.855000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "seems like nimbus/lodestar/prysm/teku \u003c\u003e ethereumjs are all stuck. any idea what's going on? \n\n`engine_forkchoiceUpdatedV3` requests are responding with `SYNCING`, ethereumJS logs `Forkchoice requested unknown head`, atleast according to forkmon they do seem to be stuck at some weird old head that doesn't match with the rest of the network.",
        "created_at": "2023-09-21T13:12:34.219000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@583892532644151312\u003e seems like lighthouse-erigon-1 is also stuck. Its responding to `engine_forkchoiceUpdatedV2` with `INVALID`. \n\nOnly other thing i noticed on this node is that the calls for building new payloads are `engine_newPayloadV3` but the calls for fcu are `engine_forkchoiceUpdatedV2`, even though `engine_forkchoiceUpdatedV3` is supported according to `engine_exchangeCapabilities`. Is this an okay? combo (don't know the spec well enough to deciper this)",
        "created_at": "2023-09-21T13:17:05.304000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Cancun strictly expects V3 methods afaik",
        "created_at": "2023-09-21T13:26:18.946000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "if true, that'd explain it ðŸ˜„ \n\u003c@607055410104500244\u003e or \u003c@491624610215886849\u003e ?\n\n`ssh devops@104.248.194.214`\n\n`docker logs snooper-engine 2\u003e\u00261 | grep -A 50 -B 30  \"engine_forkchoiceUpdatedV2\"` (or replace search term for whatever you want to dig through)",
        "created_at": "2023-09-21T13:29:11.783000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "checking!",
        "created_at": "2023-09-21T13:31:20.922000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "Looks like there is no `engine_forkchoiceUpdatedV3` in the `engine_exchangeCapabilities`Â response from erigon, we'll only call it if it exists there\n```\nSep 21 13:15:17.486 2023 REQUEST\n{\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"engine_exchangeCapabilities\",\n  \"params\": [\n    [\n      \"engine_newPayloadV1\",\n      \"engine_newPayloadV2\",\n      \"engine_newPayloadV3\",\n      \"engine_getPayloadV1\",\n      \"engine_getPayloadV2\",\n      \"engine_getPayloadV3\",\n      \"engine_forkchoiceUpdatedV1\",\n      \"engine_forkchoiceUpdatedV2\",\n      \"engine_forkchoiceUpdatedV3\",\n      \"engine_getPayloadBodiesByHashV1\",\n      \"engine_getPayloadBodiesByRangeV1\"\n    ]\n  ],\n  \"id\": 1\n}\n\nSep 21 13:15:17.486 2023 RESPONSE\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"result\": [\n    \"engine_forkchoiceUpdatedV1\",\n    \"engine_forkchoiceUpdatedV2\",\n    \"engine_newPayloadV1\",\n    \"engine_newPayloadV2\",\n    \"engine_newPayloadV3\",\n    \"engine_getPayloadV1\",\n    \"engine_getPayloadV2\",\n    \"engine_getPayloadV3\",\n    \"engine_exchangeTransitionConfigurationV1\",\n    \"engine_getPayloadBodiesByHashV1\",\n    \"engine_getPayloadBodiesByRangeV1\"\n  ]\n}\n```",
        "created_at": "2023-09-21T13:45:11.727000+00:00",
        "attachments": null
    },
    {
        "author": "yperbasis",
        "category": "Testing",
        "parent": "",
        "content": "Right. I'll add engine_forkchoiceUpdatedV3 to erigon's capabilities",
        "created_at": "2023-09-21T13:53:58.360000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "ill check",
        "created_at": "2023-09-21T14:01:51.997000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "lodestar \u003c\u003e ethereumjs seems synced",
        "created_at": "2023-09-21T14:03:29.530000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "There's a hive test for this already but it's not running on the hivecancun, let me add it so this doesn't slip again",
        "created_at": "2023-09-21T14:04:10.072000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Yeah you're right, just the others are out",
        "created_at": "2023-09-21T14:04:11.687000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "so does lighthouse ethereumjs",
        "created_at": "2023-09-21T14:04:21.388000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "lemme look at others because they were previously synced except teku i think",
        "created_at": "2023-09-21T14:04:56.335000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "prsym doesn't seem to sending newpayloads/fcu to ethereumjs, so restarted prsym to see if that fixes the issue",
        "created_at": "2023-09-21T14:06:40.235000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "except teku rest of the paris seem to have synced up, no idea why teku isn't moving with newpayloads and fcus since it keeps repeating the same blocks over and over again",
        "created_at": "2023-09-21T14:28:28.414000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "maybe \u003c@504202741933932544\u003e can have a look?",
        "created_at": "2023-09-21T15:23:53.236000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "I'll take a look!",
        "created_at": "2023-09-21T17:12:58.426000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "we seem to have hit something in devnet-8: https://forkmon.dencun-devnet-8.ethpandaops.io/\nbesu, ethereumJS seem to be affected",
        "created_at": "2023-09-21T18:39:49.470000+00:00",
        "attachments": null
    },
    {
        "author": "marcinds",
        "category": "Testing",
        "parent": "",
        "content": "I'm testing nethermind's blob pool by sending 16k 6-blob txs (16 txs from 1000 senders) and looks like I accidentally killed few nodes https://ethstats.dencun-devnet-8.ethpandaops.io/\n14k txs already sent, 2k left",
        "created_at": "2023-09-21T18:50:37.921000+00:00",
        "attachments": null
    },
    {
        "author": "marcinds",
        "category": "Testing",
        "parent": "",
        "content": "And looks like with such amount of blob transactions only Geth is not missing any slots",
        "created_at": "2023-09-21T18:53:02.534000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "so blob pool ddos basically?",
        "created_at": "2023-09-21T18:54:27.296000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "i think you caused a mem leak in besu with that ðŸ˜‰ \u003c@827653956955406406\u003e",
        "created_at": "2023-09-21T18:54:51.244000+00:00",
        "attachments": null
    },
    {
        "author": "marcinds",
        "category": "Testing",
        "parent": "",
        "content": "high amount of valid blob transactions",
        "created_at": "2023-09-21T18:54:52.530000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "a highly used chain is indiscernible from ddos /s",
        "created_at": "2023-09-21T18:55:23.913000+00:00",
        "attachments": null
    },
    {
        "author": "marcinds",
        "category": "Testing",
        "parent": "",
        "content": "My main goal was to just make blob pools full",
        "created_at": "2023-09-21T18:56:55.189000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "are you sending it with the nethermind blob spammer or did you send it with some modification of it? ðŸ˜„",
        "created_at": "2023-09-21T18:56:59.860000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "yeah deeefinitely a good idea!",
        "created_at": "2023-09-21T18:57:28.296000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "some interesting graphs from this time:",
        "created_at": "2023-09-21T18:59:49.718000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "Screenshot_2023-09-21_at_20.58.44.png",
                "content": "ee5f6babddef784b7e8bc540cc6cac005ab1aedee26bd9e3168f4c0f00764ff4"
            },
            {
                "type": "image/png",
                "origin_name": "Screenshot_2023-09-21_at_20.58.49.png",
                "content": "3500869985d7de94999b723f5a90dfd515cb5650df926169779d97c3f056ceef"
            },
            {
                "type": "image/png",
                "origin_name": "Screenshot_2023-09-21_at_20.58.56.png",
                "content": "907d75df37b2f313be1e09b8c79e3bb7797d272cda5099fe84098ded0c85db87"
            }
        ]
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "I'm guessing blobs are stored in disk while they are in the mempool? that's a rapid disk space reduction and im trying to see why",
        "created_at": "2023-09-21T19:00:17.482000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "ram use gets very spiky too and network usage expectedly increases",
        "created_at": "2023-09-21T19:00:40.457000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Testing",
        "parent": "",
        "content": "very cool! thanks for doing this.",
        "created_at": "2023-09-21T19:01:12.651000+00:00",
        "attachments": null
    },
    {
        "author": "marcinds",
        "category": "Testing",
        "parent": "",
        "content": "It's \u003c@277500722655002624\u003e blob spammer modified by Anders - one of our interns - to create X new accounts (here 1000) and split balance of account in the argument to them. And then I just automated blob spammer to run 1000 times. Few last ones left",
        "created_at": "2023-09-21T19:01:28.392000+00:00",
        "attachments": null
    },
    {
        "author": "marcinds",
        "category": "Testing",
        "parent": "",
        "content": "We (nethermind) are saving blob txs to db, but we store sorting-related parts in memory. I'm not satisfied about our latency and missed spots, probably we need to improve block building and maybe simplify sorting. Or maybe reduce max number of blob txs from 16k to e.g. 8k",
        "created_at": "2023-09-21T19:04:49.603000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Testing",
        "parent": "",
        "content": "besu definitely got blobclobbered",
        "created_at": "2023-09-21T19:06:57.545000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Testing",
        "parent": "",
        "content": "is there a repo for the spammer we can look at? our performance eng would love that.",
        "created_at": "2023-09-21T19:20:27.207000+00:00",
        "attachments": null
    },
    {
        "author": "marcinds",
        "category": "Testing",
        "parent": "",
        "content": "Blob spammer made by \u003c@277500722655002624\u003e is here: https://github.com/NethermindEth/nethermind/tree/feature/send-blobs-tool/src/Nethermind/Nethermind.SendBlobs\nwith docker images and descriptions how to use it\nFeature for creating accounts and splitting balance is not yet merged, you can find it here: https://github.com/NethermindEth/nethermind/pull/6090",
        "created_at": "2023-09-21T19:34:47.656000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "prysm-nethermind-1 seems off btw",
        "created_at": "2023-09-21T20:01:18.665000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "https://dencun-devnet-8.beaconcha.in/ explorer doesn't work\n\nabout prysm-nethermind IG \u003c@334704997122179072\u003e  might be doing some experiments",
        "created_at": "2023-09-21T20:02:57.370000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "seems to work for me?\n\nalso looks like the drop in blobs included per block drops massively around the time the experiment starts. I'd guess most of it is due to missed proposals. We're at ~56.25% proposal rate and ~78% attestation rates. The drop in blobs included however looks higher than it should, ill see if i can get a better metric on it.",
        "created_at": "2023-09-21T20:09:37.397000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "Screenshot_2023-09-21_at_22.06.25.png",
                "content": "5d25e785eaf0c3c57848a37e267e64f131e89812ecb457f03645d27d5dbae584"
            }
        ]
    },
    {
        "author": "marcinds",
        "category": "Testing",
        "parent": "",
        "content": "Only blocks preview, when you click on block, there is nothing",
        "created_at": "2023-09-21T20:10:26.765000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "it wasn't working for me at all a few minuets ago. hmmm perhaps, the effect of spammingðŸ¤”",
        "created_at": "2023-09-21T20:12:22.342000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "ah you're right! our internal liteweight one is undergoing renaming and re-releasing that's causing some chaos, we'll try and get it up soon",
        "created_at": "2023-09-21T20:13:06.423000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "im sure this is an experiment we're gonna be repeating ðŸ˜„",
        "created_at": "2023-09-21T20:13:15.348000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "also does nethermind have a nice tx-pool grafana dashboard we can use?",
        "created_at": "2023-09-21T20:14:07.197000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "We have a few blobs metrics for sure. We have to add it to our grafana ðŸ™‚",
        "created_at": "2023-09-21T20:15:40.775000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "oh unfortunately, looks like something we should investigate",
        "created_at": "2023-09-21T20:31:21.149000+00:00",
        "attachments": null
    },
    {
        "author": "marcinds",
        "category": "Testing",
        "parent": "",
        "content": "I restarted it - not helped, removed blob db - not helped. Looking in the logs and looks like we are not receiving any payloads",
        "created_at": "2023-09-21T20:33:30.123000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "restarted prysm? that usually triggers the fcus to be sent again. but you should also check the snooper if there was an `invalid` returned at some point, that could set the CL down on the wrong path.",
        "created_at": "2023-09-21T20:38:33.608000+00:00",
        "attachments": null
    },
    {
        "author": "marcinds",
        "category": "Testing",
        "parent": "",
        "content": "Prysm restart helped. Prysm-nethermind is back",
        "created_at": "2023-09-21T20:41:40.642000+00:00",
        "attachments": null
    }
]
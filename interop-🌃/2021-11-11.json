[
    {
        "author": "paulhauner",
        "category": "Testing",
        "parent": "",
        "content": "For the consensus clients, when you use the terminal difficulty/hash/epoch overrides on the CLI do you expect these changes to be represented in the output of the `/eth/v1/config/spec` endpoint?\n\nI'm thinking that Lighthouse *will* change those values, otherwise we have to keep a \"default\" and \"actual\" value around (default is used for API, actual is used... actually üòõ).\n\nThis would mean you need to provide those values to both the VC and the BN otherwise the VC is going to complain that the BN has a different spec.",
        "created_at": "2021-11-11T02:54:12.773000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Testing",
        "parent": "",
        "content": "I have discovered today that teku *doesn't* change the `config/spec` content when you override the Altair fork epoch (we serialize the raw map we started with because the parsed representation we actually work off is quite different).  This is really very annoying so I vote for using overridden values (including changing our Altair override).",
        "created_at": "2021-11-11T02:58:24.545000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Testing",
        "parent": "",
        "content": "Lighthouse is also in the same boat, it *doesn't* change but I feel it should.",
        "created_at": "2021-11-11T02:58:51.753000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Testing",
        "parent": "",
        "content": "Prysm changes it. `/eth/v1/config/spec` reflects the new values that override via cli",
        "created_at": "2021-11-11T03:17:55.533000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "Lodestar also serves the final overriden config over the api, and the validator also expects the same.  +1 for overriding values",
        "created_at": "2021-11-11T04:46:29.291000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003carnetheduck\u003e I would expect them in spec, yeah (re @amphora_interop_bot: \u003cpaulhauner\u003eFor the consensus clients, when you use the terminal difficulty/hash/epoch overrides on the CLI do you expect these changes to be represented in the output of the `/eth/v1/config/spec` endpoint?\nI'm thinking that Lighthouse *will* change those values, otherwise we have to keep a \"default\" and \"actual\" value around (default is used for API, actual is used... actually üòõ).\nThis would mean you need to provide those values to both the VC and the BN otherwise the VC is going to complain that the BN has a different spec.)",
        "created_at": "2021-11-11T08:16:11.566000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003carnetheduck\u003e on that topic, we've made our spec parsing lenient with regards to extra values and entries",
        "created_at": "2021-11-11T08:16:32.950000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!792822129019584562\u003e I fixed up the ttd calculation now",
        "created_at": "2021-11-11T12:42:01.413000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "thank you! üôÇ",
        "created_at": "2021-11-11T14:10:28.249000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!360491619402776577\u003e docker build from the dockerfile is failing",
        "created_at": "2021-11-11T14:29:58.421000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "unknown.png",
                "content": "abbbd47a886991ff87dd4c457b7396bb41f3e3ef9a05825dcb57a679474037d0"
            }
        ]
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "```\nlight/lightchain.go:82:66: undefined: consensus.NewMerger\nlight/lightchain.go:88:145: undefined: consensus.Merger\n```",
        "created_at": "2021-11-11T14:30:22.865000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "i suspect these lines might be causing issue",
        "created_at": "2021-11-11T14:30:42.235000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "That's weird, I ran all the tests successfully",
        "created_at": "2021-11-11T14:35:42.801000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Testing",
        "parent": "",
        "content": "Agreed! any manual override would also be accompanied with a new spec release. Thus doing a CLI override is a faster way to get the spec change into the client than waiting on a release. But getting the spec override from a release is equally as valid (and likely) path",
        "created_at": "2021-11-11T14:41:09.577000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "fails on our CI as well, previously was building with no issues: https://github.com/ChainSafe/lodestar/runs/4179513436?check_suite_focus=true",
        "created_at": "2021-11-11T15:10:08.994000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!543900561460822016\u003e \u003c@!203220829473996800\u003e Could you verify if the mergemock is adding Random - MixHash to blockhash? If I understand eip4399 correctly, a random should affect the calculation of block hash. When I turned it off, Nethmerge was working fine.\nI also found the difference between test vectors and mergemock. I observed it when mergemock is sending forkchoiceUpdatedV1 without payload attributes. TestVectors expected 0x, but mergemock expected null. I assume it should be fixed in testVectors.",
        "created_at": "2021-11-11T15:56:23.367000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!758579010027782144\u003e trying to understand your issue - where are you expecting random to be added but doesn't seem to be?",
        "created_at": "2021-11-11T16:17:20.097000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "also if you could link to the test vector - the spec says that `PayloadAttributes` should be `Object|null`, so i think that should be updated in the vector",
        "created_at": "2021-11-11T16:18:28.887000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "When we're calculating the block hash, one of the parts of this calculation is MixHash. According to the EIP4339 https://github.com/ethereum/EIPs/blob/979cf123558bab61e2278f3c962c9a68d1adc2f4/EIPS/eip-4399.md we're reusing the existing field (MixHash) instead of appending a new one (Random). So when we're doing block.Hash =Keccak(blockHeaderRlp) one of the fields of blockHeaderRlp should be block.Random. At least, this is my assumption. When I tried to calculate it with random, I got \n` 2021-11-11 17:47:05.6070|Invalid block header (0x9e498a12f9b251b56012dbbbf7d388fd179fc5e99e2d8034a8b65c13af1bffa9) - invalid block hash`\n When I am still using MixHash = Keccak.Zero everything is fine.",
        "created_at": "2021-11-11T17:00:00.971000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "mergemock is okay here üôÇ Sure, the response of forkchoice in this link: https://notes.ethereum.org/@9AeMAlpyQYaAAyuj47BzRw/rkwW3ceVY#Update-the-fork-choice\nSo the possible options are:\n`1. {\"jsonrpc\":\"2.0\",\"result\":{\"status\":\"SUCCESS\"},\"id\":67}\" - mergemock OK üôÇ\n2. {\"jsonrpc\":\"2.0\",\"result\":{\"status\":\"SUCCESS\",\"payloadId\":null},\"id\":67} \n3. {\"jsonrpc\":\"2.0\",\"id\":67,\"result\":{\"status\":\"SUCCESS\",\"payloadId\":\"0x\"}} - testVectors\n4. {\"jsonrpc\":\"2.0\",\"result\":{\"status\":\"SUCCESS\",\"payloadId\":\"\"},\"id\":67} `\n\nI think options the first one is the best üôÇ I will add a comment to test vectors.",
        "created_at": "2021-11-11T17:17:10.753000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cralxz\u003e should the EIP-3675 \"Block structure\" table (https://eips.ethereum.org/EIPS/eip-3675#block-structure) be updated that mixHash should follow EIP-4399 rather than constant 0x0000...?",
        "created_at": "2021-11-11T17:19:33.093000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!360491619402776577\u003e I could compile at home your branch `kintsugi-spec` early this morning, but now in my office it fails without any descriptive error\n```\ngithub.com/dop251/goja\ngithub.com/influxdata/influxdb-client-go/v2/api\ngithub.com/influxdata/influxdb-client-go/v2\ngithub.com/ethereum/go-ethereum/metrics/influxdb\ngithub.com/ethereum/go-ethereum/internal/jsre\ngithub.com/ethereum/go-ethereum/console\ngithub.com/ethereum/go-ethereum/eth/tracers\ngithub.com/ethereum/go-ethereum/eth/tracers/native\nutil.go:46: exit status 2\nexit status 1\nmake: *** [Makefile:12: geth] Error 1\n```\nWhere should I start looking?",
        "created_at": "2021-11-11T17:29:21.670000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Ok, so here's something more descriptive: \n```\n$ make\nenv GO111MODULE=on go run build/ci.go install ./cmd/geth\n\u003e\u003e\u003e /usr/lib/go/bin/go build -ldflags -X main.gitCommit=3a1a2af8227fb7b016f381c0df480f357ad6e88d -X main.gitDate=20211111 -extldflags -Wl,-z,stack-size=0x800000 -trimpath -v -o ./go-ethereum/build/bin/geth ./cmd/geth\ngithub.com/ethereum/go-ethereum/consensus/beacon\ngithub.com/ethereum/go-ethereum/miner\n# github.com/ethereum/go-ethereum/consensus/beacon\nconsensus/beacon/consensus.go:63:10: undefined: consensus.Merger\nconsensus/beacon/consensus.go:68:43: undefined: consensus.Merger\n# github.com/ethereum/go-ethereum/miner\nminer/miner.go:71:171: undefined: consensus.Merger\nminer/worker.go:131:15: undefined: consensus.Merger\nminer/worker.go:194:188: undefined: consensus.Merger\nutil.go:46: exit status 2\nexit status 1\n```",
        "created_at": "2021-11-11T17:40:59.916000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Oh I think it may have been a force push you made today. I'll see if I manage to get a previous commit",
        "created_at": "2021-11-11T17:44:51.697000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "ahh no I don't have it here",
        "created_at": "2021-11-11T17:45:32.286000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "facing same issue in docker build",
        "created_at": "2021-11-11T17:47:14.222000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Testing",
        "parent": "",
        "content": "Yes, I think so",
        "created_at": "2021-11-11T17:52:41.170000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "That's so weird",
        "created_at": "2021-11-11T19:01:23.617000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "It works for me",
        "created_at": "2021-11-11T19:01:27.290000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "ha",
        "created_at": "2021-11-11T19:02:11.610000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I didn't commit the one file",
        "created_at": "2021-11-11T19:02:17.311000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "sorry about that",
        "created_at": "2021-11-11T19:02:24.368000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I moved the merger around and did not commit the new file üò¶",
        "created_at": "2021-11-11T19:02:54.521000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I just pushed to my prysm branch doing the exact same mistake üôÇ",
        "created_at": "2021-11-11T19:03:19.071000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Done, should be working now",
        "created_at": "2021-11-11T19:04:14.854000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "thanks \u003c@!360491619402776577\u003e , I can finally confirm the merge transition scenario with ttd \u003e0 to be fixed!",
        "created_at": "2021-11-11T19:35:06.905000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "Got it - thanks. We weren't supporting EIP-4399, but you should be able to use it now with this PR https://github.com/protolambda/mergemock/pull/10",
        "created_at": "2021-11-11T20:53:16.700000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "Merged it \u003c@!543900561460822016\u003e, nice fix üëç",
        "created_at": "2021-11-11T21:00:51.857000+00:00",
        "attachments": null
    }
]
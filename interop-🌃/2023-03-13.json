[
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Writeup of fridays DOS issues on goerli: https://twitter.com/vdWijden/status/1635218368155488262",
        "created_at": "2023-03-13T09:57:30.064000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I'm still seeing a bunch of stale transactions (meaning the attack is still going on)",
        "created_at": "2023-03-13T14:37:14.744000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@199561711278227457\u003e",
        "created_at": "2023-03-13T14:37:55.368000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "ah, but our geth nodes seem fine tbh. I dont see what would cause a drop down to ~25% on the network :/",
        "created_at": "2023-03-13T14:40:40.458000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "even with higher resource usage, it shouldn't be this drastic",
        "created_at": "2023-03-13T14:40:53.879000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2023-03-13T14:41:11.001000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "IMG_1829.png",
                "content": "1378769ee927d05f2677dee77c2d7c657200fcd2a28a3e540be9aa040b983c78"
            }
        ]
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "Ignore timezone, screenshot is from internal infra, just a few min ago",
        "created_at": "2023-03-13T14:42:08.854000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Nimbus nodes seemed to fail according to https://goerli.beaconcha.in/epoch/162000",
        "created_at": "2023-03-13T14:42:30.949000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Lighthouse blocks were reorged out",
        "created_at": "2023-03-13T14:42:45.673000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "hmm, for whatever reason i also don't see too many reorgs on our machines. the deepest one is depth 3. How is yours defined \u003c@203220829473996800\u003e ? Is that a sum of all or is that the depth seen by 1 machine?",
        "created_at": "2023-03-13T14:45:43.577000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "sum of reorgs weâ€™re seeing while following Goerli as L2",
        "created_at": "2023-03-13T14:46:30.452000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2023-03-13T14:46:32.559000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "Screenshot_2023-03-13_15-46-21.png",
                "content": "aa4091454e2a7d9a5d8a73d19f798569d65813209a1f2560eed787f9915fb3f6"
            }
        ]
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "tons of late blocks in the last ~2h according to teku logs atleast",
        "created_at": "2023-03-13T14:49:55.852000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "In that particular epoch it seems LH nodes were on a separate fork:\n```\n{\"blockSlot\":5184007,\"graffiti\":\"Lighthouse/v3.5.1-6dbb87c\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\",\"message\":\"Received block\",\"prefix\":\"sync\",\"proposerIndex\":98033,\"severity\":\"DEBUG\",\"sinceSlotStartTime\":1908527052}\n{\"headRoot\":\"0x1366db33baa96a535cf4b95c80a086c84911366faec3a52c88ec9cdbfdbd8fa8\",\"headWeight\":156703000000000,\"message\":\"Head block is not the received block\",\"prefix\":\"blockchain\",\"receivedRoot\":\"0x5f2a1c0bbb3fa5e68bf3e42e17ca611f44605a327408e830f2bac935cf75186c\",\"receivedWeight\":178973387500000,\"severity\":\"DEBUG\"}\n{\"block\":\"0x5f2a1c0b...\",\"chainServiceProcessedTime\":884210085,\"deposits\":0,\"epoch\":162000,\"finalizedEpoch\":161998,\"finalizedRoot\":\"0xa6a72ee8...\",\"justifiedEpoch\":161999,\"justifiedRoot\":\"0x78e1f3ae...\",\"message\":\"Synced new block\",\"parentRoot\":\"0xe984a41c...\",\"prefix\":\"blockchain\",\"severity\":\"DEBUG\",\"sinceSlotStartTime\":3227319395,\"slot\":5184007,\"slotInEpoch\":7,\"version\":\"bellatrix\"}\n```\nThey were building on top of this block which was also orphaned:\nhttps://goerli.beaconcha.in/slot/0xe984a41c6c18ddfbcc936e01ed845e0a869e6355da7581fff5a6f4ae0fc6326c",
        "created_at": "2023-03-13T15:05:26.558000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Why was it orphaned?",
        "created_at": "2023-03-13T15:06:01.526000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Did prysm reject it somehow?",
        "created_at": "2023-03-13T15:06:17.090000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "It most likely was very late, let me double check now",
        "created_at": "2023-03-13T15:06:25.717000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Prysm reorg feature was working great, but it self disabled once the chain failed to advance",
        "created_at": "2023-03-13T15:07:35.704000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Nimbus is sending very very late blocks, this was happening even before this disruption",
        "created_at": "2023-03-13T15:07:55.343000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "this was\n```\n\"blockSlot\":5183997,\"graffiti\":\"Nimbus/v23.3.0-17c0ee-stateofus\\u0000\",\"message\":\"Received block\",\"prefix\":\"sync\",\"proposerIndex\":190473,\"severity\":\"DEBUG\",\"sinceSlotStartTime\":71468712835}\n{\"headRoot\":\"0x9f01f39a337de3d8b7b03b7390a04e63387cd1503244643dfc9876c2592f30f5\",\"headWeight\":523336387500000,\"message\":\"Head block is not the received block\",\"prefix\":\"blockchain\",\"receivedRoot\":\"0xe984a41c6c18ddfbcc936e01ed845e0a869e6355da7581fff5a6f4ae0fc6326c\",\"receivedWeight\":0,\"severity\":\"DEBUG\"}\n{\"block\":\"0xe984a41c...\",\"chainServiceProcessedTime\":1495187990,\"deposits\":0,\"epoch\":161999,\"finalizedEpoch\":161998,\"finalizedRoot\":\"0xa6a72ee8...\",\"justifiedEpoch\":161999,\"justifiedRoot\":\"0x78e1f3ae...\",\"message\":\"Synced new block\",\"parentRoot\":\"0x1cb63629...\",\"prefix\":\"blockchain\",\"severity\":\"DEBUG\",\"sinceSlotStartTime\":73002262912,\"slot\":5183997,\"slotInEpoch\":29,\"version\":\"bellatrix\"}\n{\"blockHash\":\"0x625e03c7abc3\",\"gasUtilized\":\"0.54\",\"message\":\"Synced new payload\",\"parentHash\":\"0x1067f676c30c\",\"prefix\":\"blockchain\",\"severity\":\"DEBUG\"}\n{\"attestations\":128,\"message\":\"Finished applying state transition\",\"payloadHash\":\"0x625e03c7abc3\",\"prefix\":\"blockchain\",\"severity\":\"INFO\",\"slot\":5183997,\"syncBitsCount\":329,\"txCount\":88}\n```\nit is 71 seconds late",
        "created_at": "2023-03-13T15:08:04.113000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "not sure why LH built on top of it though",
        "created_at": "2023-03-13T15:08:18.203000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I saw a bad block \n```\n\"\nERROR[03-13|14:22:16.338] \n########## BAD BLOCK #########\nBlock: 8648313 (0x1d3af85ac9b17bdfa51134723f546bb09faad5a5e69b11b443f04d06782d4726)\nError: invalid merkle root (remote: 219cf4605f088c1f8905e807cf05ee746916289084763d3a62e118531253621a local: e39a545f503392a83bd6bdc4419f8cd7fc969b7a4bc40d077b4a40301141fef3)\nPlatform: geth (devel) go1.20.2 amd64 linux\n``` \n(it was correctly reorged out)",
        "created_at": "2023-03-13T15:10:24.088000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "yeap, we saw that too in our geth nodes",
        "created_at": "2023-03-13T15:11:02.273000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Most likely this slot? https://goerli.beaconcha.in/slot/5184111",
        "created_at": "2023-03-13T15:11:19.208000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "that is the one, all our nodes got an invalid payload on it",
        "created_at": "2023-03-13T15:11:33.774000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "who produced it?",
        "created_at": "2023-03-13T15:11:35.251000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "it says EF, so maybe \u003c@199561711278227457\u003e will know",
        "created_at": "2023-03-13T15:12:02.139000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "probably caused by nethermid as we mentioned on ACD, we fixed the issue recently. But bad blocks shouldn't result with late blocks and reorgs",
        "created_at": "2023-03-13T15:12:12.892000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "This block was also after the epoch",
        "created_at": "2023-03-13T15:12:34.442000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "teku-nethermind ðŸ˜„",
        "created_at": "2023-03-13T15:12:45.458000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "yeah, but bad blocks don't explain participation problems and late blocks IMO",
        "created_at": "2023-03-13T15:13:28.963000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@199561711278227457\u003e I will send you the image soon",
        "created_at": "2023-03-13T15:13:43.956000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@199561711278227457\u003e do you have forkchoice dumps from lighthouse nodes around this time? https://goerli.beaconcha.in/slot/5184007 I'll give you my unborn child for them",
        "created_at": "2023-03-13T15:14:28.781000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "so that node was running out of space earlier today, so i triggered a resync on it ~4h ago. So it should be offline technically. I'm confused why the node was online for 1 slot, then online and then offline again. It is connected to mev_boost if that's adding any context.",
        "created_at": "2023-03-13T15:14:50.825000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "checking, we should have some forkchoice dump available - will check",
        "created_at": "2023-03-13T15:15:03.801000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "luckily that epoch took time to finalize, so there's plenty of time to check. I'd like to understand why LightHouse proposed that block, there's no way that block was head for anyone in normal conditions. cc \u003c@602753420033785856\u003e when you're awake you'll have some fun ðŸ™‚",
        "created_at": "2023-03-13T15:16:15.548000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "LH logs",
        "created_at": "2023-03-13T15:16:31.325000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "message.txt",
                "content": "1c1eee7128d7e85bb82a3595ae57aed0beb71026b79dfee420182b46471fe4e8"
            }
        ]
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "sorry i just have forkchoice dumps from teku-geth :/",
        "created_at": "2023-03-13T15:16:36.928000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "ahh crap, hopefully sigp people grab dumps",
        "created_at": "2023-03-13T15:16:57.315000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Looks like 97 is not received, then a reorg later",
        "created_at": "2023-03-13T15:16:59.863000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "ahh pitty you donÂ´t have debug logs, they show the LMD weights, perhaps you have them \u003c@199561711278227457\u003e ?",
        "created_at": "2023-03-13T15:18:57.408000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Nope, just have info logs :/",
        "created_at": "2023-03-13T15:19:36.599000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Perhaps a race, they receive 97 and shortly after they receive 03, the reorg shows 97 becoming head when perhaps they wanted to save 03?",
        "created_at": "2023-03-13T15:20:15.521000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Anyway, it seems that the disturbance probably comes from Lighthouse being in that long fork. From our logs everything looks fine here",
        "created_at": "2023-03-13T15:21:29.752000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Anyone from \u003c@\u0026595683849225240704\u003e here?",
        "created_at": "2023-03-13T15:21:56.471000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "slackers ðŸ˜‹",
        "created_at": "2023-03-13T15:29:01.157000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "Checking it out",
        "created_at": "2023-03-13T15:59:07.163000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@360491619402776577\u003e \u003c@199561711278227457\u003e debug logs should be written to disk by default in `$DATADIR/beacon/logs/beacon.log`",
        "created_at": "2023-03-13T16:08:24.098000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "oh damn, sigp backdooring debug logs on my machine ðŸ™€",
        "created_at": "2023-03-13T16:10:00.666000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "but yes, thank you! I can confirm they are there. Should i upload them here?",
        "created_at": "2023-03-13T16:10:14.743000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Testing",
        "parent": "",
        "content": "sure or you can dm them to me and potuz or whoever else is interested",
        "created_at": "2023-03-13T16:13:32.332000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "DM-ing",
        "created_at": "2023-03-13T16:18:06.413000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Thanks Pari, this was explained, I can confirm the same on our own nodes, will dm Marius",
        "created_at": "2023-03-13T17:48:28.495000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@144468805697929216\u003e would vouch call the blinded beacon block endpoint for any other reason than proposing a block? I'm thinking it's fine to keep exactly one block cached would that work for Vouch?",
        "created_at": "2023-03-13T19:54:22.094000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Nope.  If you imagine a bunch of MEV relays on one side of a diagram and a bunch of beacon nodes on the other, with Vouch in the middle, then the proposal process goes like this:\n  1 Vouch talks to all of the MEV relays and asks them for their best (blinded) execution payload header\n  2 Vouch selects the best payload and makes it available on an \"MEV-relay lite\" endpoint to which all beacon nodes are pointing\n  3 Vouch talks to all of the beacon nodes and asks them for their blinded block proposals\n  4 Vouch selects the best proposal and signs it\n  5 Vouch unblinds the execution payload header with the relevant MEV relays\n  6 Vouch recomposes the signed beacon block proposal, and publishes it to all beacon nodes\n\nSo having Prysm just hold the data wouldn't help, because in step 3 Prysm would send us back a block which we cannot unblind so steps 5 and 6 would fail.",
        "created_at": "2023-03-13T20:25:36.092000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Alright am I understanding correctly that someone would need to implement the relay API too on prysm to be able to be compatible with vouch right? At least when the local payload is higher than the bid cc \u003c@363800010518822915\u003e",
        "created_at": "2023-03-13T20:46:24.252000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Testing",
        "parent": "",
        "content": "Assuming ppl want to treat Prysm as a relayer and use that for relayer end point. This is a big project",
        "created_at": "2023-03-13T21:03:50.055000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Hence the suggestion of a flag that just tells the beacon node not to attempt to use a local payload if asked for a blinded block.",
        "created_at": "2023-03-13T21:41:38.626000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@144468805697929216\u003e is this what https://github.com/attestantio/vouch/blob/master/docs/blockrelay.md documents?",
        "created_at": "2023-03-13T22:11:00.884000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Yes, although I haven't had a chance to fill out that doc with full details yet.",
        "created_at": "2023-03-13T22:12:05.797000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "I'm confused though, based on what it says there and what you write here, \"Vouch talks to all of the beacon nodes and asks them for their blinded block proposals\" and \"Vouch talks to all of the beacon nodes and asks them for their blinded block proposals\" are a bit, in principle, redundant. Why would BNs know about relays vouch does not?",
        "created_at": "2023-03-13T22:14:14.669000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "And seems to be the root of the issue",
        "created_at": "2023-03-13T22:14:27.611000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "It says \"Vouch acts as an MEV-boost service\" but `mev-boost` very much does not connect back to BNs, at all. It's a builder API proxy/multiplexer. That's not what you describe Vouch doing",
        "created_at": "2023-03-13T22:15:28.730000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "BNs are only configured to point back to Vouch.  Vouch needs to talk to the BNs to obtain their consensus view, from which it picks the best proposal.",
        "created_at": "2023-03-13T22:25:58.228000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Vouch acts as an MEV-boost service as far as the beacon nodes are concerned, in that the beacon nodes are configured to talk to Vouch instead of MEV-boost itself.",
        "created_at": "2023-03-13T22:26:48.187000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "I'm not sure a requirement that a blinded block from the blinded beacon API endpoint being unblindable by random MEV relays is one that's supported by the specs.",
        "created_at": "2023-03-13T22:30:58.049000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "Nimbus currently, for the record, does operate in a Vouch-compatible way, but there's a request to, in these terms, add a mode where the BN does provide blinded-local blocks if appropriate. Right now Nimbus's endpoint returns nothing in that case, just an error which can allow a VC to try other options",
        "created_at": "2023-03-13T22:31:31.153000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "If that is added please make it a flag, \"if appropriate\" is down to interpretation.",
        "created_at": "2023-03-13T22:37:54.056000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "well, the spec doesn't actually mention \"if appropriate\". It doesn't mention conditions on this at all",
        "created_at": "2023-03-13T22:38:18.995000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "That's my point",
        "created_at": "2023-03-13T22:38:24.921000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "https://github.com/ethereum/beacon-APIs/blob/master/apis/validator/blinded_block.yaml  states\n```\n     Requests a beacon node to produce a valid blinded block, which can then be signed by a validator. \n     A blinded block is a block with only a transactions root, rather than a full transactions list.\n     Metadata in the response indicates the type of block produced, and the supported types of block\n     will be added to as forks progress.\n     \n     Pre-Bellatrix, this endpoint will return a `BeaconBlock`.\n```",
        "created_at": "2023-03-13T22:40:03.886000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Okay, but my point is simply that if the beacon node returns a blinded block with a payload header that Vouch does not recognize it has to discard the proposal, as it doesn't know how to unblind it to obtain the payload.  And we'd rather be able to work with all of the beacon nodes.",
        "created_at": "2023-03-13T22:48:36.926000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "It can unblind it -- use the appropriate beacon API",
        "created_at": "2023-03-13T22:49:15.301000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "if it selects that bid",
        "created_at": "2023-03-13T22:49:23.520000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "In context, by the way, \"And we'd rather be able to work with all of the beacon nodes.\" is awfully disingenuous",
        "created_at": "2023-03-13T22:50:10.218000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "It's Vouch which is doing dodgy-spec-stuff.",
        "created_at": "2023-03-13T22:52:07.463000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "It isn't disingenuous, it's how Vouch works.\n\nWe cannot find the value of the blinded proposal, so we cannot compare it to anything else.\n\nWe cannot obtain the unblinded block from the beacon node, so we can't broadcast it to other nodes.\n\nIn a multi-beacon node environment, we're going to be safer and better of discarding proposals where we don't recognize the payload rather than make a bunch of assumptions about it and the beacon node that presented it.",
        "created_at": "2023-03-13T22:53:30.399000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "It's effectively adding a condition to the spec, which is not there, and constraints a quite reasonable within-BN fallback option based on some things Vouch wants to do to balance multi-BN setups (which is, of course, a reasonable setup, as well).\n\nSo I would suggest that this is resolved explicitly one way or another as part of the beacon API spec. Either a BN can return a blinded header only it can unblind (has certain advantages) or it cannot return such a header (to better support multi-BN use cases).\n\nThe trouble right now is that Vouch is adding effectively undocumented requirements to this beacon API endpoint. I don't care that much which way it goes, but having this requirement be undocumented is not great for interoperability.",
        "created_at": "2023-03-13T22:56:57.239000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "And, I don't regard \"add a flag to choose which Beacon API variation is implemented\" as even a vaguely reasonable requirement",
        "created_at": "2023-03-13T22:58:28.153000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I think it should be fine to add the blockvalue to the blind block endpoint so that we can return it with our local blinded block",
        "created_at": "2023-03-13T22:59:13.565000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "This is something that we have and I don't think it should be hard for anyone to do",
        "created_at": "2023-03-13T22:59:35.584000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "The flag overriding I'm very against",
        "created_at": "2023-03-13T22:59:47.685000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Adding the value only addresses one of the items, it still reduces resiliency twice over (once by relying on the beacon node to have selected a good payload, and once by forcing Vouch to use only a single beacon node to broadcast the block).",
        "created_at": "2023-03-13T23:02:28.810000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I don't get this last point. To broadcast the block all others beacons vouch is connected would need to validate it. So just peering them should be equivalent",
        "created_at": "2023-03-13T23:04:41.909000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "And relaying on the beacon node is something you already do: we give you the best block we think",
        "created_at": "2023-03-13T23:05:33.157000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Sometimes beacon nodes take a long time to broadcast the block after receiving it.  Sending it to multiple beacon nodes at the same time greatly decreases the time at which it is broadcast by *someone*.",
        "created_at": "2023-03-13T23:06:04.406000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "That's fine, but it's simply not a constraint in the specs. I'd be fine with with the specs stating that the blinded endpoint has to respond with something which can be externally unblinded, but it simply does not state that right now. So, the options appear to be (a) go one-by-one with the BNs to get them to behave in the Vouch-compatible way [status quo]; (b) alter Vouch's assumptions; or (c) alter the spec",
        "created_at": "2023-03-13T23:06:13.767000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "We don't rely on it, we compare it with the proposals from the other beacon nodes and select the best one.",
        "created_at": "2023-03-13T23:06:40.172000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "I don't care in detail which outcome except for (a) happens here, but I do care that Ethereum doesn't become a folklore-driven protocol",
        "created_at": "2023-03-13T23:06:51.474000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "That one can read the specs, implement the specs as written, and function in the ecosystem",
        "created_at": "2023-03-13T23:07:10.390000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "I suspect that potuz wouldn't like c.",
        "created_at": "2023-03-13T23:08:09.593000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "I suspect that, yes, as well",
        "created_at": "2023-03-13T23:08:22.373000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "And you can do this with the current endpoints: we give you the blinded block with the value, that's enough to compare with others",
        "created_at": "2023-03-13T23:08:22.698000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Right, but your point was that we rely on the beacon node already.  We don't.  We would have to rely on the beacon node with a locally generated execution payload, because the payload doesn't exist anywhere other than the beacon node.",
        "created_at": "2023-03-13T23:10:01.085000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "The other way it exists in a unique builder",
        "created_at": "2023-03-13T23:10:50.193000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I don't get it",
        "created_at": "2023-03-13T23:10:58.089000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Commonly it exists in multiple relays.",
        "created_at": "2023-03-13T23:11:21.365000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "So c) is out, b) isn't altering Vouch's assumption as much as altering Vouch's ability to select and broadcast the best consensus block, which is why I suggested a) but it seems that people are against that as well.",
        "created_at": "2023-03-13T23:12:21.346000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "And even if it doesn't, it still allows us to publish to multiple beacon nodes at the same time (assuming we can obtain the payload).",
        "created_at": "2023-03-13T23:13:06.703000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I don't mind changing the spec, just think that this is a problem that should be solved downstream instead",
        "created_at": "2023-03-13T23:14:45.698000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "(a) is problematic because it works, more or less, as long as Vouch is one of the few special cases people have to realize exists when implementing these. But that places Vouch in a more privileged position as an arbiter of spec interpretation than is more broadly warranted, and there's nothing structurally preventing other people from trying similar things in other parts of the spec they want to tweak",
        "created_at": "2023-03-13T23:15:22.903000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "What I do mind is anything that will force me to send a block that I didn't produce and that I suspect it's censoring or is bad for any reason",
        "created_at": "2023-03-13T23:15:26.369000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "It means that BNs pairing with Vouch have to operate not so much as \"Ethereum BNs\", but as \"Vouch BNs\"",
        "created_at": "2023-03-13T23:16:43.059000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "And that's the problem.  There is no spec alteration that I can think of that would meet this requirement and still allow posting blocks to multiple beacon nodes simultaneously.",
        "created_at": "2023-03-13T23:19:14.643000+00:00",
        "attachments": null
    }
]
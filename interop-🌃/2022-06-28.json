[
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Is everyone fine with us deprecating MSF6 \u0026 MSF7 later today? \n\nWe essentially found besu issues that are fixed by a resync and erigon one's that need static peers. So we're not sure its worth keeping around considering resyncing takes a while. Instead we can dedicate the resources to MSF8. We'd still have ropsten to test fixes on.",
        "created_at": "2022-06-28T08:26:37.064000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Do the updated erigon nodes with static peers work correctly? I'm still seeing a lot of read\nDeprecating MSF6 üëç",
        "created_at": "2022-06-28T08:28:00.298000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Testing",
        "parent": "",
        "content": "Here's the LH release with the latest Sepolia TTD: https://github.com/sigp/lighthouse/releases/tag/v2.3.2-rc.0",
        "created_at": "2022-06-28T08:51:12.460000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "I'm seeing a weird behaviour on teku-erigon-2 on MSF7 that i could use some help with.\n\nTeku is listing the EL as offline or syncing (with this message `Eth1 service down or still syncing for 180s, retrying`). The EL exchange call is working, I can see it with the JSON-RPC snooper.\n```\nJun 28 09:19:36.280 2022 REQUEST\n{\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"engine_exchangeTransitionConfigurationV1\",\n  \"params\": [\n    {\n      \"terminalTotalDifficulty\": \"0xb153ad39f8dff800000\",\n      \"terminalBlockHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\n      \"terminalBlockNumber\": \"0x0\"\n    }\n  ],\n  \"id\": 9\n}\n\nJun 28 09:19:36.280 2022 RESPONSE\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 9,\n  \"result\": {\n    \"terminalTotalDifficulty\": \"0xb153ad39f8dff800000\",\n    \"terminalBlockHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\n    \"terminalBlockNumber\": \"0x0\"\n  }\n}\n```\n\nSo the EL is online, hence its stuck in the syncing stage. \n\nThe EL is however is not receiving any fcu's from the CL, the only fcu the CL has sent the EL is this one:\n```\nJun 24 12:34:14.249 2022 REQUEST\n{\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"engine_forkchoiceUpdatedV1\",\n  \"params\": [\n    {\n      \"headBlockHash\": \"0x52f457d1a204ed61414d56c555608f292cbb8e1a5624774c81e8e9a714185b8d\",\n      \"safeBlockHash\": \"0x08f099ceb3d3897f1c2d883af3806b1c4a0b6b3def800fd17d868d14e7d13fe9\",\n      \"finalizedBlockHash\": \"0x2dbb3411df59afe420f213ea5074e931c32ccf3bb14dec9fc701d19d2f9b1884\"\n    },\n    null\n  ],\n  \"id\": 57010\n}\n\nJun 24 12:34:14.249 2022 RESPONSE\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 57010,\n  \"result\": {\n    \"payloadStatus\": {\n      \"status\": \"SYNCING\"\n    }\n  }\n```\nThis was ~3 days ago...\n\nThe Erigon EL has this log message:\n```\n[INFO] [06-28|09:16:34.872] [1/16 Headers] Fork choice missing header with hash 52f457d1a204ed61414d56......\n```\n\ni.e, it cannot find that block and then the EL stalls syncing, but the CL doesn't sent it the fcu to try syncing to the head again.\n\u003c@\u0026836981489430036500\u003e",
        "created_at": "2022-06-28T09:24:59.828000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "As a result, that node is always stuck on this block:\n```\n[INFO] [06-28|09:22:54.874] [4/16 Bodies] Wrote block bodies         block_num=15010209 delivery/sec=0B wasted/sec=0B alloc=2.4GB sys=3.8GB\n[INFO] [06-28|09:23:14.873] [4/16 Bodies] Wrote block bodies         block_num=15010209 delivery/sec=0B wasted/sec=0B alloc=2.5GB sys=3.8GB\n```\n\nI'm assuming \u003c@\u0026688101493978562687\u003e didn't find the block and teku for whatever reason didn't send the fcu to ask erigon to look for the block again.",
        "created_at": "2022-06-28T09:26:56.206000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Some erigon nodes are fine post adding static peers, some are still stuck. I'm assuming there's some incompatibility similar to how teku-erigon-2 has that's randomly triggered based on if the peer responds with a block or not. Unsure if the non-finality period made things worse or more confusing for the network.",
        "created_at": "2022-06-28T09:27:37.274000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I would like to preserve MSF7 until those issues are solved if thats okay?",
        "created_at": "2022-06-28T09:28:39.439000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Yea of course, let's keep it around to figure this stuff out. I'll just get rid of MSF6 for now.",
        "created_at": "2022-06-28T09:28:58.327000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@199561711278227457\u003e logging there to have a look. One quick comment is that when you see errors like this `Eth1 service down or still syncing for ...`, the teku module that is complaining is the Deposit tracking one. It is definitely signalling that something is wrong on EL side but it isn't strictly related to engine apis.",
        "created_at": "2022-06-28T12:19:25.097000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "hello, should `latest`follow the fcu head or the newPayload head?",
        "created_at": "2022-06-28T12:24:37.843000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "or the last LVH returned by EL?",
        "created_at": "2022-06-28T12:24:47.921000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Testing",
        "parent": "",
        "content": "parithosh0530 logging there to have a",
        "created_at": "2022-06-28T12:33:02.452000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Mainnet-shadow-fork-8 configs are out: https://github.com/eth-clients/merge-testnets/tree/main/mainnet-shadow-fork-8\n\nTTD is planned to be reached on Tuesday (5th July) at ~2PM UTC.  We're testing a mix of forest/bonsai nodes for besu and using static peers for erigon. Additionally we have added a forkmon to make tracing forks easier. \n\nI'll be running a round of updates + TTD override on Monday (4th), if there's anything please do reach out.\n\nTooling links:\nhttps://ethstats.mainnetshadowfork8.ethdevops.io/\nhttps://explorer.mainnetshadowfork8.ethdevops.io/\nhttps://beaconchain.mainnetshadowfork8.ethdevops.io/\nhttps://forkmon.mainnetshadowfork8.ethdevops.io/",
        "created_at": "2022-06-28T16:39:27.922000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Seeing a fair few missed proposals on ropsten for validators in the 2x,xxx and 7x,xxx range.  Looks like those in the 2x,xxx range are not yet attesting either, so I'd guess they are not yet configured, but those in the 7x,xxx range are attesting so perhaps some issue with proposals specifically?",
        "created_at": "2022-05-31T11:57:30.757000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "2xxxx are Besu nodes, they should be up later today and are indeed offline. \n\n7xxxx are lodestar nodes, tagging \u003c@688748669268132001\u003e \u003c@792822129019584562\u003e for visibility",
        "created_at": "2022-05-31T12:10:37.006000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "thanks for tagging, we are trying to identify/fix, our deposit tracker is causing issues leading to proposal failure",
        "created_at": "2022-05-31T12:19:35.907000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "alright! lodestar is back in proposal game! ü•≥ keeping an eye to see if the issue resurfaces",
        "created_at": "2022-05-31T12:58:15.666000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@199561711278227457\u003e you may upgrade your lodestar EF combos to the latest lodestar:next",
        "created_at": "2022-05-31T12:59:55.996000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "I think a versioned patch release may follow",
        "created_at": "2022-05-31T13:00:19.037000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@792822129019584562\u003e nice.  Looks like outside of the besu nodes we're seeing full participation in attestations.  Great base from which to tackle the merge.",
        "created_at": "2022-05-31T14:45:01.286000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "just updated the ef nodes now. They're still peering up, but we should see soon if it worked.",
        "created_at": "2022-05-31T14:50:43.378000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "eth1 head voting is still poor on ropsten.  First period (1698/2048 slots proposed):\n```\n                         f_eth1_block_hash                          | f_votes \n--------------------------------------------------------------------+---------\n \\x278f9b7d26b307c06b777ea7f79349716345806e6045f82dceb9d66e088fb755 |     847\n \\xeefb1f70bf7bed6394ed7d6f812f422aa37bf7680e1b75fa551d40e849f10a87 |     582\n \\x3325160b1c27bdd2fe1bc62488f990d5a408b741eae3ee21f4e050ced5bb7c3b |     238\n \\x017d818e29c8eb35200680e653c0b587bf87cae1c10a161b3f91bd4a2132a9f4 |      16\n...\n```\n\nSecond period (1701/2048 slots proposed):\n```\n                         f_eth1_block_hash                          | f_votes \n--------------------------------------------------------------------+---------\n \\xf14947d6f17d8ccd6d33941b401772c1377a846be592c0e9756711e7bce42e53 |     840\n \\xeefb1f70bf7bed6394ed7d6f812f422aa37bf7680e1b75fa551d40e849f10a87 |     608\n \\x0a0bd94cea32012ebea89511d70efb0f9aa4bd3444f702ccd38c11427685cd33 |     240\n...\n```\n\nThird period (1683/2048 slots proposed):\n```\n                         f_eth1_block_hash                          | f_votes \n--------------------------------------------------------------------+---------\n \\xf0181d1f8d6b43ac1f4dbf13b94b36333484740f6a0773c827f2ccb5ca36fc24 |     887\n \\xeefb1f70bf7bed6394ed7d6f812f422aa37bf7680e1b75fa551d40e849f10a87 |     543\n \\x94ff5fdd38b7d40e6353054e697fdd45ad7ac07cb49f10b7a8f3094a428126ea |     236\n...\n```\n\nNow that lodestar is proposing again I'm hoping that we'll see better results.",
        "created_at": "2022-05-31T16:18:57.901000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Did you use ethdo to generate that? If so, what command is that?",
        "created_at": "2022-05-31T19:19:54.941000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "No, it came from chaind.",
        "created_at": "2022-05-31T19:49:44.313000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Not getting any better.  Fourth period (1824/2048 slots proposed):\n```\n                        f_eth1_block_hash                          | f_votes \n-------------------------------------------------------------------+--------- \\x6f9fb340281dda1bd4e31395b81e2277cdde579cbe21be4310025cc4ef484a8e |     864\n\\xeefb1f70bf7bed6394ed7d6f812f422aa37bf7680e1b75fa551d40e849f10a87 |     419\n\\x528010e5733db414ab8c944496b4b9cd8eb4922694f780d487d918dd86fd3fa9 |     384 \\xa15d058a35eea294bf3fe773a0a80acd97ddcf7b1f1c945a5873d959f8261f94 |     145\n...\n```\n\nCurrent period (832/883 slots proposed):\n```\n                         f_eth1_block_hash                          | f_votes \n--------------------------------------------------------------------+---------\n \\x46deeb7f5b67f1d431d8af93891625a0fb713a5b0f8cf738777649a2e4351ee3 |     307\n \\xeefb1f70bf7bed6394ed7d6f812f422aa37bf7680e1b75fa551d40e849f10a87 |     204\n \\x6e9c6d576ef4556e6decbbac127711823f58e38c5495b4d5cd05e5d52e2cd594 |     158\n \\x866e46f2c51a0f23fab66756ae48fb6c30f16af3df133d2e4c134842fe71ec70 |     151\n...\n```",
        "created_at": "2022-05-31T21:16:05.084000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Not all the Besu keys are up and running, so we're still at ~94% capacity. So 832/883 would be about 94% ?",
        "created_at": "2022-05-31T21:17:53.721000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Deprecation notice for mainnet-shadow-fork-5, we can use MSF6 for testing. We additionally still have MSF2 that is long running and will continue to stay online. One besu node that had some issues will stay online for debugging.",
        "created_at": "2022-05-31T21:18:48.232000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Here is a more detailed dump of the current period.",
        "created_at": "2022-05-31T21:22:54.262000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "current.txt",
                "content": "c26d5742a28cf8de295e8646ce8cb5f98df2802ae841a356cc6228de2da857d2"
            }
        ]
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Yep proposals seem good in terms of their numbers, it's the failure to agree upon an ETH1 block on which to vote that's causing deposits to stall.",
        "created_at": "2022-05-31T21:28:00.538000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "Looks like most of the Erigon nodes are voting for the incumbent block `0xeefb1f70bf7bed6394ed7d6f812f422aa37bf7680e1b75fa551d40e849f10a87` which might just mean they're not synced",
        "created_at": "2022-05-31T21:36:02.375000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "and whatever EE `Nimbus/v22.5` is running",
        "created_at": "2022-05-31T21:36:24.131000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "My tool is also showing disagreement amongst the `6e9c6d576ef4556e6decbbac127711823f58e38c5495b4d5cd05e5d52e2cd594` voters on how many deposits there should be, which is a worry",
        "created_at": "2022-05-31T21:37:03.697000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "```\n0x46deeb7f5b67f1d431d8af93891625a0fb713a5b0f8cf738777649a2e4351ee3[180]: 317\n0xeefb1f70bf7bed6394ed7d6f812f422aa37bf7680e1b75fa551d40e849f10a87[0]: 209 (incumbent)\n0x866e46f2c51a0f23fab66756ae48fb6c30f16af3df133d2e4c134842fe71ec70[178]: 157\n0x6e9c6d576ef4556e6decbbac127711823f58e38c5495b4d5cd05e5d52e2cd594[180]: 72\n0x6e9c6d576ef4556e6decbbac127711823f58e38c5495b4d5cd05e5d52e2cd594[179]: 48\n0x6e9c6d576ef4556e6decbbac127711823f58e38c5495b4d5cd05e5d52e2cd594[178]: 42\n...\ntotal votes in period: 859, slots remaining: 1137\nparticipation: 94.4%\n```",
        "created_at": "2022-05-31T21:37:30.349000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "(single votes omitted, data from https://github.com/michaelsproul/eth2-scripts/tree/master/eth1_votes)",
        "created_at": "2022-05-31T21:38:00.169000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "the numbers in `[]` are the deposit count",
        "created_at": "2022-05-31T21:40:28.170000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "Lodestar is consistently voting for `866e46f2c51a0f23fab66756ae48fb6c30f16af3df133d2e4c134842fe71ec70`, which naively seems too old. It's from 18h48m ago, whereas the start of the period is ~3.4h ago plus the 8h follow distance ~= 11h. cc \u003c@688748669268132001\u003e",
        "created_at": "2022-05-31T21:48:21.090000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "Voters for `6e9c6d576ef4556e6decbbac127711823f58e38c5495b4d5cd05e5d52e2cd594` seem to all be Prysm. Can you get the `deposit_count` for those votes from `chaind` \u003c@144468805697929216\u003e?",
        "created_at": "2022-05-31T21:51:11.744000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "In terms of timing though Prysm's vote of `6e9c6d576ef4556e6decbbac127711823f58e38c5495b4d5cd05e5d52e2cd594` seems closest to what we want. The block with the most votes (from LH/Teku) is 3h older:\n\n- Prysm: https://ropsten.etherscan.io/block/0x6e9c6d576ef4556e6decbbac127711823f58e38c5495b4d5cd05e5d52e2cd594\n- LH/Teku/mode: https://ropsten.etherscan.io/block/0x46deeb7f5b67f1d431d8af93891625a0fb713a5b0f8cf738777649a2e4351ee3",
        "created_at": "2022-05-31T21:53:50.845000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Between 178 and 180.",
        "created_at": "2022-05-31T22:10:54.683000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "Can you see which graffiti chooses which vote count?",
        "created_at": "2022-05-31T22:15:25.256000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "```\n f_eth1_deposit_count |    f_graffiti    | f_blocks \n----------------------+------------------+----------\n                  178 | \"prysm-k8s\"      |       23\n                  178 |                  |       16\n                  178 | prysm-besu       |        2\n                  178 | prysm-geth       |        1\n                  179 | \"prysm-k8s\"      |       28\n                  179 |                  |       18\n                  179 | prysm-nethermind |        2\n                  180 | \"prysm-k8s\"      |       76\n                  180 |                  |       40\n                  180 | prysm-geth       |        4\n                  180 | prysm-besu       |        1\n```",
        "created_at": "2022-05-31T22:16:44.764000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "And here's the SQL (doing this on the fly so worth seeing in case I mucked something up)\n```\nSELECT f_eth1_deposit_count\n      ,convert_from(TRIM('\\x00'::BYTEA FROM f_graffiti)::BYTEA, 'UTF8') AS f_graffiti\n      ,COUNT(*) AS f_blocks\nFROM t_blocks\nWHERE f_slot \u003e= 8192\n  AND f_slot \u003c 10240\n  AND f_eth1_block_hash = '\\x6e9c6d576ef4556e6decbbac127711823f58e38c5495b4d5cd05e5d52e2cd594'\nGROUP BY f_eth1_deposit_count,f_graffiti\nORDER BY f_eth1_deposit_count,f_blocks DESC,f_graffiti\n```",
        "created_at": "2022-05-31T22:17:50.885000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "your query LGTM",
        "created_at": "2022-05-31T22:21:12.381000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "I don't think this shows a particularly striking correlation with the EEs, so there must be some other factor in play",
        "created_at": "2022-05-31T22:22:05.889000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "Dusting off my memory of eth1 voting, validators are meant to vote with the majority if they see the majority vote as valid (within the 8h window that begins 8h before the start of the current period)",
        "created_at": "2022-05-31T22:24:27.209000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "The first block of the period was a Lighthouse one voting for what became the majority: https://beaconchain.ropsten.ethdevops.io/block/8192",
        "created_at": "2022-05-31T22:24:42.987000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "So for Prysm not to vote for that must mean that it doesn't see it as valid and within the period",
        "created_at": "2022-05-31T22:24:56.634000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "Ah, and vice versa, Lighthouse doesn't see Prysm's block as within period. I just remembered the endpoint we have for dumping our set of valid blocks: https://gist.github.com/michaelsproul/91ada4ed92722de68cd3a3e6d12cd5bf",
        "created_at": "2022-05-31T22:34:34.460000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "I think prysm is very much doing its own thing (given the different deposit counts for the same block, I'm not sure I'd trust it until at least that is addressed)\n\nLodestar looks like it is consistently picking a block a fair bit earlier than the one that Lighthouse selected, so perhaps a mistake in their algorithm?\n\nProbably need to have other client teams dig in to why they are picking the values they are.\n\n(ETH1 voting is such a pain, it's definitely climbing up the list of \"things to tidy in post-merge hard forks\" for me.)",
        "created_at": "2022-05-31T22:41:00.865000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Testing",
        "parent": "",
        "content": "I'm desperately hoping that we can get rid of eth1 voting before I have to go and change that code again...",
        "created_at": "2022-05-31T22:47:04.442000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Testing",
        "parent": "",
        "content": "Anyway from what I understand of the above Teku is agreeing with Lighthouse right?",
        "created_at": "2022-05-31T22:47:08.994000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "Yeah looks like it",
        "created_at": "2022-05-31T22:49:02.608000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "cc \u003c@363800010518822915\u003e, seems there's an issue with Prysm eth1 voting on Ropsten (bit of a thread above)",
        "created_at": "2022-05-31T22:50:00.963000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Testing",
        "parent": "",
        "content": "Ack. We'll look into this today üôè",
        "created_at": "2022-05-31T22:52:23.327000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "I'm going to keep digging too, it looks like the block Prysm is proposing is within the period by 27 seconds, yet Lighthouse doesn't see it as valid (working here: https://gist.github.com/michaelsproul/a6c5a51a3fca2261f72d706f46638cec)",
        "created_at": "2022-05-31T22:58:27.186000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "Prysm doesnt vote with the majority anymore",
        "created_at": "2022-05-31T22:58:41.169000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "it hasnt for a while",
        "created_at": "2022-05-31T22:58:47.347000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "How come?",
        "created_at": "2022-05-31T23:00:06.421000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "Mostly as a mitigation for the previous incident we encountered in mainnet, it seemed too risky to allow for vote by majority, so we have changed back to simple voting for now.",
        "created_at": "2022-05-31T23:04:59.467000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e Voting with the majority means voting for something *correct* in that range. So I don't immediately see why it's dangerous. I guess unless compounded with other bugs",
        "created_at": "2022-05-31T23:07:59.009000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "Yeah, the validity check should guard against any downsides of voting with the majority though, you never just vote blindly. That said, it gives the first proposer of the period a lot of power to choose _which_ block in the period to make majority, and in this case Lighthouse chose an old block and got overridden by Prysm",
        "created_at": "2022-05-31T23:08:26.376000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "so in this case, LH doesn't see this as valid ?",
        "created_at": "2022-05-31T23:12:52.615000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "I just realised our LH nodes don't have synced eth1 caches, so I think we're just lagging",
        "created_at": "2022-05-31T23:13:18.309000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "I'm going to see if I can force a sync before the period ends",
        "created_at": "2022-05-31T23:13:27.847000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "ah ok",
        "created_at": "2022-05-31T23:13:34.175000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "hmm this is odd",
        "created_at": "2022-05-31T23:13:45.359000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "It looks like `fcU` to said block should return `SYNCING` in this case if `newPayload` returned `ACCEPTED`. But yes, I would expect geth to execute a block if it has a parent block post-state which I think is the case when syncing to TTD is finished and if said block is the direct child of a terminal block",
        "created_at": "2022-06-13T09:51:04.585000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "yes, I had misunderstood part of `ACCEPTED` specs",
        "created_at": "2022-06-13T10:33:28.049000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "But the building-on-top-of-TTD-block case still seems relevant",
        "created_at": "2022-06-13T10:33:51.222000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Weren't discussions about simplifying ACCEPTED/SYNCING into one for NewPayload?",
        "created_at": "2022-06-13T10:35:58.095000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "My understanding is that they're generally treated the same by CLs anyway, not sure if there are exceptions to this",
        "created_at": "2022-06-13T10:36:39.175000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Had read correctly after all :)",
        "created_at": "2022-06-13T10:38:08.539000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "any issues with this case?",
        "created_at": "2022-06-13T11:41:38.871000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "well, it's what I wrote, that Geth is at least sometimes returning `ACCEPTED`, not `VALID` here",
        "created_at": "2022-06-13T11:47:22.062000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "ah, ok. If geth has a pre-state then returning `ACCEPTED` does seem like a bug",
        "created_at": "2022-06-13T11:50:28.617000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "We need both the parent block and the parent state, otherwise we will return ACCEPTED (maybe SYNCING if we can extend our currently running sync cycle with it)",
        "created_at": "2022-06-13T11:52:16.350000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Do you have some log output of the geth node? It should tell you *why* we return accepted",
        "created_at": "2022-06-13T11:54:14.273000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "Yeah, looks like the left PoW stage maybe just meant that it got an fcU and that was its cue to leave PoW stage?",
        "created_at": "2022-06-13T18:08:52.803000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "didn't \u003c@219015859182632960\u003e let geth sync up to the merge point beforehand, highly likely geth would have the terminal block + terminal state, may be there is some log for where geth's head state is executed till",
        "created_at": "2022-06-13T18:12:14.006000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "evidently that was not the case",
        "created_at": "2022-06-13T18:30:44.852000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "So, question, when this first fcU is received, it does\n- Left PoW stage\n- New skeleton head announced\n- Synchronisation terminated\n- Created initial skeleton subchain\n- Starting reverse header sync cycle\n- Fetching skeleton headers\n\nwhat does this mean?",
        "created_at": "2022-06-13T18:32:14.428000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "from my understanding, skeleton subchain is geth's backfill chain starting back from that fcU block",
        "created_at": "2022-06-13T18:35:39.997000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "but geth wouldn't need to start a skeleton subchain in case its all synced upto TTD",
        "created_at": "2022-06-13T18:36:18.530000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "yes -- wasn't the case here, but will know soon about that",
        "created_at": "2022-06-13T18:37:11.802000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@219015859182632960\u003e is testing that",
        "created_at": "2022-06-13T18:37:45.584000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "(scenario i am assuming is : geth synced to TTD beforehand, first fcU referes to the terminal block as parent, and geth's terminal block is that parent , i.e.geth is not on a different fork)",
        "created_at": "2022-06-13T18:38:03.501000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "yes, which it turns out was not actually what happened here, but definitely will be interesting to see how this interaction occurs",
        "created_at": "2022-06-13T18:38:40.005000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "I have started seeing an increeased proposal count in the past 6 or so hours. http://134.209.87.158:8080/slots Looks like its mainly a nethermind and erigon issue. \u003c@\u0026652918665943056397\u003e",
        "created_at": "2023-05-04T08:03:51.565000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Example of an error message, Lodestar-Nethermind: ```May-04 08:05:00.045[rest]            error: Req req-qyse produceBlockV2 error  Invalid hex string: hex argument type object must be of type string\nError: Invalid hex string: hex argument type object must be of type string\n    at fromHexString (/usr/app/node_modules/@chainsafe/ssz/src/util/byteArray.ts:19:11)\n    at dataToBytes (file:///usr/app/packages/beacon-node/src/eth1/provider/utils.ts:111:19)\n    at file:///usr/app/packages/beacon-node/src/execution/engine/types.ts:276:56\n    at Array.map (\u003canonymous\u003e)\n    at parseBlobsBundle (file:///usr/app/packages/beacon-node/src/execution/engine/types.ts:276:43)\n    at parseExecutionPayload (file:///usr/app/packages/beacon-node/src/execution/engine/types.ts:204:42)\n    at ExecutionEngineHttp.getPayload (file:///usr/app/packages/beacon-node/src/execution/engine/http.ts:312:12)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at BeaconChain.produceBlockBody (file:///usr/app/packages/beacon-node/src/chain/produceBlock/produceBlockBody.ts:221:29)\n    at BeaconChain.produceBlockWrapper (file:///usr/app/packages/beacon-node/src/chain/chain.ts:403:39)```",
        "created_at": "2023-05-04T08:05:53.492000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "is there a new nethermind image maybe that I should be using ?",
        "created_at": "2023-05-04T08:06:11.157000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Erigon-Lodestar issues are the following: ```May-04 08:20:12.131[rest]            error: Req req-r3r7 produceBlockV2 error  allVersionedHashes len 4 != blobKzgCommitments len 0\nError: allVersionedHashes len 4 != blobKzgCommitments len 0\n    at verifyKzgCommitmentsAgainstTransactions (file:///usr/app/packages/state-transition/src/util/blobs.ts:42:11)\n    at processBlobKzgCommitments (file:///usr/app/packages/state-transition/src/block/processBlobKzgCommitments.ts:14:8)\n    at processBlock (file:///usr/app/packages/state-transition/src/block/index.ts:65:5)\n    at stateTransition (file:///usr/app/packages/state-transition/src/stateTransition.ts:83:3)\n    at computeNewStateRoot (file:///usr/app/packages/beacon-node/src/chain/produceBlock/computeNewStateRoot.ts:22:21)\n    at BeaconChain.produceBlockWrapper (file:///usr/app/packages/beacon-node/src/chain/chain.ts:421:23)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.produceBlockV2 (file:///usr/app/packages/beacon-node/src/api/impl/validator/index.ts:255:35)\n    at Object.handler (file:///usr/app/packages/api/src/utils/server/genericJsonServer.ts:45:23)```",
        "created_at": "2023-05-04T08:22:07.492000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Example of an error message Lodestar",
        "created_at": "2023-05-04T09:26:57.946000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Erigon seems to be crashing with LH on this: ```[WARN] [05-04|10:28:46.256] Served                                   conn=172.18.0.4:35110 method=eth_getBlockByNumber reqid=1 t=138.891942ms err=\"decoding block from 626c6f636b5f726c703a225c7866615c7830385c745c7862315c7866395c783032205c7861305c7864327d6d5c786634465c7838633b5c7530303935485c786233245c7839335c7830385c7864395c7864645a525c7830315c7839335c786337585c783866715c7861315c7838395c7865664b5c7831665c7839335c7866385c7862395c7861305c7831645c7863634d5c7865385c7864655c7863375d7a5c7861625c7838355c786235675c7862365c7863635c7864345c7831615c7864335c783132455c7831625c7839345c783861745c7831335c7866305c786131425c78666440d493475c7839345c7866397e5c7831385c7830635c7830355c7830655a5c78623072215c7831615c7864325c7863325c7831335c7865625a5c7865654d5c786631345c7861304a69c4945c7831615c7831355c7866343d765c783939435c7866335c7866375c7830635c7839315c783033385c7838305c7839655c7865365c7831655c78613962725c225c7866665c7862375c783165535c7830665c7861305c7830355c7861303f5c786535d29a575c7830623d68455c7865375c783035603a5c7861366d5c7831315c7863395c783137265c7831655c7839665c7830635c7839632c5c7861315c7830365c7862335c6e5c7865325c786331712c5c7861305c7839345c78623861365c7838365c7830345c7866645c786635445c783032425c7838355a365c7866395c783163575c783864425c7831377c5c7830375c7830315c7838355c7839383d5c7839635c7866315c7831315c7864652f5c7866375c7862395c7830315c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c7830305c783```",
        "created_at": "2023-05-04T10:30:06.242000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "and it just continously printing hashes",
        "created_at": "2023-05-04T10:30:16.660000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@898563924440543283\u003e would you mind taking a look maybe?",
        "created_at": "2023-05-04T10:30:31.659000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "looks like we are not finalizing now",
        "created_at": "2023-05-04T10:50:15.320000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@412614104222531604\u003e looking.",
        "created_at": "2023-05-04T14:23:43.584000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "`lighthouse-erigon-1`",
        "created_at": "2023-05-04T14:24:39.899000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@412614104222531604\u003e is that error message truncated then or by \"continuously printing hashes\" are those across multiple error messages?",
        "created_at": "2023-05-04T14:30:20.400000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "`docker logs -f erigon --tail 100`",
        "created_at": "2023-05-04T14:30:47.795000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "this bit is just the top of the error message.",
        "created_at": "2023-05-04T14:31:28.027000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "oh I have access to a machine/instance now?",
        "created_at": "2023-05-04T14:32:21.807000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "I could give you access, if it would help debugging some bugs",
        "created_at": "2023-05-04T14:33:15.717000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "yes would def. help!",
        "created_at": "2023-05-04T14:33:21.703000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Could you pls paste your ssh key in your github ?",
        "created_at": "2023-05-04T14:33:33.235000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "done",
        "created_at": "2023-05-04T14:37:44.036000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "`ssh devops@lighthouse-erigon-1.srv.4844-devnet-5.ethpandaops.io`",
        "created_at": "2023-05-04T14:38:52.847000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "thanks!",
        "created_at": "2023-05-04T14:39:35.684000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "Those bytes are supposed to be the RLP of a pending block that it can't parse, which I guess makes sense seeing as the bytes don't really look like a valid block.",
        "created_at": "2023-05-04T14:49:42.112000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Maybe \u003c@360491619402776577\u003e submitted an ssz tx?",
        "created_at": "2023-05-04T14:50:40.623000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I have no idea what I submitted",
        "created_at": "2023-05-04T14:50:55.076000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "But yeah I submitted ssz txs",
        "created_at": "2023-05-04T14:51:02.995000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "that error is coming from the ssz parser, yes.",
        "created_at": "2023-05-04T14:51:11.546000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Ah it might related to this issue: https://github.com/attestantio/go-builder-client/issues/9#issuecomment-1534400483",
        "created_at": "2023-05-04T14:52:00.910000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Encoding of uint256 might be wonky",
        "created_at": "2023-05-04T14:52:17.914000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "I think what's happening is it's getting a bad SSZ tx from the network, but the erigon txpool parser doesn't recognize it's badly formatted, so still puts it in a block, but then the client is rejecting it.   So I need to fix the txpool parser to do the equivalent checks.",
        "created_at": "2023-05-04T15:18:49.058000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@412614104222531604\u003e does the situation just keep repeating if you restart it?",
        "created_at": "2023-05-04T15:28:42.826000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Yes",
        "created_at": "2023-05-04T15:29:05.205000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "I can try to nuke and restart and see whatâ€™s up",
        "created_at": "2023-05-04T15:29:13.856000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "ok let me get you a new build real quick to see if it makes any difference.",
        "created_at": "2023-05-04T15:29:19.720000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Havenâ€™t done that yet.",
        "created_at": "2023-05-04T15:29:24.427000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Ok",
        "created_at": "2023-05-04T15:29:27.009000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@360491619402776577\u003e could you share some txs you have been sending during the fuzzing if possible?",
        "created_at": "2023-05-04T15:31:32.030000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@412614104222531604\u003e https://github.com/roberto-bayardo/erigon try latest commit? \n```4fdfe3a868278e04db38076c64b5626f216434ec```",
        "created_at": "2023-05-04T15:42:39.564000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Am afk right now, coming back late in the evening. You should be able to just dump a block otherwise I can create some new ones tonight. They are fuzzed, so I can not guarantee creating the same ones",
        "created_at": "2023-05-04T15:44:24.058000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "building new img",
        "created_at": "2023-05-04T15:54:34.697000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "restarting lh-erigon now",
        "created_at": "2023-05-04T16:05:23.564000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "Hmm still seeing that error.",
        "created_at": "2023-05-04T16:09:31.008000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "check now pls",
        "created_at": "2023-05-04T16:10:25.870000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "it didn't seem to start (see an incorrect ussage message in the logs)",
        "created_at": "2023-05-04T16:11:47.184000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "On it.",
        "created_at": "2023-05-04T16:12:08.817000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "this version was rebased with upstream so it's possible flags change.",
        "created_at": "2023-05-04T16:12:10.688000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "ah yes the -externalcl flag has changed.",
        "created_at": "2023-05-04T16:12:37.804000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "I think it's now \"--internalcl=false\" instead of \"--externalcl\"",
        "created_at": "2023-05-04T16:14:56.938000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "one moment please",
        "created_at": "2023-05-04T16:16:13.653000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "fixed",
        "created_at": "2023-05-04T16:19:54.444000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "ok this looks better!",
        "created_at": "2023-05-04T16:20:40.737000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Gonna update all erigon nodes.",
        "created_at": "2023-05-04T16:21:57.416000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "well may. have spoke too soon I see the error again",
        "created_at": "2023-05-04T16:22:12.618000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "it was progressing for a bit though.",
        "created_at": "2023-05-04T16:22:25.416000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "ah you are right",
        "created_at": "2023-05-04T16:22:32.202000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "it might be explorer related?",
        "created_at": "2023-05-04T16:22:41.706000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "lodestar-erigon didn't have this issue",
        "created_at": "2023-05-04T16:23:09.495000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "so it might be beaconchain trying to query some tx that erigon doesn't like.",
        "created_at": "2023-05-04T16:23:23.130000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "it does seem to be advancing still however?",
        "created_at": "2023-05-04T16:25:57.041000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "The error message keeps getting longer and longer though, like that bad tx keeps getting appended again and again ....",
        "created_at": "2023-05-04T16:32:38.387000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "garbage is still getting in the txpool somehow.",
        "created_at": "2023-05-04T16:41:08.406000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Testing",
        "parent": "",
        "content": "Update:  I've updated the erigon txpool parser to be stricter in what it accepts, though this code still needs further vetting as I haven't checked every edge case. The erigon txpool doesn't use an existing already-hardened ssz lib because it does \"validation-in-place\" for efficiency reasons, so this is all new code, much of which I hastily wrote in the days prior to Edelweiss ðŸ˜… . \n\nIf the issue is indeed the txpool accepting invalid txs, then I'm a little baffled by why this only affects the pairing with Lighthouse, since I'd think the same bad txs would be gossiped and accepted by other erigon clients regardless of the CL client used.  So I may not fully understand yet what's going on.",
        "created_at": "2023-05-04T21:11:02.760000+00:00",
        "attachments": null
    }
]
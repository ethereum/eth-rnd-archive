[
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I started sending some blob transactions but they are not being propagated. I only have one peer `      remoteAddress: \"206.189.105.76:30303\",` which is `Nethermind/v1.20.0-unstable+445aec26/linux-x64/dotnet7.0.8`. I don't know if the issue is on our side or on nethermind though",
        "created_at": "2023-07-03T08:21:06.761000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "add more peers? i'll check nethermind logs for any issues",
        "created_at": "2023-07-03T08:25:43.436000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@360491619402776577\u003e didn't make it to nethermind atleast:\n```\ncurl --data-raw '{ \"jsonrpc\":\"2.0\",\"method\": \"txpool_content\", \"id\":1 }' localhost:8545\n{\"jsonrpc\":\"2.0\",\"result\":{\"pending\":{},\"queued\":{}},\"id\":1}\n```",
        "created_at": "2023-07-03T08:29:18.693000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "^ ran on bootnode",
        "created_at": "2023-07-03T08:29:23.298000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "submitted a tx via other means and its showing up in the mempool as expected + was included in a block",
        "created_at": "2023-07-03T08:30:34.459000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "i.e, this: https://explorer.4844-devnet-7.ethpandaops.io/tx/0x2db6b469db60f795d8120b59b97041637c8486cde9a4fc0c81abd9a9305b25c6",
        "created_at": "2023-07-03T08:30:58.659000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "```\nDEBUG[07-03|10:30:17.887] Transaction broadcast                    txs=1 \"announce packs\"=3 \"announced hashes\"=3 \"tx packs\"=0 \"broadcast txs\"=0\nTRACE[07-03|10:30:17.888] Sent transaction announcements           id=1e989ab974bcdbb1 conn=staticdial      count=1\nTRACE[07-03|10:30:17.888] Sent transaction announcements           id=1ac4b6a867499906 conn=staticdial      count=1\nTRACE[07-03|10:30:17.888] Sent transaction announcements           id=e22c470a609cf361 conn=staticdial      count=1\n```",
        "created_at": "2023-07-03T08:32:22.993000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Seems like we announce them correctly though",
        "created_at": "2023-07-03T08:32:33.323000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "gave you ssh access: `206.189.105.76`",
        "created_at": "2023-07-03T08:33:56.417000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Thats from ethereumjs",
        "created_at": "2023-07-03T08:34:00.007000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "(could be us failing the decoding)",
        "created_at": "2023-07-03T08:34:13.136000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "the bootnode is nethermind tho :/",
        "created_at": "2023-07-03T08:35:01.323000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "so why is ethereumjs involved if the tx isn't making it to your one peer (bootnode)",
        "created_at": "2023-07-03T08:35:18.073000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I added more peers",
        "created_at": "2023-07-03T08:35:25.263000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "ah",
        "created_at": "2023-07-03T08:35:29.226000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Could you send some more transactions? \u003c@199561711278227457\u003e",
        "created_at": "2023-07-03T08:41:01.401000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "with the old tx-fuzz or with other tools?",
        "created_at": "2023-07-03T08:41:18.303000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "blob txs",
        "created_at": "2023-07-03T08:41:48.565000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "sent like 3",
        "created_at": "2023-07-03T08:41:48.935000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "ahhh, sending that now",
        "created_at": "2023-07-03T08:41:55.030000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "hmmm \u003c@277500722655002624\u003e its all failing with `2023-07-03 08-45-11.0991|{\"jsonrpc\":\"2.0\",\"error\":{\"code\":-32010,\"message\":\"FeeTooLowToCompete\"},\"id\":67}` now",
        "created_at": "2023-07-03T08:45:34.884000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "```\ndocker run ghcr.io/flcl42/send-blobs:latest https://rpc.4844-devnet-7.ethpandaops.io 10 0xprivkey  0x000000000000000000000000000000000000f1c1\n```",
        "created_at": "2023-07-03T08:45:51.794000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Yep, seems I found the reason, fixing it. New version soon!",
        "created_at": "2023-07-03T08:46:21.526000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I'm only ever getting this error from EthereumJS, so it looks like they are sending the txs in a weird format",
        "created_at": "2023-07-03T08:46:50.312000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "^Is it one of the hive failures? https://hivecancun.ethdevops.io/suite.html?suiteid=1688362151-2630d542aab5e05f334d1bd4317b3971.json\u0026suitename=engine-blobs",
        "created_at": "2023-07-03T08:48:15.051000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Yeah probably, the multiple clients test, tests transaction propagation",
        "created_at": "2023-07-03T08:50:40.247000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "(but it fails even before tx propagation is verified, so idk)",
        "created_at": "2023-07-03T08:51:15.799000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Got it, so ethereumJS could get kicked out if it can't verify it right? assuming everyone else can and includes it in a block",
        "created_at": "2023-07-03T08:51:59.765000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "we pass all hive tests (not the master commit, but a few commits down, master commit has some issue starting from the cancun genesis which is being resolved)",
        "created_at": "2023-07-03T08:53:27.553000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Let me dump the tx",
        "created_at": "2023-07-03T08:54:01.339000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "we're on commit `6b8d9f4e3032d9bd04e8fafe020887f4aef29ccb` tho",
        "created_at": "2023-07-03T08:54:01.587000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "so this is a response to tx by hash fetch?",
        "created_at": "2023-07-03T08:54:08.345000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Yes",
        "created_at": "2023-07-03T08:54:15.935000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "probaly just dump the buffer in the file? i can try to debug it",
        "created_at": "2023-07-03T08:54:51.778000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "we should be able to verify right (the ones included in the block) even if by some mistake we are not sending correct serialized tx on the eth protocol",
        "created_at": "2023-07-03T08:56:00.075000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "so we shouldn't get kicked out, if everyone else accepts the tx",
        "created_at": "2023-07-03T08:56:17.970000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "üëç",
        "created_at": "2023-07-03T08:57:00.609000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "so if i understand the scenario: ethereumjs is trying to pull tx from geth or the other way around",
        "created_at": "2023-07-03T08:58:15.387000+00:00",
        "attachments": null
    },
    {
        "author": "terence0083",
        "category": "Testing",
        "parent": "",
        "content": "Prysm may fork off if we spam bad blobs. Please keep us in the loop cc \u003c@755590043632140352\u003e üôÇ",
        "created_at": "2023-07-03T08:58:24.079000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "If we're a minority I think it's fine",
        "created_at": "2023-07-03T08:59:04.951000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "We'll reorg, but if people are going to send invalid proofs I'll push the validation to the devnet branch today",
        "created_at": "2023-07-03T08:59:38.866000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Okay no the issue is on our side, seeing the same issue on a different node with other peers as well",
        "created_at": "2023-07-03T09:04:20.331000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "superb! glad ethereumjs can be of the service to the big guy here (sort of our new mission lol üòÜ)",
        "created_at": "2023-07-03T09:05:04.503000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "\u003e DEBUG[07-03|11:06:10.394] Message handling failed in `eth`         id=1ac4b6a867499906 conn=staticdial err=\"invalid message code: 8\"",
        "created_at": "2023-07-03T09:07:19.917000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "yes this commit is devnet7 compatible",
        "created_at": "2023-07-03T09:07:21.866000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "I'm seeing this on nimbus-geth, in the geth logs. What's confusing is that I don't see it on other geth nodes. \n\n```\nDEBUG[07-03|09:06:04.683] Message handling failed in `eth`         id=e886365aa67a0db8 conn=dyndial          err=\"invalid message: message msg #10 (787396 bytes): invalid message: (code a) (size 787396) rlp: expected input string or byte for *uint256.Int, decoding into (eth.PooledTransactionsPacket66).PooledTransactionsPacket[0](types.Transaction)(types.BlobTx).ChainID\"\n```",
        "created_at": "2023-07-03T09:08:19.560000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "It could be that this is the first geth peer and it rejects it, but by that logic the sending node should have sent it to other peers too",
        "created_at": "2023-07-03T09:08:39.525000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "unrelated possibly, but nimbus was lagging for a bit and is now catching up",
        "created_at": "2023-07-03T09:09:06.375000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "and `b2df1473b8e3fbf9315236d1099bde516a3d002b` passes the hive tests (but this also has the selfdestruct EIP 6780, but on other 4844 features its essentially same the the commit the image is based off on, just few fixes to run hive tests)",
        "created_at": "2023-07-03T09:09:25.605000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "if i take a wild guess, is the encoding of new fields is 256 by geth's expectation?",
        "created_at": "2023-07-03T09:10:44.142000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "ahh i don't know the root cause, but i can see why nimbus is lagging:\n```\nDEBUG[07-03|09:18:36.059] Fetching batch of transactions           id=0d9de040a6560389 conn=dyndial          count=1\nDEBUG[07-03|09:18:36.070] Message handling failed in `eth`         id=0d9de040a6560389 conn=dyndial          err=\"invalid message: message msg #10 (393774 bytes): invalid message: (code a) (size 393774) rlp: expected input string or byte for *uint256.Int, decoding into (eth.PooledTransactionsPacket66).PooledTransactionsPacket[0](types.Transaction)(types.BlobTx).ChainID\"\nDEBUG[07-03|09:18:36.070] Removing Ethereum peer                   peer=0d9de040 snap=false\n```\n\nnode peers with another, tries to fetch, fails since its invalid, disconnects peer and tries with another. keeps repeating in a loop i guess.",
        "created_at": "2023-07-03T09:20:03.502000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "but doesn't make sense that this one node has this problem",
        "created_at": "2023-07-03T09:20:17.972000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "also doesn't explain why nethermind-nimbus lags",
        "created_at": "2023-07-03T09:20:56.519000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "same issue i guess:\n```\nInMempoolForm trace    at Nethermind.Serialization.Rlp.TxDecoder`1.EncodeTx(RlpStream stream, T item, RlpBehaviors rlpBehaviors, Boolean forSigning, Boolean isEip155Enabled, UInt64 chainId)\n```",
        "created_at": "2023-07-03T09:21:19.497000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "kinda confused why every node isn't failing :/",
        "created_at": "2023-07-03T09:21:33.505000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "what did nimbus do specifically to trigger this in both geth/nethermind?",
        "created_at": "2023-07-03T09:21:53.535000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "Nimbus doesn't touch RLP (sort of, except if `--no-el` or a similar mode is used)",
        "created_at": "2023-07-03T09:22:53.637000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "yea, that'd what i'd expect as well",
        "created_at": "2023-07-03T09:23:03.294000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "the fcu nimbus sends should be ~same as what everyone else is doing",
        "created_at": "2023-07-03T09:23:12.672000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "FCUs also don't contain any RLP",
        "created_at": "2023-07-03T09:23:23.389000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "it should be a EL side issue, which is why its more confusing why it just happens on the 2 nimbus nodes :/",
        "created_at": "2023-07-03T09:23:32.694000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "are those messages from devp2p gossip, or are those inputs somehow from Nimbus?",
        "created_at": "2023-07-03T09:24:33.550000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "I would assume its devp2p from the logs atleast",
        "created_at": "2023-07-03T09:24:58.874000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "`Message handling failed in eth id=0d9de040a6560389 conn=dyndial          err...`",
        "created_at": "2023-07-03T09:25:10.760000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "it's odd because if Nimbus were screwing up the `newPayload` transfer, then it should be hitting other errors first (`INVALID_BLOCK` / `INVALID_BLOCK_HASH`, etc)",
        "created_at": "2023-07-03T09:25:23.780000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "Yeah, not that familiar with those logs in that level of detail, but looks like that to me",
        "created_at": "2023-07-03T09:25:50.440000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Yeah and if it was a newPayload issue the node should forever be stuck on the same head, but it is moving forward (just slowly)",
        "created_at": "2023-07-03T09:26:29.530000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "sure, e.g., if it were some endianness issue",
        "created_at": "2023-07-03T09:26:44.557000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "hmm, i guess there's no easy way to do that without some geth console access?",
        "created_at": "2023-07-03T09:48:47.238000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "seeing some of these, shouldn't be happening either afaik:\n```\nDEBUG[07-03|09:49:12.127] Ethereum peer connected                  id=04b2fbf466631ed7 conn=dyndial          name=Nethermind/v1.20.0-u...\nDEBUG[07-03|09:49:12.628] Fetching batch of transactions           id=04b2fbf466631ed7 conn=dyndial          count=20\nDEBUG[07-03|09:49:12.879] Message handling failed in `eth`         id=04b2fbf466631ed7 conn=dyndial          err=\"message too long: 15091575 \u003e 10485760\"\nDEBUG[07-03|09:49:12.879] Removing Ethereum peer                   peer=04b2fbf4 snap=false\nDEBUG[07-03|09:49:17.296] Ethereum handshake failed                id=a15d7f257651f59c conn=dyndial          err=EOF\nDEBUG[07-03|09:49:19.315] Ethereum handshake failed                id=0d36afe3be972980 conn=dyndial          err=EOF\nINFO [07-03|09:49:24.079] Imported new potential chain segment     number=20939 hash=9cd932..c8462b blocks=1   txs=0  mgas=0.000 elapsed=\"159.505¬µs\" mgasps=0.000  dirty=86.14KiB\n```",
        "created_at": "2023-07-03T09:50:04.559000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "geth is peered to nethermind here, atleast according to the ID\ngeth complaining about message too long would imply nethermind is sending a longer than expected message. Is the length not standard/not checked \u003c@277500722655002624\u003e ?",
        "created_at": "2023-07-03T09:50:50.206000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "It may mean we send like 18 transactions 6 blobs each",
        "created_at": "2023-07-03T09:53:11.474000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "But these transactions should be sent by request only",
        "created_at": "2023-07-03T09:54:21.831000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "def weird, will wait for marius to explain that then",
        "created_at": "2023-07-03T09:54:56.657000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@334704997122179072\u003e, need your opinion",
        "created_at": "2023-07-03T09:55:12.174000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "We probably request transactions without a limit atm",
        "created_at": "2023-07-03T10:04:24.190000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "but then it fails at a downstream validation step?",
        "created_at": "2023-07-03T10:05:02.156000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "yep",
        "created_at": "2023-07-03T10:09:17.504000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I've almost fixed the tx propagation issue",
        "created_at": "2023-07-03T10:09:39.259000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "thanks!",
        "created_at": "2023-07-03T10:11:32.664000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "wouldn't it be a dos vector if i can accept requests from peers wtihout a limit? i.e, couldn't nethermind be dossed if i request really large transaction counts",
        "created_at": "2023-07-03T10:12:21.207000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Testing",
        "parent": "",
        "content": "We don't have 6780 enabled right?",
        "created_at": "2023-07-03T10:16:22.729000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Can someone double check that this is a valid PooledTransactionETH66Packet",
        "created_at": "2023-07-03T11:10:45.534000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2023-07-03T11:10:48.101000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "message.txt",
                "content": "73b19509bbfed7fd8f5bae025480b11959dcf978613d8fa71349ecc1b323fc3d"
            }
        ]
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Somehow our rlp decoding is beyond f'd",
        "created_at": "2023-07-03T11:11:13.521000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "like this?\nhttps://gist.github.com/miguelmota/9099b705cf433336036065ab748c8404",
        "created_at": "2023-07-03T11:11:59.230000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "is this connected to Nimbus in any way, or?",
        "created_at": "2023-07-03T11:17:56.502000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "no",
        "created_at": "2023-07-03T11:21:25.770000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Decodes ok, 1 tx x 6 blobs there",
        "created_at": "2023-07-03T11:38:42.916000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Could you decode this as well?",
        "created_at": "2023-07-03T11:42:26.036000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2023-07-03T11:42:54.660000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "message.txt",
                "content": "30927dd89e43df59e8b6d563a8f179f62db4094a9494417b7f7cbf468ca217e7"
            }
        ]
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Error, seems like RLP list was expected, but got RLP  string",
        "created_at": "2023-07-03T11:43:53.057000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Yep okay my whole encoding and decoding is fucked",
        "created_at": "2023-07-03T11:44:18.234000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "it works with itself",
        "created_at": "2023-07-03T11:44:22.715000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "but not with other clients",
        "created_at": "2023-07-03T11:44:28.136000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Could you point me to your decoding/encoding for blob txs network packets?",
        "created_at": "2023-07-03T11:44:59.336000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "isn't that a hive check though?",
        "created_at": "2023-07-03T11:48:02.166000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "It's so weird",
        "created_at": "2023-07-03T11:50:02.125000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "We decode the transactions we get via rpc correctly, but the network ones not",
        "created_at": "2023-07-03T11:50:34.389000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Even though they use the same format",
        "created_at": "2023-07-03T11:51:01.829000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Yep, but it's distributed across some files:\nget request id https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Network/P2P/Subprotocols/Eth/V66/Messages/Eth66MessageSerializer.cs#L26\nthen \nhttps://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Network/P2P/Subprotocols/Eth/V62/Messages/TransactionsMessageSerializer.cs#L47\n(which means txs are in InMempoolForm and wrapped in rlp)",
        "created_at": "2023-07-03T11:51:22.174000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "is there some reason why nethermind then has that error message with decoding?\n```\nInMempoolForm trace    at Nethermind.Serialization.Rlp.TxDecoder`1.EncodeTx(RlpStream stream, T item, RlpBehaviors rlpBehaviors, Boolean forSigning, Boolean isEip155Enabled, UInt64 chainId)\n```",
        "created_at": "2023-07-03T12:04:02.439000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "ahh yes, correct",
        "created_at": "2023-07-03T12:13:27.354000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "It's just a stack trace log",
        "created_at": "2023-07-03T12:13:52.171000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "ahh, similar to the blob one then",
        "created_at": "2023-07-03T12:14:04.090000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Wanted to log every place of mempool form of transaction usage*",
        "created_at": "2023-07-03T12:14:05.122000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "still missing an explanation as to why nimbus-nethermind is lagging in that case. with geth its clear-ish, assuming its related to the RLP issue.",
        "created_at": "2023-07-03T12:19:40.494000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Let me check that pair, my first and totally unproven guess is that those are CL's p2p troubles on a small network",
        "created_at": "2023-07-03T12:22:46.812000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2023-07-03T12:29:27.180000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "eb23ed4dfd2814af72d05e1a4ed36a520ef3a3fd8b3ae9c7efdd98b6b7c8feb3"
            }
        ]
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Left side has tx's rlp as rlp string\nRight side has tx's rlp raw\nRaw rlp is for eth_sendrawtransaction only as far as I remember",
        "created_at": "2023-07-03T12:30:00.460000+00:00",
        "attachments": null
    },
    {
        "author": "marcinds",
        "category": "Testing",
        "parent": "",
        "content": "We have a limit on sending requested transactions (sending PooledTransactionsMessage). MaxPacketSize is 102400. The only exception is when single tx is larger - then we are sending 1 tx even if limit is exceeded https://github.com/NethermindEth/nethermind/blob/master/src/Nethermind/Nethermind.Network/P2P/Subprotocols/Eth/V65/Eth65ProtocolHandler.cs#L133-L154",
        "created_at": "2023-07-03T12:30:38.073000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "But it says 15091575 which is 19 time more than max 6 blob tx",
        "created_at": "2023-07-03T12:32:58.853000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "it could be 1 really big blob right? but even then, its more than `102400`",
        "created_at": "2023-07-03T12:33:34.881000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Any blob tx is more than 102400 ü§î",
        "created_at": "2023-07-03T12:34:38.654000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "But less then 15091575 for sure",
        "created_at": "2023-07-03T12:34:47.418000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "why are they both different? is left client A and right client B or are they just different blobs?",
        "created_at": "2023-07-03T12:44:12.788000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Clients A and B have different encoding for tx pool messages",
        "created_at": "2023-07-03T12:46:46.633000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@360491619402776577\u003e seen this already?",
        "created_at": "2023-07-03T12:47:37.280000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I know",
        "created_at": "2023-07-03T12:48:12.303000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Why is the transaction type not part of the network message? (according to spec)",
        "created_at": "2023-07-03T13:05:01.028000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "\u003e tx_payload_body - is the TransactionPayloadBody of standard EIP-2718 blob transaction\n\n\u003e TransactionPayloadBody:\n\u003e \n\u003e [chain_id, nonce, max_priority_fee_per_gas, max_fee_per_gas, gas_limit, to, value, data, access_list, max_fee_per_data_gas, blob_versioned_hashes, y_parity, r, s]",
        "created_at": "2023-07-03T13:05:54.580000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "But I guess you're also not doing that \u003c@277500722655002624\u003e ?",
        "created_at": "2023-07-03T13:19:11.721000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Which part? Wrap tx as RLP string? Should be wrapped by nethermind too",
        "created_at": "2023-07-03T13:20:15.674000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "not put the tx type?",
        "created_at": "2023-07-03T13:21:56.443000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Yep, it's always before transaction in any form, but not in its rlp",
        "created_at": "2023-07-03T13:26:58.955000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Still don't get it, could you maybe provide an easy struct to explain?",
        "created_at": "2023-07-03T13:31:04.863000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "is this known already? seen from Nethermind logs:\n```\n03 Jul 14:14:08 | Error in communication with [Node|5.9.25.111:4465|eth66|Geth/v1.11.0-unstable-2a2b0419-20230125/linux-amd64/go1.19.5]: System.IO.InvalidDataException: Input is not a valid snappy-compressed block\n   at Snappy.SnappyCodec.Uncompress(Byte[] input, Int32 offset, Int32 length, Byte[] output, Int32 outOffset)\n   at Nethermind.Network.P2P.ProtocolHandlers.ZeroNettyP2PHandler.ChannelRead0(IChannelHandlerContext ctx, ZeroPacket input) in /src/Nethermind/Nethermind.Network/P2P/ProtocolHandlers/ZeroNettyP2PHandler.cs:line 100\n   at DotNetty.Transport.Channels.SimpleChannelInboundHandler`1.ChannelRead(IChannelHandlerContext ctx, Object msg)\n   at DotNetty.Transport.Channels.AbstractChannelHandlerContext.InvokeChannelRead(Object msg)\n```",
        "created_at": "2023-07-03T14:14:40.948000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Yep, so we have transaction in two forms: execution-payload \n`BLOB_TX_TYPE || rlp([chain_id, nonce, ...])`\nand mempool\n`BLOB_TX_TYPE || rlp([[chain_id, nonce, ...], [0xb10b...], [0xc0mmitment...], [0xpr00f...]])`",
        "created_at": "2023-07-03T14:30:37.639000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I really don't understand what I'm doing wrong",
        "created_at": "2023-07-03T14:34:41.430000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Oh wait",
        "created_at": "2023-07-03T14:34:55.309000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "And this encoding can be used as raw transaction as is in `eth_sendRawTransaction` or `engine_newPayloadV3`, `engine_getPayloadV3`. Or become a part of some p2p message, where it is additionally fully encoded as rlp string.",
        "created_at": "2023-07-03T14:35:41.185000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Nah I'm doing exactly the same thing",
        "created_at": "2023-07-03T14:38:31.633000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "but the encoding just doesn't match",
        "created_at": "2023-07-03T14:39:01.186000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Okay now only a single character difference..",
        "created_at": "2023-07-03T14:49:08.019000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Any wizard able to figure this out?",
        "created_at": "2023-07-03T14:50:07.667000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "Screenshot_2023-07-03_16-49-50.png",
                "content": "f2a1c1e8f5f30f6374f923b6a5912f929bb61d130f9238933f61c178bef8a4e7"
            }
        ]
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "can't it be an RLP encoder messing String and List?",
        "created_at": "2023-07-03T14:55:17.682000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Could be",
        "created_at": "2023-07-03T15:00:25.684000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "Probably not an encoder bug but a wrong encoder has been called encoding list as a string or vice versa",
        "created_at": "2023-07-03T15:23:50.845000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Testing",
        "parent": "",
        "content": "Internal wrapper prefix length is not considered",
        "created_at": "2023-07-03T15:25:58.324000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Testing",
        "parent": "",
        "content": "Upon a glance this looks correct to me, left is list, right is string",
        "created_at": "2023-07-03T15:31:48.393000+00:00",
        "attachments": null
    }
]
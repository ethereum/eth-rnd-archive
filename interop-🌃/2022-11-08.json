[
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "Getting back to this. What is the current EL's behaviour if say `transactions` is `null`?",
        "created_at": "2022-11-08T04:59:06.404000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@792822129019584562\u003e \u003c@755590043632140352\u003e Do you guys have a docker image for your branches for the testnet?",
        "created_at": "2022-11-08T09:19:29.129000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@758579010027782144\u003e and I just noticed that the EL test vectors have another tiny bug. (I think \u003c@792822129019584562\u003e already told me about it, but I forgot)\nThe genesis hash for the tests is wrong as with shanghai-time = 0 (shanghai-time \u003e= genesis.timestamp), the genesis should have the withdrawal hash set",
        "created_at": "2022-11-08T09:51:48.841000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Testing",
        "parent": "",
        "content": "yes, Nethermind's adding WithdrawalsRoot to genesis hash and we couldn't get the same block hash in test vectors",
        "created_at": "2022-11-08T09:53:36.902000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I have to fix the rpc api before I can update the test vectors :/",
        "created_at": "2022-11-08T09:56:59.245000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "But I'll do that soon ‚Ñ¢Ô∏è",
        "created_at": "2022-11-08T09:57:10.772000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Nvm I wrote a really ugly hack, will update now",
        "created_at": "2022-11-08T09:58:18.180000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Updated",
        "created_at": "2022-11-08T10:01:42.553000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Nope, and I think I don't have permission  to upload those.  You'll have to wait until \u003c@363800010518822915\u003e wakes up. Or perhaps \u003c@816572064995082280\u003e is up. But you'll need also prysmctl from that branch",
        "created_at": "2022-11-08T10:12:46.724000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "We're currently trying to build them locally",
        "created_at": "2022-11-08T10:13:20.511000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Based off of https://github.com/prysmaticlabs/prysm/blob/capella/interop.Dockerfile, still debugging some stuff there",
        "created_at": "2022-11-08T10:14:01.984000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "With Marius we decided to try to have the first multi client testnet launch on 1668078000 (10th of Nov, Thursday at 11:00 GMT). Hopefully we gonna be able to have geth-lodestar, geth-prysm, nethermind-lodestar, nethermind-prysm participate in this.",
        "created_at": "2022-11-08T10:27:58.579000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "i can do this",
        "created_at": "2022-11-08T10:30:12.290000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "can you please give me a dockerfile/docker image that we could use?",
        "created_at": "2022-11-08T10:30:44.241000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "you guys just need our beacon node and validator, correct ?",
        "created_at": "2022-11-08T10:31:55.880000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "I can get started in a few mins",
        "created_at": "2022-11-08T10:32:05.388000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@412614104222531604\u003e will you be generating genesis?",
        "created_at": "2022-11-08T10:36:20.068000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "If you don't have the tooling to generate validators with ETH1 withdrawal addresses, you'll need to use also prysmctl from that branch",
        "created_at": "2022-11-08T10:37:28.967000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "yup",
        "created_at": "2022-11-08T10:37:56.775000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "yes, we would like to have both.",
        "created_at": "2022-11-08T10:38:15.140000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "https://github.com/ethpandaops/withdrawals-testnet/tree/withdrawals/withdrawals-testnet/custom_config_data genesis should be here.",
        "created_at": "2022-11-08T10:38:55.981000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "ah nice, those are all ETH1 validators?",
        "created_at": "2022-11-08T10:40:02.912000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "yes",
        "created_at": "2022-11-08T10:40:07.723000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "100 for each combo",
        "created_at": "2022-11-08T10:40:17.492000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "```\ngcr.io/prysmaticlabs/prysm/beacon-chain:capella\ngcr.io/prysmaticlabs/prysm/validator:capella\n```\n\u003c@412614104222531604\u003e",
        "created_at": "2022-11-08T10:40:34.300000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "thx",
        "created_at": "2022-11-08T10:40:39.825000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "let me build one for you",
        "created_at": "2022-11-08T11:08:00.615000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "The genesis file I generated probably will not work just yet. Have to include the Shanghai fork in it too.",
        "created_at": "2022-11-08T13:05:18.286000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@412614104222531604\u003e you'll have trouble if you don't deploy the contract. \u003c@758579010027782144\u003e is the one that made me notice it. \u003c@476250636548308992\u003e if you're up perhaps you can produce images for them? And do we have the patch somewhere to avoid checking for the contract? I should add this to the capella branch directly",
        "created_at": "2022-11-08T13:06:18.358000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "the shanghai fork is not trivial: you need to set the CL genesis time first, then compute when the CL will fork to shanghai and that's the timestamp that you need to pass to the EL",
        "created_at": "2022-11-08T13:07:10.081000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "I saw you guys set the shanghai to cl genesis +144",
        "created_at": "2022-11-08T13:09:43.155000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Where does 144 comes from?",
        "created_at": "2022-11-08T13:09:48.742000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "why do we need the contract ?",
        "created_at": "2022-11-08T13:10:20.848000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "we aren't adding new deposits in",
        "created_at": "2022-11-08T13:10:29.373000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "but prysm fails if we don't see the contract deployed",
        "created_at": "2022-11-08T13:10:48.775000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "how was it working before then ?",
        "created_at": "2022-11-08T13:11:05.054000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "for all these devnets we add a hack that's somewhere stashed",
        "created_at": "2022-11-08T13:11:05.692000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "in the interop I'm running we do have a deployed contract",
        "created_at": "2022-11-08T13:11:19.771000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "ok, I see",
        "created_at": "2022-11-08T13:11:27.900000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "There's some branch in prysm with these stashed changes, we apply them for Pari every single time",
        "created_at": "2022-11-08T13:11:50.418000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Would be good to disable it for that this test branch if possible",
        "created_at": "2022-11-08T13:11:53.014000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Yeah every time we forget to do it and then Pari needs to request new docker images",
        "created_at": "2022-11-08T13:12:10.696000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "perhaps we should directly add these changes to our `capella` branch \u003c@476250636548308992\u003e and let it sit there anyway, we'll be cherry picking to develop anyway",
        "created_at": "2022-11-08T13:12:45.610000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "Cross-posting from \u003c#804019759934078987\u003e:\nI have gathered all ideas that were brought up during the Engine API session at the R\u0026D workshop and put them into a proposal. It would be great to get everyone's opinion on it before we move on https://github.com/ethereum/execution-apis/issues/321",
        "created_at": "2022-11-08T13:41:30.140000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "Would be great if disabling the contract check can be a feature flag and pushed to master, we could reuse it on all the upcoming testnets irrespective of if its 4844 or withdrawals related üòÖ",
        "created_at": "2022-11-08T14:43:09.499000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Yeah it's already there, I myself may have added that and forgot about it",
        "created_at": "2022-11-08T14:46:03.405000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@755590043632140352\u003e is this what you meant? ```time=\"2022-11-08 14:56:03\" level=debug msg=\"Starting DB\" prefix=node\ntime=\"2022-11-08 14:56:03\" level=info msg=\"Checking DB\" database-path=\"/beacondata/beaconchaindata\" prefix=node\ntime=\"2022-11-08 14:56:03\" level=info msg=\"Opening Bolt DB at /beacondata/beaconchaindata/beaconchain.db\" prefix=db\ntime=\"2022-11-08 14:56:03\" level=error msg=\"could not load genesis from file: loaded genesis fork version (0x30000039) does not match config genesis fork version (0x10000039)\" prefix=main```",
        "created_at": "2022-11-08T14:56:48.087000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "No that's a config mismatch",
        "created_at": "2022-11-08T14:57:21.575000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "can we get a merged genesis support from the prysm team? e.g have GENESIS and BELLATRIX at epoch 0?",
        "created_at": "2022-11-08T17:56:24.539000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "The main reason for this is that the capella fork is triggered at a timestamp. If we have to go through altair/bellatrix and time TTD, it gets hard to time capella as well. We'd definitely have to use a clique chain - but we just got around to deprecating all of that tooling in favour of merged genesis, so we don't have to bother with the TTD timing issues again.",
        "created_at": "2022-11-08T18:04:08.900000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Hi all, is there consensus on what should happen when the execution client receives a payload where the withdrawals break the monotonically increasing index rule ?\n\nIt seems to me like there should be no verification on the EL-side whatsoever, because that would mean the EL needs to save the last index somewhere, but just wanted to confirm in order to have that in mind while writing the test vectors...",
        "created_at": "2022-11-08T18:16:58.429000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e yeah, interesting question mario\n\nThe spec does say:\n\u003e a monotonically increasing index, starting from 0, as a uint64 value that increments by 1 per withdrawal to uniquely identify each withdrawal\n\nThe fact that it is in the EL spec kind of implies that it would be a validity condition (rather than just saying, \"there is an index\")\n\nIt was written there to be informative rather than normative. And adding additional verificaiton logic and overhead in EL does not buy us anything other than complexity (as I see it currently)",
        "created_at": "2022-11-08T18:35:04.953000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e I would be in favor of turning that bullet point into \"a `uint64` index identifying the withdrawal\"",
        "created_at": "2022-11-08T18:35:36.148000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e cc: \u003c@539495253418180618\u003e",
        "created_at": "2022-11-08T18:35:42.153000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Testing",
        "parent": "",
        "content": "i think the EIP is pretty clear about what is and is not a validity condition for the EL",
        "created_at": "2022-11-08T18:53:23.416000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Testing",
        "parent": "",
        "content": "im happy to be less precise if this point is confusing in the EIP but the intent was to provide as much information as possible, as clients have more optionality around optimized storage/retrieval of withdrawal data if they know there is extra structure here around the index",
        "created_at": "2022-11-08T18:54:42.792000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "I did not interpret this as an EL validity condition fwiw",
        "created_at": "2022-11-08T19:40:05.535000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "so it sounds like we should be storing the last valid withdrawal index and verify each withdrawal in monotonically increasing?",
        "created_at": "2022-11-08T19:41:07.545000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "This may not happen soon enough for this \u003c@833706406699073536\u003e",
        "created_at": "2022-11-08T20:49:41.877000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Why is hard? Capella is deterministic. I'm forking perfectly fine in my interop",
        "created_at": "2022-11-08T20:50:34.323000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Why would you do it if we're enforcing it and there's a trust assumption anyway",
        "created_at": "2022-11-08T20:52:09.900000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@199561711278227457\u003e coming back to timing: just set TTD to zero. Bellatrix is on an epoch and capella on another one. There's no room for timing issues",
        "created_at": "2022-11-08T20:53:14.766000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "Yeah, that was my original thought and the reason I have not implemented this check, but I was trying to confirm if \u003c@539495253418180618\u003e' intention was for ELs to verify",
        "created_at": "2022-11-08T20:58:23.254000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "If you guys enforce it then I'll move to remove that index from the beacon state üôÇ",
        "created_at": "2022-11-08T21:05:52.231000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e I'm saying don't enforce on EL. and if the fact that that statement is under \"specification\" in the EIP implies otherwise, we should edit it",
        "created_at": "2022-11-08T21:08:38.121000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cdannyryan\u003e and we should have an EL test with scrambled withdrawal indices and duplicates and EL should be fine with it",
        "created_at": "2022-11-08T21:09:11.079000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Haha hope you're saying under reorgs... Like forcing El clients to not enforce something is murky",
        "created_at": "2022-11-08T21:11:12.574000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Testing",
        "parent": "",
        "content": "\u003cralexstokes\u003e the idea is to write tests that enforce the spec, and the spec says (or implies if it‚Äôs not clear rn) that the CL verifies all of the data coming from the engine API to the EL, the EL just blindly applies them to the world state",
        "created_at": "2022-11-08T22:56:35.638000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I don't really mean to be getting into a flame over the same kinds of things as before. But I find wrong enforcing behavior that is not strictly necessary. If the EL dev wants to check that the withdrawal amount corresponds to the amount in the beaconstate Balance, and somehow they have access to the right information, the spec should not forbid them from doing this check. The spec can allow them to not do it, but not forbid them to do it unless there's a clear reason to. To me testing that the EL does not check for something under a malformed input is equivalent to the issue we already had on justification bits",
        "created_at": "2022-11-08T23:00:01.286000+00:00",
        "attachments": null
    }
]
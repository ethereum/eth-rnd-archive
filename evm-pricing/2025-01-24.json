[
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cjacekglen\u003e Hi All! I have updated the Gas Cost Estimator project, you can see it here: https://github.com/imapp-pl/gas-cost-estimator\nI guess most of you would be interested in seeing our proposal, head straight to https://github.com/imapp-pl/gas-cost-estimator/blob/master/docs/gas-schedule-proposal.md#radical-gas-schedule-proposal\n\nPlease review and any feedback is welcome!",
        "created_at": "2025-01-24T11:18:58.437000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cben_a_adams\u003e Is decreasing Tx being considered? Is 21000 gas the right amount?",
        "created_at": "2025-01-24T13:47:34.983000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cjacekglen\u003e I am very much in favour of drastically reducing Tx gas cost. But what is the correct value? What kind of analysis can we use to figure it out?",
        "created_at": "2025-01-24T14:50:03.188000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003craxhvl\u003e What is the origin of 21000? (re @jacekglen: I am very much in favour of drastically reducing Tx gas cost. But what is the correct value? What kind of analysis can we use to figure it out?)",
        "created_at": "2025-01-24T15:47:43.562000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003craxhvl\u003e Related: https://ethereum-magicians.org/t/some-medium-term-dust-cleanup-ideas/6287 (re @jacekglen: I am very much in favour of drastically reducing Tx gas cost. But what is the correct value? What kind of analysis can we use to figure it out?)",
        "created_at": "2025-01-24T15:49:55.346000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "it's a rough calculation of the costs that go into initiating the tx:\n\n3000 ECDSA recover\n5000 * 2 state updates\n2600 * 2 warming accounts\nrest, p2p costs and some computation around the tx",
        "created_at": "2025-01-24T16:21:27.590000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cben_a_adams\u003e ü§î why 2*state updates? Is only if sending eth to To? (re @evm_pricing_bot: \u003clightclient\u003e [reply]: it's a rough calculation of the costs that go into initiating the tx:\n\n3000 ECDSA recover\n5000 * 2 state updates\n2600 * 2 warming accounts\nrest, p2p costs and some computation around the tx)",
        "created_at": "2025-01-24T16:23:03.436000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003craxhvl\u003e Think state update for the sender and recipient. Sender.balance-= value. Recipient.balance+=value. (re @ben_a_adams: ü§î why 2*state updates? Is only if sending eth to To?)",
        "created_at": "2025-01-24T16:24:38.490000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cshemnon\u003e Writing the new updated account nodes to the trie.  2600 just covers the read.",
        "created_at": "2025-01-24T16:25:29.569000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cben_a_adams\u003e Could argue that From/To addresses shouldn't be more expensive than access list address; though that would only save 200 which isn't much üòÖ",
        "created_at": "2025-01-24T16:38:07.188000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cchfast\u003e If you we are at this, it would be nice to express costs of complex operations as a sum of basic ones. As in this base transaction cost example.",
        "created_at": "2025-01-24T16:43:31.396000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cben_a_adams\u003e 3000 ECDSA recover\n2400 * 2 accesslistaddress\n4500 account update (nonce+balance = callvalue/2)\n‚Äî-\n9900; round to 10000 for tx additionals\n\n4500 if value transfer (callvalue/2, as first half already included)\nExtra if account create as normal \n‚Äî-\n14500\n\nMaybe 10k and 14.5k where Eth sent? (re @evm_pricing_bot: \u003clightclient\u003e [reply]: it's a rough calculation of the costs that go into initiating the tx:\n\n3000 ECDSA recover\n5000 * 2 state updates\n2600 * 2 warming accounts\nrest, p2p costs and some computation around the tx)",
        "created_at": "2025-01-24T17:11:23.041000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cfradamt\u003e There should be another few 1000s for the p2p load, no? E.g. charging at 7623 price per byte, the non-calldata part of a tx would cost about 4000 gas? (~100 bytes or something)",
        "created_at": "2025-01-24T17:12:58.258000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cben_a_adams\u003e probably should ignore it. Get p2p'd with 10s of thousands of tx each block and see txs again and again (if low fee); not charging them by how many times they circle around the mempool? Or giving private orderflow a discount because they don't p2p (re @fradamt: There should be another few 1000s for the p2p load, no? E.g. charging at 7623 price per byte, the non-calldata part of a tx would cost about 4000 gas? (~100 bytes or something))",
        "created_at": "2025-01-24T17:17:33.446000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cfradamt\u003e A tx in the mempool is different that a tx onchain, that we are going to have consensus over, that it's going to be sent out in a block, that we are always going to have in the chain's history",
        "created_at": "2025-01-24T17:26:56.509000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cfradamt\u003e why should the non-calldata bytes be treated differently than calldata bytes?",
        "created_at": "2025-01-24T17:27:10.137000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cfradamt\u003e You also verify a bunch of signatures in the mempool. Doesn't mean we should drop the signature verification cost from txs that end up onchain",
        "created_at": "2025-01-24T17:28:53.653000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cben_a_adams\u003e Do the whole tx as calldata cost? \n\nEIP-7623:\n 4 gas per byte if use execution\n10 gas if don't\nFor 100 byte transfer tx, would be ~1000 extra; so 11000; less if you do something in the tx\n\nSeems ok; still less than now (re @fradamt: why should the non-calldata bytes be treated differently than calldata bytes?)",
        "created_at": "2025-01-24T17:34:46.764000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cfradamt\u003e It's 40 per non-zero byte",
        "created_at": "2025-01-24T17:35:49.670000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cben_a_adams\u003e Ah so it is; so 4000 extra. Mempool ECDSA (3000) is also a valid question; as is that just a sunk cost of being a validator and shouldn't be included for a tx? (Get tx level one for free; is a network security check/cost)\n\nThe ~150k tx in the mempool aren't really paying it; and is done for them block after block (re @fradamt: It's 40 per non-zero byte)",
        "created_at": "2025-01-24T17:43:06.845000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003csophiagold0\u003e Instead of rescaling these, do we want to consider either particle gas or increasing storage opcodes and raising the limit? Maybe something to discuss on the next call (re @jacekglen: Hi All! I have updated the Gas Cost Estimator project, you can see it here: https://github.com/imapp-pl/gas-cost-estimator\nI guess most of you would be interested in seeing our proposal, head straight to https://github.com/imapp-pl/gas-cost-estimator/blob/master/docs/gas-schedule-proposal.md#radical-gas-schedule-proposal\n\nPlease review and any feedback is welcome!)",
        "created_at": "2025-01-24T19:21:13.073000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cjacekglen\u003e As a rule of thumb we aim to avoid any price increase. Let's consider a simple scenario: a contract with some funds locked in. Imagine that the release function makes a call to another contract and it assigns hardcoded amount of gas for this purpose. If the price increase causes the call to exceed the allocated gas, then the transaction fails and the funds are locked permanently.\n- Is this a real issue? Possibly \n- How many contracts are affected? I don't know \n- Can we run some analysis on mainnet? Not easily",
        "created_at": "2025-01-24T20:32:44.532000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003ctimbeiko\u003e What would be the blocker to running the mainnet analysis? (re @jacekglen: As a rule of thumb we aim to avoid any price increase. Let's consider a simple scenario: a contract with some funds locked in. Imagine that the release function makes a call to another contract and it assigns hardcoded amount of gas for this purpose. If the price increase causes the call to exceed the allocated gas, then the transaction fails and the funds are locked permanently.\n- Is this a real issue? Possibly \n- How many contracts are affected? I don't know \n- Can we run some analysis on mainnet? Not easily)",
        "created_at": "2025-01-24T20:34:47.014000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003csophiagold0\u003e I think it is inevitable that we increase the price of some opcodes so we will need to know this",
        "created_at": "2025-01-24T20:36:49.617000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003ckevaundray\u003e Perhaps the issue is that a contract may only conditionally use X amount of gas, so its not possible to be completely sure that all contracts are safe (re @timbeiko: What would be the blocker to running the mainnet analysis?)",
        "created_at": "2025-01-24T20:37:24.525000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cshemnon\u003e Locking in gas prices for calls has been an auditor red-flag since 2016 when EIP-150 increased sload 4x for chain stability reasons.  I don't think behavior that was known to be a bad practice at the time the contract was written should hold us back.  It's been 8 years.",
        "created_at": "2025-01-24T20:37:51.410000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cshemnon\u003e This entire line of discussion is why we removed the GAS opcode and put in new CALL opcodes to EOF.",
        "created_at": "2025-01-24T20:38:46.404000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cjochembrouwer\u003e Does solidity still allow for hardcoded gas to be forwarded? Or is this also flagged when compiled now?",
        "created_at": "2025-01-24T20:38:50.359000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cshemnon\u003e Not a warning, but in the docs - https://docs.soliditylang.org/en/latest/control-structures.html#external-function-calls\n\n\u003e  Note that it is discouraged to specify gas values explicitly, since the gas costs of opcodes can change in the future.",
        "created_at": "2025-01-24T20:44:15.203000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cjochembrouwer\u003e Hmm ok interesting. I actually wonder how much this gas feature in solidity is being used. What is the actual use case for it? I know in EOF \"all\" gas is forwarded, so the ability to not \"send all gas\" is being removed, which signals to me there is no (?) practical use case of not sending all gas forward? (The called contract could spent all available gas, but that should still yield 1/64 of the original gas left for the caller, so in practice if you just send enough gas you will likely have enough gas left after that call?)",
        "created_at": "2025-01-24T20:47:29.192000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cshemnon\u003e 4337 entrypoint contract is the only legitimate use I found without a valid substitute.  And what makes 4337 not a problem is the gas value comes from outside the contract and is not hard coded.",
        "created_at": "2025-01-24T20:51:12.258000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003czhengxun_wu\u003e It's commonly used in mev contract (re @jochembrouwer: Hmm ok interesting. I actually wonder how much this gas feature in solidity is being used. What is the actual use case for it? I know in EOF \"all\" gas is forwarded, so the ability to not \"send all gas\" is being removed, which signals to me there is no (?) practical use case of not sending all gas forward? (The called contract could spent all available gas, but that should still yield 1/64 of the original gas left for the caller, so in practice if you just send enough gas you will likely have enough gas left after that call?))",
        "created_at": "2025-01-24T20:53:16.614000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cjochembrouwer\u003e Can you send an example? (re @zhengxun_wu: It's commonly used in mev contract)",
        "created_at": "2025-01-24T20:53:44.158000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cshemnon\u003e People who write and operate MEV are fully aware of the risk.",
        "created_at": "2025-01-24T20:53:45.250000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003czhengxun_wu\u003e Arb across different dex in one tx (re @jochembrouwer: Can you send an example?)",
        "created_at": "2025-01-24T20:54:11.807000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cjochembrouwer\u003e I don't directly see how that would need non-standard forward all gas though",
        "created_at": "2025-01-24T20:54:54.867000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cjacekglen\u003e One approach is to re-execute all mainnet transactions with the repriced gas cost schedule and see if any of them fails. \nBut that does not guarantee that future transactions would be successful. So you can run some static analysis on all deployed code. It is quite a task, but still no guarantee that all circumstances will be considered. \nThen we have to accept that any price increase *might* break something. (re @timbeiko: What would be the blocker to running the mainnet analysis?)",
        "created_at": "2025-01-24T20:58:50.897000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003crodiazet\u003e Ipsilon did something like that recently to check what inputs goes to modexp precompile. But we only reexecuted main net",
        "created_at": "2025-01-24T21:03:06.887000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003ctimbeiko\u003e Right my intuition was to do something like static analysis. I guess I‚Äôm trying to to understand if there are any ‚Äúnon linear‚Äù complexities between checking what breaks when we change the cost of 1 thing vs N (re @jacekglen: One approach is to re-execute all mainnet transactions with the repriced gas cost schedule and see if any of them fails. \nBut that does not guarantee that future transactions would be successful. So you can run some static analysis on all deployed code. It is quite a task, but still no guarantee that all circumstances will be considered. \nThen we have to accept that any price increase *might* break something.)",
        "created_at": "2025-01-24T21:03:40.984000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cjacekglen\u003e What client did you use? (re @rodiazet: Ipsilon did something like that recently to check what inputs goes to modexp precompile. But we only reexecuted main net)",
        "created_at": "2025-01-24T21:09:37.506000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003crodiazet\u003e Erigon. Afaik. But have to confirm with Hugo from ipsilon.",
        "created_at": "2025-01-24T21:10:23.123000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003cjacekglen\u003e Hmm... great question üòÅ (re @timbeiko: Right my intuition was to do something like static analysis. I guess I‚Äôm trying to to understand if there are any ‚Äúnon linear‚Äù complexities between checking what breaks when we change the cost of 1 thing vs N)",
        "created_at": "2025-01-24T21:11:00.220000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003crodiazet\u003e Maybe it can be good first step in this case too. (re @rodiazet: Erigon. Afaik. But have to confirm with Hugo from ipsilon.)",
        "created_at": "2025-01-24T21:11:52.745000+00:00",
        "attachments": []
    }
]
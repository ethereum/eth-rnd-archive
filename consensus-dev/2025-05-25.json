[
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "For what it's worth, I'm also in favor of changing the fork digest for each BPO fork. This has an added benefit of *always* being able to define max block size limits by fork digest before decoding the block.",
        "created_at": "2025-05-25T22:35:01.680000+00:00",
        "attachments": null
    },
    {
        "author": "raulvk",
        "category": "general",
        "parent": "",
        "content": "PR: https://github.com/ethereum/EIPs/pull/9818",
        "created_at": "2025-05-25T23:20:49.346000+00:00",
        "attachments": null
    },
    {
        "author": "raulvk",
        "category": "general",
        "parent": "",
        "content": "based on my analysis, changing the fork digest wasn't sufficient. as I mentioned above, it's necessary to assign `fork_version` so that upcoming BPO hardforks can be advertised in the ENR",
        "created_at": "2025-05-25T23:22:11.911000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "I would still say that every item under \"In reality, I would've gone for a deeper refactor to:\", the whole parametric fork thing, is well beyond what was agreed to as just this small little EIP to get scaling to happen.\n\nSo I appreciate that this particular PR isn't trying to introduce it, but it's also being set up in the usual saleman-y way, well, I _could_ be doing this, but instead I'm _only_ do doing this, really, very moderate, don't you think, thing.\n\nBut no, I regard the \"parametric fork\" idea as not so much intrinsically flawed/bad (or good, either way), just very much not what was agreed to, procedurally, and it would be very much riding BPO coattails and sneaking in.\n\nProvocative language deliberate",
        "created_at": "2025-05-25T23:24:08.715000+00:00",
        "attachments": null
    },
    {
        "author": "raulvk",
        "category": "general",
        "parent": "",
        "content": "the intention was simply to communicate an alternative approach which i think conceptually fits in better, and offer to write up a draft for future consideration if we think it's worth generalising this technique for future parameters. but point taken on stylistic choice, i guess?",
        "created_at": "2025-05-25T23:28:00.662000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "\"We backport Deneb and Electra to the blob schedule.\" is a bit in between. As a bit of mechanism, it's hard to feel that much about either way, if people like it, I guess, ok. But one concern I noticed about that while adding initial BPO support to Nimbus based on 1.6.0-alpha.0 is that there's now this implied numerical correlation between then 6 blobs come in, and 9 blobs come in, and Deneb and Electra.\n\nSo now there's this new possible failure mode of, well, someone updates one of those but doesn't maintain the other in some network configuration. Not convinced it's on net better in that regard, because (and I think this is a reasonable claim to make?) the flexibility sought by BPOs cannot in reality apply to Deneb/Electra, those are for this purpose past tense, done, and so the only advantage relevant is implementation complexity/safety/verifiability/etc",
        "created_at": "2025-05-25T23:28:07.410000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "I know the backporting thing isn't really your innovation, you're implementing it on behalf of others, so this isn't either way a commentary on what you're doing per se",
        "created_at": "2025-05-25T23:29:24.090000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "as a really concrete thing on that point: Nimbus uses Holesky/Sepolia/Hoodi `eth-clients` network configurations absolutely verbatim, we git submodule/vendor them. So right now if we implement the backporting thing, it will regress/break those",
        "created_at": "2025-05-25T23:30:39.866000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "because until the entire ecosystem has copied that backporting-compatible thing into their network configs, it's now making every deneb/electra config out there incompatible",
        "created_at": "2025-05-25T23:31:03.388000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "And, all of this can happen sort of silently/automatically, and so far I'm not sure even `getConfig` is equipped to detect that difference of, oops, \"Hoodi\" is using mainnet fork epochs for \"BPOs\" for Deneb/Electra",
        "created_at": "2025-05-25T23:32:55.085000+00:00",
        "attachments": null
    },
    {
        "author": "raulvk",
        "category": "general",
        "parent": "",
        "content": "\u003c@654267572107083777\u003e the backport is necessary for consistency. This version enfoces that all blob parameter changes be performed via config—**even** if they're introduced within a named fork. That removes room for ambiguity, as the history of blob parameters is all in one place now. (Also paves the way for a general \"parametric forks\" solution; once a parameter is brought into the framework, it's always managed by the framework from there on).",
        "created_at": "2025-05-25T23:33:37.190000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "well, it will consistently break (or require even more inconsistent override/detect-no-BPO-config-so-fall-back-to-non-BPO-approach) mechanisms for existing network configs",
        "created_at": "2025-05-25T23:34:36.440000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "and \"Also paves the way for a general \"parametric forks\" solution; once a parameter is brought into the framework\" means that this will keep happening, again and again",
        "created_at": "2025-05-25T23:35:09.526000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "if this vision comes to pass",
        "created_at": "2025-05-25T23:35:13.142000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "But since it's not what the EIP agreed to be SFI'd actually says, it's not to me an argument for doing this one way or another",
        "created_at": "2025-05-25T23:35:41.008000+00:00",
        "attachments": null
    },
    {
        "author": "raulvk",
        "category": "general",
        "parent": "",
        "content": "\u003c@654267572107083777\u003e is your concern with the backporting of past configurations only, but you'd agree that blob params be _always_ managed via blob schedule changes from Fusaka onwards (even if they're changed by a named fork)?",
        "created_at": "2025-05-25T23:38:09.284000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "No strong view on that point, aside from the general skepticism of BPOs being tightly managed on the CL side at all (see \u003c@680234424037670912\u003e and my discussion/proposal at https://discord.com/channels/595666850260713488/598292067260825641/1375588180992200754). But sure, within the scope of that variety of BPO, using them consistently in lieu of the forks themselves going forward seems no worse than anything else",
        "created_at": "2025-05-25T23:39:45.284000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "for the purpose of this specific discussion, it's the backporting only",
        "created_at": "2025-05-25T23:40:19.388000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "But I regard \"it breaks almost every actual network configuration Nimbus has if naïvely implemented\" based on https://github.com/eth-clients as actually a fairly compelling, to me, issue",
        "created_at": "2025-05-25T23:41:51.014000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "and this isn't just a Nimbus-specific issue in principle, Nimbus only happens to be a CL which implements this mechanism/source its data in a fairly pure/unfiltered way",
        "created_at": "2025-05-25T23:42:56.072000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "to me, we're doing a whole bunch for a trivial validation, i dont see the value.",
        "created_at": "2025-05-25T23:43:17.376000+00:00",
        "attachments": null
    },
    {
        "author": "raulvk",
        "category": "general",
        "parent": "",
        "content": "\u003c@654267572107083777\u003e to be more concrete, are we talking about configurations [like this](https://github.com/eth-clients/sepolia/blob/main/metadata/config.yaml)? (that Nimbus has adopted verbatim)",
        "created_at": "2025-05-25T23:43:54.440000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "yes",
        "created_at": "2025-05-25T23:44:10.133000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "Nimbus uses the whole repositories verbatim. They are literally submodules of `nimbus-eth2`",
        "created_at": "2025-05-25T23:44:31.973000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "so I would suggest a good test case for how well the EIP works",
        "created_at": "2025-05-25T23:44:54.656000+00:00",
        "attachments": null
    },
    {
        "author": "raulvk",
        "category": "general",
        "parent": "",
        "content": "got it, so really what would happen if we backport Deneb and Electra under `BLOB_SCHEDULE` is that those specific configs would be redundant, because I assume clients are picking up the top-level `MAX_BLOB_PER_BLOCK{_FORKNAME}` entry for those past forks anyway, right? So I don't quite get the breakage you mentioned",
        "created_at": "2025-05-25T23:46:49.989000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "well nothing in https://github.com/ethereum/EIPs/pull/9818 specifically makes the Deneb/Electra versions of `process_execution_payload()` (yes, I know, some CLs implement them all as one function, some as separate, but in the spec they're separate, more or less, conceptually, so going with that framing here) use the BPO versions.\n\nBut then either it's\n- (a) useless because it's specified not to be used under ordinary circumstances (yes, edge cases, when Fusaka starts and maybe the first BPO hasn't kicked in); or\n- (b) creates consensus issues where some CLs use them and some don't.",
        "created_at": "2025-05-25T23:50:57.197000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "so if Nimbus goes the route of (a), and just ignores them because nothing 9818 says it should use them, then it's a pointless exercise. And not only for Nimbus but everyone.\n\nBut if the intent is to create a ... hint? to use them, then see case (b)",
        "created_at": "2025-05-25T23:51:47.781000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "so it either does nothing or breaks things",
        "created_at": "2025-05-25T23:52:00.425000+00:00",
        "attachments": null
    },
    {
        "author": "raulvk",
        "category": "general",
        "parent": "",
        "content": "i think the easy way to solve this is by commenting those lines, so they remain informational and implementors don't feel compelled to modify past fork logic unnecessarily. this is consistent with NOT removing the `MAX_BLOB_PER_BLOCK{_FORKNAME}`. (TIL I learnt about the [eth-clients](https://github.com/eth-clients) repo, thanks!).",
        "created_at": "2025-05-25T23:57:04.013000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "ok, then sure, that seems at least unobjectionable",
        "created_at": "2025-05-25T23:57:42.939000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "it also means, as a matter of implementation, people (especially CLs which filter the inputs a bit more and can more readily unify these kinds of disparate configuration mechanisms) can still choose to use the \"backported\" method if it's easier for them",
        "created_at": "2025-05-25T23:59:33.844000+00:00",
        "attachments": null
    }
]
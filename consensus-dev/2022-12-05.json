[
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "\u003c@361447803194441738\u003e In \u003chttps://github.com/ethereum/consensus-specs/pull/3141\u003e you said:\n\u003e With this PR, we use the assumption that if \u003e2/3rds of validators have attested to a chain then all payloads must have been available at some point.\nIsn't this a fairly significant escalation of validator trust?  Currently (before 4844) a malicious group of majority validators are fairly constrained on what they can do.  At worst, they can reorg the chain prior to finality, and they can do some bad things to new clients after weak subjectivity.  Am I correct in understanding that now a malicious 2/3 of validators would be able to finalize a chain that never had data made available?\n\nIs this true with 4844 regardless of whether this PR is merged, or without this PR is there no increase in validator trust?",
        "created_at": "2022-12-05T08:49:44.432000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Ideally a node should be able to do DA verification beginning with the WS checkpoint. Otherwise, DA assumption gets stronger than it is today, today it is implicitly verified by pulling blocks from the network. But we can't verify it for the period in before a WS checkpoint",
        "created_at": "2022-12-05T09:31:48.960000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "A malicious 2/3 of validators can finalize anything, with or without 4844.",
        "created_at": "2022-12-05T09:42:30.605000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "But they can't make you follow a chain that doesn't abide by the rules of your client. Whereas I guess \u003c@301186049323958275\u003e is saying that your client can now be convinced of following a chain it doesn't have all information on (not the same as violating rules, but sort of like it).",
        "created_at": "2022-12-05T09:45:15.892000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Yes, but full nodes can't be convinced in following invalid chain even if it's finalized. Similar guarantee should be provided by the data layer",
        "created_at": "2022-12-05T09:49:53.437000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "general",
        "parent": "",
        "content": "A malicious 2/3rd validator set is practically game over. They can’t do double spends or invalid state transitions, but they can force anyone onto almost any chain they like. The chain would be unfit for purpose without manual intervention. Majority validators do get more power with 4844, however I think we could generally expect that if we add a feature then 2/3rds validators can do something unpleasant to it. Especially something like 4844 which is relatively light-on when it comes to proof schemes.",
        "created_at": "2022-12-05T09:50:43.811000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "\u003e but they can force anyone onto almost any chain they like.\n\nThey can censor, but a full node will get stuck rather than import a block not satisfying validity conditions. In this case manual intervention and UASF can help to recover",
        "created_at": "2022-12-05T09:55:34.580000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "One of the big selling points of PoS, and blockchains more broadly, is that it is explicitly *not* majority rules, and I'm quite apprehensive about changes that drive us toward that (rather than away from it).  As an example, Ethereum's PoS (compared to PoW) takes away some power from the supermajority by introducing finality.  The closer we can get to the supermajority having any ability to do bad things the better.  Right now I think the worst they can do is cause finality to fail (harming liveness), but they cannot trick people onto an invalid finalized chain.",
        "created_at": "2022-12-05T10:02:18.332000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Is the problem here that we have no way to introduce these data blobs without giving power to break the network to the supermajority?",
        "created_at": "2022-12-05T10:02:40.528000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "In the current 4844 design, what does a non-validator client do if there is a supermajority of validators who claim the data is available when it is not?  Will non-validating clients try to availability sample themselves, find the data to be unavailable, and then stop following head?  If so, what happens once finality is reached?  Will those nodes just fast-forward sync even though they never saw the data?",
        "created_at": "2022-12-05T10:05:01.051000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "general",
        "parent": "",
        "content": "I claim that a supermajority already has the ability to break the chain. It’s recoverable, but Ethereum PoS with 2/3rds malicious wouldn’t be working as we intend.\n\nRegardless, in the current 4844 design the honest validators will stop following the unavailable head. Eventually the malicious validators will leak out on the honest chain and there will no longer be a malicious majority from its perspective.\n\nHowever, any new nodes that sync from genesis or WS sync will most likely end up stuck on the wrong chain because they’ll be outside the blob retention period and the malicious chain will finalise quicker. To stop that we’d probably have to push client releases that reject the malicious blocks (or favour the honest ones).",
        "created_at": "2022-12-05T10:15:08.351000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "The point is that currently there is no retention period affecting sync from a WS checkpoint, and 4844 introduces one",
        "created_at": "2022-12-05T10:21:00.180000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Do non-validator clients (e.g., regular users running their own node) do availability sampling and will they also refuse to follow head even if it has 2/3 of validators claiming availability?",
        "created_at": "2022-12-05T10:28:06.411000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "\u003e However, any new nodes that sync from genesis or WS sync will most likely end up stuck on the wrong chain because they’ll be outside the blob retention period and the malicious chain will finalise quicker. To stop that we’d probably have to push client releases that reject the malicious blocks (or favour the honest ones).\nThe point about honest validators **not** following an invalid chain is compelling though. A supermajority can trick us into following any fork and can make the network completely useless, but they cannot make us follow a chain with invalid execution for example.",
        "created_at": "2022-12-05T10:30:00.639000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Is the current blob data retention period longer than the weak subjectivity period?",
        "created_at": "2022-12-05T10:31:55.264000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "We already have a fairly hard requirement that nodes acquire a blockhash from a trusted source that is more recent than weak subjectivity.  If blob retention is longer than that, then an attacking supermajority wouldn't be able to trick newly syncing users into syncing to their chain if the users are getting the recent blockhash from a trusted source who has been following head and correctly forked away from the chain without data availability.",
        "created_at": "2022-12-05T10:33:52.821000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "If all of that is correct, then I feel like a newly syncing node should do data availability sampling of their own from the trusted checkpoint blockhash forward.",
        "created_at": "2022-12-05T10:34:28.002000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Which likely means *not* trusting that finalized == available.",
        "created_at": "2022-12-05T10:34:45.897000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "It is `MIN_EPOCHS_FOR_BLOBS_SIDECARS_REQUESTS = 4096 epochs`, this number is greater than recommended WS period numbers (see here https://github.com/ethereum/consensus-specs/blob/dev/specs/phase0/weak-subjectivity.md#compute_weak_subjectivity_period)",
        "created_at": "2022-12-05T12:53:47.286000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "parithosh",
        "category": "general",
        "parent": "",
        "content": "We're testing the flashbots relay(currently, but happy to point some validators to other relays as well) on Zhejiang and plan on testing further relays on mainnet-shadowfork-2 (unfortunately some delays pushing it back). The idea is that we explicitly test the circuit breaker conditions and implicitly test the relay functionality.",
        "created_at": "2023-02-17T09:52:10.878000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "The argument for this explicit/implicit testing is that we test everything that we can do on our end, and rely on private parties to either have ready their product and tested by mainnet time or we will safely fall back to local execution. I claim this is a flawed system. One could envision innumerable types of bugs that won't trigger the circuit breaker and still screw up mainnet, eg. The builder somehow is so screwed up that pays a lot for bids but produces empty or close to empty blocks. I claim that we clients should not be facilitating our users shooting themselves in the foot by using untested software",
        "created_at": "2023-02-17T09:59:19.940000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Not sure which side of the argument this gives credence to, but just found a bug in a beacon node that's only surfaced when testing against a relay.",
        "created_at": "2023-02-17T10:04:04.947000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "So in principle testing against a mock relay can find those bugs. We're late IMO testing this but at least we are testing. The builder on the other hand is nonexistent as far as I know (they tell me that there is one already, but I haven't seen a single block produced by it yet)",
        "created_at": "2023-02-17T10:05:14.362000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "general",
        "parent": "",
        "content": "Hello, I noticed that some of the finality consensus tests has a case where no member of the sync committee signed the block, how should it be handled? just skip the check?",
        "created_at": "2023-02-17T14:38:28.183000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "general",
        "parent": "",
        "content": "with that i mean no participating bits in sync aggregate",
        "created_at": "2023-02-17T14:40:05.784000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Do we care about the builder, though?  If it produces bad blocks they would be rejected by the beacon node so no harm done.",
        "created_at": "2023-02-17T14:44:29.257000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "The relevant function is `process_sync_aggregate`and has a loop over the signing bits which will be a noop, so yes you can skip this loop, but still need to check the signature of the message\nhttps://github.com/ethereum/consensus-specs/blob/dev/specs/altair/beacon-chain.md#sync-aggregate-processing",
        "created_at": "2023-02-17T14:52:06.137000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "No, my point is that it could produce good blocks with no transactions for example, that stalls mainnet and we will not activate the circuit breaker",
        "created_at": "2023-02-17T14:52:49.069000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "general",
        "parent": "",
        "content": "what I am referring to is different: what if there are no participating bit being active in the sync aggrefate? empty aggregate signature? It is in one of consensus specs and by looking at prysm it seems that if there are no pubkeys validation fails. however all other checks passes (block sig, etc..) and can compute correct state root.",
        "created_at": "2023-02-17T15:01:01.354000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "general",
        "parent": "",
        "content": "so this leaves me weirded out a bit",
        "created_at": "2023-02-17T15:01:10.660000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I fail to see what you mean by different here, it is precisely what I linked: you need to verify the empty sync aggregate, this aggregate will have zero bits set, which therefore makes the loop in that function a noop, but the signature has to be the point at infinity in the BLS curve",
        "created_at": "2023-02-17T15:04:43.615000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "So you still need to verify the signature",
        "created_at": "2023-02-17T15:05:08.478000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "general",
        "parent": "",
        "content": "thank you i see",
        "created_at": "2023-02-17T15:07:03.519000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "But is that any different from today? A builder could upgrade at any time and introduce bugs, no?",
        "created_at": "2023-02-17T15:14:45.359000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "yes indeed, but this we have certainty that the builder was not tested. I do see that I am wasting my time since eventually a builder may appear either Sepolia, Goerli or whatever testnet. And then my complains will be empty.",
        "created_at": "2023-02-17T15:36:36.889000+00:00",
        "attachments": null
    }
]
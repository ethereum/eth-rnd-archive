[
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Question: why do we have the full header in the proposer slashings instead of the HTR?",
        "created_at": "2025-01-21T00:26:54.052000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "my main guess was re. the signature... you need the header to have enough context to see they signed both block slots and they're for the same slot etc... the root wouldn't get you that and most ppl may only keep the canonical so it'd be impossible to verify...",
        "created_at": "2025-01-21T04:12:35.717000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "i do think deposits could be bad... its probably easier to make sure it doesn't occur, raised a PR to discuss anyway...\nhttps://github.com/ethereum/consensus-specs/pull/4089",
        "created_at": "2025-01-21T04:17:12.712000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "What do you mean it'd be impossible to verify, as long as you have the slot and different roots you know it's different blocks for the given slot and you can verify the signature with just the root",
        "created_at": "2025-01-21T08:05:31.464000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "with the header you have at least hte signature / slot etc. with the root, you need to have seen the block",
        "created_at": "2025-01-21T08:06:00.767000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "You do not need to have seen the block",
        "created_at": "2025-01-21T08:06:16.518000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "and i guess importantly still have it",
        "created_at": "2025-01-21T08:06:18.366000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "You can verify the signature with just the root",
        "created_at": "2025-01-21T08:06:25.759000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "But you do need a proof that the slot is part of it yes",
        "created_at": "2025-01-21T08:06:57.922000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Hmm but perhaps proving the slot is just as bad or worse than including the full header",
        "created_at": "2025-01-21T08:09:44.361000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I'm having this same problem now with the RLNC branch",
        "created_at": "2025-01-21T08:10:08.185000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "In that the signature is not over the block but rather over the commitments",
        "created_at": "2025-01-21T08:10:24.965000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "And then a proposer slashing becomes over 1KB",
        "created_at": "2025-01-21T08:11:04.954000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "we need HTR / signature / slot minimum, for both messages, and proposer index\nso readly we have ... 2 extra roots?",
        "created_at": "2025-01-21T08:11:13.763000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "basically we're talking about not needing parent root or state root",
        "created_at": "2025-01-21T08:12:29.934000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "napkin math suggests the same size",
        "created_at": "2025-01-21T08:12:33.488000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Yeah as soon as I said so I realized it's large too. But with linear coding it becomes worse",
        "created_at": "2025-01-21T08:13:07.883000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "slot + proposer_index + root + root + block_root which is same as header",
        "created_at": "2025-01-21T08:13:09.267000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "but thats on phase0 objects",
        "created_at": "2025-01-21T08:13:09.949000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "what makes it worse?",
        "created_at": "2025-01-21T08:13:38.659000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "ok i'll believe Mikhail ðŸ™‚",
        "created_at": "2025-01-21T08:13:41.298000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "In RLNC the signature is not over the HTR of the block, but over the commitments+slot+parent_root",
        "created_at": "2025-01-21T08:14:39.550000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "So a proposer slashing needs to include at least the HTR of the commitments plus slot plus parent root plus proposer index as we are talking above",
        "created_at": "2025-01-21T08:15:35.457000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "But in my case this is way better than including the full commitments (that would be 1KB)",
        "created_at": "2025-01-21T08:16:46.551000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I suspect the header is larger anyway \u003c@425572898787426305\u003e",
        "created_at": "2025-01-21T08:17:09.771000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "btw, why does the signature not include proposer index in RLNC?",
        "created_at": "2025-01-21T08:22:25.479000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "It's not needed, you need the proposer index just to verify it",
        "created_at": "2025-01-21T08:23:08.874000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "But you don't need to sign over it do you?",
        "created_at": "2025-01-21T08:23:23.175000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Anyway the slashing does need to have it",
        "created_at": "2025-01-21T08:23:40.617000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Notice that since you are signing the commitments and the block contains the proposer index, then you are signing over it anyway",
        "created_at": "2025-01-21T08:24:35.574000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Anyway in my code the signature does include the index lol BeaconBlockChunkHeader in this PR \u003chttps://github.com/prysmaticlabs/prysm/pull/14813/files\u003e",
        "created_at": "2025-01-21T08:27:31.015000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "in case of RLNC proposer slashing will have two containers with that data instead of two block headers + two signatures. i think it is fine",
        "created_at": "2025-01-21T08:28:49.384000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "2 * size(data_root + *coefficients_root* + slot + proposer_index + parent_root + *commitments_root* + signature) = 2 * 240 = 480 byte\nvs\n2 * size(slot + proposer_index + parent_root + state_root + body_root + signature) = 2 * 208 = 416 byte\n\ndoes it seem to be correct?",
        "created_at": "2025-01-21T08:36:05.685000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "It's correct as of now but I think we can do better by collecting everything but the slot into one subcontainer. And the same could be done today. That is all you need is a 2* size of one root + slot number",
        "created_at": "2025-01-21T08:41:08.578000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "And the full slashing is 2 roots, one slot (no need to repeat the slot) one proposer index and two signatures",
        "created_at": "2025-01-21T08:41:49.530000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I think this is way better than the header",
        "created_at": "2025-01-21T08:42:08.547000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "And it should be trivial to implement",
        "created_at": "2025-01-21T08:42:17.405000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "But today it would require changing the block, in RLNC that's not needed",
        "created_at": "2025-01-21T08:43:27.376000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "btw, moving proposer index out of the brackets is similar to the committee index case in attestation. Don't see any problem with that. I guess the main reason was to reuse the block header structure as it doesn't give a big data complexity overhead",
        "created_at": "2025-01-21T08:43:56.703000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Yeah my guess is the same, that we used the actual block to sign. I think this is the real source of the lack of optimization",
        "created_at": "2025-01-21T08:44:58.816000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Instead of signing the block, we could arrange the header however we like and sign over that",
        "created_at": "2025-01-21T08:45:20.818000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Since that's a commitment to a block anyway",
        "created_at": "2025-01-21T08:45:37.445000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "And it should always be in full size as my last computation above 80 + 2*96",
        "created_at": "2025-01-21T08:46:25.583000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Which is way better than today",
        "created_at": "2025-01-21T08:46:40.121000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "It should be a simple PR to the spec if there's interest I can open it",
        "created_at": "2025-01-21T08:48:05.843000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "i would keep things same until RLNC, just for simplicity. and, btw, RLNC rocks ðŸ¤˜",
        "created_at": "2025-01-21T08:49:47.362000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "general",
        "parent": "",
        "content": "I believe the slashing mechanism in the EIP should be updated. However, it would be beneficial if someone from the CL development team could provide input. According to the EIP, this topic is still under discussion.\n\nhttps://eips.ethereum.org/EIPS/eip-7251#consensus-layer-1\nRemoving the initial slashing penalty** (still in discussion).** This reduces the risk of consolidation for large validators.",
        "created_at": "2025-01-21T13:22:36.065000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "yes, it is still yet not up to date with what is supposed to be rolled out. will be working on it during next couple of weeks",
        "created_at": "2025-01-21T13:58:47.059000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Re balances: What happens if somebody deposits 33 ETH?",
        "created_at": "2020-02-04T12:17:41.966000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Max Effective balance says that your effective balance cannot be greater than 32 ETH. If that validator gets slashed by 1 ETH, that would mean the validator would have an effective balance of 31 ETH. Losing this 1 ETH extra. Right?",
        "created_at": "2020-02-04T12:18:44.309000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "No, your balance is tracked separately from effective balance",
        "created_at": "2020-02-04T13:25:24.911000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "If you get slashed, your effective balance stays the same, it's just your balance that is updated, and your validator being marked as slashed and forced into the exit queue",
        "created_at": "2020-02-04T13:26:08.205000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "And then your effective balance is updated each epoch based on the real full precision balance. (with steps of 1 ETH, and hysteresis to avoid changes going back and forth between two balances too fast)",
        "created_at": "2020-02-04T13:27:25.813000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "I see. Both the tracking and mutation of the validator balances are in the beacon chain state: https://github.com/ethereum/eth2.0-specs/blob/dev/specs/phase0/beacon-chain.md#beaconstate and https://github.com/ethereum/eth2.0-specs/blob/dev/specs/phase0/beacon-chain.md#increase_balance. With the validator objects tracking their `effective_balance` only https://github.com/ethereum/eth2.0-specs/blob/dev/specs/phase0/beacon-chain.md#validator",
        "created_at": "2020-02-04T13:48:50.161000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "AIUI, this is an optimisation to avoid having to rehash the list of validator objects very often - the effective balance is designed to vary infrequently. Rehashing the list of actual balances, which change every epoch, is much lighter-weight.",
        "created_at": "2020-02-04T13:54:51.010000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "On activation elegibility: https://github.com/ethereum/eth2.0-specs/blob/dev/specs/phase0/beacon-chain.md#is_eligible_for_activation_queue",
        "created_at": "2020-02-04T15:11:33.484000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Looking for the specification on when the deposit (or addition) qualifies to be put on the activation queue",
        "created_at": "2020-02-04T15:13:10.203000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "got it",
        "created_at": "2020-02-04T15:19:22.659000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "A deposit, if sufficient amount, always creates a validator slot. It defaults to inactive (and yet not withdrawn). This is picked up by the final updates during the epoch transition, which checks qualifications and puts a validator in the queue by saying when it was recognized as eligible",
        "created_at": "2020-02-04T15:19:38.598000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Here, https://github.com/ethereum/eth2.0-specs/blob/dev/specs/phase0/beacon-chain.md#deposits you process the deposits and issue the mutation in the state",
        "created_at": "2020-02-04T15:19:59.282000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "That doesn't set the activation, though. Just adds the balance. Search for `is_eligible_for_activation` to see how validators are inducted.",
        "created_at": "2020-02-04T15:20:46.379000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Then in somewehere, the effective balance gets issued",
        "created_at": "2020-02-04T15:20:47.341000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "Edit: not final updates, but registry update function. I guess you got that",
        "created_at": "2020-02-04T15:20:49.658000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "The effective balance is updated for everyone as part of final updates",
        "created_at": "2020-02-04T15:21:43.551000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "in final updates, triggered by `process_epoch`",
        "created_at": "2020-02-04T15:22:02.582000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "Yep",
        "created_at": "2020-02-04T15:22:10.037000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "\u003c@!203220829473996800\u003e , I am confused here. This function https://github.com/ethereum/eth2.0-specs/blob/dev/specs/phase0/beacon-chain.md#is_eligible_for_activation_queue is triggered at the registry updates. I gather this is the one. But it compares the balance of the validator to be equal (`==`) with MAX_EFFECTIVE_BALANCE. What happens if the deposit exceeded 32 ETH?",
        "created_at": "2020-02-04T15:26:54.261000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Ugh. No no. This is comparing the `effective_balance`... (answering myself)",
        "created_at": "2020-02-04T15:28:05.871000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "ok, here is when the `effective_balance` gets incremented from the deposit (https://github.com/ethereum/eth2.0-specs/blob/dev/specs/phase0/beacon-chain.md#deposits), with a cap.",
        "created_at": "2020-02-04T15:31:31.066000+00:00",
        "attachments": null
    }
]
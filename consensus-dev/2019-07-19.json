[
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "Thanks, I think the last question for now is what is `previous_eth1_distance`?",
        "created_at": "2019-07-19T00:18:08.048000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "nvm",
        "created_at": "2019-07-19T00:18:29.381000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "Actually, no, it's not clear",
        "created_at": "2019-07-19T00:19:52.063000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "`Let previous_eth1_distance be the distance relative to the Eth 1.0 block corresponding to state.eth1_data.block_hash at the start of the current Eth 1.0 voting period.`",
        "created_at": "2019-07-19T00:19:58.080000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "how do i determine this value?",
        "created_at": "2019-07-19T00:20:07.605000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "Another question about eth1data processing:\n```python\ndef process_eth1_data(state: BeaconState, body: BeaconBlockBody) -\u003e None:\n    state.eth1_data_votes.append(body.eth1_data)\n    if state.eth1_data_votes.count(body.eth1_data) * 2 \u003e SLOTS_PER_ETH1_VOTING_PERIOD:\n        state.eth1_data = body.eth1_data\n```\n\nGiven that eth1_data_votes is a list of size SLOTS_PER_ETH1_VOTING_PERIOD, how can it ever `count()` to 2 * SLOTS_PER_ETH1_VOTING_PERIOD?",
        "created_at": "2019-07-19T00:29:23.860000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "oh nvm, it needs to more than half of SLOTS_PER_ETH1_VOTING_PERIOD",
        "created_at": "2019-07-19T00:30:09.609000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Yeah just a simple majority of eth1 data votes updates the canonical value",
        "created_at": "2019-07-19T00:31:30.452000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "thanks, took a second to translate that",
        "created_at": "2019-07-19T00:31:53.496000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Checking on previous eth1 distance, need to review",
        "created_at": "2019-07-19T00:31:53.877000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "ty",
        "created_at": "2019-07-19T00:31:56.964000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "One sec",
        "created_at": "2019-07-19T00:31:58.344000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Yeah I spent some time just the other day trying to sort this out",
        "created_at": "2019-07-19T00:32:10.780000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "So it‚Äôs kind of fresh üòÉ",
        "created_at": "2019-07-19T00:32:16.647000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "great, really appreciate it üòÑ",
        "created_at": "2019-07-19T00:32:24.305000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Totally, also on mobile so sorry for bad formatting",
        "created_at": "2019-07-19T00:32:47.932000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Yeah so my interpretation starts from the ‚Äúhead of the eth1 chain at the start of the current eth1 voting period‚Äù",
        "created_at": "2019-07-19T00:34:05.634000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "If that was not clear from above, let‚Äôs rehash it",
        "created_at": "2019-07-19T00:34:15.896000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "But this means for any slot in any voting period, there will be a ‚Äúhead‚Äù of the chain we are looking at",
        "created_at": "2019-07-19T00:34:51.849000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "From there, the highest possible block is behind this ‚Äúhead‚Äù by the follow distance",
        "created_at": "2019-07-19T00:35:16.376000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "The lowest possible block is the one last enshrined in the state",
        "created_at": "2019-07-19T00:35:35.672000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "It's not clear. Maybe you can confirm my interpretation:\n_Block producers should take the slot timestamp of the eth1 voting period start slot and determine the most recent ETH1 canonical block before that timestamp._",
        "created_at": "2019-07-19T00:35:44.271000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Ie the block with the hash state.eth1_data.block_hash",
        "created_at": "2019-07-19T00:35:57.209000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "unclear what state.eth1data.block_hash has to do with it",
        "created_at": "2019-07-19T00:36:15.908000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Previous eth1 distance is the block height of the ‚Äúhead‚Äù - the block height of this last enshrined block",
        "created_at": "2019-07-19T00:36:24.908000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "That‚Äôs minus",
        "created_at": "2019-07-19T00:36:32.294000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Yeah so for your interpretation I‚Äôm calling that the ‚Äúhead‚Äù",
        "created_at": "2019-07-19T00:37:22.012000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "But it isn‚Äôt the tip of the chain so I can call it something else if that‚Äôs confusing",
        "created_at": "2019-07-19T00:37:33.686000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "oh right, i left out the minus follow distance",
        "created_at": "2019-07-19T00:38:08.299000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "let me rephrase it:\n_Block producers should take the slot timestamp of the eth1 voting period start slot and determine the most recent ETH1 canonical block before that timestamp, subtract block number by `ETH1_FOLLOW_DISTANCE` and use that block as the data for eth1data_.",
        "created_at": "2019-07-19T00:38:55.514000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "everyone should land on the same block during hte voting period",
        "created_at": "2019-07-19T00:39:32.840000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "What you said is correct if you run the code there and land on the default value in the max term",
        "created_at": "2019-07-19T00:40:24.699000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "But yeah, if you follow that algo, everyone should basically land on that same block",
        "created_at": "2019-07-19T00:40:45.655000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "This is my interpretation",
        "created_at": "2019-07-19T00:42:39.279000+00:00",
        "attachments": [
            {
                "type": "",
                "origin_name": "image0.jpg",
                "content": "004e7307bac211ed692d2c1d29c5618dc0fa89d63486ae36f3d1e1af460e3eff"
            }
        ]
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "I‚Äôm assuming the constants are set in the spec so that this is generally what‚Äôs going on into a given voting period",
        "created_at": "2019-07-19T00:43:24.816000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "I haven‚Äôt verified the numbers myself yet but I think this is approximately correct",
        "created_at": "2019-07-19T00:44:03.884000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "wait, so it's a moving target?",
        "created_at": "2019-07-19T00:44:57.490000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "the tip of 1.0 keeps moving",
        "created_at": "2019-07-19T00:45:01.576000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Not a moving target , let‚Äôs make sure this diagram is clear",
        "created_at": "2019-07-19T00:45:30.446000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "So the highest valid block is the first one moving left of the rightmost ellipsis",
        "created_at": "2019-07-19T00:46:05.039000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Lol",
        "created_at": "2019-07-19T00:46:06.474000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "But that stays fixed per voting period bc we round down to that start slot",
        "created_at": "2019-07-19T00:46:26.155000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "ok, I think we're on the same page in that case",
        "created_at": "2019-07-19T00:46:37.282000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Cool",
        "created_at": "2019-07-19T00:46:48.581000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "This is my understanding, afaict it did change a bit from at least how it was specified in previous versions of the spec",
        "created_at": "2019-07-19T00:47:39.106000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "I forgot the PR number but the idea was to harden the voting so that honest validators end up not voting in an old/stale block",
        "created_at": "2019-07-19T00:48:17.373000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "So progress is always made",
        "created_at": "2019-07-19T00:48:32.536000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "It does seem that we could make more progress but I expect the algo that got frozen is more stable to pow reorgs and stuff",
        "created_at": "2019-07-19T00:49:12.799000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Making an eth1 light client is in fact tricky w/o a proof of work seal to verify üòÖ",
        "created_at": "2019-07-19T00:50:20.230000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "thanks for the help today \u003c@539495253418180618\u003e, got it working on our end!",
        "created_at": "2019-07-19T03:12:55.329000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Nice, of course",
        "created_at": "2019-07-19T03:21:12.176000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "Here is some new work on surround-vote matching for slashings: https://github.com/protolambda/eth2-surround\n\nQuadtrees are a bit aggressive as a solution for the chunks, but the bigger picure, the 2D view of the attested data, and the layered approach, should help us progress towards a good solution.",
        "created_at": "2019-07-19T18:39:37.944000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea**\n@protolambda is your intention to utilize geospatial DBs?",
        "created_at": "2019-07-19T18:42:10.084000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nYou could very well use geo-hashes (interleaved target/source bits), and query a Geo-indexed DB for attestations. But see note on quadtree, that gradient distribution is everything here. Some of the solution here is definitely over-kill",
        "created_at": "2019-07-19T18:43:22.846000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea** (in reply to **protolambda**)",
        "created_at": "2019-07-19T18:44:12.612000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "it's a rad idea",
        "created_at": "2019-07-19T18:44:12.768000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nWould focus on the chart; how a new point p selects two areas (surrounded by, and surrounding). This is core to matching whatever can be slashed.",
        "created_at": "2019-07-19T18:44:24.320000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea** (in reply to **protolambda**)",
        "created_at": "2019-07-19T18:44:53.945000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "ya i caught that (danny showed me your hand notes)",
        "created_at": "2019-07-19T18:44:54.109000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nThen roll whatever binary search / quadtree / geospatial DB works best in practice. If the gradient is very strong around the s=t line, quadtrees won't help much. But binary search will",
        "created_at": "2019-07-19T18:45:08.540000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea**\nso i might as well share an idea that i kicked around.  i experimented with transforming the source and target indexes of attestations into Fibonnacci numbers.  Then defined this metric:\n`rank(I) = Fend + Fend-start` to rank all attestations by their transformed value in \"fibonacci space\"",
        "created_at": "2019-07-19T18:49:16.451000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea**\nThe algorithm then goes something like this:\n```\n1. Calculate the rank of the interval\n2. If the list is empty, then add the new interval to the list. \n3. Starting from index 0, compare the new interval's rank with the interval contained at the current index. \n4. If the rank of the interval at the current index \u003e the rank of the new interval, then check if it spans the new interval.  \n5. If the current interval spans the new interval, then check signatures\n6. If the rank of the interval at the current index is \u003c the rank of the new interval, then insert the new interval into the current index. \n7. The remaining intervals in the list must be checked against the new interval to see if they are contained within the new interval's span.\n8. If any of these intervals are contained within the new interval's span, then remove them from the list.\n```",
        "created_at": "2019-07-19T18:50:50.181000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea**\nessentially allows you to know that the only possible attestations that could be spanning a new attestation will have a higher rank.",
        "created_at": "2019-07-19T18:51:39.825000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea**\nany attestations that have a rank less than the new attestation need to be checked to see if they are spanned by the new attestation",
        "created_at": "2019-07-19T18:52:26.145000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nyes, I am trying to avoid dynamic list based algorithms, to make the matching bounded to some constant time (O(bit depth of lookup * some layer count)), with no big IO writes accross history when adding attestations.",
        "created_at": "2019-07-19T18:54:57.833000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\n54000 epochs look back is cheap, if the data doesn't change very often. And it's very, very similar to adding static points to some map, then querying for points in an area. Which is a mostly solved problem, just need to specialize it for a longer stretch, instead of a square area.",
        "created_at": "2019-07-19T18:57:34.940000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nAnd the layering is important. Intentionally going from attestation first, then a low resolution match of 32 validators reduced to 1. And so on, really helps to short-cut the matching, and not having to store one big map of data for each validator",
        "created_at": "2019-07-19T18:58:58.190000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nLike the fibonacci idea though. Didn't think of such solution.",
        "created_at": "2019-07-19T18:59:55.138000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea** (in reply to **protolambda**)",
        "created_at": "2019-07-19T19:02:09.238000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "ya, that's why i abandoned it.  i just wanted to release the idea into the wild in case someone decides it is useful somehow.  It essentially is just a clever way to sort intervals automatically (defining rank different ways results in different properies of the sort)",
        "created_at": "2019-07-19T19:02:09.393000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nYou may be able to reduce IO writes with some linked list like structure. Still a possible more reads, and I find it hard to understand the time complexity quickle there.",
        "created_at": "2019-07-19T19:02:48.499000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea** (in reply to **protolambda**)",
        "created_at": "2019-07-19T19:03:07.882000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "ya i dig this idea.  used to use spatial dbs in a former life.  very clever",
        "created_at": "2019-07-19T19:03:08.050000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea** (in reply to **protolambda**)",
        "created_at": "2019-07-19T19:03:29.802000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "ya linked list should allow a constant insertion time",
        "created_at": "2019-07-19T19:03:30.106000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\ngeo-hashes (bit interleaving) is awesome tech. This is one of those rare non-geographical problems you actually could apply them üòÇ",
        "created_at": "2019-07-19T19:03:53.448000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea** (in reply to **protolambda**)",
        "created_at": "2019-07-19T19:04:52.099000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "i'm putting this on my resume üòâ",
        "created_at": "2019-07-19T19:04:52.299000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nhehe. Bet you can improve the geo-hash/geo-search thing too ;)",
        "created_at": "2019-07-19T19:06:01.440000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**JonnyRhea** (in reply to **protolambda**)",
        "created_at": "2019-07-19T19:06:42.318000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "indeed...my productivity just took a nose dive.  so cool",
        "created_at": "2019-07-19T19:06:42.503000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nThe core idea with geo-hashes are \"prefixes\". The first N bits of a key give you a 2D precision of exactly that. Ideal for maps / area searches.",
        "created_at": "2019-07-19T19:07:40.961000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nSo if there is some known Geo DB, with efficient *range* lookups (query those quadrants), you pretty much have a base solution",
        "created_at": "2019-07-19T19:08:43.248000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "general",
        "parent": "",
        "content": "I think I have a stack of papers on thos",
        "created_at": "2019-07-19T19:16:16.679000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "general",
        "parent": "",
        "content": "you can use space-filling curve like Morton curve or a Hilbert curve for indexing since they preserve locality",
        "created_at": "2019-07-19T19:17:04.109000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "general",
        "parent": "",
        "content": "iirc, mapbox had an article explaining the low-level details of their fast quandrant search",
        "created_at": "2019-07-19T19:19:59.919000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nYup, thought of using a hilbert curve for the backing list of the quads in the quadtree. Linked list. To retrieve the full quad, simply iterate from start to end. And a subquad, is a sublist",
        "created_at": "2019-07-19T19:20:04.429000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nBut \"overkill\", a bit... :P",
        "created_at": "2019-07-19T19:20:27.976000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "general",
        "parent": "",
        "content": "Or it was this: https://blog.zen.ly/geospatial-indexing-on-hilbert-curves-2379b929addc",
        "created_at": "2019-07-19T19:22:02.291000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "general",
        "parent": "",
        "content": "There is even a python implementation: https://gist.githubusercontent.com/poudro/9b9481764ce46e8dd8536532c655c356/raw/895fe8d4d07f58839362f3fbdece8f531e877e86/s2tree.py",
        "created_at": "2019-07-19T19:24:04.093000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\ngeo-hashes + linked lists (backed by arrays, with dynamic-programmign-esque references to other nodes) + quadtrees + some coordinates transform (map source to distance from target) would make a bad ass solution to this problem. But I do think it's also way too much for what it's good for üòÇ",
        "created_at": "2019-07-19T19:24:45.584000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nalso, the query bounds are always either diagonal from top left, to bottom right, or vertical. Can optimize queries even more there... Putting it to rest now though. There is lots of other stuff to prepare for testnets.",
        "created_at": "2019-07-19T19:31:04.958000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**cem_ozer**\nShould first slot be considered slot 0 or 1?",
        "created_at": "2019-07-19T21:17:15.986000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "0, but that block is the geensis block. expectation is for committee to attest to genesis block but for no one to propose",
        "created_at": "2019-07-19T21:17:42.301000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003ccemozerr\u003e I mean first slot as in the slot we kick right after the genesis time. So that is considered the slot #1? and your message also means that people actually attest to genesis block",
        "created_at": "2019-07-19T21:24:41.245000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Genesis time defines the start of slot 0, slot 1 is SLOTS_PER_SECOND after that",
        "created_at": "2019-07-19T21:32:37.241000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Etc",
        "created_at": "2019-07-19T21:32:42.615000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "And yeah validators should follow the honest validate guide which implies you follow what the shuffling dictates that epoch",
        "created_at": "2019-07-19T21:33:15.515000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "Modulo proposing the genesis block",
        "created_at": "2019-07-19T21:33:56.787000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**cem_ozer**\nokay so the slot right after the genesis time is slot number 0, validators don‚Äôt create a block for this slot because genesis block is considered the block of this slot, they just create attestations",
        "created_at": "2019-07-19T21:36:12.103000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "the slot at exactly genesis_time is slot 0",
        "created_at": "2019-07-19T21:42:13.748000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "Revisit of the geospatial surround vote matching: in the case where most attestations are near `s=t`, a manhatten distance of `(0, 0)` to `(source,  target)` can be used as lookup index.\nSo for a point `p`, the index is `s_p + t_p`. All attestations surrounded by `p` will fall into the range `(s_p*2) .... (t_p*2)`, with some false positives. But the false positives are much more sparse, as these would be attestations with a higher distance from `s = t` than most other attestations. And you can query the middle e.g. 25% part of the `(s_p*2) .... (t_p*2)` range for less false positives, at the cost of some false negatives (which could be covered in a 2nd query if no valid results were found in the 1st).",
        "created_at": "2019-07-19T22:34:56.289000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "Update (with new chart) here: https://github.com/protolambda/eth2-surround#manhatten-alternative",
        "created_at": "2019-07-19T23:13:37.477000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "So the manhatten distance idea effectively reduces the maximum necessary data to just ~2.2GB for 8 months of tracking. üéâ \u003ca:cketh:595706272658227251\u003e",
        "created_at": "2019-07-19T23:33:43.956000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**cem_ozer**\nhttps://github.com/ethereum/eth2.0-specs/blob/v0.8.1/specs/core/0_fork-choice.md#get_latest_attesting_balance I think there might be an error in get_latest_attesting_balance. Lets say that the children root (in the last line of get_head) that gets passed into get_latest_attesting_balance is the root of the actual head block. in the last line of get_latest_attesting_balance, lets say that the root we get by indexing latest_messages by the validator index i corresponds to the parent block of this head block. since head block will have slot number n , and its parent will have slot number n - 1, the assert statement at get_ancestor will throw",
        "created_at": "2019-07-19T23:46:42.978000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**cem_ozer**\nwhat am I missing?",
        "created_at": "2019-07-19T23:46:45.993000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_bridge_bot",
        "category": "general",
        "parent": "",
        "content": "**protolambda**\nyup, if the latest message is older than the root we are getting the balance for, the message should not be counted.",
        "created_at": "2019-07-19T23:58:39.304000+00:00",
        "attachments": null
    }
]
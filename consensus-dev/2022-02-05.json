[
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "\u003c@!291925846556540928\u003e Yesterday in the lounge (I think) I asked about being able to validate a proof of beacon chain on the execution layer.  You indicated that the beacon block hashes are aggregated, but IIUC that information is not (yet) available to the execution layer in any trustless way?",
        "created_at": "2022-02-05T07:43:53.018000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Do you know if there are plans to make that available to the execution layer?  Is it a requirement of withdraws?",
        "created_at": "2022-02-05T07:44:13.345000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "In the original proposal by Misha Kalinin \u003chttps://ethresear.ch/t/executable-beacon-chain/8271\u003e there was an item that was changing the semantics of the opcode `BLOCKHASH` so as to return beacon block roots. If I remember correctly the plan is still to include this in an early fork after the merge",
        "created_at": "2022-02-05T11:47:31.614000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Of course perhaps with a new opcode `BEACONBLOCKHASH` instead of breaking old contracts",
        "created_at": "2022-02-05T11:51:10.192000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Oh and finally, not, this is not a requirement for withrawals, at least not in the current proposal for withdrawals \u003chttps://github.com/ethereum/consensus-specs/pull/2759\u003e",
        "created_at": "2022-02-05T12:03:04.158000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "I think it natural to expose the `BEACON_STATE_ROOT` in the EVM for users and for withdrawal receipt  consumption\nI believe \u003c@!539495253418180618\u003e is operating with this in the draft EL EIP(s)  he's working on to complement the CL spec",
        "created_at": "2022-02-05T14:15:03.704000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "Not, within the beacon state root are two lists -- `block_roots` and `state_roots`. These lists are then merkle batched into `historical_roots` every 8192 slots",
        "created_at": "2022-02-05T14:16:27.875000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "thus through beacon_state_root, you have access to all historic state and block roots in an efficient proof structure",
        "created_at": "2022-02-05T14:16:50.115000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "and here is the `BeaconState` data structure with those fields\nhttps://github.com/ethereum/consensus-specs/blob/dev/specs/phase0/beacon-chain.md#beaconstate",
        "created_at": "2022-02-05T14:28:33.708000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Is this targeted at Shanghai (optimistically) or something \"down the road\"?",
        "created_at": "2022-02-05T18:00:23.177000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I think to be useful this would need to provide access to the last `n` state roots.  If it just gives the current, then only bots who can complete all of their operations within 12 seconds can actually use it.  You need the ability to prove data based on a \"recent but not immediate\" state root.",
        "created_at": "2022-02-05T18:04:15.429000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "related to this question, in the future when we require upgrades that touch both the EL and the CL, are we going to synchronize them into one fork or are we going to try to ship one and then the other? It was my understanding that Shanghai was going to be only for the EL",
        "created_at": "2022-02-05T22:44:35.190000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "likely need to synchronize when they touch both layers",
        "created_at": "2022-02-05T22:45:07.212000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "Yah, it would have to by default be from the prior slot (avoiding circular dependency). I do see the value of just writing it to state like  that old EL BLOCK_HASH to state EIP.",
        "created_at": "2022-02-05T22:46:12.117000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "Some amount of read and proof capability must be introduced with withdrawals",
        "created_at": "2022-02-05T22:46:26.880000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "I'm a shanghai withdrawal guy so.",
        "created_at": "2022-02-05T22:46:32.305000+00:00",
        "attachments": null
    }
]
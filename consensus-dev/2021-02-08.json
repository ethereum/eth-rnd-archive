[
    {
        "author": "kchau8761",
        "category": "general",
        "parent": "",
        "content": "think it has to do something with the version of py_ecc that gets pulled in for me,  related to my workaround in `setup.py` (removed the ==5.1.0 requirement). When I look in the venv files theres definitely no G2ProofOfPossession class in py_ecc, unlike the latest version of it on github.",
        "created_at": "2021-02-08T00:02:52.724000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I found it too that the versioning was very strict, last I tried it was milagro_bls giving that problem after upgrading to Python 3.9 which is orthogonal to py_ecc",
        "created_at": "2021-02-08T00:14:47.260000+00:00",
        "attachments": null
    },
    {
        "author": "kchau8761",
        "category": "general",
        "parent": "",
        "content": "\u003c@755590043632140352\u003e yup! I just updated to python 3.9, maybe I should try everything with a previous version",
        "created_at": "2021-02-08T00:15:55.076000+00:00",
        "attachments": null
    },
    {
        "author": "kchau8761",
        "category": "general",
        "parent": "",
        "content": "It'd be nice to get this working for the latest though, are you able to run the deposit contract tests?",
        "created_at": "2021-02-08T00:16:11.904000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "With 3.8  I didn't get a single problem",
        "created_at": "2021-02-08T00:16:48.478000+00:00",
        "attachments": null
    },
    {
        "author": "kchau8761",
        "category": "general",
        "parent": "",
        "content": "To get past the milagro_bls error I added an upgrade pip command to the make",
        "created_at": "2021-02-08T00:17:01.744000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I built it from source",
        "created_at": "2021-02-08T00:17:18.084000+00:00",
        "attachments": null
    },
    {
        "author": "kchau8761",
        "category": "general",
        "parent": "",
        "content": "K, I'll try 3.8",
        "created_at": "2021-02-08T00:17:33.446000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I just checked here in the \u003c#778633028451696680\u003e channel I had trouble in Dec 16, when upgraded to Python 3.9 required to pull a nightly rust and build milagro_bls and lru_dict from source",
        "created_at": "2021-02-08T00:26:53.932000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "But I never ran the deposit tests",
        "created_at": "2021-02-08T00:27:14.153000+00:00",
        "attachments": null
    },
    {
        "author": "kchau8761",
        "category": "general",
        "parent": "",
        "content": "Yeah, I had to use a nightly rust too, forgot to mention that",
        "created_at": "2021-02-08T00:28:04.990000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "With 3.8 pip installed cleanly",
        "created_at": "2021-02-08T00:28:27.411000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "But it looks that the problems you are seeing about versioning are the same I had. Eventually it required only those two built from source",
        "created_at": "2021-02-08T00:30:19.228000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Giving up on geth, I've tracked strict correlation of bad head votes with days of high eth 1 activity, I'm guessing we'll see a lot of people having trouble to keep up at the time of the merge or when running a local node becomes mandatory. It's not the constant use of resources, but the spikes that seem to lock my system just enough to delay block processing and therefore I end up attesting to the previous head. Switching to infura for now",
        "created_at": "2021-02-08T14:06:34.838000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "FWIW this is a Ryzen 5 3600 with 6 cores, 16Gb of RAM and a fast nvme.",
        "created_at": "2021-02-08T14:07:38.199000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Have you considered running eth1 client on a separate machine?",
        "created_at": "2021-02-08T14:11:06.402000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I have, and I may when I import a NUC, for the time being the only option here would be a  laptop that I need for work. But perhaps the hidden point is that at some point it was stated that anyone would be able to stake with home hardware like a normal laptop. I'm anxious to see what happens when the testnets start for the merge, but from what I see here I find it very unlikely. Bad votes went from 0/day/validator away from slot 0 at genesis to 12 currently",
        "created_at": "2021-02-08T14:16:01.579000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Also the correlation could be both ways so probably switching to infura won't help much. I'm guessing block producers are also being affected and that's why there are more blocks coming late when there's a lot of eth1 activity",
        "created_at": "2021-02-08T14:20:37.795000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I have only a tiny fraction of my bad votes being on blocks that I process right after 4 seconds. The vast majority is after 6, meaning they were actually late and not because my node was slow",
        "created_at": "2021-02-08T14:21:58.816000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Have you a measure of how much time does it take to process a block on avg?",
        "created_at": "2021-02-08T14:26:16.095000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "@nishant at prysm is currently benchmarking this cause there seems to be a lot of variation, the common block is processed in less than 100ms if I remember correctly, but slot zero takes a bit more in general and there are unexplained outliers",
        "created_at": "2021-02-08T14:28:29.126000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "\u003c@476250636548308992\u003e",
        "created_at": "2021-02-08T14:29:50.655000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "If a block is received at 6s into a slot there should be enough time to process it and send attestation to the wire",
        "created_at": "2021-02-08T14:30:05.824000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "No",
        "created_at": "2021-02-08T14:30:20.312000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "The specs ask to submit your attestation at 4 seconds",
        "created_at": "2021-02-08T14:30:38.142000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "The problem about bad head votes are the blocks that arrive between 4 seconds and 12. This will be solved by the fork choice fix",
        "created_at": "2021-02-08T14:31:40.419000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "But what it worries me is that there is a clear worse performance when there's large variations of eth price",
        "created_at": "2021-02-08T14:32:08.496000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Right. Now I am wondering how much time does it take to produce and disseminate a block.",
        "created_at": "2021-02-08T14:34:13.728000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "general",
        "parent": "",
        "content": "There are ways to reduce the outliers, but even with that and optimizing away all the bottlenecks 4 seconds will be quite tight when taking into eth1 into account",
        "created_at": "2021-02-08T14:44:38.208000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "It is also interesting how much time does it take to disseminate attestation aggregates. For instance, if 99.99% of aggregates are disseminated at 10s into a slot then probably network could be fine tuned and we can leave more room for proposing a block",
        "created_at": "2021-02-08T14:44:41.097000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Not sure if aggregates are supplied as part of eth2's events API, but if so that would give a basis for being able to calculate how long it takes for attestations to show up",
        "created_at": "2021-02-08T14:48:07.258000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Regarding eth1 network spikes and its impact on the beacon chain. Technically, full eth1 node is not required to run a validator at the moment, the problem is that there is no reliable alternative except for services. If eth1 node is a part of the infra it's better to run it on a separate machine to avoid resource competition between eth1 node (which is heavy resource consumer) and BN",
        "created_at": "2021-02-08T14:56:04.558000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I think the issue is that if currently on a local computer (and not a weak one) we are having trouble with the ETH1 engine, then services will also not be an option at the merge, surely network lag is worse than CPU hogs",
        "created_at": "2021-02-08T15:23:23.840000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Eth1 node running on the same machine as the beacon node impacts on the performance of the latter. This is the problem, right? Probably if you run eth1 node on a separate machine even if this machine is less powerful than the current one it will be enough for the use case that eth1 node is needed today, that is, reading the state of deposit contract. For the case of the merge we will likely have higher requirements to the eth1 engine performance than it is now and it will likely require powerful machine. This machine can be shared between several BNs. Why do you think services become not an option after the merge?",
        "created_at": "2021-02-08T16:20:13.053000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I am talking out of my #$%@#$, I am just guessing based on the highly speculative observation that a temporary lag due to a local CPU hog should be less than the lag due to network hops. So if currently these CPU hogs are causing nodes to missbehave, I suppose at the time of the merge, when we need current information about ETH1 to produce a block, that lag will be worse than the current CPU hogs",
        "created_at": "2021-02-08T16:23:24.037000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I do agree that a second system running geth may solve the local issue, but that makes the entry point to staking very different than what was expected originally (at least to me when I started reading about this)",
        "created_at": "2021-02-08T16:24:44.076000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "I see your concern and we will definitely have testnets to evaluate an impact of eth1 block production/execution on beacon chain progress. IMHO, we need more parameters to be measured to make correct conclusion on reasons behind these lags. It also could be the case that by the time of the merge there will be services providing eth1 block production/execution for those who wants to keep minimalistic infra and run VC/BN only.",
        "created_at": "2021-02-08T16:42:02.876000+00:00",
        "attachments": null
    }
]
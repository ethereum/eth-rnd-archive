[
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "We have already implemented that suggestion I left there about checking high participation in N-2, and there's a circuit break on justification. \n\n\u003c@425572898787426305\u003e what I mean about timings is this:\n\nBetween 0-4: block arrival and processing time, this interval is currently shorter than it should be, or many believe so.\nBetween 4-8: here aggregators need to aggregate. Attestation propagation here is not that important as there's plenty of time, but actual aggregation can take up to 3-4 seconds on lower end hardware (so those aggregators are garbage anyway) and up to 2 seconds on a typical NUC, so this part of the slot can me made shorter but not by much\nBetween 8-12: important tasks here are attestation propagation and running forkchoice. The problem of making this part shorter is that you can cause a split view if some validators see the aggregates on time and others don't. The next proposer may choose to incorrectly reorg a block",
        "created_at": "2023-06-01T09:40:39.701000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Note that between 4 and 8 seconds you have the entire generation _and_ aggregation of attestations in the case of a skipped slot.",
        "created_at": "2023-06-01T09:46:03.233000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "I see. Fork choice run is during 11-12s, right? So, reduction by a second brings us to the situation when the network will have to be capable of disseminating aggregates in 2s, which sounds quite restrictive.",
        "created_at": "2023-06-01T10:00:07.892000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Forkchoice is run at different times, prysm does it at 10s and then 12 again. And attestation processing needs to be done before",
        "created_at": "2023-06-01T10:03:55.734000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "There's no difference here in skipped or not: most clients generate the attestations anyway at 4 seconds",
        "created_at": "2023-06-01T10:04:53.350000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Isn't that against spec?",
        "created_at": "2023-06-01T10:05:51.028000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "It is",
        "created_at": "2023-06-01T10:06:23.263000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "There were other technical problems with submitting as soon as the block is seen. We should review this, but has been low priority. Prysm has a non default flag to do it",
        "created_at": "2023-06-01T10:07:44.722000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "\"Between 0-4: block arrival and processing time, this interval is currently shorter than it should be, or many believe so.\" isn't this a side-effect of the MEV-boost design?  Building blocks locally takes \u003c1s so that gives lots of time for propagation and processing.  Or is processing time for post-merge blocks taking longer than I expect?  Any numbers on this?",
        "created_at": "2023-06-01T10:08:55.465000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I believe so, I think in a world without mev boost we wouldn't have this discussion until 4844 at least",
        "created_at": "2023-06-01T10:11:07.442000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "The problem with attempting to change the spec to fit the current MEV-boost reality is that I suspect they'll just take any additional time in the slot for themselves.  There is a lot of room in the current relay code for optimizations, until that happens, the relay infrastructure is running on top-end hardware, and it is shown that it is bumping up against limits, I wouldn't want to see the spec being changed to accommodate the current implementation inadequacies.",
        "created_at": "2023-06-01T10:15:16.267000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Seconds 8-12 are, in my opinion, the more interesting ones.  By 8s the aggregation process should have completed, and obtaining and propagating the aggregates should be very quick due to their relatively small numbers.  Again, I don't have numbers but I would assume that fork choice is \u003c1s, so that time _could_ be slimmed down by 1-2 seconds.",
        "created_at": "2023-06-01T10:17:12.492000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "So, 2s of boundary on latency is already assumed by an optimistic case. What would be difference if FC run at 11 and then 12?",
        "created_at": "2023-06-01T10:21:24.633000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "very much agreed on this. That the protocol likely should not conform to mev-boost but that mev-boost should conform to the protocol",
        "created_at": "2023-06-01T13:01:15.939000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "this conversation was kicked off due to concern around gossip times of 4844 large data blocks. which given that's within the protocol, is a reason to contemplate the associated timings",
        "created_at": "2023-06-01T13:02:22.513000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Absolutely, but I guess that part of the question is which latencies should be considered: those in the base protocol, or those with MEV-boost?  Obviously the latter has a lot higher latency due to the back-and-forth.\n\n(Did we end up decoupling blobs from blocks on the p2p and API layer?  If so that makes this easier, as the impact of MEV-boost will be less.  Otherwise, it's likely to be hideous with the back-and-forth required.)",
        "created_at": "2023-06-01T13:33:09.656000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "blobs and blocks are decoupled and the blobs + block will be sent by a relay to the p2p before handing it to the proposing node (if at all)",
        "created_at": "2023-06-01T13:53:39.245000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "but yeah, the back and forth isn't great.\nsome relays are doing bonded \"optimistic\" relaying where they don't do full vlaidation of the payloads from the builder which could in this case also include blob transmission (with the builder to send the blobs upon selection). but optimistic is it's own can of worms",
        "created_at": "2023-06-01T13:54:32.020000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "Updated issue reflecting Deneb CL spec intentions\nhttps://github.com/ethereum/consensus-specs/issues/3182",
        "created_at": "2023-06-01T16:37:36.470000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Whatever happened to the PR to remove the whole ETH1 voting mess?  \u003c@425572898787426305\u003e was that one of yours?",
        "created_at": "2023-06-01T16:48:06.667000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "( https://eips.ethereum.org/EIPS/eip-6110 )",
        "created_at": "2023-06-01T16:56:27.979000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "I don't think it has high priority; checkpointz has EIP-4881 support now, as do many clients. EIP-6110 would still be a nice cleanup though",
        "created_at": "2023-06-01T16:57:35.410000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "We're considering it for inclusion into the hardfork next to Deneb, the spec can be found here:\nhttps://github.com/ethereum/consensus-specs/tree/dev/specs/_features/eip6110\nhttp://eips.ethereum.org/EIPS/eip-6110",
        "created_at": "2023-06-01T17:26:01.528000+00:00",
        "attachments": null
    }
]
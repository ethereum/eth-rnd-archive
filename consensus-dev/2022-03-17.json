[
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "is there any good way to check/validate ETH1 withdrawal credentials before sending a TX to the deposit contract?",
        "created_at": "2022-03-17T14:40:05.458000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "specifically, eth1 pubkey, not BLS",
        "created_at": "2022-03-17T14:40:18.508000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "of is there a good channel to ask that? ðŸ˜„",
        "created_at": "2022-03-17T14:41:54.787000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "You can check the deposit-data.json? Otherwise, it should also just be part of the hex data (which e.g. MetaMask will show, or your Ledger will show if you enable \"show debug data\").",
        "created_at": "2022-03-17T14:45:25.574000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "yeah, I can check it, just want to see if there is a tool to enter both the pubkey and the withdrawal credentials and give me \"OK\"\n\nI wanted to cross-check ðŸ™‚",
        "created_at": "2022-03-17T14:46:09.464000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "The withdrawal credentials are also part of the data root, so there is a check there",
        "created_at": "2022-03-17T14:46:11.392000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "OK for what?",
        "created_at": "2022-03-17T14:46:33.209000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "that these withdrawal credentials correspond to this pubkey correctly basically, and if I have a privkey for that I will be able to withdraw later",
        "created_at": "2022-03-17T14:47:26.346000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "I don't quite follow. The withdrawal credentials are not related to the pubkey at all if you are _not_ using BLS keys",
        "created_at": "2022-03-17T14:48:18.556000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "ah, I read the wrong spec version",
        "created_at": "2022-03-17T14:49:38.114000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "https://github.com/ethereum/consensus-specs/blob/dev/specs/phase0/validator.md#eth1_address_withdrawal_prefix that is the current one, right?",
        "created_at": "2022-03-17T14:50:46.558000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "`dev` branch",
        "created_at": "2022-03-17T14:50:58.612000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "I don't think anything has changed there for a long time, but that looks right to me",
        "created_at": "2022-03-17T14:52:12.891000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "Anyway, the deposit contract rejects most invalid transactions. The only \"wrong\" things it allows (as far as I know) is:\n1. Sending a deposit with the wrong fork id (happened a few times with Pyrmont \u003c-\u003e Prater)\n2. Sending a deposit for a different amount than you are actually transferring. For example, you say you will deposit 32 ETH (part of calldata), but you actually only transfer only 1 ETH.\n\nFrom what I can tell (based on beaconcha.in) there has only ever been one invalid deposit.",
        "created_at": "2022-03-17T14:58:45.906000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "You cannot check this without giving the seed to that hypothetical tool: the validator public key has nothing to do with the withdrawal credentials, those are two public keys (one is hashed) of two different private keys. Both private keys are derived from the same seed",
        "created_at": "2022-03-17T22:48:59.422000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "They _can_ be derived from the same seed, but in many cases are not. If people want to run with eth1 withdrawal credentials (e.g. an address generated by a hw wallet), I at least recommend they use a newly generated (different) mnemonic to derive the validator keys.",
        "created_at": "2022-03-17T23:04:15.286000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I understand, the point I'm making is that there is no tool that can possibly validate the input of validator public key, withrawal credentials and give an Ok for answer, before the deposit",
        "created_at": "2022-03-17T23:05:40.785000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Even after depositing, with that information you can only verify that the withrawal credentials corresponds to the given validator public key, but to verify that you hold the private key to withdraw you will need to provide more information like signing a message with that key and decrypting it with the public key, and then checking that the hash of the public key corresponds to the withrawal credentials",
        "created_at": "2022-03-17T23:09:20.311000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Or simply regenerating the public key and hashing it",
        "created_at": "2022-03-17T23:09:54.234000+00:00",
        "attachments": null
    }
]
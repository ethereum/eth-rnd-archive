[
    {
        "author": "etan_status",
        "category": "general",
        "parent": "",
        "content": "Transactions are sent as RLP encoded strings, so no conversion to them is done in CL when using engine",
        "created_at": "2023-01-12T00:52:16.989000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "general",
        "parent": "",
        "content": "For Withdrawals, CL currently converts from Gwei to Wei when putting them into engine",
        "created_at": "2023-01-12T00:52:38.856000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "general",
        "parent": "",
        "content": "(and back when getting back out)",
        "created_at": "2023-01-12T00:52:44.209000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "general",
        "parent": "",
        "content": "Yep so we'd be moving some complexity (a mix of wei and gwei) from out of the CL into the engine API and the EL.",
        "created_at": "2023-01-12T01:00:38.905000+00:00",
        "attachments": null
    },
    {
        "author": "p0xky",
        "category": "general",
        "parent": "",
        "content": "Hey ðŸ‘‹\nI was wondering if it is possible for an exited validator to reenter the activation queue later on using the same validator key/index?",
        "created_at": "2023-01-12T10:30:13.944000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "No.",
        "created_at": "2023-01-12T10:31:11.030000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Yes, which also means that the minimal change to support equal roots either involves the CL converting to wei, then the EL converting back to gwei to deserialize and hash, or changes in both layers",
        "created_at": "2023-01-12T12:12:11.299000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Removing conversion shouldn't be a big problem, right? we can test it in Hive to be sure that it works for all clients",
        "created_at": "2023-01-12T12:14:06.149000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "None of the changes in any of the combinations I've seen proposed are a big problem. Is just that they are not trivial, bug prone, need to be tested and most importantly of all: need to be designed/decided. We all know how long it takes to decide on something here, and I would argue that going back to a design board at this stage of the game for Shanghai only if we found a security concern on Shanghai as currently specified",
        "created_at": "2023-01-12T12:19:50.863000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Fair point",
        "created_at": "2023-01-12T13:25:57.762000+00:00",
        "attachments": null
    },
    {
        "author": "yperbasis",
        "category": "general",
        "parent": "",
        "content": "The change from Wei to GWei on the EL side is trivial. If we don't do it now (in Shanghai), we'll likely never be able to do it later because it'll be enshrined in many tools.",
        "created_at": "2023-01-12T16:17:45.083000+00:00",
        "attachments": null
    },
    {
        "author": "yperbasis",
        "category": "general",
        "parent": "",
        "content": "Using GWei everywhere sounds like a bug fix to me rather than a major re-design.",
        "created_at": "2023-01-12T16:19:09.333000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I fully support your proposal to change Wei to Gwei on both sides, this is infact trivial on our side and from reading geth's code it should be trivial there as well. What I don't want to have is SSZ in this fork",
        "created_at": "2023-01-12T16:48:17.837000+00:00",
        "attachments": null
    },
    {
        "author": "yperbasis",
        "category": "general",
        "parent": "",
        "content": "Right, I agree that SSZ for withdrawals in Shanghai is more challenging. To my mind just switching EL to Gwei for withdrawals in Shanghai is a good compromise. Provided the switch to GWei, switching withdrawal root to SSZ in EL will be a relatively self-contained change which we'll be able to do in Cancun.",
        "created_at": "2023-01-12T17:34:57.749000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "please check out my last message in \u003c#745077610685661265\u003e  where i've dropped the spec updates for the `Gwei` change",
        "created_at": "2023-01-12T18:03:00.702000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "i've also made a pass at the \"full\" set of changes that includes the complete SSZ serialization at the EL in EIP-4895 as a patch on top of the patch to use `Gwei` at the EL: https://github.com/ralexstokes/EIPs/pull/1",
        "created_at": "2023-01-12T18:32:26.209000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "i'll drop here for reference but i strongly suggest we don't seriously pursue this route as it is too late in the game for such a change to shanghai",
        "created_at": "2023-01-12T18:33:08.762000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "I'm just thinking about submitting bls to execution changes and pools and re-submitting...\nI'm not sure I can find a definitive answer for 'how long should i wait before resubmitting, if i haven't seen my withdrawal key change'\nFor example, when we submit and it gets gossiped out, assuming pools get congested it's possible mine doesn't actually end up in a pool for block production, and at what point should i be submitting again...\nI definitely think an hour is too short as a guide, if people signed a bls change and pushed and its not done, can i just re-submit that a day later?\nThere'll be a point afaik where gossip will actually just filter it as a duplicate message? so clearly that's too soon...\nRandom background - if the pool on a BN is 10k entries, then that'll be filled very quickly, and at what point should i consider taking further action...  one mitigation may be thinking about that pool size being quite large initially... but the same problem potentially occurs when nodes restart and lose their pool...",
        "created_at": "2023-01-12T21:47:25.976000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Yeah, there's no simple answer to this one.  I think that the answer to this depends a fair bit on exactly how the beacon nodes will handle the receipt of these operations:\n - are they purely stored in memory, or stored on disk and so persistent on reboots?\n - does the queue have a maximum size?  If so, what is ejected when an additional operation arrives?\n\nNote that although the pool of eligible operations may start quite large it's likely to shrink down pretty quickly, so this is likely to be one of those situations that will resolve itself relatively quickly anyway.  But it is likely to be a frustrating user experience for many who want to see their validator with updated credentials as soon as the hard fork activates.",
        "created_at": "2023-01-12T22:14:16.082000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "our queue size is pretty small, but probably going to make it large-ish",
        "created_at": "2023-01-12T22:17:32.823000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "We have an unbound queue, no duplications should be more than fine. And we do not persist the pool across reboots. If something drastic happens and all prysm nodes go offline once before all pools are exhausted, then users will need to resubmit. I feel that going though the problem of persisting the pool on disk is useless complication",
        "created_at": "2023-01-12T22:29:31.983000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "wow i'm not sure i could do unbounded, but i can probalby make it pretty big",
        "created_at": "2023-01-12T22:31:10.430000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "preferencing your own validators over others in the queue i guess may be an optimisation",
        "created_at": "2023-01-12T22:32:12.529000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "It's not so much if all nodes go offline, but for each node that does restart without a persistent pool it opens up another opportunity for hackers to broadcast a malicious operation that sits in the queue waiting for that node to propose (or broadcast to other nodes that restart).\n\nOf course, if the attacker's operation gets in first that could be a Good Thing.  No simple solution.",
        "created_at": "2023-01-12T22:32:30.456000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "it'll be interesting to see what happens IRL when capella changes, and if the topic explodes",
        "created_at": "2023-01-12T22:33:38.549000+00:00",
        "attachments": null
    },
    {
        "author": ".paulharris",
        "category": "general",
        "parent": "",
        "content": "roughly 310k 0x00 withdrawal creds on mainnet as it turns out",
        "created_at": "2023-01-12T23:18:40.791000+00:00",
        "attachments": null
    }
]
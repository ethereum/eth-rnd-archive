[
    {
        "author": "huntingisland",
        "category": "general",
        "parent": "",
        "content": "I want to reiterate how critical it is for Ethereum to make concrete plans NOW to sunset PoW. The world isnâ€™t waiting around for us to slowly get around to stop trashing the environment. We need to make this happen ASAP!",
        "created_at": "2021-02-25T12:01:21.156000+00:00",
        "attachments": null
    },
    {
        "author": "huntingisland",
        "category": "general",
        "parent": "",
        "content": "https://mobile.twitter.com/RaoulGMI/status/1364896784355627011",
        "created_at": "2021-02-25T12:01:35.467000+00:00",
        "attachments": null
    },
    {
        "author": "huntingisland",
        "category": "general",
        "parent": "",
        "content": "This message isnâ€™t going to go away. Ethereum needs to have concrete dates to stop trashing the environment NOW or we are going to get eviscerated by the public conversation that is coming. This is URGENT folks.",
        "created_at": "2021-02-25T12:03:28.742000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "general",
        "parent": "",
        "content": "\u003c@!438324482306998273\u003e thanks for the call of action, but please don't use caps or go off-topic. We're well aware of the situation and actively building the replacement.",
        "created_at": "2021-02-25T13:00:39.279000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "eth2 call in 20 minutes",
        "created_at": "2021-02-25T13:42:05.945000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "we'll be discussion merge specs today and there are people working on the merge daily",
        "created_at": "2021-02-25T13:42:29.672000+00:00",
        "attachments": null
    },
    {
        "author": "coldsnap2695",
        "category": "general",
        "parent": "",
        "content": "Livestream link?",
        "created_at": "2021-02-25T13:49:52.035000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "one mnute",
        "created_at": "2021-02-25T13:50:51.788000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I wouldn't mind a link as well, assuming you have room for one more.",
        "created_at": "2021-02-25T13:52:12.494000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "https://youtu.be/yrDVhoTg5XU",
        "created_at": "2021-02-25T14:00:32.166000+00:00",
        "attachments": null
    },
    {
        "author": "trent_vanepps",
        "category": "general",
        "parent": "",
        "content": "I've heard it mentioned a few times, can anyone point me to discussion on capping the # of validators?",
        "created_at": "2021-02-25T14:35:30.126000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "https://github.com/ethereum/eth2.0-specs/issues/2137",
        "created_at": "2021-02-25T14:36:07.911000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "Call notes https://hackmd.io/@benjaminion/B1BZs7SMO",
        "created_at": "2021-02-25T14:59:01.338000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "ETH2 currently trails ETH1 right?  That is, ETH2 is validating blocks from `n` minutes ago or something?",
        "created_at": "2021-02-25T14:59:52.605000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "If so, what is `n`?",
        "created_at": "2021-02-25T15:00:09.652000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "2048 Eth1 blocks",
        "created_at": "2021-02-25T15:00:53.636000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Hypothetically, what happens if there is a 2048 block ETH1 reorg?",
        "created_at": "2021-02-25T15:01:07.848000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "(I'm aware of how unlikely that is)",
        "created_at": "2021-02-25T15:01:14.652000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "Ethereum is dead if that can happen. The 2048 is not so much about fork resistance as allowing time for devs to fix any issues if something bad happens on Eth1 or to the deposit contract.",
        "created_at": "2021-02-25T15:02:18.556000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "In theory, if miners are angry *enough* about PoS cutting out their business they could (in theory) coordinate such an attack.  It would not be profitable for them, more of a ðŸ–• on the way out the door.",
        "created_at": "2021-02-25T15:03:32.974000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "To answer your question - there is a separate voting process in Eth2 on Eth1 blocks. If clients disagree, because they are following different Eth1 chains, then no new validators can be onboarded.",
        "created_at": "2021-02-25T15:03:55.976000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I wonder if, as an iterative step toward The Merge, we could introduce finality into ETH1 clients where they will refuse to reorg past ETH2 finality.  This would require all ETH1 clients to connect to ETH2 clients, which would introduce the bi-directional communication we'll need for The Merge, and it would protect us from a particular class of miner attacks around The Merge and take some amount of power away from miners to disrupt the chain.",
        "created_at": "2021-02-25T15:05:34.876000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "You could probably use it to spin up some costless validators too (same as a double-spend).",
        "created_at": "2021-02-25T15:05:46.601000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "In particular I like the idea of getting the bi-directional connection up and running before it is on the hot path (The Merge).",
        "created_at": "2021-02-25T15:06:53.889000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "And this gives ETH1 clients *something* to use that connection for.",
        "created_at": "2021-02-25T15:07:16.892000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "This used to be in the plan. But iirc was dropped as it is a significant engineering project, and it was thought more expedient to put the resources into accelerating the Merge. My recollection on this is hazy, though.",
        "created_at": "2021-02-25T15:07:39.402000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Hmm, is there extra engineering required for this plan?  It feels like it just breaks up engineering work that already needs to be done?",
        "created_at": "2021-02-25T15:08:04.666000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "ETH1 needs to talk to ETH2 for The Merge, so that work has to be done either way and that feels like the bulk of the work here.",
        "created_at": "2021-02-25T15:08:28.388000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Adding logic to the fork choice rule of ETH1 clients *feels* fairly simple, but maybe I'm missing something?",
        "created_at": "2021-02-25T15:08:58.713000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "\u003e ETH1 needs to talk to ETH2 for The Merge, so that work has to be done either way and that feels like the bulk of the work here.\nNot really. The bridge would need at least BLS precompiles in Eth1 - an Eth2 light client - as well as fork choice changes. The beauty of the executable beacon chain is that it side-steps all that.",
        "created_at": "2021-02-25T15:09:51.080000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Oh, The Merge doesn't require ETH1 clients to implement BLS precompiles?  I had heard otherwise.",
        "created_at": "2021-02-25T15:10:27.039000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Why is an ETH2 light client required?",
        "created_at": "2021-02-25T15:11:04.245000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Is this information incorrect?  https://discord.com/channels/595666850260713488/800773302213279784/807258676900790292",
        "created_at": "2021-02-25T15:11:42.705000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "It would be required if shards shipped before the merge to allow eth1 apps e.g. rollups to use shards as the data layer",
        "created_at": "2021-02-25T15:13:11.734000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "\u003e Why is an ETH2 light client required?\nThis is how an Eth1 node learns about the state of Eth2, and can prove things about it. It needs to be able to verify BLS signatures to do so. Maybe not in the EVM, but certainly in the client. After the merge, they are tightly coupled, and no light client is needed on the Eth1 side.",
        "created_at": "2021-02-25T15:13:17.620000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "\u003e Oh, The Merge doesn't require ETH1 clients to implement BLS precompiles?  I had heard otherwise.\nNo, the Merge itself does not. As per Mikhail, making shards visible in Eth1 does require Eth1 to know about BLS signatures.",
        "created_at": "2021-02-25T15:14:26.762000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Perhaps I'm misunderstanding The Merge.  I thought the plan was that as-of The Merge, everyone would need to run both an ETH1 client and an ETH2 client.  Is this incorrect?",
        "created_at": "2021-02-25T15:14:31.817000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "\u003e as-of The Merge, everyone would need to run both an ETH1 client and an ETH2 client.  Is this incorrect?\nThis is correct. As I said, at that point they are tightly coupled. Pre Merge, however, this is not the case.",
        "created_at": "2021-02-25T15:15:32.406000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I'm arguing that we should try to break apart The Merge into more iterative steps.  It feels like we could introduce the coupling in a limited capacity by having ETH1 get finality from ETH2 prior to the merge, and it wouldn't create *new work*.",
        "created_at": "2021-02-25T15:16:30.383000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "I would say that in a different way. After the merge there will be an upgraded ethereum client which is connected to both, the consensus (beacon chain) and application (mainnet) networks. Depending on the implementation it may be two pieces of software which were previously called eth2-client and eth1-engine or a single piece of software connected to both chains",
        "created_at": "2021-02-25T15:17:01.783000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "That aligns with my understanding.",
        "created_at": "2021-02-25T15:17:27.900000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The key component here is that at the point of The Merge, ETH1 clients need to communicate with a PoS client in some way (whether that is internal due to having one baked in, or via network connection to a PoS validator).",
        "created_at": "2021-02-25T15:18:23.563000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "So between now and The Merge, ETH1 clients need to add that functionality.",
        "created_at": "2021-02-25T15:18:34.581000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "It isn't necessary to *wait* to add that functionality until The Merge itself, we could add that functionality before The Merge so it is done and tested in production when The Merge happens.",
        "created_at": "2021-02-25T15:19:07.841000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "At the point of merge the responsibility of keeping the head of the chain is moved to the consensus layer. I.e. beacon chain client will keep track of blocks and feed them to the application client. It does not imply bi-directional communication",
        "created_at": "2021-02-25T15:21:35.151000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "general",
        "parent": "",
        "content": "\u003e  it wouldn't create new work.\nBut it would: (a) building an Eth2 light client into Eth1 clients, and (b) modifying Eth1's fork choice rule, with all the testing and governance around that. Neither of these are needed after the Merge.",
        "created_at": "2021-02-25T15:21:43.451000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The fork choice rule changes I agree with.  Can you help me better understand the need for an ETH2 light client that isn't necessary with The Merge?",
        "created_at": "2021-02-25T15:22:25.082000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Right, and I think we can't rely on security assumptions of light clients here, it would rather require the full client run by miners",
        "created_at": "2021-02-25T15:22:44.073000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "You mean the light client on Eth1 chain or ETH2 light client in general?",
        "created_at": "2021-02-25T15:24:14.276000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "What you just described sounds bi-directional to me?  The application client will receive blocks from the beacon chain (consensus =\u003e application) and the application will will tell the beacon about execution results (application =\u003e consensus).",
        "created_at": "2021-02-25T15:24:15.826000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Whatever Benjaminion is talking about.  ðŸ™‚  I must be missing some core component here because in my mental model of The Merge, everyone runs Geth/Nethermind/OpenEthereum/Besu + Teku/Lighthouse/Prysm/Nimbus client and they are connected and talk to each other.",
        "created_at": "2021-02-25T15:25:50.683000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "(assuming no new application layer or consensus layer clients are authored and no one authors a combined one by The Merge)",
        "created_at": "2021-02-25T15:26:12.848000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Right, but the communication is initiate by the consensus layer because application payload becomes a part of beacon block. Application layer won't be able to initiate communication with the consensus one as it is not needed",
        "created_at": "2021-02-25T15:27:51.147000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I'm also assuming (and maybe this is incorrect) that the connection between application layer and consensus layer clients will be trusted as-of The Merge, similar to how it is today where the consensus layer client \"trusts\" the data it gets from the JSON-RPC calls it makes to the application layer client.",
        "created_at": "2021-02-25T15:27:59.573000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Hmm, so as of The Merge, the application layer client disconnects from the internet and just processes whatever the consensus layer client asks it to (and updates state accordingly)?",
        "created_at": "2021-02-25T15:29:07.901000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Let's say for now that it will be disconnected from block gossip only. Not from the entire network stack. For instance, transaction pool remains unchanged, application state sync is the responsibility of the application client as well and probably (yet we don't know for sure) chain history as well. Consensus client will be responsible for pointing to the head of the chain and keeping application layer updated with it",
        "created_at": "2021-02-25T15:31:21.030000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Consensus Client =\u003e Application Client: \"Give me what you think should be the next block.\"\nApplication Client =\u003e Consensus Client: \"Here you go.\"\n\nConsensus Client =\u003e Application Client: \"Execute this block and tell me the results (state root, receipt root).\"\nApplication Client =\u003e Consensus Client: \"Done, here you go!\"\n\nConsensus Client =\u003e Application Client: \"This block is the new head, update your database accordingly.\"\nApplication Client =\u003e Consensus Client: \"OK.\"",
        "created_at": "2021-02-25T15:31:21.124000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "(updated my sample conversation above)",
        "created_at": "2021-02-25T15:32:46.594000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "That looks accurate to me. I was also preparing my version while you were updating yours ðŸ˜† \nConsensus =\u003e Gimme new payload with all the transactions that you think worth including\nApplication \u003c= ApplicationPayload\nConsensus =\u003e Insert this new block into your application chain and verify the state root is correct\nApplication \u003c= False/True\nConsensus =\u003e This is new head\nApplication \u003c= Ack\nConsensus =\u003e This block is finalised\nApplication \u003c= Ack",
        "created_at": "2021-02-25T15:35:14.169000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Thanks!  I understand much better now I think.",
        "created_at": "2021-02-25T15:35:51.623000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Side note: We should *not* be using the existing JSON-RPC server for this.",
        "created_at": "2021-02-25T15:36:00.438000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Actually, the consensus part heavily depends on the first two. The last two are more implementation and UX specific",
        "created_at": "2021-02-25T15:36:09.408000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Since this is a *highly* trusted endpoint, it should sit on a different port from the current 8545 endpoint so users can firewall and bind appropriately.",
        "created_at": "2021-02-25T15:36:24.446000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "I agree with that! It should be possible to secure it separately than user layer JSON-RPC",
        "created_at": "2021-02-25T15:37:02.207000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Soo... circling back to my proposal, could we have an iterative step between now and The Merge where:\n1. New RPC endpoint is served by application client.\n2. Application client accepts finalized block hashes over that channel.\n3. Application client updates fork choice rule such that it refuses to reorg past the finalized block it received.",
        "created_at": "2021-02-25T15:39:08.542000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "(1) is necessary for The Merge.\n(2) it sounds like is technically optional for The Merge but likely to be included in The Merge.\n(3) would be extra work (but I suspect pretty simple)",
        "created_at": "2021-02-25T15:39:46.644000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Let's get back to it now. One of the proposals for the merge was two-step transition. After the first step block production is kept by miners while beacon chain validators secures the chain by mandating that valid chain includes the most recent finalized block; i.e. this is the stage when validators provide safety while miners provide liveness to the chain and get rewards for this job. \n\nThe second step is switching block production to validators. The nice part of this plan is that during switching off the miners there will be no ability for them to attack the network. The downside is the requirement to run the beacon chain client for every participant in the network and increased timeline of the whole transition. And then the question, if the amount of work (research, engineering, community, etc) to deliver the first step is near the same to deliver the merge, shouldn't we rather go straight to the end goal?",
        "created_at": "2021-02-25T15:49:04.559000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "\u003e The downside is the requirement to run the beacon chain client for every participant in the network and increased timeline of the whole transition.\nThis is true post Merge right?  We would just be introducing the requirement a bit earlier.",
        "created_at": "2021-02-25T15:50:36.516000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "\u003e if the amount of work (research, engineering, community, etc) to deliver the first step is near the same to deliver the merge, shouldn't we rather go straight to the end goal?\nNot necessarily, because there is significant value in iterative small steps that are tested in production one at a time.",
        "created_at": "2021-02-25T15:51:03.651000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Also, I *suspect* that the amount of work required for step 1 would be notably smaller than the amount of work required for step 2.  Especially if we have a 2048 block follow distance.",
        "created_at": "2021-02-25T15:51:47.142000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "We could also have the follow distance decrease to say 5 blocks (or maybe even 0 blocks) over the course of 6 months so that if there *was* a problem we might be able to notice it on a subset of the network rather than the whole network at once.",
        "created_at": "2021-02-25T15:53:02.269000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "If we have 2048 follow distance then it won't be of any security source for apps. Imagine, how you're waiting 2048 blocks (or even more if current eth1 data poll algorithm stays unchanged) to charge your balance. It would start working if the distance is reduced to something like 32 or 16 blocks",
        "created_at": "2021-02-25T15:54:53.447000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Of course, the distance may be 2048 at the beginning and then gradually decreased to 32",
        "created_at": "2021-02-25T15:55:45.759000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "But to making that work requires changing of the eth1 data poll algorithm, otherwise, there is no way to reduce the minimal distance to *finality* (not the follow distance), the distance to finality is what matter for the apps and services I guess",
        "created_at": "2021-02-25T15:58:26.654000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Is this is what you have in mind? Or anything more granular?\n1) Make the mainnet respect beacon chain finality; no gain for the mainnet (as distance is too high); requirements: run the full beacon node alongside ethereum mainnet node\n2) Reduce follow distance to 16 and minimal finality distance to 32; mainnet is secured by the beacon chain; requirements: beacon chain changes (eth1 poll)\n3) Merge",
        "created_at": "2021-02-25T16:01:40.604000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "It's primary purpose would be to iterate on The Merge instead of doing it all in one big push.\nIt's secondary purpose would be to protect against a malicious miner attack that wrecks PoS before it launches.",
        "created_at": "2021-02-25T16:03:38.901000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "What do you mean by \"eth1 poll\"?",
        "created_at": "2021-02-25T16:04:12.218000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Generally yes, this is what is floating around in my head right now.",
        "created_at": "2021-02-25T16:04:23.767000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "eth1 data voting mechanism, when proposer vote for a portion of eth1 data including deposit root and count and eth1 block hash",
        "created_at": "2021-02-25T16:05:27.938000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "That eth1 poll change is required if we change the follow distance at all, or only if the follow distance gets too close to head?",
        "created_at": "2021-02-25T16:07:44.598000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "There are two parameter actually, `ETH1_FOLLOW_DISTANCE` and `EPOCHS_PER_ETH1_VOTING_PERIOD`. We would need to reduce both to reduce the delay between the production of the block and its finalised state. If we reduce `EPOCHS_PER_ETH1_VOTING_PERIOD` to something like `4` (`128` slots) with the current voting algorithm the whole voting mechanism starts to be pretty insecure under `2/3` honest majority assumption. Hence the change of the voting algorithm to reduce the distance even lower. This analysis is provided here with alternative voting algorithms https://ethresear.ch/t/on-the-way-to-eth1-finality/7041",
        "created_at": "2021-02-25T16:21:15.870000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "you would need to change the eth2 fork choice to respect correct eth1data voting",
        "created_at": "2021-02-25T16:22:12.593000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "and you  get the entirety of the validator set weighing in each epoch",
        "created_at": "2021-02-25T16:22:24.801000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "right, it's not a small change definitely",
        "created_at": "2021-02-25T16:22:43.684000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "right now, it is proposer drive but the proposer set over voting period is large so sampling is good",
        "created_at": "2021-02-25T16:22:45.810000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "right. interestingly, one that we'd want to do with the merge though!",
        "created_at": "2021-02-25T16:22:58.316000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "if we still use eth1data and do a 1 slot vote",
        "created_at": "2021-02-25T16:23:07.534000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "How low can we take it without having to do major changes to ETH2?",
        "created_at": "2021-02-25T16:23:46.995000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Right, but that's gonna be easier because Eth1Data is derived form the application state which becomes deterministic after the merge",
        "created_at": "2021-02-25T16:24:07.193000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Oh, if it is a change that is required for The Merge anyway then I'm not opposed to including it.",
        "created_at": "2021-02-25T16:24:14.524000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "probably 4 epochs. looks like sampling a committee which is reasonable",
        "created_at": "2021-02-25T16:24:18.577000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "but 4 epochs doesn't look great even then. a multiple on that is better",
        "created_at": "2021-02-25T16:24:40.147000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "For the sake of achieving my goals, I would be fine with lowering it only to 5 epochs or something safe.",
        "created_at": "2021-02-25T16:24:42.140000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "actually it's a 50% threshold",
        "created_at": "2021-02-25T16:24:55.436000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "instead of 2/3 commitee vote",
        "created_at": "2021-02-25T16:25:03.679000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "afk",
        "created_at": "2021-02-25T16:25:05.062000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The idea is to just exercise ETH1/ETH2 connection prior to The Merge.",
        "created_at": "2021-02-25T16:25:10.390000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "And also give us some *mild* protection against miners around The Merge. (this is a pretty minor concern for me, but I prefer caution when I see it as easy).",
        "created_at": "2021-02-25T16:25:37.541000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Isn't it a problem of introducing additional responsibilities to client devs, users, miners, etc without any gain for them?",
        "created_at": "2021-02-25T16:26:30.427000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "This is reasonable and one of the way of doing the thing. The problem is that it will highly likely delay the merge",
        "created_at": "2021-02-25T16:27:19.369000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I think the value it provides everyone is risk reduction.",
        "created_at": "2021-02-25T16:27:52.655000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "My past experience tells me that a large monolithic change is more risky than a series of smaller changes that achieves the same end result.  Thus, in an effort to reduce risk for users I would *rather* take the iterative path over the all-at-once path.",
        "created_at": "2021-02-25T16:28:32.092000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "As an example of how this could go wrong, we have 4 ETH1 clients and 4 ETH2 clients.  Any one of them could have a bug in any individual piece of code.  If we release small chunks of that code at a time and start exercising them, a bug may pop up in one or two of the clients that would cause them to fall out of sync while everyone else remained in sync.  If we release a dozen changes at once, then we could see a different bug crop up in each of the clients causing everyone to fall out of sync from everyone else.",
        "created_at": "2021-02-25T16:30:34.270000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "We can of course do lots of things to mitigate this risk (like extensive testing), but by releasing the code in pieces we are more likely to hit the bugs one at a time instead of all at once.",
        "created_at": "2021-02-25T16:30:59.534000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Also, since humans are the ones implementing these features and we need consensus, it is a bit easier to achieve if we are able to all focus on one piece at a time rather than all clients implementing all the things at once.",
        "created_at": "2021-02-25T16:31:42.059000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Introducing this interim state moves the main risk of breaking the mainnet from the merge to the intermediate step. I agree that the whole risk is spread across the steps. But anyway, there will potentially be a major point of failure at the second step, i.e. the fork choice update and we should consider that this step contributes to the security of transition. Probably we should get back to this discussion during one of the ACD calls and ask for more opinions.",
        "created_at": "2021-02-25T16:35:11.236000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Oh, I am mistaken. Change the fork choice would be the first step. The second is to reduce the distance to make finality usable for eth1. The third is the merge.",
        "created_at": "2021-02-25T16:37:29.309000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I very much appreciate you talking this out with me.  I'm not convinced that a single monolithic The Merge is the right path (from a risk mitigation standpoint), but I feel like I much better understand the situation and the opposition now!",
        "created_at": "2021-02-25T16:37:51.652000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "I see potential failures on each of the steps",
        "created_at": "2021-02-25T16:37:59.573000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "You're always welcome! My initial thoughts about delivering the merge were pretty similar to what we have discussed",
        "created_at": "2021-02-25T16:40:23.841000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "This is a strong argument for spreading the pieces out then.  ðŸ˜„",
        "created_at": "2021-02-25T16:40:49.156000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Currently, I feel like each step is a stress for the community anyway and being in the intermediate state (after first step takes place till the merge happens) for an year or two is not the best option. But as it being said, granular delivery definitely has its own pros.",
        "created_at": "2021-02-25T16:44:40.744000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "If the mainnet starts to respect beacon chain finality delayed by a few hours it adds a risk to get a deep chain reorg if something goes wrong, which is a huge risk",
        "created_at": "2021-02-25T17:20:28.308000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "How does it add risk?  I would think it would reduce it?",
        "created_at": "2021-02-25T17:32:33.715000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Suppose that something went wrong with the eth1 voting and it has finalised the chain that is not canonical according to the eth1 fork choice. Hm, difficult to imagine this kind of scenario, though, it would need to be a collective failure. Anyway, it might be a big risk if the purpose in only to test communication between mainnet and beacon chain clients",
        "created_at": "2021-02-25T17:38:15.886000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "That risk would exist with The Merge as well, right?",
        "created_at": "2021-02-25T17:44:32.065000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "That is, if the beacon chain fails to come to consensus on a canonical chain then we have a major failure with the beacon chain.  I would *rather* get that sort of thing found sooner rather than later (e.g., before The Merge if possible).",
        "created_at": "2021-02-25T17:45:30.290000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "There is a certain difference between the fork choice after the Merge (i.e. the beacon chain fork choice) and the hybrid fork choice rule (PoS finality + PoW). The former relies on the fork choice of the beacon chain and uses unidirectional communication. The latter depends uses bi-directional communication between two nodes and relies on eth1 data voting in addition to the beacon chain fork choice. There is more points of failure in the hybrid fork choice",
        "created_at": "2021-02-25T18:09:26.247000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "right, after the merge -- the beacon chain IS ethereum. That is the eth1 application layer is embedded directly in the beacon chain. So there isn't really the notion of one re-orging the other. they are in tandem at all points",
        "created_at": "2021-02-25T18:11:58.376000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Why does it require bidirectional communication?",
        "created_at": "2021-02-25T18:13:56.145000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The beacon chain would push finalized blocks onto the ETH1 client, which the ETH1 client would ack.  Just like in The Merge.",
        "created_at": "2021-02-25T18:14:59.776000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "You're right, it could be implemented this way",
        "created_at": "2021-02-25T18:17:33.703000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I don't *think* ETH1 clients will have any difficulty with a reorg near head, they deal with it all the time.",
        "created_at": "2021-02-25T18:18:32.798000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "They only run into problems with reorgs when they are outside their pruning distance.",
        "created_at": "2021-02-25T18:18:51.591000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "right",
        "created_at": "2021-02-25T18:18:56.994000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "so pruning under the merge would probably be dictated by finality (at it's most aggressive) rather than a constant distance",
        "created_at": "2021-02-25T18:19:21.933000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "(although in normal operation this is indeed constant)",
        "created_at": "2021-02-25T18:19:28.407000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "The main concern is finalising eth1 block hash via the voting mechanism and making mainnet fork choice depend on it",
        "created_at": "2021-02-25T18:25:43.007000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "With The Merge everything will depend on the beacon chain voting on blocks working properly, so it is unclear to me what the increased risk is, other than bugs in ETH1 client fork choice rule changing.",
        "created_at": "2021-02-25T18:32:13.046000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I do acknowledge that an ETH1 fork choice rule change would *not* be required with a single monolithic Merge, but it *feels* like a small amount of additional risk and work that *feels* like it is fully offset by the benefits of an iterative release.",
        "created_at": "2021-02-25T18:33:13.340000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "With the Merge attesting on beacon block and application payload are indistinguishable. While in the hybrid fork choice in order to finalise block validators would attest to the result of eth1 voting and not to the block itself. I agree that the size of the risk may vary but in general finality after the merge has at least one moving part less.",
        "created_at": "2021-02-25T18:43:01.890000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Hmm, what to validators attest to now?  I thought it was beacon blocks which contain an ETH1 block hash in it?",
        "created_at": "2021-02-25T18:44:26.935000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Currently, ETH1 block hash is not validated by attesters. Although, it could be changed later on, especially, if we speak about reducing the delay between the block and its finality to something like 32-64 mainnet blocks. Validators would likely be against this kind of change because it potentially reduces their rewards if the vote on eth1 data was incorrect by any reason",
        "created_at": "2021-02-25T18:49:05.829000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Oh, what *is* in a beacon chain block right now then?",
        "created_at": "2021-02-25T18:54:41.887000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "(feel free to link me to a doc if that is easier)",
        "created_at": "2021-02-25T18:54:57.419000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Here is it, https://github.com/ethereum/eth2.0-specs/blob/dev/specs/phase0/beacon-chain.md#beaconblockbody\n`body.eth1_data` field indeed contains ETH1 block hash but the correctness of that hash is not verified by attesters. Instead, proposers vote for it and if one of ETH1 hashes proposed during voting period collects more than a half of the votes it becomes a part of the beacon state (https://github.com/ethereum/eth2.0-specs/blob/dev/specs/phase0/beacon-chain.md#eth1-data), then the state is finalised and the hash gets finalised within.",
        "created_at": "2021-02-25T19:00:39.907000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "What do you mean \"hash is not verified\"?",
        "created_at": "2021-02-25T19:02:35.994000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Ah, I think you mean that if a whale decided to vote for `5` as ETH1.data and collected enough votes the system would accept it and not fork.",
        "created_at": "2021-02-25T19:04:58.171000+00:00",
        "attachments": null
    },
    {
        "author": "chris2_2_2",
        "category": "general",
        "parent": "",
        "content": "With the discussions of concerns around eth deflation on eth magicians I'd suggest considering some sort of mechanism to increase staker rewards on 2.0 to maintain a set minimum of eth in circulation and possibly include 1-2% annual inflation. This is required for a healthy currency. I'm a miner so I'm not saying this should be done in 1.0 (which would benefit me) I'm saying this should be considered for 2.0 where I do plan to participate.",
        "created_at": "2021-02-25T19:05:21.635000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Yes, there is no check whether eth1 data is valid at all during attesting to a block and if one gets enough voting power it could maliciously finalise a block hash that is not included into canonical chain",
        "created_at": "2021-02-25T19:10:10.293000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Why was that path chosen rather than having beacon clients refuse to follow a chain with an invalid/unknown block?",
        "created_at": "2021-02-25T19:11:44.967000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "I guess the goal was to avoid an impact of mainnet fluctuations on the beacon chain consensus. Because it would require perfect agreement on what ETH1 block hash at a certain height is, which depends on the view of the mainnet at a moment in time which is subjective and may be different from one node to another.",
        "created_at": "2021-02-25T19:24:51.869000+00:00",
        "attachments": null
    },
    {
        "author": "margulus",
        "category": "general",
        "parent": "",
        "content": "any downsides to partial staking on a centralized exchange like Coinbase? \u003c@!301186049323958275\u003e",
        "created_at": "2021-02-25T19:26:09.119000+00:00",
        "attachments": null
    },
    {
        "author": "margulus",
        "category": "general",
        "parent": "",
        "content": "\u003c@!291925846556540928\u003e",
        "created_at": "2021-02-25T19:26:33.515000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "ETH1 chain read failures are also considered as fluctuations. I am going to bed now, happy to chat more on that tomorrow!",
        "created_at": "2021-02-25T19:26:57.517000+00:00",
        "attachments": null
    },
    {
        "author": "butta",
        "category": "general",
        "parent": "",
        "content": "come to us https://discord.gg/98Z8FjfA .. and ask there ðŸ™‚",
        "created_at": "2021-02-25T19:27:55.610000+00:00",
        "attachments": null
    },
    {
        "author": "margulus",
        "category": "general",
        "parent": "",
        "content": "\u003c@!425572898787426305\u003e",
        "created_at": "2021-02-25T19:28:03.576000+00:00",
        "attachments": null
    },
    {
        "author": "margulus",
        "category": "general",
        "parent": "",
        "content": "\u003c@!97774605351010304\u003e  thanks ðŸ˜‰",
        "created_at": "2021-02-25T19:28:24.210000+00:00",
        "attachments": null
    }
]
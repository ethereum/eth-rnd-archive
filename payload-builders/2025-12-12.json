[
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "hey folks, i have a draft of the builder-api for staked builders over here: https://github.com/ethereum/builder-specs/pull/138",
        "created_at": "2025-12-12T09:57:19.327000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "please feel free to comment and let me know what you folks think",
        "created_at": "2025-12-12T09:57:33.097000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "there are some open questions which i have documented in the PR",
        "created_at": "2025-12-12T09:57:42.360000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "\"Execution Payload\" --\u003e \"execution Payload bid\" in the second call description",
        "created_at": "2025-12-12T10:00:06.187000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "we def have a lot of room for name changes üëç",
        "created_at": "2025-12-12T10:00:24.080000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "You need to pass all the removed info: slot, parent hash and also parent root",
        "created_at": "2025-12-12T10:01:59.096000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "note that i have not specced out the builder-api for unstaked builders. I have documented a couple of designs for it at: https://hackmd.io/PBruPO_YSOOzi_O3aYNlOg \nits more complicated and i want to understand if there will be any demand for it before speccing it out",
        "created_at": "2025-12-12T10:02:05.592000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "would be great to understand if builders would prefer validators signing the request to get the execution payload bid",
        "created_at": "2025-12-12T10:19:59.283000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "basically something like: https://github.com/ethereum/builder-specs/issues/108 \nunsure if it really matters if relays anyways expose websocket streams with the getHeader data? it would make the auction a sealed bid auction vs an open outcry",
        "created_at": "2025-12-12T10:24:51.548000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "the `ExecutionPayloadBid` is a pretty slim data structure without a lot of sensitive information.\n```python\nclass ExecutionPayloadBid(Container):\n    parent_block_hash: Hash32\n    parent_block_root: Root\n    block_hash: Hash32\n    prev_randao: Bytes32\n    fee_recipient: ExecutionAddress\n    gas_limit: uint64\n    builder_index: ValidatorIndex\n    slot: Slot\n    value: Gwei\n    execution_payment: Gwei\n    blob_kzg_commitments_root: Root\n```\nit might not be necessary to add any proposer signature to the call too i believe",
        "created_at": "2025-12-12T10:43:17.506000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "i think the signed get_header is definitely a good idea, other features that we think would make sense:\n- return the signed header to the builder on top of propagating to p2p (builder has interest in helping with p2p propagation)\n- communicate how the proposer will make the bid selection (is p2p used, is there any boost factor, is the `execution_payment` taken into consideration etc)",
        "created_at": "2025-12-12T11:02:33.615000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "assume the fields here are the absolute necessary already? ie do we definietly need both the parent block hash and root? assume so but just to double check, the small we can keep the request / response payloads the better it is for latency",
        "created_at": "2025-12-12T11:03:26.041000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "also we're assuming that sidecars like mev boost will be deprecated after right? if so would be good to suppor also the headers currently in the builder api so as to minimize incentives to fork clients",
        "created_at": "2025-12-12T11:05:55.766000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "1. The proposer would return the `SignedBeaconBlock` to the builder if it accepts the bid. The builder can def broadcast the block at this point. I think this is what you were referring to right?\n2. I would assume the proposer checks bids from the p2p bidpools and the builder-api and choose the bid? by a boost factor you mean like a boost to p2p bids over builder-api bids right?",
        "created_at": "2025-12-12T11:13:16.200000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "i believe we need both of them because the parent_block_hash represents the latest execution chain head and root represents the latest beacon chain head. you ideally want to know the parent block hash on top of which your payload is built on and the root of the parent block the consensus on top of which its built",
        "created_at": "2025-12-12T11:15:06.374000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "1. yep exactly\n2. currently many clients support a boost factor for the builder bid but i think more in general you want to be clear in how the auction rules are (ie how bids are ranked) so it's clear to builders and they can bid accordingly",
        "created_at": "2025-12-12T11:18:43.056000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "the `ExecutionPayloadBid` is around 220 bytes and the `SignedExecutionPayloadBid` is around 316 bytes. i believe thats not really big right?",
        "created_at": "2025-12-12T11:19:14.833000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "we can definitely document a bid ranking mechanism but i think it would be hard to enforce it",
        "created_at": "2025-12-12T11:19:33.780000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "maybe we could define it as honest validator behaviour according to the builder-specs(or wherever).",
        "created_at": "2025-12-12T11:20:27.081000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah that works , my intuition is that it should be in the interest of the proposer to be transparent about the rules as it will lead to higher bids",
        "created_at": "2025-12-12T11:23:19.261000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "yes we should support the headers mev-boost sends along today. this decision depends on clients willing to enshrine the mev-boost bid multiplexing support",
        "created_at": "2025-12-12T11:25:23.931000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "i def wouldn't mind mev-boost going away lmao, but we could also have a transition plan away from it if clients choose to prioritize getting ePBS right first and then prioritize the builder-api. \nmev-boost could act as a builder-api proxy for now and then clients can transition away from it later",
        "created_at": "2025-12-12T11:27:26.088000+00:00",
        "attachments": null
    },
    {
        "author": "alextes",
        "category": "Cross-layer",
        "parent": "",
        "content": "i'd encourage not to assume this. is there any reason we can't have: CL calls sidecar, as they would a builder, CL is otherwise configured to ignore other bids. effectively one could configure a single builder which is really a sidecar and turn off trustless bids.\n\nif we call the relay/builder directly from the CL i think we need a story for what happens if a CL is calling sub-optimally.\n\nnow that difference is handled by sidecars.",
        "created_at": "2025-12-12T13:19:35.177000+00:00",
        "attachments": null
    },
    {
        "author": "alextes",
        "category": "Cross-layer",
        "parent": "",
        "content": "on the auction rule point. 100% need to know the boosts and really anything else that can effect how a bid is selected otherwise you risk higher value blocks losing to lower value blocks just because it wasn't clear what the competing bid is. not sure how to best communicate that. maybe in the registration would be best.\n\non this point, i think it'd be healthy for the proposer to communicate the highest bid it has seen to any builder it calls. maybe in the call so the builder may outbid and avoid the cost of p2p competition, but could also be after the fact. data cached for a couple slots. this may help avoid trustless p2p becoming the dominant auction venue.",
        "created_at": "2025-12-12T13:40:16.062000+00:00",
        "attachments": null
    },
    {
        "author": "alextes",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e yes we should support the headers mev-boost sends along today. this decision depends on clients willing to enshrine the mev-boost bid multiplexing support\n\ngood to remember it really doesn't depend on the clients üòÖ . in the sense that, if one of those headers, like communicating the deadline is essential to land a higher bid, and clients choose not to support people will either 1. use the sidecar approach i outlined above if that's sufficient or 2. fork the clients to add them.\n\nthere's an open question as to whether the builder API should aim to document \"the api as it is used in the real world\" or \"as the CL devs intended it to be used\". but that's a different question and i'm kinda ambivalent, do whatever you think is best üòÅ .",
        "created_at": "2025-12-12T13:54:11.420000+00:00",
        "attachments": null
    },
    {
        "author": "alextes",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e i def wouldn't mind mev-boost going away lmao, but we could also have a transition plan away from it if clients choose to prioritize getting ePBS right first and then prioritize the builder-api. \n\ni really really hope that's what clients do. not only is there a limit to how many difficult discussions i have time for until we say \"we'll just hack around it later\" there are so many useful things client devs could work on üòÖ .\n\nfinally, even if you nail support today. that says nothing about the future. what are we going to do when the next way people want to select their bids shows up?",
        "created_at": "2025-12-12T13:56:10.655000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "you mean return the full CL block right?",
        "created_at": "2025-12-12T15:07:29.641000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "yes you now need both and the builder should be preparing multiple payloads. We can get into a call probably if it helps, or add this to the breakout if you need further clarifications. But the builder should in theory build on top of the last two different execution payloads. These two are the main biggest constructions. But also the builder should build on top of the last two CL beacon blocks!. This is because the proposer may be able to reorg just a payload, or both payload and CL block from the previous slot.",
        "created_at": "2025-12-12T15:09:29.004000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Also please notice that the builder needs to compute a CL state root before sealing the payload envelope, even though the payload is already sealed",
        "created_at": "2025-12-12T15:10:00.279000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "should clients support mev-boost?",
        "created_at": "2025-12-12T15:24:29.407000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "honest validation auction rule",
        "created_at": "2025-12-12T15:29:17.509000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "what type of headers?. And yes, I would strongly advocate for deprecation of any sidecars at the fork. This has always a testing problem. I believe we can accomodate any information the builder needs on the call to get_bid",
        "created_at": "2025-12-12T15:36:41.860000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@177711679977684993\u003e \n\u003e In the auction rule point. 100% need to know the boosts and really anything else that can effect how a bid is selected otherwise you risk higher value blocks losing to lower value blocks j\nI am not sure I agree with this, or at least I can see how proposers may not like this idea. So calling people on the other side of the auction to express opinions: \u003c@77492786336636928\u003e \u003c@376089961327362048\u003e \u003c@219015859182632960\u003e \n\nIn short: the situation is the following. After ePBS, the proposer has several options to decide the bids. For example it may or may not accept out of protocol payments. I believe this **has** to be signalled to the builder. However it may want to take the extra risk on the off-protocol payment if the payment is at least `min_diff` higher than the in-protocol one. Or other combinations like a boost parameter on the in-protocol one, etc. I can see why proposers may want to hide this information from the builder.",
        "created_at": "2025-12-12T15:40:35.449000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Definitely understand that for the builder it would be benefitial to have this information",
        "created_at": "2025-12-12T15:40:54.576000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "will CL clients support such a variety of options through command line flags or so since there are a lot of combinations possible here?",
        "created_at": "2025-12-12T16:27:50.762000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I believe these things should be a file as it is today for MEV-Boost, someone already pointed here that commit-boost even requires different config flags per validating key",
        "created_at": "2025-12-12T16:30:46.888000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "\"file\"? you mean flag right? üòÖ",
        "created_at": "2025-12-12T16:31:31.107000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "file with proposer settings",
        "created_at": "2025-12-12T16:32:13.720000+00:00",
        "attachments": null
    },
    {
        "author": "bharath.vedartham",
        "category": "Cross-layer",
        "parent": "",
        "content": "ahh got it, you mean a config file",
        "created_at": "2025-12-12T16:33:31.985000+00:00",
        "attachments": null
    },
    {
        "author": "nflaig",
        "category": "Cross-layer",
        "parent": "",
        "content": "we already have this on the vc side https://chainsafe.github.io/lodestar/run/validator-management/proposer-config (per pubkey) but we should probably standardize that across clients",
        "created_at": "2025-12-12T16:34:17.788000+00:00",
        "attachments": null
    },
    {
        "author": "quasar_win",
        "category": "Cross-layer",
        "parent": "",
        "content": "Wouldn't we have to do this? I mean otherwise all builders are going to be hammering each other constantly in order to update their bids in anticipation of the proposer call. (i think we have to assume relays might not exists at some point and plan for that, or that relays at least move to blind auctions to prevent leaking for p2p)",
        "created_at": "2025-12-12T16:58:07.924000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "yes you now need both and the builder",
        "created_at": "2025-12-12T20:27:04.980000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "we have ours as well, I assume every client has their standard üôÇ",
        "created_at": "2025-12-12T20:31:20.108000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "one point around observability, currently a lot of data is exposed by relays via the data api. this is helpful for researchers and other network participats to understand what went on. how could that work with epbs?",
        "created_at": "2025-12-12T20:33:29.465000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "most of the data will now be on-chain. Some other like which bids did the proposer get will not. We could probably work something with pandaops to have proposers offer this data like what they have for geo decentralization and the such",
        "created_at": "2025-12-12T20:34:38.268000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "but the thing is that by running the auction on a push system, the relay has a time evolution of the auction. This is compeltely lost on ePBS since the builder does not need to send multiple bids ever",
        "created_at": "2025-12-12T20:35:32.244000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "on this would be great if the parameters to rank bids where standardized across clients, as there already will be a lot of different combinations so anything that can help simplify is useful. My intuition would be that a rational proposer would want to make this public to incentivize builders outbidding each other. Eg builder may have had enough value in the block but did not know the min diff so it undershoots",
        "created_at": "2025-12-12T20:40:22.486000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "in general i would expect the new in-protocol auction to be potentially less efficient than the one at the relay, so anything we can to make it more transparent / efficient is beneficial",
        "created_at": "2025-12-12T20:42:40.973000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "my intuition is the opposite here, but I guess there's theory on blind auctions: the proposer has a min-diff parameter that is hidden. The builder knows the valuation of the trustless bids cause they came mostly in the p2p stack. So the builder can start bidding at trustless_bid + min_diff even though he may have a larger valuation. This is specially true if the builder is the only one with valuable POF in this block.",
        "created_at": "2025-12-12T20:46:21.257000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "trustless bids can come also via the direct http call no? i would assume in most cases these will be the actual valuable trustless bids",
        "created_at": "2025-12-12T20:51:20.402000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "i suppose depending on the assumptions on the number of bidders and risk preference of the proposer one could arrive at either situation. maybe node operators will have a better view on this",
        "created_at": "2025-12-12T20:51:52.843000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "in my view an inefficient outcome is when the auction is resolved and a losing builder had more value than the winner and was willing to bid higher but could not , in this case both the losing builder and the proposer are worse off. this is even more relevant since the auction is blind first price, so the builder cant just max bid and pay the second highest price",
        "created_at": "2025-12-12T20:55:55.638000+00:00",
        "attachments": null
    },
    {
        "author": "quasar_win",
        "category": "Cross-layer",
        "parent": "",
        "content": "You could argue that the occasional block that wins with lower value helps prevent all flow from wanting to aggregate with one builder. If the highest value block always wins, then all flow wants to be at the same builder since at the extreme that would have the highest inclusion rate. If flow has to contend instead with x% of blocks winning that don't have the best flow, they will probably be more willing to spread out that flow.",
        "created_at": "2025-12-12T21:26:26.634000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "But flow can already be shared with multiple builders at once? If that‚Äôs not possible then how‚Äôs the originator expected to decide to which builder to send for a given block?",
        "created_at": "2025-12-12T21:44:34.441000+00:00",
        "attachments": null
    },
    {
        "author": "quasar_win",
        "category": "Cross-layer",
        "parent": "",
        "content": "I mean there's obviously already significant quantities of exclusive flow. The more exclusive flow that aggregates together the more lopsided block values become leading to a runway that will attract more exclusive flow... thats going with the assumption that its always best that higher block values should always win. So there's an argument to be had that a system that creates more opportunity for lower value blocks to win could work to decentralize block building.",
        "created_at": "2025-12-12T21:51:06.182000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yes I agree, I pinged a couple of people among node operators, hopefully they will show up and express preference. Anyway it's easy to add/remove from the API",
        "created_at": "2025-12-12T23:40:33.116000+00:00",
        "attachments": null
    }
]
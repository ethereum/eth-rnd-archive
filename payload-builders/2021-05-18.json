[
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Actually, pre-1559 now that txfees are so high, the block uncling opportunity cost has increased from ~0.33 to ~0.33 + fees, so it's about 7x higher now, so the minimum compensating gasprice is *already* about 5 gwei ðŸ¤£",
        "created_at": "2021-05-18T01:12:09.423000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "1559 will fix (most of) this",
        "created_at": "2021-05-18T01:12:23.283000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But yeah, 1 should work almost always",
        "created_at": "2021-05-18T01:12:46.701000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I can see a \"fast\" tip of 10-100 being helpful too",
        "created_at": "2021-05-18T01:13:29.916000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But I am really hoping that the merge removes this marginal uncling risk issue!",
        "created_at": "2021-05-18T01:13:50.588000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I guess we'll see",
        "created_at": "2021-05-18T01:13:54.160000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Well, that won't be true post-1559, though, given the txn fees are burnt ðŸ˜… I feel like given the small difference and possible change in inclusion guarantees, I'm more inclined to recommend wallets set 2 gwei as the default tip, and we can monitor how much the average block's MEV grows as Flashbots enables \u003e1 bundle per block.",
        "created_at": "2021-05-18T02:02:29.197000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "One of the reason I'm drilling for a specific number is that we are having a call with wallets next week and they will definitely want to know \"what should we hardcode here\"",
        "created_at": "2021-05-18T02:05:19.253000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Miners are free to leave money on the table, other miners may not be as interested in leaving money on the table though.",
        "created_at": "2021-05-18T02:58:59.348000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "They should look at history of miner minimums.",
        "created_at": "2021-05-18T03:01:38.064000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We can tell miners what is a rational minimum priority fee, but they can choose to behave irrationally like \u003c@471975503859810316\u003e proposed above.  Wallets want to serve their users, so they should look at reality (which involves irrational actors) not at theoretic equilibriums.",
        "created_at": "2021-05-18T03:02:58.928000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "How is the increased opportunity cost of uncle blocks due to MEV more irrational than the uncle block risk at all?",
        "created_at": "2021-05-18T03:32:00.841000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What is irrational is 10-100 nanoeth.  ðŸ™‚",
        "created_at": "2021-05-18T03:34:07.989000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Got it!",
        "created_at": "2021-05-18T03:35:15.699000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "As Vitalik indicated above, a rational miner accounting for MEV may go up to 5, but certainly not 100.",
        "created_at": "2021-05-18T03:35:39.831000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In theory, an optimal strategy would be to look at the amount of MEV in the block and factor that into a live calculation baked into the client.",
        "created_at": "2021-05-18T03:36:23.732000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Clients donâ€™t have that info though, so wallets will need to use a proxy, but that would be a great service that, say, EthGasStation could provide",
        "created_at": "2021-05-18T03:37:10.734000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@273808422753796097\u003e Since I think you are the only expert on this, do you think you can put together an algorithm that would let a miner set min fee live based on expected MEV for the upcoming a block?  Something written in code (python maybe) so it would be easy for clients to implement.",
        "created_at": "2021-05-18T03:51:00.393000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So there was an algorithm calculating the uncle risk earlier",
        "created_at": "2021-05-18T03:53:38.368000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Wouldnâ€™t you use that, and then just add the average MEV per block / gas in block * gas in txn?",
        "created_at": "2021-05-18T03:53:59.137000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Link?",
        "created_at": "2021-05-18T04:04:05.239000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "a quick note on this MEV/uncle risk: https://notes.ethereum.org/@barnabe/rk5ue1WF_",
        "created_at": "2021-05-18T06:47:24.611000+00:00",
        "attachments": null
    },
    {
        "author": "tenacious_seahorse_09647",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If more than 50% hashrate behave like this, itâ€™s rational.",
        "created_at": "2021-05-18T08:15:54.865000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It is rational to launch a 51% attack in PoW if you can.",
        "created_at": "2021-05-18T08:26:51.737000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hi, \nquick question, how should transaction replacement work? Same nonce and increased priority_fee_per_gas?",
        "created_at": "2021-05-18T08:42:49.546000+00:00",
        "attachments": null
    },
    {
        "author": "tenacious_seahorse_09647",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it's not 51% attack",
        "created_at": "2021-05-18T08:59:38.763000+00:00",
        "attachments": null
    },
    {
        "author": "tenacious_seahorse_09647",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "1559 is like gas refund mechanism, dev thought it will work.",
        "created_at": "2021-05-18T09:11:57.533000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!486501030046203915\u003e thanks! To be clear, is the final value in the chart the total gwei tip that should be paid, or only the fraction that offsets the MEV opportunity cost?",
        "created_at": "2021-05-18T14:37:48.307000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It reads to me as the former, but I just want to be sure ðŸ˜…",
        "created_at": "2021-05-18T14:38:04.006000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yes, the value in the chart is the miner fee (in Gwei) the wallet would set if it had knowledge of how much MEV was going to be included in the next block",
        "created_at": "2021-05-18T14:39:07.763000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so for MEV = 0 you recover the usual 1 Gwei miner fee (basically you don't account for the MEV)",
        "created_at": "2021-05-18T14:39:32.280000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Got it. So, it's obviously hard to predict the future MEV, and blocks with extremely high MEV will probably not want to include any \"low tips\" txns, but I guess it would be reasonable for wallets to do something like look at the past 7 days of MEV and use the average to calculate their default tip, right?",
        "created_at": "2021-05-18T14:41:25.370000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yes i mean it depends how MEV blocks base their decisions on including/not including transactions based on their miner fee. if they have a lax policy they might include based on a static threshold (\"i don't want anything under 2 Gwei\"), if they are more sophisticated they could use something like the rule in my note",
        "created_at": "2021-05-18T14:45:38.184000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "the other thing is i am slightly opposed to application-tuning a particular tip rule (e.g., we do this because of MEV) but you could make the case for that dynamic tip rule based on the fact that transactions fees have a long tail (few high paying transactions)",
        "created_at": "2021-05-18T14:47:04.583000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, I guess in a way if miners know that wallets use a \"smart\" estimation, then they many be more lax in what they include and that's a net positive ðŸ™‚",
        "created_at": "2021-05-18T14:47:05.791000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so can base_fee_per_gas  in block header = 0  ?",
        "created_at": "2021-05-18T14:48:42.702000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "anyways, that was a bit unclear, but all this to say we could base the tip on an estimation of the 95% quantile of transaction fees over the last 7 days. though now with flashbots the \"real\" transaction fee is somewhat hidden",
        "created_at": "2021-05-18T14:49:43.054000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The minimum base fee is 7 wei, so I don't know what should happen if a header has 0 in it.",
        "created_at": "2021-05-18T14:52:08.558000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this if you follow the formula, but it actually does not fix it \n```\nexpected_base_fee_per_gas = max(parent_base_fee_per_gas - base_fee_per_gas_delta, 0)\n```\n0 seems to be allowed. but the case wont happen so I wonder if I can use baseFee of 1 or 0 for all the legacy blockheader tests that we have",
        "created_at": "2021-05-18T14:54:10.064000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Divide by 500 million?",
        "created_at": "2021-05-18T16:08:19.987000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e Can/should this be addressed in the EIP? It is implicitly disallowed, as the starting base fee is 1 Gwei, and will never drop below 7 Wei. If you change the starting base fee to something like 0 or 1 Wei, I would expect everything to work though, if clients implemented it exactly according to spec (including all assertions, and no additional assertions).\n\n(I still feel allowing base fee to drop to zero is a prettier solution though ðŸ˜‰ )",
        "created_at": "2021-05-18T16:51:32.412000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "if its not allowed I can run legacy tests with basefee \u003e 7",
        "created_at": "2021-05-18T17:26:18.143000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "for less we make tests to make sure it is rejected",
        "created_at": "2021-05-18T17:26:30.871000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but the only way to test is really at the fork block. which by eip is set",
        "created_at": "2021-05-18T17:26:56.700000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and then we test the diff formula which does not allow it to ever drop",
        "created_at": "2021-05-18T17:27:15.982000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so the only way is in the test protocol",
        "created_at": "2021-05-18T17:27:25.923000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://twitter.com/syscoin/status/1392601510186475522?s=21",
        "created_at": "2021-05-18T23:10:06.140000+00:00",
        "attachments": null
    }
]
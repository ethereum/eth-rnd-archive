[
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@552133098075193354\u003e Yes, sorry.  Fixed.",
        "created_at": "2020-11-14T03:50:21.658000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Why not only accept transactions with a fee cap \u003e= 100% of the block's base fee?",
        "created_at": "2020-11-14T06:44:12.774000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If the base fee is stable at some level, then setting the minimum to 75% does still introduce a risk that someone can reliably broadcast transactions that can never be included",
        "created_at": "2020-11-14T06:44:34.904000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because not everyone agrees on current block height.",
        "created_at": "2020-11-14T06:58:36.166000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If a new block arrives with a higher base fee than the previous block, your peer may not yet have seen the new block so you don't agree on current base fee yet.",
        "created_at": "2020-11-14T06:59:15.866000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also, in the case of two blocks mining at the same time with different base fees, this state can last for a bit since both peers will prefer their block as the head over the alternative head block until such time as a new block is mined on one of them (I believe).",
        "created_at": "2020-11-14T06:59:34.051000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It seems like we should continue to propagate transactions during this time.",
        "created_at": "2020-11-14T07:00:19.649000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah I see, fair!",
        "created_at": "2020-11-14T07:01:51.098000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "* only *send* transactions to peers where `fee_cap \u003e= head_block.base_fee`\n* only *accept* transactions from peers where `fee_cap \u003e= head_block.base_fee * 0.75`\n* *disconnect* any peer that sends you a transaction where `fee_cap \u003c= head_block.base_fee * 0.5`\n* *evict* any transactions where `fee_cap \u003c= head_block.base_fee * 0.5`",
        "created_at": "2020-11-14T07:02:09.865000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "üëç",
        "created_at": "2020-11-14T07:02:22.597000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(numbers arbitrary, but we do need to consider the 1/8 per block movement speed of base fee)",
        "created_at": "2020-11-14T07:02:25.713000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hmm, the latter seems a bit harsh, I would evict at `* 0.25`",
        "created_at": "2020-11-14T07:02:41.046000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think we just need to decide \"how out of sync before you start disconnecting peers\"?",
        "created_at": "2020-11-14T07:03:03.961000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also, there is the issue of peers propagating transactions while they are syncing.  I think this totally breaks that, so a peer can't gossip transactions *at all* until they are in sync.",
        "created_at": "2020-11-14T07:03:35.355000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Unless the client tracks the current head of all of its peers (which it hasn't verified any of yet) and is careful to only gossip transactions that it believes that particular peer will accept.",
        "created_at": "2020-11-14T07:04:08.661000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "6 blocks out of sync for 50%, 11 blocks out of sync for 25% (if my math is right, and assuming 1/8 base_fee change per block).",
        "created_at": "2020-11-14T07:05:39.584000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "sounds about right",
        "created_at": "2020-11-14T07:05:54.662000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also assumes worst case scenario, where all blocks are 2x full for the duration.",
        "created_at": "2020-11-14T07:06:10.008000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@486501030046203915\u003e Hmm, good point.  I don't think it clicked with me previously that if the base fee is sufficiently high you'll eat into the miner bribe.",
        "created_at": "2020-08-02T01:08:05.788000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is a pretty strong argument for the current parameter set and naming.",
        "created_at": "2020-08-02T01:08:27.441000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I will let this knowledge percolate for a bit and see how I feel after it has sunk in.",
        "created_at": "2020-08-02T01:08:49.456000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Where are current implementations putting the base fee in the block header?",
        "created_at": "2020-08-02T05:01:07.534000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "At the end (after the nonce)?",
        "created_at": "2020-08-02T05:01:15.628000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I found an inconsistency in the specification, curious how implementers have implemented it.  At the fork block, do you set the EIP-1559 gas **limit** to half of the block size, or do you set the EIP-1559 gas **target** to half of the block size?  I'm pretty sure **target** is correct, otherwise we run into a problem where large transactions can't be included in Ethereum for 800,000 blocks and I think the other formulas in the spec don't make sense if you use **limit**.",
        "created_at": "2020-08-02T05:11:43.759000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It appears there is another issue where the spec suggests that the base fee delta for block `n` (relative to block `n-1`) is calculated by looking at the fullness of block `n`.  I believe it should be that base fee delta for block `n` is calculated by looking at the fullness of block `n-1`.",
        "created_at": "2020-08-02T05:21:05.707000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is, a miner doesn't have control over the base fee for the block they are producing, they only have control over the base fee for the following block.",
        "created_at": "2020-08-02T05:21:32.711000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "As I'm trying to clean up this spec while retaining its general style, I'm reminded of this commit which echoes my feelings about having a special specification syntax:",
        "created_at": "2020-08-02T05:25:58.975000+00:00",
        "attachments": [
            {
                "type": "",
                "origin_name": "Strip-Les-specs-cest-du-code-650-finalenglish.png",
                "content": "c80d23d33a80eef1a8b25630daebded8616a1a0c03cdccb22c6d0c08974f057f"
            }
        ]
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Maybe one day someone can explain to me why we write EIPs in pseudocode instead of actual code.  Every time I do it I struggle compared to if I just wrote a tiny little go/rust/typescript/c#/python library (e.g., a function or two).",
        "created_at": "2020-08-02T05:27:08.916000+00:00",
        "attachments": null
    },
    {
        "author": "afdudley",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e Maybe one day someone can explain to me why we write EIPs in pseudocode instead of actual code.  Every time I do it I struggle compared to if I just wrote a tiny little go/rust/typescript/c#/python library (e.g., a function or two).\n\u003c@!301186049323958275\u003e They should be written in python. I'm not sure why they aren't.",
        "created_at": "2020-08-02T08:19:55.366000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm actually writing up EIP-1559 in python right now, maybe I'll submit a PR that just swaps out the spec with Python (which means the tests can also run against the spec itself, which is a nice bonus).",
        "created_at": "2020-08-02T08:20:35.339000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Do transactions have the `gas_limit * gas_price` deducted from their account first, then the transaction executed, then `gas_refund * gas_price` refunded to their account?",
        "created_at": "2020-08-02T08:28:42.546000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah, I suppose it doesn't really matter since at the moment the only way to move a user's ETH is by setting the `value` on the transaction, which is part of the transaction.",
        "created_at": "2020-08-02T08:35:38.774000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What is the rationale for allowing miners to cover `base_fee` for transactions?  It feels like it adds a tad bit of complexity, and I don't really see a clear benefit.",
        "created_at": "2020-08-02T08:56:58.305000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e It appears there is another issue where the spec suggests that the base fee delta for block `n` (relative to block `n-1`) is calculated by looking at the fullness of block `n`.  I believe it should be that base fee delta for block `n` is calculated by looking at the fullness of block `n-1`.\n\u003c@!301186049323958275\u003e I agree that this is how the spec is written, but I also find it more natural to have transactions in block `n` experience basefee after block `n-1`. trying to think of arguments against",
        "created_at": "2020-08-02T09:02:09.205000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!486501030046203915\u003e Do you know how things are currently implemented?",
        "created_at": "2020-08-02T09:02:35.141000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah, the basefee of block n definitely \"should\" depend only on things that happen before block n",
        "created_at": "2020-08-02T09:03:07.031000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm pretty sure using block `n`'s fullness to calculate `base_fee` for the block is incorrect (just a mistake in the spec).  I'm not even sure how you would build a block like that since you don't know how much gas money to deduct from the signer before fully executing the block, and you need to know that to know whether a transaction is valid *before* you include it in a block.",
        "created_at": "2020-08-02T09:03:56.255000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If the `fee_cap` and `gas_premium` are both `0` and a miner includes the transaction, does that mean the signer account doesn't need to have any balance to execute the transaction, since the miner is paying for gas?",
        "created_at": "2020-08-02T09:05:19.256000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "~~Means we need another conditional to avoid giving the signer a flash loan for the duration of the transaction.  ðŸ˜¢~~ Hmm, maybe not.  I think it naturally stays positive.",
        "created_at": "2020-08-02T09:06:56.639000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e \u003c@!486501030046203915\u003e Do you know how things are currently implemented?\n\u003c@!301186049323958275\u003e I don't know go but from a quick search for places where basefee is set in the vulcanize repo I think it is implemented as we think it should be, and not as the specs define it",
        "created_at": "2020-08-02T09:09:04.687000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm going to move forward assuming it was just a bug in the spec and everyone implemented it \"correctly\".",
        "created_at": "2020-08-02T09:09:31.888000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I feel like someone would have complained during implementation if not.  ðŸ™‚",
        "created_at": "2020-08-02T09:09:39.582000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I also kind of dislike how a miner with a buggy transaction inclusion algorithm can end up draining their own account.",
        "created_at": "2020-08-02T09:10:20.451000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "specifically this line: https://github.com/vulcanize/go-ethereum/blob/eip1559_rebase/consensus/misc/basefee.go#L78",
        "created_at": "2020-08-02T09:10:24.577000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it's also how i implemented the simulations (btw a new one is here: https://twitter.com/barnabemonnot/status/1289243605358452738)",
        "created_at": "2020-08-02T09:11:08.095000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e What is the rationale for allowing miners to cover `base_fee` for transactions?  It feels like it adds a tad bit of complexity, and I don't really see a clear benefit.\n\u003c@!301186049323958275\u003e can't find a source but I remember it as miners can use it to include invalid transactions they like, in which case they have to subsidise the missing basefee",
        "created_at": "2020-08-02T09:13:49.361000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!486501030046203915\u003e Any idea what the use case for that is?  In theory, it enables miner-sponsored transactions, but I feel like EIP-2711 is a much better and more generalized solution to that particular problem (sponsored transactions), and since it *likely* will get added anyway (potentially at same time or earlier than 1559) we shouldn't try to use 1559 to solve sponsored transactions.",
        "created_at": "2020-08-02T09:15:57.875000+00:00",
        "attachments": null
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "not familiar with 2711 but yes that seems to address this use case",
        "created_at": "2020-08-02T09:17:50.707000+00:00",
        "attachments": null
    },
    {
        "author": "statelayer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "has been it been considered to also burn a % of tips to miners ?",
        "created_at": "2020-08-02T19:06:20.950000+00:00",
        "attachments": null
    },
    {
        "author": "kiwi.eth",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hey \u003c@!574864862338088960\u003e gonna look into the testnet a bit today",
        "created_at": "2020-08-02T19:58:22.914000+00:00",
        "attachments": null
    }
]
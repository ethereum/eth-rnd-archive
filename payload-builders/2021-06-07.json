[
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, overloading an RPC method based on [] or [][] I suspect will be tricky in some languages.  I suspect many deserialize/validate parameters based on the method name and not all languages have easy type unions.  They can handle missing, but not necessarily overloads.",
        "created_at": "2021-06-07T01:49:47.540000+00:00",
        "attachments": null
    },
    {
        "author": "perama",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I have taken some ideas from your gist \u003c@!202397237962211328\u003e  and made an alternative proposal:\n\nhttps://gist.github.com/perama-v/89df9c0701c5121620bbee9d4fab4a2c",
        "created_at": "2021-06-07T06:54:34.669000+00:00",
        "attachments": null
    },
    {
        "author": "abcoathup",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Are there any notes or a summary?",
        "created_at": "2021-06-07T08:04:13.662000+00:00",
        "attachments": null
    },
    {
        "author": "perama",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For comparison:\n\n```\nfeeHistory(blockCount) ([baseFee, gasFraction, []priorityFeeDeciles]history)\n```",
        "created_at": "2021-06-07T08:18:59.080000+00:00",
        "attachments": null
    },
    {
        "author": "perama",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "A single call from the function I propose delivers 11 data points from which a curve may be constructed. Whilst 100 points would be prettier, I think the ROI is rapidly diminishing beyond ~10",
        "created_at": "2021-06-07T08:26:54.452000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But why limit the API to deciles? I also suggested that a multi-point curve can be useful (though I only wrote it here, I'll ad it to the gist), I think it's better to allow any range/resolution needed by the application:\n`feeHistory(blockCount, []rewardPercentile) ([][]reward, []baseFee, []usedRatio)`",
        "created_at": "2021-06-07T08:29:34.287000+00:00",
        "attachments": null
    },
    {
        "author": "perama",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Does ```feeHistory(1, 10)``` return the fee in the ten percentile? So you would then make the call again for 20, 30 etc? (If you wanted all the deciles)",
        "created_at": "2021-06-07T09:03:33.744000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`feeHistory(1, [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100])` would return all deciles at once",
        "created_at": "2021-06-07T09:04:56.102000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Actually the function name may be different for this advanced version to avoid overloading issues",
        "created_at": "2021-06-07T09:05:29.610000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm adding it to my gist right now",
        "created_at": "2021-06-07T09:05:48.237000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For visualization maybe sevaral hundred data points can be useful. For GPO maybe a few are enough but then the low percentiles are the most interesting (between 0 and maybe 10-20). So I think it's better to let the callers specify what they exactly want.",
        "created_at": "2021-06-07T09:07:25.317000+00:00",
        "attachments": null
    },
    {
        "author": "perama",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Thanks",
        "created_at": "2021-06-07T09:21:03.040000+00:00",
        "attachments": null
    },
    {
        "author": "trent_vanepps",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "not yet, but we are hoping to get some via the Cat herders üê±",
        "created_at": "2021-06-07T15:29:44.339000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I updated the feeHistory proposal:\nhttps://gist.github.com/zsfelfoldi/473e29106d38525de6b4413e2ebcddf1\nNow I think it's maybe better to just have the `[]rewardPercentile -\u003e [][]reward` function header and the \"no reward\" version in order to avoid confusion with a different function name for the third version. Though I can be convinced otherwise üôÇ",
        "created_at": "2021-06-07T16:22:27.309000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Though if we want to support both the advanced block range specification (specified in this new version) and the simple \"last N blocks\" version then probably we'll have to use different function names for those. But I still find this a lot less confusing. Or we can just only support the more explicit version.",
        "created_at": "2021-06-07T16:35:32.687000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I can even be convinced about using just the simple version but now I'm excited about how useful this API could be for long-term fee market analysis which could be super important for understanding how this new market really behaves. It's a different use case though, hence the `feeHistory` and `recentFeeHistory` versions in my proposal.",
        "created_at": "2021-06-07T16:40:53.482000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "One thing to consider though is whether `recentFeeHistory` should be counted from head block or pending block? Head block feels more natural but the `blockCount` would behave the same as in `feeHistory` if we counted from pending block.",
        "created_at": "2021-06-07T16:45:54.788000+00:00",
        "attachments": null
    },
    {
        "author": "perama",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Nice work. Being able to specify the range of blocks over which to apply the call is good. The API can them be used for both real-time fee planning and historical analysis. I had presumed that historical analysis would be performed by other means of parsing the block data. However, having this API will make that process more accessible.",
        "created_at": "2021-06-07T19:21:37.937000+00:00",
        "attachments": null
    },
    {
        "author": "trent_vanepps",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "update - they should be available in the next few days",
        "created_at": "2021-06-07T19:22:18.668000+00:00",
        "attachments": null
    },
    {
        "author": "perama",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I was pondering this, too. Is it crazy to just embed the block number in the response?\n\nThat would also save effort if doing historical analysis",
        "created_at": "2021-06-07T19:26:26.064000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "the more advanced `feeHistory` function in the latest version of my proposal does return the block number in the response.",
        "created_at": "2021-06-07T19:33:45.708000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`feeHistory(blockCount, lastBlock, []rewardPercentile) (firstBlock, [][]reward, []baseFee, []gasUsedRatio)`",
        "created_at": "2021-06-07T19:34:31.378000+00:00",
        "attachments": null
    },
    {
        "author": "perama",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In general, I think it would be good to have the API have a simple default call where you don't pass any arguments, and are returned a set of data that we think is most concise and valuable. E.g.\n```\nfeeHistory() \n```\nReturns 5 blocks of data with a set of basic percentiles/deciles/quartiles\n\nBut passing arguments allows you to explicitly change the block range and the percentiles of interest. What do you think?",
        "created_at": "2021-06-07T19:35:21.859000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think 4 versions of the same function is probably enough üôÇ",
        "created_at": "2021-06-07T19:36:22.354000+00:00",
        "attachments": null
    },
    {
        "author": "zsfelfoldi",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also, there's the original `eth_gasPrice` without any params that does return some useful values. That's good for existing apps. We can expect new apps can supply a few basic params to the new API functions. Using a single function format that does everything like a swiss army knife is one extreme, but having too many versions is confusing.",
        "created_at": "2021-06-07T19:41:35.579000+00:00",
        "attachments": null
    }
]
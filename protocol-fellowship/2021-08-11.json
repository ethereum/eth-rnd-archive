[
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "I just asked someone else \u003c@!501979165801578507\u003e hopefully someone can have a look... !",
        "created_at": "2021-08-11T18:31:51.814000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "\u003c@!508125616940515329\u003e, maybe?",
        "created_at": "2021-08-11T18:32:21.287000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "general",
        "parent": "",
        "content": "\u003c@!552133098075193354\u003e I'm not sure I fully understand the example/question",
        "created_at": "2021-08-11T18:32:43.769000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "Does this trigger EIP-3198 + 3529",
        "created_at": "2021-08-11T18:33:03.182000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "If we deploy the contract + call the various functions",
        "created_at": "2021-08-11T18:33:26.551000+00:00",
        "attachments": null
    },
    {
        "author": "hrkrshnn",
        "category": "general",
        "parent": "",
        "content": "Solidity just released 0.8.7. You can use `block.basefee` or `basefee()` inline assembly or Yul.",
        "created_at": "2021-08-11T18:33:44.794000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "general",
        "parent": "",
        "content": "If you use today's release (0.8.7), `block.basefee` can be used directly.",
        "created_at": "2021-08-11T18:33:49.302000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "general",
        "parent": "",
        "content": "But 3529 is not affecting the above ^^",
        "created_at": "2021-08-11T18:34:27.758000+00:00",
        "attachments": null
    },
    {
        "author": "bholland.eth",
        "category": "general",
        "parent": "",
        "content": "OK sweet. That simplifies my contract building process. Swapping the opcode for base fee did work for me on Ropsten but that is cleaner.",
        "created_at": "2021-08-11T18:35:26.819000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "general",
        "parent": "",
        "content": "Oh wait, there's an \"Expand\" button with more code ðŸ˜¬",
        "created_at": "2021-08-11T18:35:35.138000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "general",
        "parent": "",
        "content": "You don't need to use inline assembly with sstore to trigger eip-3529, could just have a state variable with a function changing its value. Once you change it from zero to a non-zero value, and then back to zero in a different transaction, the refund should be triggerred.",
        "created_at": "2021-08-11T18:37:17.559000+00:00",
        "attachments": null
    },
    {
        "author": "bholland.eth",
        "category": "general",
        "parent": "",
        "content": "Yeah that makes sense. I was trying to figure out what the bytecode cases in eip-3529 was actually doing by converting it into the opcodes and I just wanted to be as close as possible to the example so that is why I used the inline assembly.",
        "created_at": "2021-08-11T18:40:19.189000+00:00",
        "attachments": null
    },
    {
        "author": "hrkrshnn",
        "category": "general",
        "parent": "",
        "content": "About the `sstore`, because you are writing to the same slot during the same tx, the write is dirty and therefore cheaper, i.e.,  `100` gas (EIP-2929). You may have to write to storage across different tx. Will take another look tomorrow.",
        "created_at": "2021-08-11T18:41:59.171000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "general",
        "parent": "",
        "content": "Yes, I said it has to be a different transaction ðŸ™‚",
        "created_at": "2021-08-11T18:42:39.049000+00:00",
        "attachments": null
    },
    {
        "author": "bholland.eth",
        "category": "general",
        "parent": "",
        "content": "So one transaction to set the original value, then the bytecode for the case in a second transaction?",
        "created_at": "2021-08-11T18:43:37.512000+00:00",
        "attachments": null
    },
    {
        "author": "bholland.eth",
        "category": "general",
        "parent": "",
        "content": "The single line of bytecode per case appears to call sstore multiple times with the 1 2 3 values",
        "created_at": "2021-08-11T18:44:02.306000+00:00",
        "attachments": null
    },
    {
        "author": "bholland.eth",
        "category": "general",
        "parent": "",
        "content": "Is 1, 2, 3 meant to be in different transactions?",
        "created_at": "2021-08-11T18:44:24.727000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "general",
        "parent": "",
        "content": "I'd just do\n```\ncontract C {\n  uint a;\n  function f(uint b) external {\n    a = b;\n  }\n}\n```\n\nAnd do two transactions: first transaction `f(100)` and second transaction `f(0)`. The second transaction should do the refund.",
        "created_at": "2021-08-11T18:44:42.924000+00:00",
        "attachments": null
    },
    {
        "author": "bholland.eth",
        "category": "general",
        "parent": "",
        "content": "Awesome. I will try and make the changes tonight and should be able to try and deploy it. Thanks!",
        "created_at": "2021-08-11T18:46:33.237000+00:00",
        "attachments": null
    }
]
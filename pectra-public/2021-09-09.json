[
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "**The call is in 1 hour**",
        "created_at": "2021-09-09T12:00:04.405000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Call in 10 minutes\nZoom: https://us02web.zoom.us/j/85972471613?pwd=akRKdW1FeWRaWmlNVVc0T1gvUkQvZz09",
        "created_at": "2021-09-09T12:50:10.800000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I am not aware of any use cases for the `earliest` BlockTag.  Maybe it is used in stuff like Beam sync cc \u003c@489256758989029405\u003e?",
        "created_at": "2021-09-09T13:30:11.498000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "general",
        "parent": "",
        "content": "earliest not used",
        "created_at": "2021-09-09T13:51:39.584000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Sorry, I meant to ask whether Nethermind returns anything *other* than Genesis block to that.  Does Beam sync return genesis block as well if someone asks for earliest?",
        "created_at": "2021-09-09T13:54:06.680000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I actually kinda wish that clients returned lowest block it has full data on (header, body, receipts).  That would have saved me so much pain in the past.  ðŸ˜–",
        "created_at": "2021-09-09T13:54:53.027000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "\u003c@555483069038198827\u003e I believe (again, I haven't followed closely) that when the last PoW-only fork block is reached, the TTD is calculated at that time.",
        "created_at": "2021-09-09T13:59:57.410000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "So we don't know the TTD until after everyone has deployed their final Merge Execution clients.",
        "created_at": "2021-09-09T14:00:47.758000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e what? My understanding is that the total difficulty is computed long before the merge?",
        "created_at": "2021-09-09T14:01:01.125000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Long before, yes, but after clients are all deployed I thought.  Best to get \u003c@425572898787426305\u003e to chime in on this though, as I haven't followed the latest on this process.",
        "created_at": "2021-09-09T14:01:32.509000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e I don't see why it depends on anyone deploying clients? Can someone explain that dependency to me?",
        "created_at": "2021-09-09T14:01:33.768000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e but why?",
        "created_at": "2021-09-09T14:01:39.896000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e why can't it just be like any other hard fork where you hardcode it in the client (but add an emergency override so that the community can react to things like miner attacks)",
        "created_at": "2021-09-09T14:02:07.084000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Because difficulty is a function of hashpower, and we don't want to rely on a fixed amount of hashpower to be running to hit a certain target.",
        "created_at": "2021-09-09T14:02:09.256000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "And we have no idea what hashpower changes will happen as we approach The Merge (like miners selling off hardware in advance of the hardware dump).",
        "created_at": "2021-09-09T14:02:31.458000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "Terminal total difficulty though, not just difficulty of the last block",
        "created_at": "2021-09-09T14:02:48.168000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "So we want to wait until some block height *near* when we want transition to occur, and then we dynamically calculate the TTD based on \"last minute\" network hashpower.",
        "created_at": "2021-09-09T14:03:02.297000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "It's the sum of difficulties of all blocks so it shouldn't be dependent on hashrate at the merge",
        "created_at": "2021-09-09T14:03:33.920000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e right, that makes some sense then. But if we say want to make it ~1 week as suggested, then surely clients can release a version with that hardcoded? I mean getting one release with a single variable change out should not take that long?",
        "created_at": "2021-09-09T14:03:43.997000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "It could be but then we will have to take big enough value to mitigate the risk of TTD hit *before* the actual Merge fork on the beacon chain. THis is why instead it is computed *at the Merge fork*",
        "created_at": "2021-09-09T14:04:02.159000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Getting everyone to upgrade 1 week prior to an event is tough.  Historically we have struggled even when there is months of head-start planning.",
        "created_at": "2021-09-09T14:04:21.182000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "And we don't want to wait to build the client until 1 day before the hard fork.",
        "created_at": "2021-09-09T14:04:36.827000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Essentially we want to build/test/release production clients months before The Merge.  This gives people plenty of time to integrate the build into their infrastructure, test it, etc.",
        "created_at": "2021-09-09T14:05:11.837000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "We don't want to say \"everyone has to deploy this client that we just built sometime between now and 1 week from now\".",
        "created_at": "2021-09-09T14:05:34.798000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e here is the danger I see with this approach: This means that Eth1 clients will just keep working after the merge if they aren't connected to a beacon node",
        "created_at": "2021-09-09T14:05:49.893000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e it's literally the default",
        "created_at": "2021-09-09T14:06:08.297000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Yes, this is a very reasonable (and likely!) possibility.  In theory, this is explicitly what the ice age is for.  ðŸ˜„",
        "created_at": "2021-09-09T14:06:14.820000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "So you're making the case for 2 conditions:\nTTD \u003e= X \u0026\u0026 height \u003e= Y?",
        "created_at": "2021-09-09T14:06:30.878000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e for the users, everything looks normal, except a drop in hash rate, but I think currenlty clients don't even warn about it!",
        "created_at": "2021-09-09T14:06:39.017000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "What if we add an option to the execution client like `--pos-operating-mode-enabled`? Will it help?",
        "created_at": "2021-09-09T14:06:57.276000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "user will have to manually switch their client upon start up",
        "created_at": "2021-09-09T14:07:21.756000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e so I may be running the latest geth and suddenly I would be working on the Proof of Work fork \"Ethereum Classic Classic\"",
        "created_at": "2021-09-09T14:07:23.103000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "We are saying, `n` blocks worth of `block_y.difficulty` on top of `block_y`.",
        "created_at": "2021-09-09T14:07:27.395000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e I think this is horrible. Like this is reaaly reeeeaaaally bad",
        "created_at": "2021-09-09T14:07:35.401000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e The *default has to be safe* (re @merge_chat_bot: \u003cMikhail Kalinin [mkalinin]\u003e What if we add an option to the execution client like `--pos-operating-mode-enabled`? Will it help?)",
        "created_at": "2021-09-09T14:07:44.567000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e that is really essential",
        "created_at": "2021-09-09T14:07:49.763000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Hm, then we can switch the default to be PoS",
        "created_at": "2021-09-09T14:08:05.730000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "We could say something like, \"if you have reached fork block + n and haven't heard from a consensus client, halt\".",
        "created_at": "2021-09-09T14:08:13.737000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e interesting",
        "created_at": "2021-09-09T14:08:17.635000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "There is no fork block, actually, which is known in advance",
        "created_at": "2021-09-09T14:08:37.113000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "\"fork block\" meaning \"the block that TTD is calculated at\".",
        "created_at": "2021-09-09T14:08:50.701000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e that could be a possibility. Essentially the PoS client has to tell the execution node that it's still in PoW",
        "created_at": "2021-09-09T14:08:52.766000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "yeah",
        "created_at": "2021-09-09T14:09:01.127000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e yeah that could work. So basically from a certain point on you can't run the client without PoS node, it will just refuse to accept blocks",
        "created_at": "2021-09-09T14:09:31.065000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e yeah that could work",
        "created_at": "2021-09-09T14:09:33.043000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "Why is it a concern / dangerous for the execution client to keep running if not connected to consensus client?",
        "created_at": "2021-09-09T14:10:01.599000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e because user's think they are working with Ethereum but they are actually on a PoW fork chain?",
        "created_at": "2021-09-09T14:10:40.003000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "We would prefer it that the default behavior for people that fail or forget to turn on a consensus client to be to halt until user intervenes rather than continue on behaving like everything is fine.",
        "created_at": "2021-09-09T14:11:10.993000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e I can send you PoWEth which are worth $0.1 and you might think that you received ETH which are worth thousands of times more",
        "created_at": "2021-09-09T14:11:25.434000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "Gotcha. So it's about ensuring all major infrastructure providers either fail or handle the merge correctly",
        "created_at": "2021-09-09T14:11:42.310000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e ðŸ‘Œ (re @merge_chat_bot: \u003cMicah\u003e We would prefer it that the default behavior for people that fail or forget to turn on a consensus client to be to halt until user intervenes rather than continue on behaving like everything is fine.)",
        "created_at": "2021-09-09T14:11:44.451000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "More specifically, all *users*.  If users are delegating operations to infrastructure providers that is opaque to us.",
        "created_at": "2021-09-09T14:12:10.407000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "We don't want anyone running an Ethereum client to be able to shoot themselves in the foot if we can avoid it.",
        "created_at": "2021-09-09T14:12:42.569000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "This means minimizing the opportunity to accidentally end up on a fork.  If they want to fork, that should be intentional.",
        "created_at": "2021-09-09T14:13:05.843000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "So second question:\n\nWhat happens if there's a fork (2 POW blocks) at the TTD ðŸ˜¬",
        "created_at": "2021-09-09T14:13:06.115000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "There almost certainly will be.  It is up to PoS to pick one.",
        "created_at": "2021-09-09T14:13:17.837000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e Exactly. If your node stops working, you're going to check on it and investigate what happened and probably find out that you need to connect your consensus node. When everything looks like it's working fine, you may think that it's ok and lose funds\nAlso note that this would be a great help for anyone trying to start EthClassicClassic (re @merge_chat_bot: \u003cethDreamer\u003e Gotcha. So it's about ensuring all major infrastructure providers either fail or handle the merge correctly)",
        "created_at": "2021-09-09T14:13:20.937000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e BTW, it's also very likely that some people will be aware they need to run a PoS node, and do, but make some mistake in the configuration so the two aren't connected properly. If then the Execution node just keeps running and validating PoW, that's very bad behaviour. It needs to be absolutely obvious to user that something's wrong",
        "created_at": "2021-09-09T14:14:46.500000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "I guess my question about the POW fork at the TTD boils down to this:\n - Pure POW can resolve forks\n - Pure POS can resolve forks\nIs there any edge cases involved in resolving forks with the hybrid case at the merge?",
        "created_at": "2021-09-09T14:17:37.195000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Not if you have an execution and consensus client connected and talking.",
        "created_at": "2021-09-09T14:19:20.942000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "Or is it essentially the first proposer basically resolves the conflict?",
        "created_at": "2021-09-09T14:19:39.778000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "First proposer proposes a conflict resolution.  PoS then comes to consensus on that resolution (or another, if there are multiple).",
        "created_at": "2021-09-09T14:20:08.898000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "Are there links to all the relevant merge docs? There was one that was flipped to during the presentation that I don't have",
        "created_at": "2021-09-09T14:21:30.166000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "So as the consensus client devs prepare for merge F2F, are we planning to simulate Altair fork first and then simulate the merge?",
        "created_at": "2021-09-09T14:24:13.695000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "general",
        "parent": "",
        "content": "I'm definitely for doing it from Altair. It's closer to reality and Lighthouse doesn't plan to support arbitrary fork ordering.",
        "created_at": "2021-09-09T14:25:08.251000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "or genesis from altair at epoch 0. either way should be fine",
        "created_at": "2021-09-09T14:42:04.010000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "but the merge spec is based on altair now",
        "created_at": "2021-09-09T14:42:10.502000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "so it won't go from phase0 to merge in any case",
        "created_at": "2021-09-09T14:42:24.690000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "yeah, any valid PoS chain(s) built on a valid TTD wins the fork choice over pow",
        "created_at": "2021-09-09T14:42:59.406000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "Would the first proposer get slashed if they propose on two POW forks? Meaning do slashing conditions apply as they would a POS fork?",
        "created_at": "2021-09-09T14:44:14.633000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "the proposer proposes a PoS block so is subject to the PoS slashing rules",
        "created_at": "2021-09-09T14:45:51.411000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "general",
        "parent": "",
        "content": "Okay so if there are 2 POW blocks with the same TTD then proposing on both would be the equivalent of proposing two POS blocks at the same height.. so slashable",
        "created_at": "2021-09-09T14:47:40.080000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "If this is done by the same proposer in the same slot then yes, it is slashable. If it is done by two proposers of contiguous slots then it's fine",
        "created_at": "2021-09-09T14:54:51.392000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "If the first PoS block proposed in the system hasn't been accepted for any reason then the next proposer is free to choose another terminal PoW block as long as it's literally terminal according to the spec rules (block.TD \u003e= TTD \u0026\u0026 block.parent.TD \u003c TTD)",
        "created_at": "2021-09-09T14:56:22.162000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "but the blocks remain and are valid right? meaning, when a slashable event is caught, you slash the validator but the event stays on chain. So in principle we could see a split right at the beginning of the merge that can take a few slots to settle in one chain.",
        "created_at": "2021-09-09T18:09:58.263000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cralexstokes\u003e there can be some confusion w/ competing forks at the TTD but thatâ€™s why we wait for finality to turn off the consensus parts of the execution client",
        "created_at": "2021-09-09T19:21:40.098000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cralexstokes\u003e e.g. turning off block gossip in the execution client once it sees the first FINALIZED event",
        "created_at": "2021-09-09T19:23:13.937000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "pieterastra",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "A single catch-all fee recipient on the BN doesn't suffice, if the BN serves validators that *must* send to different recipients. (e.g. a combination of solo and Rocket Pool validators.) \nPerhaps the BN could also have a config file where it stores a per-validator default fee recipient (based on validator pubkey?)",
        "created_at": "2022-02-01T10:27:55.096000+00:00",
        "attachments": null
    },
    {
        "author": "pieterastra",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Then the order of determination would be:\n1) use the fee recipient the VC requested, if available;\n2) use the fee recipient configured on the BN for the currently proposing VC, if set;\n3) use the global default fee recipient configured on the BN",
        "created_at": "2022-02-01T10:27:55.741000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "what is the default behavior architected in the event no recipient is configured? 0x0000 or the client dev? or ? thx",
        "created_at": "2022-02-01T13:28:04.674000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This has to do with the fee receipient which is an address in EL. Rather than withdrawal creds",
        "created_at": "2022-02-01T13:41:09.779000+00:00",
        "attachments": null
    },
    {
        "author": "yorickdowne",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Right. Just trying to figure out where the fee recipient comes from, with multiple validators. Up to the VC though - it can set an address it likes or derive it. Got it.",
        "created_at": "2022-02-01T13:41:54.807000+00:00",
        "attachments": null
    },
    {
        "author": "pieterastra",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "0x0000 would be bad UX (burning money for a misconfiguration). The same applies to runtime failure to propose a block.\nClient dev address would be morally questionable imo.\nMaybe best way to go would be a failure to start the BN without a default fee recipient (if it's also configured to support staking/validating)",
        "created_at": "2022-02-01T14:26:40.609000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Fee recipient comes from the VC, not the BN.",
        "created_at": "2022-02-01T14:35:14.440000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I agree that client dev as a default might have some unintended consequences.. though it is probably better than burning at 0x0000..  curious what the spec is on this.. I suspect the worst case should be the withdrawal address for that given validator...  (curious).. thx...",
        "created_at": "2022-02-01T14:49:49.695000+00:00",
        "attachments": null
    },
    {
        "author": "pieterastra",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The discussion was about a race condition where the VC fails to provide a fee recipient and how the BN should behave in that case (e.g. by a configurable default fee recipient)",
        "created_at": "2022-02-01T14:51:00.766000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "In that situation I think the BN needs to fall back to the VC.",
        "created_at": "2022-02-01T15:07:47.792000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "To be clear, this was a tongue in cheek joke ðŸ˜…",
        "created_at": "2022-02-01T15:08:20.228000+00:00",
        "attachments": null
    },
    {
        "author": "pieterastra",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "What do you mean by fall back here?\nAs I understand it, the VC calls the prepare and getPayload requests on the BN\nWhen / how would the BN fall back to the VC to get the fee recipient?",
        "created_at": "2022-02-01T15:14:23.441000+00:00",
        "attachments": null
    },
    {
        "author": "pieterastra",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "also, reading https://discord.com/channels/595666850260713488/692062809701482577/937599382440796160 the described race condition would actually force a block proposal failure anyway?",
        "created_at": "2022-02-01T15:15:21.008000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The VC sends the preparation call to the BN, the BN sends the prepare payload call to the EL.  If the VC asked the BN for a block for which the BN did not have a fee recipient it could error, forcing the VC to send the preparation call.",
        "created_at": "2022-02-01T15:26:00.765000+00:00",
        "attachments": null
    },
    {
        "author": "pieterastra",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Got it. But wouldn't it then become a timing question - could the prepare still be executed timely at the point the VC actually wanted to have the payload? \n\u003c@!361447803194441738\u003e raised the issue, just thinking along here",
        "created_at": "2022-02-01T15:31:16.942000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Payload creation takes roughly the same time as payload execution (so \u003c1s)",
        "created_at": "2022-02-01T16:46:05.802000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Trouble is we are already pushing, and often exceeding, the safe time to receive a block.\n\nThe attached shows the time in to the slot that one of our nodes receives beacon blocks over the past few hours.  Anything that comes in 4s or greater will result in an incorrect head vote, as the block has not arrived by the time that the attestation is made.\n\nAdding another 1 or 2 s to the overall process from start of slot to receiving a block would significantly increase the number of blocks that arrive to nodes late.",
        "created_at": "2022-02-01T16:56:53.641000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "screenshot_2022-02-01-165246.png",
                "content": "fe2fe16291f10887493d7e56a1f19ccc6c571c2420f63921c30a8e31d9ef5457"
            }
        ]
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "What??? This distribution for \"empty\" beacon blocks?",
        "created_at": "2022-02-01T18:22:42.229000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This doesn't look great",
        "created_at": "2022-02-01T18:23:40.128000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "How big are the block in kb?",
        "created_at": "2022-02-01T18:24:52.447000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "do you avhe a similar analysis for the EL as-is today to compare...  also, out of raw curiosity, how many peers did that CL node have? when I see the outliers of data that have 11.5s, my first thought is how? unless the node is scrambling for peers...",
        "created_at": "2022-02-01T18:29:02.251000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "https://ethstats.net/",
        "created_at": "2022-02-01T18:30:23.763000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Don't have a better resource than that",
        "created_at": "2022-02-01T18:30:39.686000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Are nodes fully verifying the block before propagating?",
        "created_at": "2022-02-01T18:33:20.231000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We only verify the pow before propagating a block, afterwards we verify the full block",
        "created_at": "2022-02-01T18:34:07.917000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Current consensus blocks (this is live data from mainnet).  Think a block is around 32KB, although not sure.",
        "created_at": "2022-02-01T18:34:41.266000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "128 peers, and the pattern is replicated across multiple nodes.  There are a number of nodes that produce blocks late.",
        "created_at": "2022-02-01T18:35:46.264000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(And sorry I don't have any EL data.)",
        "created_at": "2022-02-01T18:36:10.295000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "New blocks will be ~ 120 kb on average post-merge",
        "created_at": "2022-02-01T18:39:01.153000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Do they produce block late, or is the network the bottleneck?",
        "created_at": "2022-02-01T18:39:30.822000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "More likely the former, although I can't say for sure.  Block production delay seems to be relatively consistent for each validator, which suggests that it's more a case of the node than the network.",
        "created_at": "2022-02-01T18:41:28.935000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Weird... why would they delay block production? cc \u003c@!291925846556540928\u003e",
        "created_at": "2022-02-01T18:42:50.753000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "interesting... i am not the expert on this.. but isnt the inclusion distance referenced?  or is that something else?",
        "created_at": "2022-02-01T18:43:57.758000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(Low CPU power, overloaded server, poor network connection for first hop, slow signing, lack of time synchronization... hard to tell without being able to look in to the server itself.  I doubt that anyone is delaying block production on purpose.)",
        "created_at": "2022-02-01T18:44:33.518000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "not delaying today on purpose.. but post-merge we could easily imagine tht happening in the future for some type of MEV to grab the last possible txn where the fee is in excess of the consequence of being late...",
        "created_at": "2022-02-01T18:46:34.957000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(but not so late that the network ignores the block)",
        "created_at": "2022-02-01T18:47:16.891000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Proposing in the 4-12 second range is a pain, as the attestations will have the wrong head vote.  Proposing just after 12s can be very nasty, as it can orphan the block in the next slot.  Proposer boosting should help address this.",
        "created_at": "2022-02-01T18:48:39.895000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Would be really good to check propagation times on kintsugi. How do you prepare these charts \u003c@!144468805697929216\u003e ?",
        "created_at": "2022-02-01T18:59:09.067000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Very likely an off clock",
        "created_at": "2022-02-01T18:59:56.302000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But clock drift by multiple seconds for big parts of the network?",
        "created_at": "2022-02-01T19:00:39.053000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "time it takes to propagate (first seen vs fullly propagated) is different than if a block is late (which could be the fault of a late initial sending of proposal)",
        "created_at": "2022-02-01T19:01:27.852000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "These come from Vouch metrics, and unfortunately Vouch isn't ready for the merge.  It would be possible to listen to the CL SSE stream for `head` events across multiple nodes and select the minimum as an approximation of block production (as long as the network is small enough or the peers are highly connected).",
        "created_at": "2022-02-01T19:02:43.536000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The latter can't really be controlled (although block-slot forkchoice -- which is requisite for native PBS -- would orphan and thus incentives help)\n\nthe former should be measured in a pre vs post merge context",
        "created_at": "2022-02-01T19:02:45.453000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah, this has been my read too \n\nMight be interesting to cross reference with client fingerprinting. There's a chance it's a client type in some particular configuration. Or if it doesn't map to client, thats also good data. More operator issue (cloud, resources, time sync, etc) rather than client softwsre",
        "created_at": "2022-02-01T22:54:39.966000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Right, if it's a single pool/operator that we can identify, or an issue with (I assume?) a minority client, it really helps to fix the issue.",
        "created_at": "2022-02-01T23:12:24.269000+00:00",
        "attachments": null
    }
]
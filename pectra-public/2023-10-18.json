[
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Coming back to this: looking at the blobs on devnet 9 many of them seem to have a lot of trailing 0s.  Is this an artefact of the test data, or is similar to be expected on mainnet?",
        "created_at": "2023-10-18T15:42:34.001000+00:00",
        "attachments": null
    },
    {
        "author": "pk910",
        "category": "general",
        "parent": "",
        "content": "blobs are always 4096 fields Ã¢ 32 bytes. They've got a static length.\n\"Unused\" fields are filled with 0 bytes",
        "created_at": "2023-10-18T16:25:37.647000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "But are \"unused\" fields expected to be commonplace on mainnet?",
        "created_at": "2023-10-18T16:40:23.573000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdannyryan\u003e there might be  markets that pack multi-L2s more efficiently within the blob-space",
        "created_at": "2023-10-18T16:43:08.228000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdannyryan\u003e but if one L2 uses a single blob, it'lll remain innefficient to some degree with 0s\n\nnote, these are highly compressible on the p2p, of course",
        "created_at": "2023-10-18T16:43:44.145000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "So why isn't a blob defined as something like `List[FieldElement, FIELD_ELEMENTS_PER_BLOB]` where the variable length is baked in to the definition?\n\nAgree that they can be compressed if compression is applied, but it seems that we are potentially storing and carting around a load of 0s unnecessarily.",
        "created_at": "2023-10-18T16:46:20.487000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdannyryan\u003e blobs need to be padded out to this size for the KZG verification. That said, that could have just been done when porting the variable List to verification step.",
        "created_at": "2023-10-18T16:52:31.073000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "Also, it seems less critical to constrain/optimize their size for state growth purposes, exactly because only the commitments (which don't have this issue) are the only thing on-chain.\n\nIt's arguably useful not to create fast paths/slow paths, because they'd have the typical issue of, well, the cached version works fine but when it misses cache, etc. So this way, if blobs work on one's network, they work, always. No, oops, that was a big blob and that was a small blob",
        "created_at": "2023-10-18T16:56:19.856000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Does seem a bit odd to burden ourselves with moving and storing the padding, when you'd likely be dropping the data into a fixed-size array for verification anyway so it would automatically be the correct size, but fair enough.  Will trim accordingly when storing.",
        "created_at": "2023-10-18T17:04:21.931000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "Yeah, it's compatible with that as well -- the network and KZG verification format doesn't dictate the durable storage format",
        "created_at": "2023-10-18T17:06:49.400000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "Especially for people who want to store years of blobs for \"true\"/complete archive nodes, I'm sure that'll become a standard trick to the extent it's worthwhile",
        "created_at": "2023-10-18T17:07:48.671000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e rollups always pay the same price, whether full or not. so we can largely expect them to queue transactions until they can create a full blob or if that's too scarce, share blob space",
        "created_at": "2023-10-18T17:15:57.973000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e the savings from not storing zeroes are likely very marginal",
        "created_at": "2023-10-18T17:16:17.135000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Tell that to my archive database ðŸ™‚",
        "created_at": "2023-10-18T17:17:48.169000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e implementing 4444 is the solution rather than irrelevant things that scratch the surface",
        "created_at": "2023-10-18T17:18:49.189000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "To an extent, doing some kind of primitive RLE also just seems like a less useful optimization than for such an archive database to use any usual compression algorithm (e.g., the kinds filesystems use)",
        "created_at": "2023-10-18T17:20:14.900000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "I don't control the filesystem, though.  Will do what I can to keep the size down.",
        "created_at": "2023-10-18T17:23:10.594000+00:00",
        "attachments": null
    },
    {
        "author": "rjected",
        "category": "general",
        "parent": "",
        "content": "can always encode compressed before inserting in the db",
        "created_at": "2023-10-18T17:44:21.344000+00:00",
        "attachments": null
    },
    {
        "author": "rjected",
        "category": "general",
        "parent": "",
        "content": "without changing the filesystem",
        "created_at": "2023-10-18T17:44:35.345000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "I'll just trim the trailing zeros, I think.",
        "created_at": "2023-10-18T17:47:42.899000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "simon5219",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "After the completion of the Ethernet merger, assuming that the chain activity maintains the data of the past year, the average daily handling fee is 8376 ETH, and the beacon chain issues up to 2700 ETH per day, then the total amount of Ethernet deflation. Assuming that the chain activity maintains the data of the last two months of market cooling downturn, and the average daily fee is 2662 ETH, then the next long time probability of destroying the fee is greater than the POS increase, then the total Ether deflation. Assuming the market becomes a complete bear market, the chain activity compared to the bear market in 2019, the average daily handling fee is 511 ETH, which is less than 1400 ETH, that is, the total amount of Ether will continue to be deflationary, but considering the booming development of Defi in the past two years in Ether, the chain activity and the number of Defi users, which is not comparable to 2019, so this deflation occurs is extremely unlikely. Right?",
        "created_at": "2021-07-30T03:23:46.952000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!550951048248819723\u003e this is not the right server to discuss markets",
        "created_at": "2021-07-30T06:11:02.735000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I second that. Users are indifferent to the detail of PoW consensus currently, like difficulty formula with exponentiation, Ethash epoch and related size of DAG, mixHash and so force. They even indifferent to the `DIFFICULTY` opcode they might have been hitting by their transactions. My intuition is that after the merge they will stay indifferent to consensus and a link to the corresponding beacon chain block on the page that is showing an execution block is all they should see. Even if the `SLOT` opcode will be introduced to the EVM it should be as transparent to users as the `DIFFICULTY` opcode is today.",
        "created_at": "2021-07-30T06:15:29.798000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Also, i would not make things more complex in terms of naming and use \"slot\" and \"number\" in the context of beacon block and execution block respectively. It's short, clean and sounds familiar. Nobody uses a \"number\" in application to the beacon block as far as I know.",
        "created_at": "2021-07-30T06:18:38.004000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@425572898787426305\u003e I think we should figure out whether current execution clients gossip sibling blocks or not.",
        "created_at": "2021-07-30T12:29:06.819000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Also, do you think that around the merge execution clients **should** gossip siblings?",
        "created_at": "2021-07-30T12:29:30.550000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If so, I think they need to execute them in order to determine validity.  I *think* right now execution clients validate the hash/nonce/difficulty but don't validate the roots prior to gossip.  This allows blocks to propagate quickly across the network and the risk of attack under normal circumstances is low since generating a valid proof of work is incredibly expensive.",
        "created_at": "2021-07-30T12:30:51.528000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Under the merge attack I described, I do worry a *little* bit if that cost remains high, though I don't know how feasible an attack is.",
        "created_at": "2021-07-30T12:31:17.907000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I would be curious to see numbers on the worst case scenario (all miners launch the described attack together around The Merge).  How fast can they get new sibling block production going under optimal conditions?",
        "created_at": "2021-07-30T12:32:05.546000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This feels like one of those mathy problems that \u003c@273808422753796097\u003e loves to blog about with pretty charts and formulas.  ðŸ˜‰",
        "created_at": "2021-07-30T12:32:21.834000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "For those just joining in, the question is:\n\u003e Once the first terminal PoW block is mined, if all hashing power switches over to mining a sibling chain with lower difficulty but the same eventual total difficulty, what is the maximum number of sibling terminal PoW blocks they can produce in 2 epochs?",
        "created_at": "2021-07-30T12:34:05.619000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Isn't that just ~ 64 * 12/13?",
        "created_at": "2021-07-30T12:34:44.293000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The idea is that you spend most of that time driving difficulty down on the sibling chain, and then you spend the last few minutes/hours mining as many sibling terminal PoW blocks as you can.",
        "created_at": "2021-07-30T12:34:47.168000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Because they just keep mining sisters of the same parent",
        "created_at": "2021-07-30T12:34:53.047000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "No, the idea is that they first lower the difficulty.",
        "created_at": "2021-07-30T12:35:01.448000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So you go back in history and mine a sibling chain to drive difficulty down but eventually reach target total difficulty.",
        "created_at": "2021-07-30T12:35:17.325000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Why would they do that?",
        "created_at": "2021-07-30T12:35:17.841000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah",
        "created_at": "2021-07-30T12:35:22.037000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So you can mass produce sibling blocks in the last few minutes.",
        "created_at": "2021-07-30T12:35:28.920000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Driving down difficulty should mean that the chain gets to the TD later than the main chain",
        "created_at": "2021-07-30T12:36:06.630000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes.",
        "created_at": "2021-07-30T12:36:11.963000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But clients will be gossipping all terminal PoW blocks from all chains.",
        "created_at": "2021-07-30T12:36:30.476000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Because they don't know which one will end up being canonical until the first finalization.",
        "created_at": "2021-07-30T12:36:37.801000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This is also an attack today, right?",
        "created_at": "2021-07-30T12:36:46.648000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Not really because there is financial incentive to mine the longest chain.",
        "created_at": "2021-07-30T12:36:58.462000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Since the fork choice rule is changing, incentives change.",
        "created_at": "2021-07-30T12:37:07.416000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Actually.... don't the fairly short revert limits limit how much you can do this?",
        "created_at": "2021-07-30T12:37:13.883000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Maybe!  The bottleneck may end up being the 9000 block reorg limit or whatever Geth has.",
        "created_at": "2021-07-30T12:37:34.497000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Or maybe the bottleneck is the relatively slow rate at which difficulty decreases.",
        "created_at": "2021-07-30T12:37:50.120000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah I guess you only need 20 normal blocks worth of TD space to reduce the difficulty to as low a level as you want",
        "created_at": "2021-07-30T12:38:00.300000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Hmm, really?",
        "created_at": "2021-07-30T12:38:07.538000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I didn't realize it was that fast.",
        "created_at": "2021-07-30T12:38:13.642000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Because diff can drop by up to 5% per block",
        "created_at": "2021-07-30T12:38:19.098000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If the time between blocks exceeds 891 seconds I think",
        "created_at": "2021-07-30T12:38:32.006000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So you need ~900 seconds per 5% drop in difficulty?",
        "created_at": "2021-07-30T12:38:47.010000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes",
        "created_at": "2021-07-30T12:38:51.806000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "How long is 2 epochs again?",
        "created_at": "2021-07-30T12:38:51.926000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "768 seconds",
        "created_at": "2021-07-30T12:38:59.829000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(since that is how long they have to attack)",
        "created_at": "2021-07-30T12:38:59.883000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah, so first finalization will come in before difficulty has dropped significantly it sounds like.",
        "created_at": "2021-07-30T12:39:19.572000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "They could start at an old block, and just release blocks with spaced out timestamps",
        "created_at": "2021-07-30T12:39:35.587000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Oh, right.",
        "created_at": "2021-07-30T12:39:44.583000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But then to get to the TD they would have to have pre-made all those blocks",
        "created_at": "2021-07-30T12:39:59.860000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Start -9000 blocks from head, produce a block every ~13 seconds.",
        "created_at": "2021-07-30T12:40:02.900000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "64 * 12/13 = 59",
        "created_at": "2021-07-30T12:40:21.820000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So they have time to make the equivalent of 59 blocks at normal diff",
        "created_at": "2021-07-30T12:40:36.028000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I thought the max drop should be with 1000 seconds between blocks: `max(1 - (block_timestamp - parent_timestamp) // 10, -99)`",
        "created_at": "2021-07-30T12:40:36.763000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And 59 \u003e 20",
        "created_at": "2021-07-30T12:40:44.500000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Aaah is the quotient 10? I thought it was 9",
        "created_at": "2021-07-30T12:40:57.670000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So, `20` blocks will result in 7.5 drop in difficulty",
        "created_at": "2021-07-30T12:41:07+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Maybe it decreased from 10 to 9 when we started counting uncles",
        "created_at": "2021-07-30T12:41:11.744000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ok so since 59 \u003e 20, miners *will* have time to make a chain that drops difficulty down to arbitrarily low values",
        "created_at": "2021-07-30T12:41:48.804000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "indeed, I forgot about it",
        "created_at": "2021-07-30T12:41:49.584000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So first they drive difficulty down to some very small number.  Then they mine a *very large* number of blocks at that difficulty to reach terminal TD.",
        "created_at": "2021-07-30T12:42:10.985000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Aha",
        "created_at": "2021-07-30T12:42:19.133000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Once there, they mine blocks as fast as they can and ship them to the network.",
        "created_at": "2021-07-30T12:42:23.895000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "They would not be able to reach terminal TD",
        "created_at": "2021-07-30T12:42:25.438000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "and they will need to spend some \"time\" to make their chain to reach terminal TD",
        "created_at": "2021-07-30T12:42:37.544000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Because they would have to start too far back",
        "created_at": "2021-07-30T12:42:39.010000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Because clients would reject timestamps from the future?",
        "created_at": "2021-07-30T12:42:39.295000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Right",
        "created_at": "2021-07-30T12:42:43.704000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "To avoid clients rejecting the blocks for being from the future they would have to start ln(diff reduction factor) * 20 blocks behind the head",
        "created_at": "2021-07-30T12:43:17.597000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "and the max distance to start is `128` blocks back right, this is the default state pruning distance",
        "created_at": "2021-07-30T12:43:22.332000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Is there an optimal time in the past they can start such that ~1500 seconds after Terminal TD is reached they can be back at terminal TD but with lower difficulty?",
        "created_at": "2021-07-30T12:43:40.494000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So they would only be able to decrease diff by... about 20-40x?",
        "created_at": "2021-07-30T12:43:43.583000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Their spam blocks would occur at a timestamp around 1500 seconds after main chain reached terminal TD, so they can mint blocks a bit in the future.",
        "created_at": "2021-07-30T12:44:18.105000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Plus clients I think accept a little bit of leeway in clock sync IIRC.",
        "created_at": "2021-07-30T12:44:30.708000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Sorry, just got to my laptop so I can write more clearly",
        "created_at": "2021-07-30T12:44:50.252000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "that is not a blocker, they could start much earlier because block propagation doesn't require block execution",
        "created_at": "2021-07-30T12:44:59.081000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So let's say that the attack has 64 epochs + 1 minute to take place",
        "created_at": "2021-07-30T12:45:07.786000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "What we are trying to establish is whether this is a viable attack or something that is effectively impossible to do so we can decide whether we need to think about it.  ðŸ™‚",
        "created_at": "2021-07-30T12:45:09.290000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "That's 828 seconds",
        "created_at": "2021-07-30T12:45:12.669000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think timestamp is validated prior to propogation?  Would be worth checking.",
        "created_at": "2021-07-30T12:45:32.237000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Within that time, an attacker can mine 828 / 13 = 63.6x the difficulty of the terminal block",
        "created_at": "2021-07-30T12:45:43.699000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think it is just state roots that aren't validated prior to propagation.",
        "created_at": "2021-07-30T12:45:44.808000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "timestamp in the past should be ok, no?",
        "created_at": "2021-07-30T12:46:05.115000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah, only timestamps in the future are rejected I think.",
        "created_at": "2021-07-30T12:46:19.389000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Because a block difficulty reduces by 5% if it's 900 seconds after its parent, it takes 1 + 0.95 + 0.95**2 + .... = 20 times the terminal block difficulty to mine a chain that decreases to an arbitrarily low difficulty",
        "created_at": "2021-07-30T12:46:33.372000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So hashpower-wise, miners are not prevented from attacking",
        "created_at": "2021-07-30T12:46:41.359000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "*but*",
        "created_at": "2021-07-30T12:46:43.147000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "In order to reduce difficulty by 1.05x, it takes 900 seconds of \"timestamp distance\"",
        "created_at": "2021-07-30T12:46:57.805000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And to reduce difficulty by a factor of k, it takes ln(k) * 900 * 20 of timestamp distance",
        "created_at": "2021-07-30T12:47:16.314000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So a miner would have to start building their chain from ~5h before the head, even to produce a factor-of-e reduction in difficulty",
        "created_at": "2021-07-30T12:47:46.141000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "1.05x is the max difficulty reduction per time?  There isn't some more optimal reduction like 1.03x over 450 seconds or something (local maxima)?",
        "created_at": "2021-07-30T12:47:55.660000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "it means 70 blocks worth of difficulty from the canonical chain. not sure that they would be able to fill this difficulty gap in time",
        "created_at": "2021-07-30T12:48:01.582000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Going to the max is optimal, because the first 10 seconds of timestamp difference goes to counteracting the *increase* that happens if a block comes right after its parent",
        "created_at": "2021-07-30T12:48:59.846000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It's a 99/2048 decrease at 900s, and a 49/2048 decrease at 450s",
        "created_at": "2021-07-30T12:49:33.777000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So because miners have to start building their chain from 5h before the original terminal block, they would have to do 5h worth of mining in 828 seconds",
        "created_at": "2021-07-30T12:50:10.086000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Which they cannot",
        "created_at": "2021-07-30T12:50:12.371000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "they could start _in advance_ and _try to_ reach terminal TD at the same time as the canonical chain. but that is another story as they should have no incentive in doing so",
        "created_at": "2021-07-30T12:50:43.661000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'm impressed, this problem contained logarithms! ðŸ˜†",
        "created_at": "2021-07-30T12:50:51.148000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Logarithms are above my pay grade.  ðŸ˜›",
        "created_at": "2021-07-30T12:51:10.070000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So realistically, they could maybe drop the difficulty by 10s of percents, which means they can (assuming 100% collusion on this attack) at worst maybe pump out a block every 10 seconds or so, which isn't enough to DoS the network.",
        "created_at": "2021-07-30T12:51:36.402000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "right",
        "created_at": "2021-07-30T12:51:43.071000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Which means we can ignore this \"problem\" and have execution engine clients gossip *all* sibling blocks they see until finalization.",
        "created_at": "2021-07-30T12:51:58.616000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "right",
        "created_at": "2021-07-30T12:52:12.941000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Thanks for the math help!",
        "created_at": "2021-07-30T12:52:19.209000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@425572898787426305\u003e I still think we should make sure that execution clients will in fact gossip siblings to the first TTD block they see.",
        "created_at": "2021-07-30T12:53:08.423000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I also still think that out of an abundance of caution we shouldn't disconnect peers who gossip blocks until the second finalization.",
        "created_at": "2021-07-30T12:53:13.457000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If they want to hardcode in a min \"if it's under this I won't look at it\" difficulty and set it to 1% of the current block difficulty at the time of hardcoding, I don't see why not, but yeah the math does suggest that it's not a problem",
        "created_at": "2021-07-30T12:53:15.247000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'm satisfied with leaning on the math in this case.  It was already a pretty outside attack vector, and just a troll vector more than anything else (DoS with hardware that is now useless).",
        "created_at": "2021-07-30T12:54:02.053000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think we I may close this PR after our discussion. It was really fast ðŸ˜† https://github.com/ethereum/pm/pull/368",
        "created_at": "2021-07-30T12:57:09.854000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We may ask but I am pretty sure that they gossip siblings, otherwise, how would uncles be propagated?",
        "created_at": "2021-07-30T12:58:05.843000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "That is a good point about uncles...",
        "created_at": "2021-07-30T12:58:43.286000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah, that makes sense to me",
        "created_at": "2021-07-30T12:58:50.331000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Because, miners can produce siblings of terminal block pivoting from the canonical chain which can lead to honest peers being disconnected. So, after the first finalized block *any* gossiped blocks must be discarded and after the second one handlers must be removed with the corresponding penalty.",
        "created_at": "2021-07-30T13:01:46.867000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah, exactly.  It just gives us strong guarantees that there are the following chunks of time (in order):\n1. Honest peers are gossipping new TTD blocks.\n2. Some honest peers are gossipping new TTD blocks, some are not.\n3. No honest peers are gossipping new TTD blocks.\n4. Honest peers are disconnecting any peers who gossip new TTD blocks.",
        "created_at": "2021-07-30T13:10:22.963000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If we start disconnecting after the first finalization, I worry there *might* be a case where we jump from (2) to (4), which would cause some honest peers to get disconnected from other honest peers because of network propogation time and bad luck.",
        "created_at": "2021-07-30T13:11:12.871000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think this spec change should have a corresponding rationale too",
        "created_at": "2021-07-30T13:13:56.746000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I have found that adding rationale notes for not-immediately-obvious things really helps speed up discourse over the EIP.",
        "created_at": "2021-07-30T13:15:00.118000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "People won't actually read the rationale up front, but when it comes up in conversation you can very easily link to it which facilitates moving things forward rapidly.",
        "created_at": "2021-07-30T13:15:17.828000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Should we have an \"annotated spec\" for the merge ðŸ¤” ?",
        "created_at": "2021-07-30T13:41:44.146000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If we can get the Ethereum 1.0 spec out in time that would be great.",
        "created_at": "2021-07-30T14:06:29.911000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I don't know if it is worth the effort prior that effort completing though.",
        "created_at": "2021-07-30T14:06:41.915000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It is a bonus item in the merge readiness checklist. For the execution client spec we will have those rationales in the EIP, that should work pretty well",
        "created_at": "2021-07-30T14:51:09.701000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I got lost in the above: can't a miner collusion also delay the first finalization and thus give more time to make this attack plausible \u003c@301186049323958275\u003e ? I mean, can they for example play the timings to submit pow blocks so that half the validators see them as valid and the others don't?",
        "created_at": "2021-07-30T23:54:49.482000+00:00",
        "attachments": null
    }
]
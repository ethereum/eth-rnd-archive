[
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cn0ble\u003e What kind of attack it can show up with as long as this chain is valid and the canonical one? (re @vbuterin: It has to be a totdiff and not a block number because otherwise an attacker could quietly mine a chain whose difficulty drops very low, and get to the number first)",
        "created_at": "2021-03-16T05:35:29.902000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Re-thinking on this and it seems like this option could give a trustless payment channel for miners. The issue is that miners can still sell these extra rewards; it's probably more difficult to do that as there is no withdrawals yet but sounds doable with probably a little discount",
        "created_at": "2021-03-16T06:59:12.336000+00:00",
        "attachments": null
    },
    {
        "author": "dkdkdkdkdkdk",
        "category": "general",
        "parent": "",
        "content": "how? by setting withdrawal credentials to a contract?\nalso, how long should these \"special\" rewards continue, anyway? are we talking about days or weeks?",
        "created_at": "2021-03-16T07:46:14.084000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "by setting to a contract or targeting to already existing validator set up by some party",
        "created_at": "2021-03-16T07:48:09.536000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "pretty much the same as if extra rewards would be issued on the PoW chain",
        "created_at": "2021-03-16T07:48:40.433000+00:00",
        "attachments": null
    },
    {
        "author": "dkdkdkdkdkdk",
        "category": "general",
        "parent": "",
        "content": "perhaps that could be avoided by requiring proof of ownership for the pubkey?",
        "created_at": "2021-03-16T08:05:51.141000+00:00",
        "attachments": null
    },
    {
        "author": "elbeem4277",
        "category": "general",
        "parent": "",
        "content": "This was discussed before. The issue with this, as pointed out by \u003c@301186049323958275\u003e , is that the miner could sell the rewards before mining a block. I believe the only way to guarantee that the private key is known by the miner would be to have the nonce in the ethash algorithm be the public key to the account that receives the reward. Because then there is no way to target a specific key.",
        "created_at": "2021-03-16T08:17:21.546000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Could it sign the nonce with the key?",
        "created_at": "2021-03-16T08:21:28.634000+00:00",
        "attachments": null
    },
    {
        "author": "elbeem4277",
        "category": "general",
        "parent": "",
        "content": "Hmm, unless the miner in a trustless way could get a third party to sign it without making that third party frontrun the producing of the block. Not sure...",
        "created_at": "2021-03-16T08:27:41.780000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "It could frontrun if it would know the block which is not that easy. Though, communicating with 3rd party to sign the nonce once it's found doesn't seem optimal for miner",
        "created_at": "2021-03-16T08:29:19.090000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "The drawback is the requirement of actively using the private key that is meant to be kept in a cold storage",
        "created_at": "2021-03-16T08:31:21.944000+00:00",
        "attachments": null
    },
    {
        "author": "dkdkdkdkdkdk",
        "category": "general",
        "parent": "",
        "content": "why? validator private keys are hot",
        "created_at": "2021-03-16T08:34:37.659000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "The assumption is that without possessing validator's key the withdrawal key is useless, right?",
        "created_at": "2021-03-16T08:38:29.467000+00:00",
        "attachments": null
    },
    {
        "author": "elbeem4277",
        "category": "general",
        "parent": "",
        "content": "Wait, why can't the miner just give the whole block with the unsigned nonce to the buyer? Don't we assume that the miner trust that the buyer of the block reward will pay?",
        "created_at": "2021-03-16T08:41:42.052000+00:00",
        "attachments": null
    },
    {
        "author": "dkdkdkdkdkdk",
        "category": "general",
        "parent": "",
        "content": "is this assumption needed because the miner could own the validator's key but not the withdrawal key?",
        "created_at": "2021-03-16T08:44:45.763000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Btw, signing the nonce would require an extra bits of data coming along with the block, this data obviously can't be included into block header",
        "created_at": "2021-03-16T08:44:49.510000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "yes, it could. but 3rd party that owns the withdrawal key would not be able to exit without `VoluntaryExit` message signed by validator's key",
        "created_at": "2021-03-16T08:48:54.093000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "and it seems that we can't avoid deferring proof of possession to a 3rd party",
        "created_at": "2021-03-16T08:54:09.797000+00:00",
        "attachments": null
    },
    {
        "author": "dkdkdkdkdkdk",
        "category": "general",
        "parent": "",
        "content": "not an issue if the validator is already exited I guess...",
        "created_at": "2021-03-16T09:07:41.479000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "yes, this is why the assumption",
        "created_at": "2021-03-16T09:13:41.732000+00:00",
        "attachments": null
    },
    {
        "author": "dkdkdkdkdkdk",
        "category": "general",
        "parent": "",
        "content": "isn't it economically problematic for the miner since it adds a delay to publishing the block?",
        "created_at": "2021-03-16T09:14:26.903000+00:00",
        "attachments": null
    },
    {
        "author": "elbeem4277",
        "category": "general",
        "parent": "",
        "content": "I'm not convinced it can't be done. What about this: Instead of signing the nonce, the miner must sign the random mix from the 1 GB dataset in the Ethash algorithm, and include this signature along with the mix, before taking the hash and discovering if the nonce is valid. The point of this is that if the signing is done by a third party, that party would have to do at least the same amount of work as the miner itself.",
        "created_at": "2021-03-16T10:29:34.206000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "The signature of nonce will go along with the block, it will have to be a kind of envelop that contains a block and a signature. Miner may send a block to a 3rd party and then 3rd party sends it to the wire with the signature. It's only one hop in terms of the gossip and time spent on signing",
        "created_at": "2021-03-16T11:11:27.501000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Miner may send the hash of the signing data to a 3rd party",
        "created_at": "2021-03-16T11:11:54.864000+00:00",
        "attachments": null
    },
    {
        "author": "elbeem4277",
        "category": "general",
        "parent": "",
        "content": "You mean send the random subset of the DAG to the 3rd party each time? How is that better for the 3rd party than just mining on its own?",
        "created_at": "2021-03-16T11:18:14.336000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Oh, I get what you mean. It will be required to find a nonce for a random mix of a lower size ðŸ¤”",
        "created_at": "2021-03-16T11:19:43.234000+00:00",
        "attachments": null
    },
    {
        "author": "elbeem4277",
        "category": "general",
        "parent": "",
        "content": "Yes, isn't that how Ethash works? By hashing random subsets of the DAG?",
        "created_at": "2021-03-16T11:21:35.906000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "What would be the operation of \"signing the random mix\"?",
        "created_at": "2021-03-16T11:23:21.764000+00:00",
        "attachments": null
    },
    {
        "author": "elbeem4277",
        "category": "general",
        "parent": "",
        "content": "I'm not too familiar with the ethash algorithm, but I was thinking something like signing with the private key the concatination of the subset of the DAG used in one run of the hashimoto function. I'm not qualified to say exactly how this affects the desired properties of Ethash, such as light-client friendliness.",
        "created_at": "2021-03-16T11:51:35.995000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "First, you will have to use some function to reduce the signing data to 32-bytes vector (either hashing or xoring pieces of a DAG file). Which implies that you can send this vector to a 3rd party alongside with a block",
        "created_at": "2021-03-16T11:54:30.740000+00:00",
        "attachments": null
    },
    {
        "author": "elbeem4277",
        "category": "general",
        "parent": "",
        "content": "Hmm, could we use KZG commitments for this?",
        "created_at": "2021-03-16T11:59:31.851000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "If we use them to replace the hash function, i.e. as a data commitment scheme, then we fall into the same problem as with regular hash. We could use a kind of proof-of-custody solution which would require to hash DAG pieces with some secret and then reduce them to a hash that is gonna be signed; it would require PoC challenges. But doesn't it become too complicated?",
        "created_at": "2021-03-16T12:04:59.324000+00:00",
        "attachments": null
    },
    {
        "author": "elbeem4277",
        "category": "general",
        "parent": "",
        "content": "Yeah, we would need a non-interactive construction that proves that the prover knows (1) the random subset of the DAG used in the hashimoto function, and (2) the private key associated to a public key. I was thinking that KZG commitments could do that, as in the proposed proof-of-custody scheme used in ETH2 sharding, or perhaps zk-S(N/T)ARKs but I am no expert. It might be too complicated, indeed.",
        "created_at": "2021-03-16T12:24:37.864000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e There is no requirement in my proposal for the block to be in the canonical pow chain to be included as a beacon block (re @n0ble: What kind of attack it can show up with as long as this chain is valid and the canonical one?)",
        "created_at": "2021-03-16T12:40:00.765000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e And I think this is important",
        "created_at": "2021-03-16T12:40:07.228000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e Because it means that it's not a two-way dependent fork choice, which would be much harder to analyze",
        "created_at": "2021-03-16T12:40:35.640000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "general",
        "parent": "",
        "content": "What happens if the beacon chain references an invalid ETH 1.0 block? Is it ignored by the ETH 1.0 chain or it makes the beacon block invalid? I figure the former",
        "created_at": "2021-03-16T12:48:30.373000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e no, it has to be the latter",
        "created_at": "2021-03-16T12:48:49.325000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e otherwise, the next beacon block would be built on an invalid block â€” how do we get the invalid block removed from the beacon chain?",
        "created_at": "2021-03-16T12:50:12.254000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "general",
        "parent": "",
        "content": "If validators keep building on an invalid block they are missing out tips and mev on ETH 1.0, someone eventually will pick up the last valid head and build back from there",
        "created_at": "2021-03-16T12:51:00.419000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "general",
        "parent": "",
        "content": "if you require the beacon block to be valid only if the ETH 1.0 state transition is valid, doesn't that introduces the \"two-way dependent fork choice\"?",
        "created_at": "2021-03-16T12:51:33.666000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e but a requirement is for beacon blocks to build on the previous eth1 state root",
        "created_at": "2021-03-16T12:51:36.500000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e so you cannot just build on an old block, except if you ignore all the previous blocks on the beacon chain that built on the invalid block. In this case, your block would not be the heaviest in the fork choice rules and ignored by the other attesters",
        "created_at": "2021-03-16T12:52:26.816000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e No, there is only one fork choice, eth eth2 one. Eth1 POW is completely ignored. But the validity of the beacon block requires validity of the eth1 block. That's not a fork choice, that's a validity condition (re @ef_general_chat_bridge_bot: \u003cAgusx1211\u003e if you require the beacon block to be valid only if the ETH 1.0 state transition is valid, doesn't that introduces the \"two-way dependent fork choice\"?)",
        "created_at": "2021-03-16T12:53:14.792000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "general",
        "parent": "",
        "content": "Yes that makes sense, but that rule could also be applied by the ETH 1.0 fork choice when it receives a new head from the Beacon chain",
        "created_at": "2021-03-16T12:53:25.161000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "general",
        "parent": "",
        "content": "I mean, the rule being, \"the new block must be built on top of the latest previous valid ETH 1.0 root published on the Beacon chain\"",
        "created_at": "2021-03-16T12:54:07.312000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e so your suggestion is \n* Beacon chain includes eth1 blocks, but no validity condition\n* all *valid* blocks on the beacon chain will be added to eth1 chain, invalid blocks are just ignored\n?",
        "created_at": "2021-03-16T12:54:55.124000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "general",
        "parent": "",
        "content": "To clarify, I am not suggesting it, I thought that was the original plan. It seems simpler that way, because it doesn't bloat the consensus of the beacon chain.",
        "created_at": "2021-03-16T12:55:50.972000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e In this case, there's a big downside for anyone who is not following the beacon chain and eth1 full time, for example all light clients",
        "created_at": "2021-03-16T12:57:45.421000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e they basically wouldn't know whether or not they can trust an eth1 block that's on the beacon chain. Basically we would completely break light clients",
        "created_at": "2021-03-16T12:58:12.928000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "general",
        "parent": "",
        "content": "yes that's true",
        "created_at": "2021-03-16T12:58:25.659000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cdankrad\u003e proving what the latest eth1 root is does not require the entire history of eth1 since merge, and that's pretty terrible",
        "created_at": "2021-03-16T12:59:06.046000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cn0ble\u003e Right, my assumption is that proposer picks a pow block that is observed as canonical and satisfies the transition condition (TD \u003e= TRANSITION_TD) then attesters does not require it to be canonical, they only check that itâ€™s been imported and satisfies the transition conditions.\nI donâ€™t see the issues with picking up a block by its height in the same fashion as it would be picked by TD. You were referring to attacks that could be avoided by using the TD instead. And I am wondering what kind of attack it could be as the only thing we need to check is that the block is valid (and available) and satisfies the transition conditions (re @vbuterin: Because it means that it's not a two-way dependent fork choice, which would be much harder to analyze)",
        "created_at": "2021-03-16T13:00:14.408000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e Imagine an attacker gets to the target block height weeks before the legitimate chain because they privately mined a chain where they let the difficulty drop very low",
        "created_at": "2021-03-16T13:05:06.534000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cn0ble\u003e Then it either requires malicious proposer that will take off of this chain or this chain to outperform the canonical one. The latter is hardly the case, for the former malicious miner could have a validator or several of them on the beacon chain and wait for his turn to propose a block. Hmm",
        "created_at": "2021-03-16T13:10:16.317000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cn0ble\u003e Is there the case for this kind of attack that does not require interaction between PoW miners and PoS validators?",
        "created_at": "2021-03-16T13:29:38.967000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cn0ble\u003e The worst case of this scenario that I could imagine is the alternative chain with a 51% of hashpower revealed right before the transition point finishing double spend attack and solidifying its results by the beacon chain finality. But this would also mean that this alternative chain has bigger total difficulty (re @vbuterin: Imagine an attacker gets to the target block height weeks before the legitimate chain because they privately mined a chain where they let the difficulty drop very low)",
        "created_at": "2021-03-16T13:36:06.803000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e \u003e Then it either requires malicious proposer that will take off of this chain",
        "created_at": "2021-03-16T13:54:51.499000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e The problem is that it only requires one malicious proposer, and after that point everyone will accept it",
        "created_at": "2021-03-16T13:55:07.518000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cn0ble\u003e yes, I see",
        "created_at": "2021-03-16T13:58:15.272000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cn0ble\u003e btw, this chain with low total difficulty could potentially complete double spend attack as well",
        "created_at": "2021-03-16T14:00:03.620000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e yes",
        "created_at": "2021-03-16T14:00:10.244000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "general",
        "parent": "",
        "content": "the above scenario, I can imagine \"might\" be an issue if there was no social coordination RE the merge.. as I would fully expect exchanges (and for the most part all users) to stop withdrawals and really to not use the network during that window pending the outcome. in that scenario, with mininimal utilization would I be correct that a 51% attack would have diminishing returns (for the attacker) if the users basically know to standdown for a while?",
        "created_at": "2021-03-16T14:48:00.156000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "general",
        "parent": "",
        "content": "in that context, I would think the impacts could possibly be hedged and still have a successful merge..",
        "created_at": "2021-03-16T14:48:37.946000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "I am wondering how long is the pause that they can take",
        "created_at": "2021-03-16T14:56:06.246000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "general",
        "parent": "",
        "content": "from a social perspective, I can easily imagine exchanges pausing the day before, the day of, and the day after the merge before allowing significant usage pending the outcome..",
        "created_at": "2021-03-16T14:57:05.083000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "general",
        "parent": "",
        "content": "and this actually leads down another possible path whereby in ETH2 the notion of finality exists, are there discussions of doing something similar X blocks before the merge in powchain to also minimize the 51% theoretical impact ? (not sure if that is possible)... though I can say, as an absolute non-expert on the tech implementation, many in the community are  concerned about how much a 51% miner attack / revolt would impact the merge... I am no ambassador to the average guy / gal in the ETH space.. though I do beleive hearing from the ACD about the possibilities (all of them, especially the insanely unlikely ones) will go a long way in communicating how the merge will occur smoothly (or \"mostly\" smoothly and how \"mostly\" is basically something to not be too concerned  about...)",
        "created_at": "2021-03-16T15:02:47.705000+00:00",
        "attachments": null
    },
    {
        "author": "sma4321",
        "category": "general",
        "parent": "",
        "content": "since clients do regular releases, could the window for a long range attack be limited by clients agreeing to hardcode a known eth1 blockhash into their client that the chain must have built upon? to be chosen at the last eth2/ACD call prior to merge",
        "created_at": "2021-03-16T21:11:18.464000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "general",
        "parent": "",
        "content": "But in that case you are still vulnerable to an attack that spans days of reorg",
        "created_at": "2021-03-16T21:54:01.809000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e \u003e I am wondering how long is the pause that they can take\n\"from 2 days before to 12 hours after\" is a reasonable recommendation maybe?",
        "created_at": "2021-03-16T22:23:13.182000+00:00",
        "attachments": null
    },
    {
        "author": "dkdkdkdkdkdk",
        "category": "general",
        "parent": "",
        "content": "does the \"pause\" imply fewer transactions and thus lower mining rewards?",
        "created_at": "2021-03-16T22:39:07.201000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e I doubt exchange deposits are a significant portion of all txs",
        "created_at": "2021-03-16T22:44:11.139000+00:00",
        "attachments": null
    },
    {
        "author": "dkdkdkdkdkdk",
        "category": "general",
        "parent": "",
        "content": "do you think the volume of other transactions would remain the same around the time of the merge?",
        "created_at": "2021-03-16T22:49:11.651000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e I would expect that many users stop using ethereum, but tx usage would still stay close to the gas limit, because defi arbitrage will always expand to fill up any space it has",
        "created_at": "2021-03-16T22:49:46.354000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e Question about the executable beacon chain proposal: current worst case eth1 blocks can take 10s of seconds to execute. Could this become a problem? You can basically stop the beacon chain doing anything for several blocks",
        "created_at": "2021-03-03T01:54:32.274000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e that's a problem, though it would degrade gracefully (at least unless we naively add that (block, slot) mechanism...)",
        "created_at": "2021-03-03T01:55:28.601000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e Though statelessness can fix that worst case",
        "created_at": "2021-03-03T01:56:02.622000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e As can state expiry if the remaining state is small enough",
        "created_at": "2021-03-03T01:56:15.414000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e Hence my post in magicians today about needing to speed up work on those two things",
        "created_at": "2021-03-03T01:56:31.518000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e Right",
        "created_at": "2021-03-03T01:58:42.963000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e So basically worst case is one block kills 10 beacon chain blocks, but that's OK...",
        "created_at": "2021-03-03T01:59:07.375000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e post-EIP-2929 that's already going down to 3",
        "created_at": "2021-03-03T01:59:20.615000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e Yup",
        "created_at": "2021-03-03T01:59:26.357000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e Though I am predicting the community will demand gas limit increases that push it back up to ~5",
        "created_at": "2021-03-03T01:59:35.615000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e Hence we need statelessness üòÇ",
        "created_at": "2021-03-03T01:59:45.144000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e I was hoping merge would let us increase gas but this makes me less optimistic",
        "created_at": "2021-03-03T01:59:51.337000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e Actually this works well as long as block proposers skip proposal if they aren't done processing the previous block",
        "created_at": "2021-03-03T02:01:20.264000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e Which is probably the default behaviour of clients",
        "created_at": "2021-03-03T02:01:43.400000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e But if they instead do the rational thing and propose anyway, it could become messy",
        "created_at": "2021-03-03T02:02:05.690000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e what if the rational thing is to propose empty blocks so the eth1 state root is just copied over?",
        "created_at": "2021-03-03T02:03:32.281000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e Don't get to collect fees then",
        "created_at": "2021-03-03T02:04:18.659000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e meh, with EIP 1559 that isn't even worth that much",
        "created_at": "2021-03-03T02:04:32.647000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e Tbd",
        "created_at": "2021-03-03T02:04:42.788000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e üòù",
        "created_at": "2021-03-03T02:04:50.788000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e According to John Adler, only 1% will be üî•",
        "created_at": "2021-03-03T02:05:06.512000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e Right but it's still probably more profitable to do this than to try to compete with the block",
        "created_at": "2021-03-03T02:05:45.383000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e Rational behaviour could also be to propose a non-DOSing block",
        "created_at": "2021-03-03T02:05:47.973000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e If clients parallelize block processing, that could work out well",
        "created_at": "2021-03-03T02:06:22.584000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e Which is essentially censorship of DOS blocks",
        "created_at": "2021-03-03T02:06:41.393000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cn0ble\u003e could you please give an example? (re @dankrad: Question about the executable beacon chain proposal: current worst case eth1 blocks can take 10s of seconds to execute. Could this become a problem? You can basically stop the beacon chain doing anything for several blocks)",
        "created_at": "2021-03-03T02:19:41.664000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e Gas costs were increased to mitigate this, but recent numbers suggest they were not increased enough. Quoting https://arxiv.org/pdf/1909.07220.pdf:\n    Although by itself, this issue might seem benign, EXTCODESIZE forces the client to search the contract ondisk, resulting in IO heavy transactions. While replaying the Ethereum history on our hardware, the malicious transactions took around 20 to 80 seconds to execute, compared to a few milliseconds for the average transactions",
        "created_at": "2021-03-03T02:20:15.887000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cn0ble\u003e this is one of the protections from DoS. the other, which is more complex, could be to measure the execution time and publish blocks with a few transactions. Though, it might be irrational action taking in account too low fees that these transactions might worth (re @vbuterin: what if the rational thing is to propose empty blocks so the eth1 state root is just copied over?)",
        "created_at": "2021-03-03T02:30:21.455000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cn0ble\u003e what exact parallelization do you mean here? (re @dankrad: If clients parallelize block processing, that could work out well)",
        "created_at": "2021-03-03T02:30:45.997000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e Basically being able to process several incoming blocks in parallel. This means that block n+1 may be available to the fork choice before block n, if block n takes long to process\nThis is assuming n+1 is built on an empty slot",
        "created_at": "2021-03-03T02:41:08.682000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cn0ble\u003e I get it. Currently fork choice rule explicitly states that block processing should be delayed until a slot is in the past. Though, not sure how exactly this rule is implemented by clients. If slot n is considered empty then honest proposer should build a block at most at the beginning of slot n+1, right? How parallel processing of future blocks would help to sort out payloads that doesn‚Äôt fit into a slot?",
        "created_at": "2021-03-03T02:52:03.096000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cn0ble\u003e I am wondering the way to evict heavy transactions from tx pool as if the order of txes is the same across different clients which is highly the case then without a kind of eviction it would not be possible to build a payload that fits the slot in terms of execution and application network may stuck.",
        "created_at": "2021-03-03T02:53:45.755000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cn0ble\u003e Btw, home stakers also have an option to fall back to producing empty application payload and they will likely do this because keeping a full application node (eth1 node) around to be able to produce once a year does not worth the cost",
        "created_at": "2021-03-03T03:03:15.056000+00:00",
        "attachments": null
    },
    {
        "author": "trent_vanepps",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "i think people don't understand the challenges with increasing the gas limit. publicly communicating this would help",
        "created_at": "2021-03-03T03:49:46.297000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Re: increased rewards near the point of merge. One another thing to consider is postponing the merge in case of emergency. Hope to handle increased rewards in this case?",
        "created_at": "2021-03-03T07:28:03.879000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Presumably such a postponement would *also* postpone the block reward increase.",
        "created_at": "2021-03-03T07:33:34.886000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Right, but what if they already in place?",
        "created_at": "2021-03-03T07:53:46.031000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I would assume that any client update that pushes back the PoS transition would also push back the block reward increase.",
        "created_at": "2021-03-03T07:58:10.606000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And rewards that has already been paid by the time of pushback (if we have those) are just wasted. Though, the probability of pushback is pretty low but we already have a precedent with Petersburg fork",
        "created_at": "2021-03-03T08:12:02.792000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah, that is another argument in favor of back-loading rewards in the merge block.",
        "created_at": "2021-03-03T08:24:26.210000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e But, we should also increase the gas limit, if we can! (re @ef_general_chat_bridge_bot: \u003cTrent\u003e i think people don't understand the challenges with increasing the gas limit. publicly communicating this would help)",
        "created_at": "2021-03-03T09:58:06.287000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e One problem is that the beacon chain will degrade with only a few seconds block processing time already ‚Äî but theoretically, the deterministic block times should have allowed us to go to 10s per block because of decreased uncle risk",
        "created_at": "2021-03-03T10:00:12.048000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e No, you can't do that, because that also means you cannot validate beacon blocks.\n[Yes, I know you can simply ignore Eth1 and just accept any Eth1 payload. This is bad and has to be discouraged. It's the verifiers dilemma] (re @n0ble: Btw, home stakers also have an option to fall back to producing empty application payload and they will likely do this because keeping a full application node (eth1 node) around to be able to produce once a year does not worth the cost)",
        "created_at": "2021-03-03T10:13:06.008000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cn0ble\u003e Yes, but it would require to increase number of seconds per slot to allow for smooth block dissemination and attesting (re @dankrad: One problem is that the beacon chain will degrade with only a few seconds block processing time already ‚Äî but theoretically, the deterministic block times should have allowed us to go to 10s per block because of decreased uncle risk)",
        "created_at": "2021-03-03T10:37:27.338000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e yeah. Unless you do something fancy where a block's eth1 payload is not validated until the next block.\nBut that would require some changes to the protocol. Basically we would have to be able to charge the pervious block's proposer for gas consumed by an invalid eth1 payload",
        "created_at": "2021-03-03T10:44:42.966000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e actually, maybe that's not that hard",
        "created_at": "2021-03-03T10:44:50.629000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cn0ble\u003e It sounds like increasing MIN_ATTESTATION_INCLUSION_DELAY to 2. If attesters attest to the consensus part of most recent block and to the application payload of the block earlier it introduces a partially valid block state which is not that useful, IMO, as everyone will wait for the full validity state of a block. (re @dankrad: yeah. Unless you do something fancy where a block's eth1 payload is not validated until the next block.\nBut that would require some changes to the protocol. Basically we would have to be able to charge the pervious block's proposer for gas consumed by an invalid eth1 payload)",
        "created_at": "2021-03-03T10:55:00.241000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e basically, we need to modify the Eth1 payload such that *any* payload is valid. If it contains any outright illegal operations (e.g. invalid opcodes), then it simply corresponds to the trivial state transition with all gas spent so far charged to the block producer",
        "created_at": "2021-03-03T10:56:24.293000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e in this case, you do not need to wait for the eth1 payload to be validated for attesting to it. you just need the next block proposer to include a valid state root for the eth1 post-state",
        "created_at": "2021-03-03T10:57:14.293000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e this means you have one full slot to execute, rather than 1/3 as it is (propagate slot and execute it, that is), which is very tight (really means we can't target more than 1-2s)",
        "created_at": "2021-03-03T10:57:50.764000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e with this we can probably target 6s blocks (so \u003e100M gas) and still be ok, which would be pretty awesome",
        "created_at": "2021-03-03T10:58:22.272000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cn0ble\u003e I get it, it introduces new responsibilities, that is sequencing and execution. A proposer becomes an executor of the previous payload and a sequencer of a new one. (re @dankrad: in this case, you do not need to wait for the eth1 payload to be validated for attesting to it. you just need the next block proposer to include a valid state root for the eth1 post-state)",
        "created_at": "2021-03-03T11:01:30.950000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e true, it doubles the load for block producers, because they do need to actually check that their payload is valid in order not to get punished",
        "created_at": "2021-03-03T11:02:25.640000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e however, if we target 6s, there would still be enough time for it in the average case ‚Äî you would have exactly 2 block execution times after you receive the previous block to produce your own block",
        "created_at": "2021-03-03T11:03:16.604000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e probably need 5s to account for propagation delays",
        "created_at": "2021-03-03T11:03:26.379000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cn0ble\u003e This separation of concerns make sense to me as it is one of the ways for L1 scalability. There could be other options whithin this model, like one sequencer with multiple executors, but that is much more complicated.",
        "created_at": "2021-03-03T11:10:08.259000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e wrote this up to put it out there:\nhttps://ethresear.ch/t/commit-to-pre-state-instead-of-post-state-on-the-executable-beacon-chain/8802",
        "created_at": "2021-03-03T12:56:20.968000+00:00",
        "attachments": null
    },
    {
        "author": "chat-bridge",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cn0ble\u003e great! üëç I‚Äôll take a closer look tomorrow (re @dankrad: wrote this up to put it out there:\nhttps://ethresear.ch/t/commit-to-pre-state-instead-of-post-state-on-the-executable-beacon-chain/8802)",
        "created_at": "2021-03-03T13:01:24.682000+00:00",
        "attachments": null
    }
]
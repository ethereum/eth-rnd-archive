[
    {
        "author": "hossein_mohebbi",
        "category": "general",
        "parent": "",
        "content": "Hey! so I know with the shapella hard fork, we will have withdrawal capability from validators...\nI had a question/issue I was trying to figure out and would really appreciate any help on it!\nTo summarize we have 3 cases that lead to a reduced balance:\n\n1. voluntary full withdrawal where the user unstakes and retrieves all funds + rewards. Leads to exiting.\n2. an automatic withdraw when the user takes no action after the upgrade. Excess balance (over 32 eth) is automatically returned. Validator remains active.\n3. slashing when there is a violation in attestation. Penalty is applied in balance and leads to exiting. Full withdrawal becomes available afterwards.\n\nThe issue I have is that I am not sure how to tell these 3 situations apart. All we see from the beacon chain is a reduced balance but that does not give any information about the cause of that. \n\nI was wondering if there  are any events or APIs on the beacon chain that check rewards, slashes and withdrawals. Do these currently exist? If so can you give me the API docs to check this?\n\nBased off this article https://www.attestant.io/posts/understanding-the-validator-lifecycle/ we have a few event types each with their own statuses \n- deposited\n- pending\n- active\n- exiting\n- slashing\n- exited\n\nWill there be a new status or event type for withdrawals?\nCan that be used to help figure this problem out? (ie. checking state before balance reduction through some api?)\n\nAny resources / advice is appreciated!",
        "created_at": "2023-02-03T05:46:14.933000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "(could you remove the cross-post in \u003c#598292067260825641\u003e ?)\n\nCan't you just look at the validator status? `/eth/v1/beacon/states/{state_id}/validators/{validator_id}` endpoint, and the `/eth/v1/beacon/states/{state_id}/validators` endpoint. The latter you can query with `?status=\u003csome status\u003e`, with statuses explained in https://hackmd.io/ofFJ5gOmQpu1jjHilHbdQQ",
        "created_at": "2023-02-03T09:24:12.300000+00:00",
        "attachments": null
    },
    {
        "author": "hossein_mohebbi",
        "category": "general",
        "parent": "",
        "content": "But how would a partial (automatic) versus a full (voluntary) withdrawal be distinguished based on status?",
        "created_at": "2023-02-03T09:26:09.136000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "https://hackmd.io/ofFJ5gOmQpu1jjHilHbdQQ",
        "created_at": "2023-02-03T09:26:24.385000+00:00",
        "attachments": null
    },
    {
        "author": "hossein_mohebbi",
        "category": "general",
        "parent": "",
        "content": "That url doesn‚Äôt explain the two possible withdrawals and how to tell them apart though. I think you helped distinguish slashing though. Would you happen to know what API can determine the sub statuses mentioned in the article? Btw thank you sm for the help and response",
        "created_at": "2023-02-03T09:30:00.892000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "Those two endpoints I listed",
        "created_at": "2023-02-03T09:30:44.805000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "Querying an individual validator lists the status as in that document (so you know if it's exiting, exited, because of slashing or voluntary, when it will exit, when it can withdraw, if it did, etc). Or you can ask all validators that match a certain status (or substatus)",
        "created_at": "2023-02-03T09:31:34.587000+00:00",
        "attachments": null
    },
    {
        "author": "hossein_mohebbi",
        "category": "general",
        "parent": "",
        "content": "Ah so they return not just the status but also the sub statuses?",
        "created_at": "2023-02-03T09:32:05.701000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "Yes  üôÇ  (18446744073709551615 = UINT_MAX is the placeholder number for \"not set\")",
        "created_at": "2023-02-03T09:32:14.775000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "```json\n{\n  \"execution_optimistic\": false,\n  \"data\": {\n    \"index\": \"10000\",\n    \"balance\": \"36505432027\",\n    \"status\": \"active_ongoing\",\n    \"validator\": {\n      \"pubkey\": \"0x945f3b894c8e7fb6f61cff5d6f388298953b4114949dff1f356358d20657907e6af8ea81c8b326c378457d6593ffca16\",\n      \"withdrawal_credentials\": \"0x00acdfff23b628cb15fdd11a20ebeb205c45b468c0015ab4fe4822eea5c95eb8\",\n      \"effective_balance\": \"32000000000\",\n      \"slashed\": false,\n      \"activation_eligibility_epoch\": \"0\",\n      \"activation_epoch\": \"0\",\n      \"exit_epoch\": \"18446744073709551615\",\n      \"withdrawable_epoch\": \"18446744073709551615\"\n    }\n  }\n}\n```",
        "created_at": "2023-02-03T09:32:46.036000+00:00",
        "attachments": null
    },
    {
        "author": "hossein_mohebbi",
        "category": "general",
        "parent": "",
        "content": "‚ÄúNot set‚Äù as in no status for an uninitialized validator?",
        "created_at": "2023-02-03T09:34:20.361000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "No, I meant the exit epoch and withdrawable epoch",
        "created_at": "2023-02-03T09:34:32.297000+00:00",
        "attachments": null
    },
    {
        "author": "hossein_mohebbi",
        "category": "general",
        "parent": "",
        "content": "I see I think this makes sense and makes the problem simpler! Just one final note",
        "created_at": "2023-02-03T09:35:41.003000+00:00",
        "attachments": null
    },
    {
        "author": "hossein_mohebbi",
        "category": "general",
        "parent": "",
        "content": "Do you have a sample response for just status query? I am a little unsure of how the sub statuses can be useful based off the example you showed",
        "created_at": "2023-02-03T09:36:41.660000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "general",
        "parent": "",
        "content": "Not sure what you mean with \"just status query\". If you mean the `/validators?status=...` endpoint, it's just an array of the above object. I suggest you start playing around querying your own node, and see if you can make things work for you",
        "created_at": "2023-02-03T09:38:24.394000+00:00",
        "attachments": null
    },
    {
        "author": "hossein_mohebbi",
        "category": "general",
        "parent": "",
        "content": "got it! Appreciate the insight and help thank you!",
        "created_at": "2023-02-03T09:39:37.408000+00:00",
        "attachments": null
    },
    {
        "author": "mithril1600",
        "category": "general",
        "parent": "",
        "content": "for shanghai, are there changes in the p2p messages between execution layer clients?",
        "created_at": "2023-02-03T14:21:21.678000+00:00",
        "attachments": null
    },
    {
        "author": "mithril1600",
        "category": "general",
        "parent": "",
        "content": "similarly, are there changes in topics between consensus layer nodes?",
        "created_at": "2023-02-03T14:21:37.846000+00:00",
        "attachments": null
    },
    {
        "author": "mithril1600",
        "category": "general",
        "parent": "",
        "content": "im going through the specs soon but figured i'd ask here",
        "created_at": "2023-02-03T14:21:45.691000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "general",
        "parent": "",
        "content": "Yes, the block bodies have an additional field []withdrawals and the headers a withdrawalHash.\nBut those are additions to existing fields, so we decided not create a new eth protocol version",
        "created_at": "2023-02-03T14:23:53.502000+00:00",
        "attachments": null
    },
    {
        "author": "mithril1600",
        "category": "general",
        "parent": "",
        "content": "thank you so much, im going to look deeper in the execution specs to study more.",
        "created_at": "2023-02-03T14:24:32.101000+00:00",
        "attachments": null
    },
    {
        "author": "franjo8",
        "category": "general",
        "parent": "",
        "content": "May we request a few hundreds validators worth of ETH for testing diva (lsd dvt) protocol? request-zhejiang-eth 0x08DdcCb42e5ee1211aE18841359Bcd679eAa63EC thanks! ping \u003c@412614104222531604\u003e",
        "created_at": "2023-02-03T16:11:56.678000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "general",
        "parent": "",
        "content": "sent",
        "created_at": "2023-02-03T16:12:34.635000+00:00",
        "attachments": null
    },
    {
        "author": "bbuddha.xyz",
        "category": "general",
        "parent": "",
        "content": "is there any way to find a withdrawal on the zhejiang beacon chain explorer?",
        "created_at": "2023-02-03T20:24:14.380000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "general",
        "parent": "",
        "content": "Withdrawals will be activated on Capella Shanghai update. Coming online next Tuesday at 1500 utc",
        "created_at": "2023-02-03T20:43:06.565000+00:00",
        "attachments": null
    },
    {
        "author": "bbuddha.xyz",
        "category": "general",
        "parent": "",
        "content": "awesome ty!",
        "created_at": "2023-02-03T21:27:29.610000+00:00",
        "attachments": null
    }
]
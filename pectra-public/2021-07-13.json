[
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If not randao, my vote is 0. 1 or anything non-zero could hide bugs in normal operation -- that is, the old pow/heaviest chain fork choice might accidentally still be in operation somewhere in the codebase because in normal operation it would agree with lmd ghost",
        "created_at": "2021-07-13T00:10:39.132000+00:00",
        "attachments": null
    },
    {
        "author": "vgadde.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Once merge is complete to POS.. will Ethereum POW data be available as a subgraph on graph network?",
        "created_at": "2021-07-13T03:21:01.105000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We should have a discussion about this.  I wasn't on the call, but after the call I spoke with \u003c@360491619402776577\u003e to better understand the issue Geth is facing and I don't think it prevents us from swapping in RANDAO, it just may require some minor changes to that plan.",
        "created_at": "2021-07-13T04:00:35.920000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You would have to talk to The Graph people about that.",
        "created_at": "2021-07-13T04:00:54.628000+00:00",
        "attachments": null
    },
    {
        "author": "vgadde.eth",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Sorry to bother you.. but shouldn‚Äôt the Ethereum dev team deploy subgraph to make data available on graph network",
        "created_at": "2021-07-13T04:06:00.821000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It is not necessary if that is what you mean.  You'll still be able to sync via Ethereum gossip network.",
        "created_at": "2021-07-13T04:06:32.429000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If someone wants to host the PoW chain somewhere they are more then welcome to, but that is up to individuals/businesses and not a concern of the Ethereum core protocol.",
        "created_at": "2021-07-13T04:06:59.356000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We will definitely have it. An alternative place for randao suggested by Peter is `mixHash` field but it would require a change in the EVM context. My preference is the way requiring less efforts from core developers.",
        "created_at": "2021-07-13T05:07:23.177000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I don't think we need an alternative location.",
        "created_at": "2021-07-13T05:08:26.646000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I am very frustrated I missed the call, and would love to engage \u003c@!206016661470314496\u003e on this a bit more in depth somewhere.  My first inclination is that there may have been a miscommunication on what exactly we mean when we say \"replace the difficulty with the RANDAO\".  If not, then I think we can fallback to just having the RANDAO opcode return 80 bits of the RANDAO after The Merge, and then we extend that to 256 bits in a future hard fork.",
        "created_at": "2021-07-13T05:10:18.167000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Really what we are saying is that The Merge would contain three separate but related changes:\n1. Remove the 8th item (difficulty) from the block header.\n2. Insert `randao` as the 8th item in the block header.\n3. Change the `0x44` opcode to return the `randao` block header field instead of the `difficulty` block header field.\nBonus. JSON-RPC block responses would have a `randao` property or a `difficulty` property but never both.",
        "created_at": "2021-07-13T05:11:33.952000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Everywhere in the internal code for a client you can refer to and store the randao separate from the difficulty.  By having them live at the same position in the block header it means that *some* tools may not need to be updated to continue working, but from a specification perspective difficulty != randao, it is a simultaneous removal of a field and addition of a field.",
        "created_at": "2021-07-13T05:13:01.385000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "With 1559, we have precedence for adding/removing a field from the block header, so I'm *hopeful* this won't be too difficult for Geth.  However, if it is we can fallback to 80 bit RANDAO in the block header for the merge and 256-bit upgrade in the fork after the merge.",
        "created_at": "2021-07-13T05:15:13.667000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Advantage of re-using the same field is in no need to change EVM. Deprecating `difficulty` (always set to `0`) and reusing `mixHash` for randao should be totally fine. We can add `randao` field to the end of the header, but then I'd ask what's bad with `mixHash`? It could be renamed and exposed by JSON-RPC as well",
        "created_at": "2021-07-13T05:22:32.531000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I suppose with The Merge we actually have two fields that become useless?  Difficulty (8th field) and ProofOfWork/MixHash/MixDigest (14th field)?",
        "created_at": "2021-07-13T05:24:39.651000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "difficulty/mixHash/nonce",
        "created_at": "2021-07-13T05:25:14.058000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah, right.  Nonce is useless as well.  üòñ",
        "created_at": "2021-07-13T05:25:24.346000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So the 8th (difficulty), 14th (mixhash), 15th (nonce) fields of the block are available for replacement if we want to avoid changing the shape of the block.",
        "created_at": "2021-07-13T05:25:56.210000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I don't think we should drop any field from block header. It is bug prone, especially near the point of merge. IIRC, there was no opposition to re-defining `difficulty` as `randao`, just a caveat that it should be done carefully as it could accidentally lead to total difficulty growth and potential overflows depending on implementation. `mixHash` should be safer in that regard",
        "created_at": "2021-07-13T05:29:16.264000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'm not opposed to using one of those other fields (like mixhash).",
        "created_at": "2021-07-13T05:29:19.579000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "One more argument, `mixHash` is always 32-bytes, while `difficulty` fits into 1 byte if set to `0`. Though, it's a weak argument",
        "created_at": "2021-07-13T05:30:19.569000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I tend to agree that for The Merge we shouldn't change the block header, but I strongly believe that we should remove the unused fields in the cleanup hardfork rathere than schlepping them around forever.",
        "created_at": "2021-07-13T05:30:20.825000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Agree on that",
        "created_at": "2021-07-13T05:31:06.956000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Proposal:\n1. 14th field (mixhash) is removed from the block header.\n2. randao is inserted as a new 14th field in the block header.\n3. `0x44` (`DIFFICULTY`) opcode returns the 14th block header field instead of the 8th block header field.\nBonus. JSON-RPC endponits that return blocks no longer include `difficulty`, `nonce`, `mixhash` and now include `randao` property.",
        "created_at": "2021-07-13T05:32:52.464000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Seem reasonable to you \u003c@425572898787426305\u003e?",
        "created_at": "2021-07-13T05:33:02.408000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, looks good to me! üëç",
        "created_at": "2021-07-13T05:36:12.329000+00:00",
        "attachments": null
    },
    {
        "author": "sauliusgrigaitis",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This is an interesting topic. From the user perspective, the most value is in the history of PoW chain until the merge + PoS chain after the merge.  Roughly speaking it's a single nice chain that is not confusing for users. Such an approach is also in line with a single Ethereum idea (no 2.0).  Current PoS chain until the merge doesn't have Execution layer state and the history of the two chains before the merge probably will make more confusion than benefits, especially when after deposits withdrawals syncing PoS chain from genesis will become tricky. And if we add PoW chain after the merge to the mix, then we have \u003e\u003c chains structure that is definitely confusing for users. I believe that PoW chain until the merge + PoS chain after the merge is something that users should use most often, but there should be some way for power users to work with the rest of chains.",
        "created_at": "2021-07-13T10:06:40.586000+00:00",
        "attachments": null
    }
]
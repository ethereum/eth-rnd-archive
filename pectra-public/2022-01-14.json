[
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I had no strong preferences but was inclined to have batching in method to avoid it depending on any JSON-RPC semantics beyond simple method calls that we already have. Having no batching support in some libraries gives batching in method much stronger preference",
        "created_at": "2022-01-14T05:22:14.649000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Design of the heartbeat may be as follows:\n\n`engine_getTransitionState -\u003e {\"terminalTotalDifficulty\": TTD, \"terminalBlockHash\": TBH, \"terminalBlockNumber\": TBN}`\n\nCL polls this data periodically, drops values to the log and also compares TTD and TBH values to its own configuration values and drop an error in the log if these values doesn't match with a call to action to a user.\n\nThoughts?",
        "created_at": "2022-01-14T05:35:51.283000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "As the heartbeat is required pre-transition only this method is relevant and could be deprecated after the merge in the cleanup fork",
        "created_at": "2022-01-14T05:43:02.550000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It *feels* like a heartbeat is generally useful, especially when debugging and troubleshooting.",
        "created_at": "2022-01-14T06:48:16.055000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Even if it isn't protocol critical, if we have a heartbeat I would be inclined to leave it in after the Merge even if it just functions as a ping.",
        "created_at": "2022-01-14T06:48:37.886000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Won't `executePayload` and `forkchoiceUpdated` calls be enough as a heartbeat? These two method calls will happen each slot after the Merge",
        "created_at": "2022-01-14T06:55:46.584000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "EL responds to both (not fire and forget)?",
        "created_at": "2022-01-14T07:18:39.287000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, meaningful responses are required in the end of any processing flow of each of these two methods",
        "created_at": "2022-01-14T07:20:42.070000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Given the heart beat isn't part of consensus we don't need to wait for the cleanup fork to remove it once it's not proving useful anymore.  We can see what happens but I suspect once the merge has actually gone through CLs can just stop making those calls and at some point we agree to remove the API from the spec and ELs. Likely all just happens pretty naturally if the heartbeat no longer has value or naturally sticks around if it turns out it is useful for some reason.",
        "created_at": "2022-01-14T08:52:47.925000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Real world example, I just spun up a new teku/geth pair, and despite geth claiming it's synced teku is reporting \"WARN  - Eth1 service down for 270s, retrying\" it'd be nice to have a safe/easy curl command I could use to see if geth is responding correctly to `engine_` RPCs on the configured local port.",
        "created_at": "2022-01-14T17:52:02.843000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "^ FWIW in this case it was because I forgot to add `engine` to the allowed HTTP apis in geth (which I _assume_ is a temporary thing since we _don't_ want that generally exposed outside of localhost), being able to curl and get back `method engine_heartbeat is not available` definitely would've made this easier to debug.",
        "created_at": "2022-01-14T18:03:28.979000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "There's no real way of removing it, other than asking the guys at prysm to not implement it. But it's impossible to enforce anything about this",
        "created_at": "2021-05-20T00:02:48.963000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Do we believe that they would be against removing it?",
        "created_at": "2021-05-20T00:03:47.718000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The *hope* here is that the core development teams are willing to work together to build a safe system.  Defaults are powerful tools.",
        "created_at": "2021-05-20T00:04:11.170000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If validators run without eth1 nodes en masse, then the post-merge has big problems regardless of what we do, so imo we shouldn't worry about it too much for the merge process itself",
        "created_at": "2021-05-20T00:04:38.656000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I believe the spec says they should vote for the current eth1data in the state if they don't have a valid block to vote for.  I think the spec may need to be updated to exclude the current eth1data from consideration as the leading vote though or we'll just keep voting for the same thing.\n\nThat situation can happen even if you have an eth1 endpoint so I'm not sure it's a feature that can be removed entirely, but I do think it would be better to vote for something old but known valid.",
        "created_at": "2021-05-20T00:04:45.905000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think the random vote is better than what the spec says",
        "created_at": "2021-05-20T00:05:21.723000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "random vote is confusing imo; harder to debug because anyone looking at it might wonder if that client knows about an eth1 chain that no one else knows about",
        "created_at": "2021-05-20T00:05:55.082000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Better either 0 or random in 0...255",
        "created_at": "2021-05-20T00:06:01.849000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The thing with random is that it can't be a majority",
        "created_at": "2021-05-20T00:07:02.849000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You avoid that problem with the existing eth1_data as well by excluding it from the valid candidates.  So you *only* vote for eth1_data if you don't have another candidate, regardless of how many votes are for it.",
        "created_at": "2021-05-20T00:07:47.090000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'd agree with this, or `0` for that matter as long as it's excluded from the valid pool",
        "created_at": "2021-05-20T00:08:23.742000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "it's a way of saying: I do not know how to vote, please do not count me",
        "created_at": "2021-05-20T00:08:54.940000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Why not just abstain?",
        "created_at": "2021-05-20T00:09:18.994000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "you can't",
        "created_at": "2021-05-20T00:09:25.976000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "That feels like a bug?",
        "created_at": "2021-05-20T00:09:33.963000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Abstaining means not creating a block.  The eth1data field isn't optional (and would make life a lot more complex if it was)",
        "created_at": "2021-05-20T00:09:39.698000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I feel like not creating a block is better than creating a wrong block.",
        "created_at": "2021-05-20T00:09:59.360000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And not voting is better than voting on a wrong block.",
        "created_at": "2021-05-20T00:10:12.006000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think it is, the closest would be explicitly setting a vote for something like `0` to be that. But changing the protocol now is kind of useless because soon having an actual vote will become kind of mandatory",
        "created_at": "2021-05-20T00:10:32.108000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\"soon\" meaning before the merge?",
        "created_at": "2021-05-20T00:10:51.840000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "no, right at the merge",
        "created_at": "2021-05-20T00:11:04.483000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If we want to have the pre-merge chain fork choice rule follow the beacon chain then I think we need to make building/voting on blocks only with valid eth1data a requirement it before The Merge.",
        "created_at": "2021-05-20T00:11:46.321000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "hmm, I don't think the merge fixes this (it revealed a bug in our eth1 voting). The fork after the merge would fix it.  But this isn't actually a consensus change either so can be fixed outside of a hard fork.",
        "created_at": "2021-05-20T00:12:00.875000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I do feel like this is all worrying too much; the reality is that the chance that almost all validators are not going to be voting for reasonable eth1data values is pretty tiny",
        "created_at": "2021-05-20T00:12:54.051000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Why rely on hope that all validators have access to an incredibly expensive to operate execution client when we could just code clients to require it?",
        "created_at": "2021-05-20T00:13:38.863000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Oh I support coding clients to require it",
        "created_at": "2021-05-20T00:13:53.751000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We can't enforce that though because a block we don't have looks the same as a random vote.",
        "created_at": "2021-05-20T00:14:17.287000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You should not accept a block you don't have.",
        "created_at": "2021-05-20T00:14:31.596000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Beacon chain's fork choice rule should reject a block with eth1data it cannot validate.",
        "created_at": "2021-05-20T00:14:48.057000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Wait I thought the \"it\" that Micah is referring to is just \"don't *vote* for eth1 blocks you don't have\"?",
        "created_at": "2021-05-20T00:14:49.850000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "That's true at the merge but that's a very big, difficult change to make now.",
        "created_at": "2021-05-20T00:14:56.270000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Is there a simple explanation of why that is a difficult change to make now, but not post-merge?",
        "created_at": "2021-05-20T00:15:22.890000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think this pin points the actual problem, and this particular problem can be solved with social consensus: we have enough time in a window of 64 epochs to deploy patches on large pools to simply stop voting for a something that looks like a malicious fork if it seems it may be majority",
        "created_at": "2021-05-20T00:15:51.144000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(I generally trust the PoS devs on this topic, but I would like to better understand this particular decision since it seems on the surface to be quite bad)",
        "created_at": "2021-05-20T00:15:59.529000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Your proposal is that beacon chain validators should *reject* beacon chain blocks that *vote for* eth1 blocks that the validator's eth1 node does not see?",
        "created_at": "2021-05-20T00:16:43.401000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think my main concern with this stuff is interaction effects leading to ways to split the chain",
        "created_at": "2021-05-20T00:16:57.427000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "eg. what if an evil validator votes for an eth1 block that's just being broadcasted at that exact moment, so half of clients see it and the other half don't?",
        "created_at": "2021-05-20T00:17:39.077000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Naively, that seems like the correct behavior. Someone is proposing a block that you think contains data that doesn't align with reality.  That isn't a valid block.",
        "created_at": "2021-05-20T00:18:38.409000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I know it's useless, but after the merge this makes all the sense (until we get rid entirely of the voting) since eth1 blocks will be on finalized eth2 blocks",
        "created_at": "2021-05-20T00:18:40.962000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "With a follow distance of 16 hours, this seems unlikely?",
        "created_at": "2021-05-20T00:19:05.342000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So there's also a rule that the validator must have seen that block for 16 hours?",
        "created_at": "2021-05-20T00:19:23.285000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Or are you concerned with someone shadow mining a 16 hour fork and releasing it exactly as beacon chain validates?",
        "created_at": "2021-05-20T00:19:24.418000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Shadow mining a small fork",
        "created_at": "2021-05-20T00:19:33.366000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And releasing it after 16h",
        "created_at": "2021-05-20T00:19:36.659000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But sure, we can think about the 51% attack case as well",
        "created_at": "2021-05-20T00:20:03.648000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think there are solutions to minority chain forks.  But they don't scale to 51% shadow mined forks.",
        "created_at": "2021-05-20T00:20:27.303000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Whereas if we just stick with the current soft-coupled voting-based thing, then sure we trust validators a bit more, but we give less power to miners",
        "created_at": "2021-05-20T00:20:29.295000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Given validators have loads of incentive to keep the beacon chain working and miners have incentive to break it, that seems like a good trade off. üôÇ",
        "created_at": "2021-05-20T00:21:03.281000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I guess my argument here is:\n\n1. Today we use soft-coupled voting\n2. Soft-coupled voting works fine, and the probability that it fails this year is astronomically tiny\n3. Scary demons may lay beyond the other door, we don't know\n4. Therefore, don't change things",
        "created_at": "2021-05-20T00:21:21.255000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "üòù",
        "created_at": "2021-05-20T00:21:24.487000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I agree that we should trust validators more than hashers.",
        "created_at": "2021-05-20T00:21:29.708000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So lets say the PoW chain is using the PoS chain for finality leading up to the merge.  What happens in that same scenario where someone mines a PoW fork and gets it included in a PoS block?",
        "created_at": "2021-05-20T00:22:42.620000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Who cares if something gets included in one single PoS block?",
        "created_at": "2021-05-20T00:23:02.150000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Only a full voting period matters",
        "created_at": "2021-05-20T00:23:07.310000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Is there something against making the first voting period longer? Say if first embedded block happens at X then all clients vote 0 for 128 epochs. The chain can go on without voting anything in giving a longer window for manual intervention",
        "created_at": "2021-05-20T00:38:46.767000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The current length was already increased for that reason ü§£",
        "created_at": "2021-05-20T00:54:50.064000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The tradeoff is against length of deposit time",
        "created_at": "2021-05-20T00:54:58.463000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yeah, but just forfeit one or two periods right at the merge would give us some extra margin of security at no cost",
        "created_at": "2021-05-20T01:54:31.721000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "and this can be simply arranged by clients without any need of any fork",
        "created_at": "2021-05-20T01:55:05.702000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Right but even figuring out the details of something as trivial as this could set the schedule back by weeks",
        "created_at": "2021-05-20T01:55:26.236000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think if you just get the major clients (you need only two) to agree on voting randomly for N-epochs after the first embedded block we are set.",
        "created_at": "2021-05-20T01:56:55.071000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "seems like a trivial patch",
        "created_at": "2021-05-20T01:57:11.107000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I like the \"vote on 0\" solution better.",
        "created_at": "2021-05-20T01:59:58.148000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It is more clear/obvious that the voter doesn't know what to vote for and we can trivially create metrics to find out how many people are following the strategy.",
        "created_at": "2021-05-20T02:00:33.145000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "With vote on random, it is significantly less obvious and harder to track.",
        "created_at": "2021-05-20T02:00:43.028000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes I like better the vote for 0, but that requires extra coordination: that that vote can not be considered valid, and this may break current algorithms that follow majority",
        "created_at": "2021-05-20T02:05:07.411000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Hmm, the idea is that with random we only need 2 people in an epoch who actually know what a legitimate ETH1 block is?",
        "created_at": "2021-05-20T02:08:25.586000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "While with `0` we need 51% of people in an epoch to know what a legitimate ETH1 block is?",
        "created_at": "2021-05-20T02:08:46.289000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "No, you need 1024 votes",
        "created_at": "2021-05-20T02:09:25.209000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah, quorum essentially?",
        "created_at": "2021-05-20T02:09:37.571000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Either way",
        "created_at": "2021-05-20T02:09:38.189000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The period is 2048 slots, and you need half to reach a majority",
        "created_at": "2021-05-20T02:10:02.611000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If no eth1data reaches majority, what happens?",
        "created_at": "2021-05-20T02:10:24.898000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Nothing, we move to the next period, this happened to your own validator when you were trying to get into pyrmont",
        "created_at": "2021-05-20T02:11:03.575000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "No validator can come in until we reach a majority, but that's a small prize to pay for a few hours after the merge",
        "created_at": "2021-05-20T02:11:34.869000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Out of curiosity, what would happen if 1024 slots vote on 0?",
        "created_at": "2021-05-20T02:13:05.367000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Currently we‚Äôd adopt it as the new eth1 data and things would go very very badly.",
        "created_at": "2021-05-20T02:22:02.591000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Would they self-heal after the next epoch (assuming the next epoch correctly voted for a real PoW block)?",
        "created_at": "2021-05-20T02:22:59.032000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If we switch to vote 0 we have to also specifically exclude it as a valid vote. Which is why I like just using the previous eth1data - it‚Äôs valid and says you don‚Äôt have a better option.",
        "created_at": "2021-05-20T02:23:06.728000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think so because new deposits wouldn‚Äôt be included but I‚Äôm not at all sure.",
        "created_at": "2021-05-20T02:23:36.252000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think process_deposits will fail",
        "created_at": "2021-05-20T02:23:52.671000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Another option is random between `[0, 2^128]`.  Very unlikely to have collision, and very easy to identify at a glance or with tools, and doesn't require looking at history.",
        "created_at": "2021-05-20T02:24:04.661000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Because it requires the merkle root of the Eth1 data vote",
        "created_at": "2021-05-20T02:24:19.820000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So no deposits could be processed for an epoch, but after that epoch they could be?",
        "created_at": "2021-05-20T02:24:42.872000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So if an invalid hash wins we can't  vote any validators anymore it seems",
        "created_at": "2021-05-20T02:24:57.749000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ever again?",
        "created_at": "2021-05-20T02:25:08.283000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It's 1025 not 1024 üòÇ  never learned the difference between \\geq and \u003e",
        "created_at": "2021-05-20T02:25:52.757000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Until someone knowledgeable replies, my recollection of the specs is that `process_deposits` will fail with a bad eth1 data on the beacon state. So certainly while the state has this data we can't produce blocks that have validators in them. What I imagine will happen is that all implementations will try to include deposits in their blocks (if the eth1 data had a non trivial deposit count) so no block will be valid. But I may be wrong",
        "created_at": "2021-05-20T02:29:10.369000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If the vote is for no deposits I think nothing will happen",
        "created_at": "2021-05-20T02:29:28.562000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This feels to me like something that should be fixed then?  Any block that your client cannot validate as being valid in the previous epoch should not be eligible for the purpose of deposit proof root.",
        "created_at": "2021-05-20T02:32:34.497000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This forces validators to have access to mainnet (a good thing IMO).",
        "created_at": "2021-05-20T02:33:14.787000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "proposers are definitely forced to include deposits",
        "created_at": "2021-05-20T02:33:25.429000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Which does force them to have eth1 clients (or else they can't propose)",
        "created_at": "2021-05-20T02:33:36.501000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And the penalty for not proposing is going up from 1/32 of all rewards to 1/8 of all rewards in altair (sure, it's a bit of a lottery, but not that much of one imo! Even with 10m ETH staking (\u003e2x higher than today), so 312500 validators, on average a single validator will propose once per two months)",
        "created_at": "2021-05-20T02:35:19.580000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Are deposit proofs provided to validators by proposers?",
        "created_at": "2021-05-20T02:35:25.524000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Deposit proofs must be part of the beacon block",
        "created_at": "2021-05-20T02:35:36.914000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah but the situation Micah was asking is what happens if we get to the point where an invalid eth1 data is voted as majority (which I think can't happen ever). In this impossible scenario I think every subsequent block is invalid",
        "created_at": "2021-05-20T02:37:28.180000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yeah I don't think we should worry about that scenario",
        "created_at": "2021-05-20T02:37:41.143000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "`process_deposits` won't do anything if we vote in a 0 block because there won't be any new deposits to include.",
        "created_at": "2021-05-20T02:37:54.405000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Why is it impossible?",
        "created_at": "2021-05-20T02:37:57.389000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Because it requires \u003e50% of validators to be dishonest?",
        "created_at": "2021-05-20T02:38:09.603000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Unless the 0 eth1_data for some reason also increases deposit_count.",
        "created_at": "2021-05-20T02:38:12.465000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah as I said if the deposit count is zero nothing will happen",
        "created_at": "2021-05-20T02:38:24.420000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If the deposit count is non zero then no block is valid",
        "created_at": "2021-05-20T02:38:45.196000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Hypothetical attack scenario:\nWealthy individual acquires a non-trivial number of validators (say 10% of validators).  They slowly bleed money by always voting for a block that isn't part of canonical history, but which contains deposits (that never showed up on canonical chain) from them.  Eventually, they get lucky and manage to win an epoch.  Now all of their deposits can be pulled into ETH2?",
        "created_at": "2021-05-20T02:39:22.137000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If the deposit count is greater than the previous eth1_data deposit_count then no blocks can be valid and the chain would get stuck.  If it's less than or equal then blocks remain valid and we should be able to just vote in a valid eth1 block during the next period.",
        "created_at": "2021-05-20T02:39:28.965000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The probability they get lucky is exponentially tiny",
        "created_at": "2021-05-20T02:39:40.461000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Like, it's harder than just guessing the private key of the parity wallet",
        "created_at": "2021-05-20T02:39:59.616000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Happen to know the formula for that, given some percentage of all validators?",
        "created_at": "2021-05-20T02:40:01.918000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If you have 50% of all validators, chances each epoch you'll be selected for 1029 slots is 50% I think?",
        "created_at": "2021-05-20T02:40:32.582000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The lower your share of validators, the lower the odds of you getting selected for 1029 slots in an epoch.",
        "created_at": "2021-05-20T02:40:53.737000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "```\n\u003e\u003e\u003e def fac(n): return 1 if n == 0 else n * fac(n-1)\n... \n\u003e\u003e\u003e def choose(n, k): return fac(n) // fac(k) // fac(n-k)\n... \n\u003e\u003e\u003e def prob(n, k, p): return p**k * (1-p)**(n-k) * choose(n, k)\n... \n\u003e\u003e\u003e def probge(n, k, p): return sum([prob(n, i, p) for i in range(k, n+1)])\n... \n\u003e\u003e\u003e probge(79, 40, 0.5)\n0.49999999999999994\n\u003e\u003e\u003e import sys; sys.setrecursionlimit(10000)\n\u003e\u003e\u003e probge(1024, 512, 0.25)\n0.0\n\u003e\u003e\u003e probge(1024, 512, 0.40)\n6.147107234299832e-11\n```",
        "created_at": "2021-05-20T02:41:58.208000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So, it's negligible if the attacker has under 40%",
        "created_at": "2021-05-20T02:42:10.117000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "C'mon! The two of you had this discussion yesterday and Vitalik had that code already, there's no way you wrote that now üòÇ",
        "created_at": "2021-05-20T02:43:14.330000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I did write the code just now, but I did write it like 20 times in the past so it's basically memorized ü§£",
        "created_at": "2021-05-20T02:43:38.408000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So going back to the merge I don't see anything wrong in simply deciding that we are not going to onboard anyone for a day after the merge... The chain will continue fine, and if there are any problems we will not have any bad eth1 data voted in. And it should be very easily implemented on clients",
        "created_at": "2021-05-20T02:47:17.974000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah, is the idea to just shut off new eth1data between the block when the totaldiff target is selected and the switchover?",
        "created_at": "2021-05-20T02:48:03.731000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Because we expect a higher risk of attacks then?",
        "created_at": "2021-05-20T02:48:10.502000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "sure, that seems like not the worst idea",
        "created_at": "2021-05-20T02:48:16.254000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah, just simply vote \"blank\" to actively prevent a majority for a day",
        "created_at": "2021-05-20T02:49:19.470000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Where `blank = random % 2^128`?  üôè",
        "created_at": "2021-05-20T02:49:59.768000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "That's my current notion of blank, but if on altair is included that the zero hash is considered invalid, then blank could be zero by the time of the merge",
        "created_at": "2021-05-20T02:50:49.807000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'd make blank = current eth1_data.  Simplest thing and with current behaviour of most clients if the first validator to propose in the period does that all the others will automatically follow suit regardless of whether they've deliberately hard coded it (because it's a valid block with the most votes)",
        "created_at": "2021-05-20T02:53:11.676000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'm really not keen on getting a heap of random block hashes flying around just at the point where tracking which blocks are and aren't valid is difficult and the way we propagate blocks changes.",
        "created_at": "2021-05-20T02:54:00.057000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e Beacon chain's fork choice rule should reject a block with eth1data it cannot validate.\n\nI actually agree with this",
        "created_at": "2021-05-20T02:54:01.507000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "makes eth1data more robust due to all valdiators operating in attestations",
        "created_at": "2021-05-20T02:54:17.205000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "hasn't been prioritized in specs due to wanting to ship other things and the assumption that deposit mech would change with the merge",
        "created_at": "2021-05-20T02:54:54.262000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "well... it isnt' at least at first",
        "created_at": "2021-05-20T02:54:59.287000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah I think its a good idea, just not a simple change so comes down to a matter of prioritisation.",
        "created_at": "2021-05-20T02:55:52.070000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "certainly agreed on that one",
        "created_at": "2021-05-20T02:56:07.505000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'm quite tempted to just do the merge and then remove eth1_data voting entirely and use the head block (pending all the hand wavey details of exactly how that works).",
        "created_at": "2021-05-20T02:56:34.797000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You mean finalized block right?",
        "created_at": "2021-05-20T02:57:20.341000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "think we should spec what the mechanism might become after merge before deciding if it's worth meddling with the fork choice today\n\none idea is that eth1data period could just be 1 block (just current block post state) and correctness must be satisfied for inclusion in the block tree",
        "created_at": "2021-05-20T02:57:48.894000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e pending all the hand wavey details of exactly how that works\nlol, exactly.",
        "created_at": "2021-05-20T02:58:17.502000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e eth1data\nwould need a rename though! can't have this outdated \"eth1\"/\"eth2\" terminology that deep üòÖ",
        "created_at": "2021-05-20T02:58:55.344000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "To be fair, eth1data voting is supposed to be removed entirely in the post-merge cleanup fork",
        "created_at": "2021-05-20T02:59:21.210000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ü§£",
        "created_at": "2021-05-20T02:59:24.220000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "and replaced with what!\n\njust insert deposit root and deposit count directly into beacon state?",
        "created_at": "2021-05-20T02:59:49.167000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'd like to say head block but hand wavey details may mean it winds up being finalized. üôÇ That would mean deposits can be included on the beacon chain immediately - validators still won't actually activate until finalization.",
        "created_at": "2021-05-20T03:00:00.096000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "the mechanism likely will look something like eth1data voting",
        "created_at": "2021-05-20T03:00:05.038000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "but less voting",
        "created_at": "2021-05-20T03:00:06.998000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(voting period of 1 slot!)",
        "created_at": "2021-05-20T03:00:11.415000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "right, no voting",
        "created_at": "2021-05-20T03:00:11.580000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And not honesty-based",
        "created_at": "2021-05-20T03:00:18.464000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "right",
        "created_at": "2021-05-20T03:00:22.118000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "More like, just add an accumulator of the deposit root directly into the beacon state",
        "created_at": "2021-05-20T03:00:39.826000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And go off of that",
        "created_at": "2021-05-20T03:00:43.723000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e the mechanism likely will look something like eth1data voting\nThat doesn't sound at all like \"* voting\"...  üòõ\n\u003e It will look something like eth1data voting, but without the voting or the eth1.",
        "created_at": "2021-05-20T03:00:45.042000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdannyryan\u003e Ha",
        "created_at": "2021-05-20T03:08:14.381000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdannyryan\u003e Execution-engine prepareBlock can also return the deposit data field for insertion into state",
        "created_at": "2021-05-20T03:08:44.436000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I am trying to summarize these hundreds of messages above. The general discussion was around protecting eth1 data voting from 51% attack near the merge when malicious vote reaches quorum and allows for onboarding a portion of maliciously created validators (e.g. using the funds that are cashed out by successful double spend attack), if something like that happens it would also require a manual clean up of the deposits history because a portion of deposits from valid chain which index range overlaps with malicious ones won't be inducted because deposit index in the state can't go back.\n\nWe also want to protect eth1 chain in case of 51% attack. In this channel we have previously discussed a socially communicated block `X` that would be the last PoW block in case of 51% attack and validators will need to start securing execution chain from that point.\n\nBut in the case if beacon chain has finished its voting for malicious eth1 data before this manual intervention we would have to either reverse the whole beacon state back or its deposit processing part; the latter doesn't seem easy. Hence the proposal to stop voting for a while. And the main question is when to stop and start voting again. IMO, eth1 data voting should be stopped once the merge fork code is deployed and started after the first embedded block gets finalized. Otherwise, there would be a room for this kind of attack.\n\nThis attack would require a malicious fork to last for more than `2048` blocks. Which is more than 8 hours worth of hardware work just to break eth1 data voting which then will be manually recovered. In the worst case it would result in cutting off a portion of beacon chain history without any gains for attacker. Unless I am completely missing something, I don't think this scenario is possible as simple double spend attack would be better way to utilize this hardware time.",
        "created_at": "2021-05-20T09:44:05.142000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "There is still the issue of someone executing an attack against ETH1 (e.g., double spend, censorship, selfish mining, etc.).  This isn't a new attack vector, but the incentive to *not* do it approaches 0 as we approach The Merge.  I think the plan is to YOLO on this?",
        "created_at": "2021-05-20T09:46:53.349000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Right, and deposit data can be verified by `NewBlock` message processor. The best way of doing things would be getting rid of deposit root and deposit count at all and linked deposit proofs to the execution state root. But the latter could happen once we move to another data commitment scheme for the execution state. We could think about whether to deal or not to deal with hexary trie once we get to the work on eth1 data voting clean up.",
        "created_at": "2021-05-20T09:48:10.622000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Broken eth1 data voting is what we could see after at least 8 hours of 51% attack happening on the PoW chain. What I am trying to say is that things worse than broken voting will highly likely happen during these hours of attack. And we want to mitigate attack vectors and be ready to cope with consequences of attack if it happens disregarding preventing measures that have been used. I don't think we would wait 8 hrs and only react after that.",
        "created_at": "2021-05-20T09:54:49.971000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "With PoW attacks there isn't really any mitigation to be done, even if we could do something within 8 hours.",
        "created_at": "2021-05-20T10:02:57.895000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "My thought is that if we have a plan B for the case of 51% attack it would imply that eth1 data voting is also gonna be affected by this plan B. If we think that 8hrs is not enough let's increase the follow distance to e.g. 24hrs or even 48hrs as a part of the merge fork code. Technically it should be easier than stopping voting and enabling it again in the runtime.",
        "created_at": "2021-05-20T10:05:18.510000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Under mitigation I meant increased rewards leading up to the merge, community work, monitoring hashpower market places and other things we have been discussed here. Of course, we might not take any of this action.  And none of them will make attack completely impossible",
        "created_at": "2021-05-20T10:07:18.699000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I mean if we witness a PoW attack there isn't anything we can do about it.  It is why we are switching to PoS.  üôÇ",
        "created_at": "2021-05-20T10:15:27.291000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Like if we saw an 8 hour shadow chain show up on the network we would all just be forced to ü§∑ and move on.",
        "created_at": "2021-05-20T10:16:01.829000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I *think* what we want is to just make sure if/when that happens, The Merge isn't prevented by it?",
        "created_at": "2021-05-20T10:16:42.406000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I see what you mean. It might be the case when we witness it too late for taking any action",
        "created_at": "2021-05-20T10:16:52.942000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "As long as The Merge happens, we'll just take the hits leading up to The Merge and potentially advise off-chain services to halt Ethereum stuff as we approach.",
        "created_at": "2021-05-20T10:17:29.612000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Longer chain may be revealed a dozen blocks before the merge. This would be the worst case scenario as there would be no time to react accordingly and attack would be persisted by the merge. And eth1 data voting will have to vote for malicious blocks in this case. We can't revert and postpone merge in this case as it would become an efficient way of attackers to delaying merge and keeping PoW chain.",
        "created_at": "2021-05-20T10:21:46.446000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It sounds like the best we can do",
        "created_at": "2021-05-20T10:32:06.707000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If someone were to execute a 51% attack today, we wouldn't be able to do anything even though we have *plenty* of time until The Merge.  üôÇ",
        "created_at": "2021-05-20T10:38:42.745000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We could manually revert it if we'd want to and come to a social consensus around the block `X`. While if this process would revert the Merge itself we couldn't do that. Because should we revert the Merge once and it will definitely happen again.",
        "created_at": "2021-05-20T10:41:39.075000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You will almost *certainly* do more harm than the attacker by reverting.",
        "created_at": "2021-05-20T10:50:13.031000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Unless you can catch it within a few blocks, the attacker likely will already have absconded with their loot to another chain by the time you revert.  So you end up causing damage to everyone involved except the attacker.",
        "created_at": "2021-05-20T10:51:11.730000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I see. In case of manual reversion other double spend opportunities may be opened.",
        "created_at": "2021-05-20T10:57:02.958000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I have a concern about implementation after the merge. A validator attesting for a block currently only needs to check the validity of this block in the consensus layer. Suppose he's also running an execution node to provide him with eth1 data, and that he's honest and follows the chain and validates blocks before submitting its eth1 data vote. Those two validations happen at different times. We have still seen however a correlation between having a local eth1 node and loosing head votes because of resources. The point I want to raise is that after the merge validators will have to check validity of both the execution payload and the consensus data at the very same time, right after receiving the block, before they can actually attest for it. I'd expect the timely head flag to be a difficult one to get. Is anyone concerned about this?  It seems to me that we can actually allow validators to **not** check the execution payload before attesting, but penalize proposers whose blocks are children of blocks with invalid execution payload. Proposers have more time to check their parent than attesters.",
        "created_at": "2021-05-20T14:18:20.847000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "What you're suggesting sounds like a delayed execution. There is a corresponding proposal by Dankrad here https://ethresear.ch/t/commit-to-pre-state-instead-of-post-state-on-the-executable-beacon-chain/8802\n\nThe main problem in this proposal is verifying cumulative gas used by transactions not exceeding block gas limit does not seem feasible. This problem requires a workaround, one of potential ways is to charge proposer of such block for transactions that are exceeding the limit.\n\nPenalizing proposer of a block with invalid payload isn't enough. This block must be also excluded by the fork choice rule. And if we have a portion of byzantine proposers in a row (either malicious or dishonest or just buggy) then we might end up with forking out a segment of several blocks which would reduce supply of a block space. It would also mean that execution chain isn't protected by all validators of the system.",
        "created_at": "2021-05-20T16:56:32.995000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e \u003e This problem requires a workaround, one of potential ways is to charge proposer of such block for transactions that are exceeding the limit.\nI described the workaround in my post, it's not too complex",
        "created_at": "2021-05-20T16:59:22.970000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I would say the workaround is at least moderately complex in terms of implementation because it requires a feedback loop with EVM to charge proposer for extra space allocated in a block.",
        "created_at": "2021-05-20T17:10:06.756000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Oh I hadn't seen that proposal, thanks for the reference. If the numbers there are right (for example 20M gas per second target) then this phenomenom will be worse than what I thought.",
        "created_at": "2021-05-20T18:20:12.358000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e  The point I want to raise is that after the merge validators will have to check validity of both the execution payload and the consensus data at the very same time, right after receiving the block, before they can actually attest for it. I'd expect the timely head flag to be a difficult one to get. Is anyone concerned about this?",
        "created_at": "2021-05-20T19:55:28.461000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Execution validation only takes ~300ms",
        "created_at": "2021-05-20T19:55:35.781000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And I would guess ethash validation may even take longer than beacon chain validation",
        "created_at": "2021-05-20T19:56:05.416000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So there's not going to be a big problem in PoS that does not exist in PoW",
        "created_at": "2021-05-20T19:56:29.077000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The problem is not how long it takes as much as when it has to be done. Currently it happens separately as blocks in pow and pos do not come at the same intervals. After the merge they'll be at the same tight spot between block arrival and 4 seconds into the slot",
        "created_at": "2021-05-20T21:10:47.206000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Also the 300ms does not match with the 20M gas per second in that document I guess, since blocks use about 15M gas",
        "created_at": "2021-05-20T21:15:34.576000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdannyryan\u003e but (1) consensus-layer and execution-layer processing can be done in parallel and (2) [i believe] consensus-layer processing is a small fraction of execution-layer processing time so it probably boils down to whether the machine can do the execution-layer processing fast enough",
        "created_at": "2021-05-20T21:15:57.668000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdannyryan\u003e you‚Äôre right though that *peak* load between these two things then becomes the norm but I think (1) and (2) make it not so bad",
        "created_at": "2021-05-20T21:16:19.145000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes with this I agree, but my lame heuristics here is that currently running geth I lose 20 head votes per day. Not running it I lose 2. If I am forced to run them at the very same moment (even if in parallel) I suppose I'd see more bad head votes. This is statistics of one person but it's not a badly speced desktop",
        "created_at": "2021-05-20T21:19:09.353000+00:00",
        "attachments": null
    }
]
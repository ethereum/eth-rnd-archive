[
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Benches on my machine \u003c@592004585506340885\u003e",
        "created_at": "2024-08-30T05:51:27.616000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "message.txt",
                "content": "Z29vczogbGludXgKZ29hcmNoOiBhbWQ2NApwa2c6IGdpdGh1Yi5jb20vZXRoZXJldW0vYy1remctNDg0NC9iaW5kaW5ncy9nbwpjcHU6IEludGVsKFIpIENvcmUoVE0pIGk3LTg1NTBVIENQVSBAIDEuODBHSHoKQmVuY2htYXJrL0xvYWRUcnVzdGVkU2V0dXBGaWxlKHByZWNvbXB1dGU9MCkgICAgICAgICAJICAgICAgIDEJMjA3Mjk4ODgwMCBucy9vcApCZW5jaG1hcmsvTG9hZFRydXN0ZWRTZXR1cEZpbGUocHJlY29tcHV0ZT0xKSAgICAgICAgIAkgICAgICAgMQkyMDM5Mzc0MzU5IG5zL29wCkJlbmNobWFyay9Mb2FkVHJ1c3RlZFNldHVwRmlsZShwcmVjb21wdXRlPTIpICAgICAgICAgCSAgICAgICAxCTIxNTk5NzE5NzIgbnMvb3AKQmVuY2htYXJrL0xvYWRUcnVzdGVkU2V0dXBGaWxlKHByZWNvbXB1dGU9MykgICAgICAgICAJICAgICAgIDEJMjA2ODg2ODc1OSBucy9vcApCZW5jaG1hcmsvTG9hZFRydXN0ZWRTZXR1cEZpbGUocHJlY29tcHV0ZT00KSAgICAgICAgIAkgICAgICAgMQkyMDY4NDI3ODA5IG5zL29wCkJlbmNobWFyay9Mb2FkVHJ1c3RlZFNldHVwRmlsZShwcmVjb21wdXRlPTUpICAgICAgICAgCSAgICAgICAxCTIxMTk3NDEwOTggbnMvb3AKQmVuY2htYXJrL0xvYWRUcnVzdGVkU2V0dXBGaWxlKHByZWNvbXB1dGU9NikgICAgICAgICAJICAgICAgIDEJMjE5OTc1ODk2MyBucy9vcApCZW5jaG1hcmsvTG9hZFRydXN0ZWRTZXR1cEZpbGUocHJlY29tcHV0ZT03KSAgICAgICAgIAkgICAgICAgMQkyMzk4MDQ0Nzg0IG5zL29wCkJlbmNobWFyay9Mb2FkVHJ1c3RlZFNldHVwRmlsZShwcmVjb21wdXRlPTgpICAgICAgICAgCSAgICAgICAxCTI3MDAwMzYyMjYgbnMvb3AKQmVuY2htYXJrL0Jsb2JUb0taR0NvbW1pdG1lbnQgICAgICAgICAgICAgICAgICAgICAgICAJICAgICAgMjIJICA1MjM1Njg1MSBucy9vcApCZW5jaG1hcmsvQ29tcHV0ZUtaR1Byb29mICAgICAgICAgICAgICAgICAgICAgICAgICAgIAkgICAgICAyMQkgIDU0MjAyODQwIG5zL29wCkJlbmNobWFyay9Db21wdXRlQmxvYktaR1Byb29mICAgICAgICAgICAgICAgICAgICAgICAgCSAgICAgIDIxCSAgNTUyMjk3OTAgbnMvb3AKQmVuY2htYXJrL1ZlcmlmeUtaR1Byb29mICAgICAgICAgICAgICAgICAgICAgICAgICAgICAJICAgICA3NDIJICAgMTU1MDc3MCBucy9vcApCZW5jaG1hcmsvVmVyaWZ5QmxvYktaR1Byb29mICAgICAgICAgICAgICAgICAgICAgICAgIAkgICAgIDQ0MQkgICAyNjk4Njg5IG5zL29wCkJlbmNobWFyay9WZXJpZnlCbG9iS1pHUHJvb2ZCYXRjaChjb3VudD0xKSAgICAgICAgICAgCSAgICAgNDQyCSAgIDI2OTIxNjEgbnMvb3AKQmVuY2htYXJrL1ZlcmlmeUJsb2JLWkdQcm9vZkJhdGNoKGNvdW50PTIpICAgICAgICAgICAJICAgICAyNTUJICAgNDYxOTg3MyBucy9vcApCZW5jaG1hcmsvVmVyaWZ5QmxvYktaR1Byb29mQmF0Y2goY291bnQ9NCkgICAgICAgICAgIAkgICAgIDE0NAkgICA4MDkxMDcwIG5zL29wCkJlbmNobWFyay9WZXJpZnlCbG9iS1pHUHJvb2ZCYXRjaChjb3VudD04KSAgICAgICAgICAgCSAgICAgIDc4CSAgMTU0Njc0NzUgbnMvb3AKQmVuY2htYXJrL1ZlcmlmeUJsb2JLWkdQcm9vZkJhdGNoKGNvdW50PTE2KSAgICAgICAgICAJICAgICAgMzYJICAyOTMxMzY4MSBucy9vcApCZW5jaG1hcmsvVmVyaWZ5QmxvYktaR1Byb29mQmF0Y2goY291bnQ9MzIpICAgICAgICAgIAkgICAgICAyMAkgIDU4MzU2MzY0IG5zL29wCkJlbmNobWFyay9WZXJpZnlCbG9iS1pHUHJvb2ZCYXRjaChjb3VudD02NCkgICAgICAgICAgCSAgICAgICA5CSAxMTYzOTI1MjQgbnMvb3AKQmVuY2htYXJrL0NvbXB1dGVDZWxsc0FuZEtaR1Byb29mcyhwcmVjb21wdXRlPTApICAgICAJICAgICAgIDMJIDM1OTc2MjgzMyBucy9vcApCZW5jaG1hcmsvQ29tcHV0ZUNlbGxzQW5kS1pHUHJvb2ZzKHByZWNvbXB1dGU9MSkgICAgIAkgICAgICAgMQkxMDMxNTM1ODQ4IG5zL29wCkJlbmNobWFyay9Db21wdXRlQ2VsbHNBbmRLWkdQcm9vZnMocHJlY29tcHV0ZT0yKSAgICAgCSAgICAgICAyCSA2MjY1OTM0OTYgbnMvb3AKQmVuY2htYXJrL0NvbXB1dGVDZWxsc0FuZEtaR1Byb29mcyhwcmVjb21wdXRlPTMpICAgICAJICAgICAgIDMJIDQzNTYwNzA2NCBucy9vcApCZW5jaG1hcmsvQ29tcHV0ZUNlbGxzQW5kS1pHUHJvb2ZzKHByZWNvbXB1dGU9NCkgICAgIAkgICAgICAgMwkgMzUwNDEyMjcyIG5zL29wCkJlbmNobWFyay9Db21wdXRlQ2VsbHNBbmRLWkdQcm9vZnMocHJlY29tcHV0ZT01KSAgICAgCSAgICAgICA0CSAzMDg4NDk4NzAgbnMvb3AKQmVuY2htYXJrL0NvbXB1dGVDZWxsc0FuZEtaR1Byb29mcyhwcmVjb21wdXRlPTYpICAgICAJICAgICAgIDQJIDI2NzM0NDY1OCBucy9vcApCZW5jaG1hcmsvQ29tcHV0ZUNlbGxzQW5kS1pHUHJvb2ZzKHByZWNvbXB1dGU9NykgICAgIAkgICAgICAgNAkgMjUwNzMzNjM2IG5zL29wCkJlbmNobWFyay9Db21wdXRlQ2VsbHNBbmRLWkdQcm9vZnMocHJlY29tcHV0ZT04KSAgICAgCSAgICAgICA1CSAyMzM1MzM0NTUgbnMvb3AKQmVuY2htYXJrL0NvbXB1dGVDZWxsc0FuZEtaR1Byb29mc1BhcmFsbGVsKGNvdW50PTgpICAJICAgICAgIDIJIDYyMjAzNTQ4MCBucy9vcApCZW5jaG1hcmsvUmVjb3ZlckNlbGxzQW5kS1pHUHJvb2ZzKG1pc3Npbmc9NTAuMCUpICAgIAkgICAgICAgNQkgMjQ3MzMxNjM5IG5zL29wCkJlbmNobWFyay9SZWNvdmVyQ2VsbHNBbmRLWkdQcm9vZnMobWlzc2luZz0yNS4wJSkgICAgCSAgICAgICA1CSAyNDgxMjg4OTMgbnMvb3AKQmVuY2htYXJrL1JlY292ZXJDZWxsc0FuZEtaR1Byb29mcyhtaXNzaW5nPTEyLjUlKSAgICAJICAgICAgIDUJIDI0ODQwODUwNyBucy9vcApCZW5jaG1hcmsvUmVjb3ZlckNlbGxzQW5kS1pHUHJvb2ZzKG1pc3Npbmc9MSkgICAgICAgIAkgICAgICAgNAkgMjU5NTQ3Nzg2IG5zL29wCkJlbmNobWFyay9SZWNvdmVyQ2VsbHNBbmRLWkdQcm9vZnMobWlzc2luZz0yKSAgICAgICAgCSAgICAgICA0CSAyNjQ5NjMxMjIgbnMvb3AKQmVuY2htYXJrL1JlY292ZXJDZWxsc0FuZEtaR1Byb29mcyhtaXNzaW5nPTMpICAgICAgICAJICAgICAgIDQJIDI2MTE3Njc1OCBucy9vcApCZW5jaG1hcmsvUmVjb3ZlckNlbGxzQW5kS1pHUHJvb2ZzKG1pc3Npbmc9NCkgICAgICAgIAkgICAgICAgNAkgMjYwNzE3ODQzIG5zL29wCkJlbmNobWFyay9SZWNvdmVyQ2VsbHNBbmRLWkdQcm9vZnMobWlzc2luZz01KSAgICAgICAgCSAgICAgICA0CSAyNzQ2Mjc4MDAgbnMvb3AKQmVuY2htYXJrL1ZlcmlmeUNlbGxLWkdQcm9vZkJhdGNoICAgICAgICAgICAgICAgICAgICAJICAgICAgIDIJIDkwMjgyNzQ2NCBucy9vcApCZW5jaG1hcmsvVmVyaWZ5Um93cyhjb3VudD0xKSAgICAgICAgICAgICAgICAgICAgICAgIAkgICAgICA1MAkgIDIzNTQ3MTM1IG5zL29wCkJlbmNobWFyay9WZXJpZnlSb3dzKGNvdW50PTIpICAgICAgICAgICAgICAgICAgICAgICAgCSAgICAgIDMwCSAgMzg5MzQyOTkgbnMvb3AKQmVuY2htYXJrL1ZlcmlmeVJvd3MoY291bnQ9NCkgICAgICAgICAgICAgICAgICAgICAgICAJICAgICAgMTYJICA2OTMwOTE2OSBucy9vcApCZW5jaG1hcmsvVmVyaWZ5Um93cyhjb3VudD04KSAgICAgICAgICAgICAgICAgICAgICAgIAkgICAgICAgOAkgMTI3NzM3NzIyIG5zL29wCkJlbmNobWFyay9WZXJpZnlSb3dzKGNvdW50PTE2KSAgICAgICAgICAgICAgICAgICAgICAgCSAgICAgICA1CSAyMzcyNzA4MzggbnMvb3AKQmVuY2htYXJrL1ZlcmlmeVJvd3MoY291bnQ9MzIpICAgICAgICAgICAgICAgICAgICAgICAJICAgICAgIDMJIDQxOTA4MTIxMiBucy9vcApCZW5jaG1hcmsvVmVyaWZ5Um93cyhjb3VudD02NCkgICAgICAgICAgICAgICAgICAgICAgIAkgICAgICAgMgkgODQxMTQyMjg4IG5zL29wCkJlbmNobWFyay9WZXJpZnlDb2x1bW5zKGNvdW50PTEpICAgICAgICAgICAgICAgICAgICAgCSAgICAgIDYxCSAgMTkyMDA4ODQgbnMvb3AKQmVuY2htYXJrL1ZlcmlmeUNvbHVtbnMoY291bnQ9MikgICAgICAgICAgICAgICAgICAgICAJICAgICAgNDAJICAyODQyMTk3MiBucy9vcApCZW5jaG1hcmsvVmVyaWZ5Q29sdW1ucyhjb3VudD00KSAgICAgICAgICAgICAgICAgICAgIAkgICAgICAyNQkgIDQ0NDc0MjE3IG5zL29wCkJlbmNobWFyay9WZXJpZnlDb2x1bW5zKGNvdW50PTgpICAgICAgICAgICAgICAgICAgICAgCSAgICAgIDE1CSAgNzI2OTMyNjAgbnMvb3AKQmVuY2htYXJrL1ZlcmlmeUNvbHVtbnMoY291bnQ9MTYpICAgICAgICAgICAgICAgICAgICAJICAgICAgIDgJIDEyOTI4MTQ3OCBucy9vcApCZW5jaG1hcmsvVmVyaWZ5Q29sdW1ucyhjb3VudD0zMikgICAgICAgICAgICAgICAgICAgIAkgICAgICAgNQkgMjM3Mzg2MTE5IG5zL29wCkJlbmNobWFyay9WZXJpZnlDb2x1bW5zKGNvdW50PTY0KSAgICAgICAgICAgICAgICAgICAgCSAgICAgICAzCSA0NTkwMjczOTQgbnMvb3AKQmVuY2htYXJrL1ZlcmlmeUNvbHVtbnMoY291bnQ9MTI4KSAgICAgICAgICAgICAgICAgICAJICAgICAgIDIJIDg1MTI3MjUyNCBucy9vcApQQVNTCm9rICAJZ2l0aHViLmNvbS9ldGhlcmV1bS9jLWt6Zy00ODQ0L2JpbmRpbmdzL2dvCTE3Ny4yNTlzCg=="
            }
        ]
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I tried with `precompute=8` , and it seems marginally better.\nhttps://github.com/prysmaticlabs/prysm/pull/14399",
        "created_at": "2024-08-30T06:09:09.084000+00:00",
        "attachments": []
    },
    {
        "author": "cskiraly",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Hmm, I get the same results with the portable flag. That's not what we want to see right? I suppose I need more verbose output from the go test to see what's happening.",
        "created_at": "2024-08-30T10:42:53.433000+00:00",
        "attachments": []
    },
    {
        "author": "cskiraly",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "wait, cache was not cleaned. After cleaning it, I get 387ms instead of the 315ms",
        "created_at": "2024-08-30T10:50:16.549000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I‚Äôm going to be afk for about four more hours but can check once I log on ‚Äî could you benchmark the methods in the prysm codebase that wrap the cryptography methods to see the discrepancy?",
        "created_at": "2024-08-30T10:51:58.596000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "There are likely some optimizations that we could employ though it might be good to figure out why this is happening and also why the time to compute the blobs increases when the node is stressed by at least 3x, since that is unexpected",
        "created_at": "2024-08-30T10:56:59.063000+00:00",
        "attachments": []
    },
    {
        "author": "cskiraly",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "interesting your i7-8550U is running it faster (233ms) then my i5-12450H (315ms). Maybe I should check my setup. It is a miniPC that I wanted silent .... and maybe I've set up some limits that I don't remember, but keep it slow.",
        "created_at": "2024-08-30T10:59:02.553000+00:00",
        "attachments": []
    },
    {
        "author": "cskiraly",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "OK, now I think I understand a few things\n- BLST_PORTABLE is not slower on mine. It was showing slower, but only occasionally, because the process was not pinned to a core, adding variance to the test results.\n- my 12th-gen i5 was slower because it was not using turbo frequencies. I had my cpu governor on `powersave`, which prevented it from going above 2.2GHz. After changing it to `performance`, it goes up to turbo freq (4.4GHz), and can sustain it for the whole test, giving me 162ms.\n\nNote that testing with turbo frequencies and assuming that can go sustained on multiple cores is quite optimistic. I think performance numbers without turbo are more realistic to expect.\n\nSome useful commands:\nget current governor and other options: `sudo cpupower frequency-info`\nset governor to performance: `sudo cpupower frequency-set --governor performance`\nmonitor power states and frequencies per core: `watch -n1 sudo cpupower monitor`\npin to core for more stable test results: `taskset -c 2 go test ...`",
        "created_at": "2024-08-30T11:24:21.539000+00:00",
        "attachments": []
    },
    {
        "author": "jtraglia",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Actually the results with the portable flag should be the same. It‚Äôs just a quick way to ensure optimized cpu instructions are being used.",
        "created_at": "2024-08-30T11:48:32.831000+00:00",
        "attachments": []
    },
    {
        "author": "jtraglia",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Cool, yeah 233ms is good. That means it would take 1.4 seconds to compute everything sequentially, with a single core. With parallelization it should be even faster.",
        "created_at": "2024-08-30T11:55:17.757000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "It's hard to use this number though cause nodes are already taking up most cores so it's unlikely that you'd get a linear correlation with the number of cores. I think we need to use the 1.2\" as the bench",
        "created_at": "2024-08-30T12:11:47.790000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I would have expected portable to be slower since it switches out cpu specific instructions/assembly code with more ‚Äúgeneric‚Äù instructions/c code",
        "created_at": "2024-08-30T12:15:08.362000+00:00",
        "attachments": []
    },
    {
        "author": "jtraglia",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "The flag was repurposed to enable ‚ÄúCPU runtime detection‚Äù",
        "created_at": "2024-08-30T12:16:01.474000+00:00",
        "attachments": []
    },
    {
        "author": "cskiraly",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I think the portable flag is to build a portable binary, one that does not use some of the CPU features of the CPU you build on (if you build on a newer CPU). So I would expect portable to be slower on new CPUs.",
        "created_at": "2024-08-30T12:17:42.910000+00:00",
        "attachments": []
    },
    {
        "author": "cskiraly",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "just seeing your previous answer üôÇ . If there is runtime detection for everything, than it is indeed the same speed.",
        "created_at": "2024-08-30T12:18:12.985000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "If the speed is the same with or without the flag, what is the purpose of the flag?",
        "created_at": "2024-08-30T12:21:02.530000+00:00",
        "attachments": []
    },
    {
        "author": "cskiraly",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I guess it is mostly for bughunting in various compile time and runtime CPU detection code parts at this point. When grepping for it, I've seen some strange combinations of flags (AVX, NO_ASM, PORTABLE), and also some related issues.",
        "created_at": "2024-08-30T12:24:08.979000+00:00",
        "attachments": []
    },
    {
        "author": "jtraglia",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "It's not always the case. The main purpose is to prevent SIGILLs when running on older hardware. By default, blst assumes that ADX instructions are available on x86_64 systems. If they aren't, it's going to crash. Before adding runtime detection, the portable flag would tell the compiler to not use any CPU features like ADX, SHA, and `__ARM_FEATURE_CRYPTO`. Now, the portable flag will cause blst to check if these features are available on startup. For the latter two features, blst will only use those if the compiler knows the feature is supported and it doesn't always know this. For example, our fuzzers use AMD processors and the compiler doesn't know it supports SHA extensions.",
        "created_at": "2024-08-30T12:38:11.596000+00:00",
        "attachments": []
    },
    {
        "author": "jtraglia",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Yes, I agree. But \u003c@476250636548308992\u003e said that it was taking 1 to 2 seconds on average with parallelization.",
        "created_at": "2024-08-30T13:07:14.743000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "yeah this is kinda consistent with what I'm saying though üôÇ",
        "created_at": "2024-08-30T13:14:38.088000+00:00",
        "attachments": []
    },
    {
        "author": "jtraglia",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "But this (1-2s upto 6-7s) is worse than the expected single-core time.",
        "created_at": "2024-08-30T13:20:26.850000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I'd assume is a mixture of Nishant's environment running vs a clean testing environment, and a rather stressed node.",
        "created_at": "2024-08-30T13:21:36.991000+00:00",
        "attachments": []
    },
    {
        "author": "jimmygchen",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "btw we're getting somewhere ~1s as well with `rust-eth-kzg` on devnets. The benchmark for compute cells \u0026 proofs is also ~200ms on a single thread.\nI think similar to the proposer bandwidth problem - computation could potentially be a bottleneck here for local block builders (given the current hardware requirements, quad core CPU). They may have to rely on supernodes to compute and disseminate data columns to avoid blocks getting orphaned / missed, if we're looking to scale above 6 blobs. \n\nI'm hoping we can get these `getBlobsV1` spec changes finalised, and spec out the distributed blob building solution (https://github.com/sigp/lighthouse/pull/6268)\n- https://github.com/ethereum/execution-apis/pull/559\n- https://github.com/ethereum/consensus-specs/pull/3864",
        "created_at": "2024-08-30T13:32:37.133000+00:00",
        "attachments": []
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "The issue is that a live node is doing a lot of other things at a time, so a static benchmark isnt always accurate on what happens. When this was profiled, calling into ckzg was the bottleneck",
        "created_at": "2024-08-30T14:24:26.771000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "So that I can reproduce and experiment; how are you profiling and running the node?",
        "created_at": "2024-08-30T14:38:06.058000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "It‚Äôs a bit surprising that the effective speed up of adding parallelism is nothing ‚Äî which could imply that thread usage is very high.\n\nI now wonder how the go runtime scheduler and for rust the os scheduler would perform if there are parts inside of computeCellsAndProofs that could be parallelised (essentially splitting up the function even more from the perspective of the scheduler)",
        "created_at": "2024-08-30T14:42:02.896000+00:00",
        "attachments": []
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "This was while running a peerdas devnet on my machine (1 supernode and 1 full node). Blocks were constantly late until we managed to fetch a profile and figure out the bottleneck",
        "created_at": "2024-08-30T14:44:18.712000+00:00",
        "attachments": []
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "What machine is that 1s number on ?",
        "created_at": "2024-08-30T14:48:07.772000+00:00",
        "attachments": []
    },
    {
        "author": "jimmygchen",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "4 nodes (2 supernode and 2 full node) on 16 core and cpu",
        "created_at": "2024-08-30T14:52:04.759000+00:00",
        "attachments": []
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Which processor would this be ?",
        "created_at": "2024-08-30T14:53:28.361000+00:00",
        "attachments": []
    },
    {
        "author": "jimmygchen",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "This is with ckzg right? We haven‚Äôt tried ckzg since we switched over to rust-eth-kzg",
        "created_at": "2024-08-30T14:53:38.026000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Since there are 2 nodes running on one machine, how are the resources being shared?",
        "created_at": "2024-08-30T14:54:00.168000+00:00",
        "attachments": []
    },
    {
        "author": "jimmygchen",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Oh its actually 8 cores\n\nAMD Ryzen 7 3700X (3.6 GHz, 8 cores)",
        "created_at": "2024-08-30T14:55:55.834000+00:00",
        "attachments": []
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "This was run on kurtosis via docker containers. As far as i understood there was no restricition on CPU utilization per node\ncc \u003c@412614104222531604\u003e",
        "created_at": "2024-08-30T14:56:42.473000+00:00",
        "attachments": []
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Yeap ckzg",
        "created_at": "2024-08-30T14:56:50.926000+00:00",
        "attachments": []
    },
    {
        "author": "jimmygchen",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "IIRC benchmark for rust kzg compute cells on this machine was also around 200ms",
        "created_at": "2024-08-30T14:57:21.291000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "there is 1core limit by default per participant",
        "created_at": "2024-08-30T15:01:20.682000+00:00",
        "attachments": []
    },
    {
        "author": "jimmygchen",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I think \u003c@427491045308235776\u003e might have told me in my dreams that he can parallelize this further and get a 80% gain",
        "created_at": "2024-08-30T15:01:53.613000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "resources are limited due to the requirement to be able to autoscale (with kube backend)",
        "created_at": "2024-08-30T15:02:05.113000+00:00",
        "attachments": []
    },
    {
        "author": "jimmygchen",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Ahhh that explains it",
        "created_at": "2024-08-30T15:02:21.398000+00:00",
        "attachments": []
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Oh that starts to explain a lot lol",
        "created_at": "2024-08-30T15:02:43.505000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "https://github.com/ethpandaops/ethereum-package/blob/main/src/package_io/constants.star#L395",
        "created_at": "2024-08-30T15:02:47.636000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "sorry for the confusion that this has caused",
        "created_at": "2024-08-30T15:02:56.169000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "you can override this for each run",
        "created_at": "2024-08-30T15:03:02.071000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "by setting cl_max_cpu: 0",
        "created_at": "2024-08-30T15:03:17.400000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "0 stands for infinity",
        "created_at": "2024-08-30T15:03:23.365000+00:00",
        "attachments": []
    },
    {
        "author": "jimmygchen",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "All good, \u003c@412614104222531604\u003e was trying to get kzg performance optimised by 10x, can‚Äôt blame you üòâ",
        "created_at": "2024-08-30T15:04:01.853000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "also ram is limited by default (for the same reasons)",
        "created_at": "2024-08-30T15:06:18.395000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "core resources are allocated based on millicores. so 1000 = 1 full core.",
        "created_at": "2024-08-30T15:06:55.659000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "don‚Äôt stop just because of me! Any speed up is appreciated still haha",
        "created_at": "2024-08-30T15:07:56.545000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "could you please confirm that you see speed up with cl_max_cpu: 0?",
        "created_at": "2024-08-30T15:15:29.855000+00:00",
        "attachments": []
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Its nearly 12 here, I wont be able to test this out by today",
        "created_at": "2024-08-30T15:23:27.675000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "we need to get better mobile phone support for kurtosis",
        "created_at": "2024-08-30T15:25:23.093000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "cc \u003c@199561711278227457\u003e",
        "created_at": "2024-08-30T15:25:28.314000+00:00",
        "attachments": []
    },
    {
        "author": "jimmygchen",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "can confirm my cpu has reached 90C",
        "created_at": "2024-08-30T15:26:07.965000+00:00",
        "attachments": []
    }
]
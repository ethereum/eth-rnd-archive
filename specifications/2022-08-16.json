[
    {
        "author": "siladu",
        "category": "general",
        "parent": "",
        "content": "Hi, I've been reading the berlin execution specs in conjunction with the berlin yellow paper and noticed a discrepancy. The execution-specs only invalidate the block if the sender balance can cover the up-front gas_fee:\nhttps://github.com/ethereum/execution-specs/blob/cc697f256d281476b9c9f810542e84fb78be2505/src/ethereum/berlin/spec.py#L599-L601 \nHowever, in the YP (and client implementations), the tx.value is also added to the gas_fee for this check: https://github.com/ethereum/yellowpaper/blob/7251f10f25fc2a340c51c57e4a71970b525c0691/Paper.tex#L708-L711\n\nA check is done later as part of the EVM https://github.com/ethereum/execution-specs/blob/cc697f256d281476b9c9f810542e84fb78be2505/src/ethereum/berlin/vm/interpreter.py#L239-L243 which can raise an InsufficientFunds exception.\nHowever I believe this results in an exception which sets the gas to 0, which seems like a significant difference compared to the transaction being recognised as invalid earlier.\n\nHave I missed something here?",
        "created_at": "2022-08-16T06:19:12.670000+00:00",
        "attachments": []
    },
    {
        "author": "gurukamath",
        "category": "general",
        "parent": "",
        "content": "Will need to take a closer look at this",
        "created_at": "2022-08-16T10:34:26.485000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "It'd be a pretty glaring hole if this case wasn't covered by `ethereum-tests`, but certainly possible.",
        "created_at": "2022-08-16T14:04:05.897000+00:00",
        "attachments": []
    },
    {
        "author": "gurukamath",
        "category": "general",
        "parent": "",
        "content": "The current tests that we run pass either way. So it appears not to have been covered ðŸ¤”",
        "created_at": "2022-08-16T14:26:16.601000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "I'll be a minute or two late",
        "created_at": "2022-08-16T14:28:36.343000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "Spec Sync #61\n - \u003c@830368514225340436\u003e finished the london fork, just waiting on the EVM refactoring PR.\n - \u003c@886437394675548190\u003e working on the talk for SBC about the specs project.\n - \u003c@243183686562873344\u003e put up the monster EVM refactoring PR, investigating supporting other networks.",
        "created_at": "2022-08-16T14:54:25.287000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "Hi I ve been reading the berlin",
        "created_at": "2022-08-16T15:15:49.876000+00:00",
        "attachments": []
    }
]
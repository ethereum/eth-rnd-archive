[
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "Spec Sync #19: Planning Homestead\n\nMostly covered new tickets and EIPs in homestead.\n\nOpen questions:\n\n - How to handle re-orgs if we follow mainnet?",
        "created_at": "2021-09-22T15:03:41.084000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "I have issues for EIPs up to and including spurious dragon now",
        "created_at": "2021-09-22T15:21:44.999000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "Something I meant to ask during the call but totally spaced on:\n\nShould we do the type audits before making the copy for homestead?",
        "created_at": "2021-09-22T15:22:18.233000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "(cc. \u003c@!497280885645639691\u003e \u003c@!564718359304863744\u003e \u003c@!243183686562873344\u003e \u003c@!543900561460822016\u003e)",
        "created_at": "2021-09-22T15:23:36.753000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "general",
        "parent": "",
        "content": "i think yes",
        "created_at": "2021-09-22T15:27:57.485000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "general",
        "parent": "",
        "content": "minimizes future work",
        "created_at": "2021-09-22T15:28:07.577000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "Okay, I'll do the bytes types today.",
        "created_at": "2021-09-22T15:37:33.346000+00:00",
        "attachments": []
    },
    {
        "author": "voith",
        "category": "general",
        "parent": "",
        "content": "Yeah we have to do those sooner than later. \nBut I'll continue to work in parallel on the Homestead hard fork.",
        "created_at": "2021-09-22T15:57:31.774000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "The state root in a block is a variable length byte array, or a `Hash32`?",
        "created_at": "2021-09-22T18:16:39.661000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "Pretty sure it's the latter",
        "created_at": "2021-09-22T18:16:44.768000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "https://eth.wiki/fundamentals/specs/consensus-datastructures",
        "created_at": "2021-09-22T19:08:37.686000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "TL;DR: 32-bytes (hash).",
        "created_at": "2021-09-22T19:08:59.875000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "All hashes are full width, leading zeros are not stripped.",
        "created_at": "2021-09-22T19:09:23.362000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Only QUANTITY values have their leading zeros stripped.",
        "created_at": "2021-09-22T19:09:42.098000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "Alright, next question. In the storage tries (global and per-account) what is the key type? Variable length byte array, or fixed length byte array?",
        "created_at": "2021-09-22T19:17:24.461000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "Probably a good question for \u003c@!243183686562873344\u003e \u003e.\u003e",
        "created_at": "2021-09-22T19:21:40.011000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "32-bytes.  Necessary for the MPT trie to work.",
        "created_at": "2021-09-22T19:22:00.738000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "From the afformentioned doc:\n```\nStateRoot = patriciaTrie(keccak256(Address) =\u003e rlp(Account)).rootHash\nStorageRoot = patriciaTrie(keccak256(StorageSlot: UInt256) =\u003e Bytes32).rootHash\n```",
        "created_at": "2021-09-22T19:22:24.699000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "They are hashed to ensure good distribution across the space, and all 32 bytes are used, even if the first byte is 0 that is still used.",
        "created_at": "2021-09-22T19:23:02.239000+00:00",
        "attachments": []
    },
    {
        "author": "peter.davies",
        "category": "general",
        "parent": "",
        "content": "This gets kind of subtle. The State consists of a mapping `Address =\u003e Account` and a mapping `(Address, Bytes32) =\u003e U256`.\nBut to calculate the root of a state you have to do the following process:\n1. Hash all the the addresses and storage keys.\n2. For each address calculate the storage root by putting all of storage slot into a MPT.\n3. Put all the accounts (with their storage roots) into a MPT.\n4. The root of that MPT is the state root.",
        "created_at": "2021-09-22T19:30:38.192000+00:00",
        "attachments": []
    },
    {
        "author": "peter.davies",
        "category": "general",
        "parent": "",
        "content": "The conceptual point is that when Verkle tries are implemented the process for calculating a state root will change, but the state will still be a pair of mappings.",
        "created_at": "2021-09-22T19:32:04.090000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "So for the API for `Trie` needs to support `Address =\u003e Account` and `Bytes32 =\u003e U256`?",
        "created_at": "2021-09-22T19:32:49.687000+00:00",
        "attachments": []
    },
    {
        "author": "peter.davies",
        "category": "general",
        "parent": "",
        "content": "It has to support `Uint`, `Address` and `Bytes32` as keys and `Account`, `Transaction`, `Receipt` and `U256` as values.",
        "created_at": "2021-09-22T19:37:30.132000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "It is `address =\u003e account_tuple` and `uint256_slot =\u003e bytes32_data`",
        "created_at": "2021-09-22T19:38:25.403000+00:00",
        "attachments": []
    },
    {
        "author": "peter.davies",
        "category": "general",
        "parent": "",
        "content": "Is there a distinction between `Bytes32` and `U256`? The EVM doesn't draw one.",
        "created_at": "2021-09-22T19:39:36.221000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "For the sake of Ethereum wire encoding yes.",
        "created_at": "2021-09-22T19:39:51.362000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Not sure if it applies here, but I think it is good to be explicit that all 32 bytes are returned, even if some are 0.",
        "created_at": "2021-09-22T19:40:18.156000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The data type of each piece of data stored in a slot is opaque, it is just 32-bytes of *something*.",
        "created_at": "2021-09-22T19:40:58.243000+00:00",
        "attachments": []
    },
    {
        "author": "peter.davies",
        "category": "general",
        "parent": "",
        "content": "We also have to support `Bytes32` as trie values for the `TrieTests` in the test suite.",
        "created_at": "2021-09-22T19:52:02.527000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "I think I'm definitely missing the point of `get_storage_root` üòê",
        "created_at": "2021-09-22T21:51:35.916000+00:00",
        "attachments": []
    }
]
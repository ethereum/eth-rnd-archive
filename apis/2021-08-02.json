[
    {
        "author": "protolambda",
        "category": "Consensus Layer",
        "parent": "",
        "content": "On the api docs site (https://ethereum.github.io/eth2.0-APIs/#/) I find a `GET /eth/v2/beacon/blocks/{block_id}` with versioned SignedBeaconBlock response,  but no v2 of `POST ​/eth​/v1​/beacon​/blocks` to version the posted data the same way. How do clients handle this currently?",
        "created_at": "2021-08-02T20:28:14.671000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Consensus Layer",
        "parent": "",
        "content": "FWIW, I updated my Go standard-api bindings with Altair support: https://github.com/protolambda/eth2api",
        "created_at": "2021-08-02T21:43:00.715000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Consensus Layer",
        "parent": "",
        "content": "We settled on that remaining a v1 but being able to accept either form. Because it's being more flexible about input, it's not a backwards incompatible change.  And not having to change the URL saves an awful lot of coordination in making sure beacon nodes and validator clients are updated at the same time.",
        "created_at": "2021-08-02T22:09:54.652000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Consensus Layer",
        "parent": "",
        "content": "\u003c@!340345049063882753\u003e Does that mean we'll need type-hacks to detect which fork the block input is for? Updating to v2 with version tag is a lot better IMHO",
        "created_at": "2021-08-02T22:12:11+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Maybe we can add the version as a query tag for this post-request, since the data itself is not wrapped with \"data\" like request payloads are?",
        "created_at": "2021-08-02T22:14:01.918000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Consensus Layer",
        "parent": "",
        "content": "\u003c@!602753420033785856\u003e how does Lighthouse handle beacon-block POST data?",
        "created_at": "2021-08-02T22:15:21.083000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "The general idea is that the beacon chain should decide on if the data is valid as part of its acceptance of the request.  In the case of a block it could carry out a partial decode of the JSON to find out the slot, and then decode it in to a suitable structure.",
        "created_at": "2021-08-02T22:21:54.647000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I still regard that as a type-hack, but it works, will update my bindings to also do that",
        "created_at": "2021-08-02T22:23:57.659000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Our (de)serialisation library actually doesn’t need the hints at all. It’s possibly a bit inefficient, but it looks at the available fields and works out which variant to decode. This is why I took so long implementing the /v2/ API too: we don’t actually need it",
        "created_at": "2021-08-02T23:18:44.204000+00:00",
        "attachments": null
    },
    {
        "author": "sproul",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Validator clients still need to be updated to use `/v2/validator/blocks` to fetch the block, as the /v1/ API stops working at the fork boundary. The next Lighthouse release will use /v2/ by default (including before the fork), so I’m hoping that corresponds with an update on Infura’s side to support /v2/",
        "created_at": "2021-08-02T23:26:56.487000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Consensus Layer",
        "parent": "",
        "content": "hmm, good point.  Teku switches to the v2 endpoint only when altair is enabled but we've supported it for a few releases now.  So likely need to ask Infura to actually expose them.  I'll chase it up.",
        "created_at": "2021-08-02T23:36:57.740000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Consensus Layer",
        "parent": "",
        "content": "We probably should do a v2 release of the apis so these get locked down as stable now as well I guess.",
        "created_at": "2021-08-02T23:38:42.798000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "https://github.com/ethereum/consensus-specs/blob/v1.5.0-beta.3/specs/electra/validator.md#construct-aggregate says\n\u003e \u003e ### Construct aggregate\n\u003e \u003e \n\u003e \u003e - Set `attestation_data.index = 0`.\n\u003e \u003e - Let `aggregation_bits` be a `Bitlist[MAX_VALIDATORS_PER_COMMITTEE * MAX_COMMITTEES_PER_SLOT]` of length `len(committee)`, where each bit set from each individual attestation is set to `0b1`.\n\u003e \u003e - Set `attestation.committee_bits = committee_bits`, where `committee_bits` has the bit set corresponding to `committee_index` in each individual attestation.\n\nBut https://ethereum.github.io/beacon-APIs/?urls.primaryName=v3.0.0#/Validator/getAggregatedAttestationV2 says\n```\n{\n  \"version\": \"electra\",\n  \"data\": {\n    \"aggregation_bits\": \"0x01\",\n    \"data\": {\n      \"slot\": \"1\",\n      \"index\": \"1\",\n      \"beacon_block_root\": \"0xcf8e0d4e9587369b2301d0790347320302cc0943d5a1884560367e8208d920f2\",\n      \"source\": {\n        \"epoch\": \"1\",\n        \"root\": \"0xcf8e0d4e9587369b2301d0790347320302cc0943d5a1884560367e8208d920f2\"\n      },\n      \"target\": {\n        \"epoch\": \"1\",\n        \"root\": \"0xcf8e0d4e9587369b2301d0790347320302cc0943d5a1884560367e8208d920f2\"\n      }\n    },\n    \"signature\": \"0x1b66ac1fb663c9bc59509846d6ec05345bd908eda73e670af888da41af171505cc411d61252fb6cb3fa0017b679f8bb2305b26a285fa2737f175668d0dff91cc1b66ac1fb663c9bc59509846d6ec05345bd908eda73e670af888da41af171505\",\n    \"committee_bits\": \"0x0000000000000001\"\n  }\n}\n```\n\nThese seem potentially inconsistent with each other? Or is it intended that the `AttestationData` returned has an invalid `index` field which is then modified?",
        "created_at": "2025-03-17T15:33:20.873000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "because the thing is, the attestationdata's it's accumulating generally speaking won't have index != 0",
        "created_at": "2025-03-17T15:37:02.559000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "or shouldn't",
        "created_at": "2025-03-17T15:37:12.865000+00:00",
        "attachments": null
    },
    {
        "author": "nflaig",
        "category": "Consensus Layer",
        "parent": "",
        "content": "the values are generated by the api explorer based on the schema, I don't think those should be considered valid I would be surprised if the signature actually is, if we would want those to be valid we would need to add example data manually for all apis\n\nthat said, we can add custom `example` field on the container to use `0` to avoid potential confusion, is that what you mean?",
        "created_at": "2025-03-17T15:37:44.047000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "yeah",
        "created_at": "2025-03-17T15:37:55.376000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "the Electra specs are very insistent on this point",
        "created_at": "2025-03-17T15:38:05.749000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "and confusion is likely reading this endpoint's documentation otherwise",
        "created_at": "2025-03-17T15:38:19.636000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "like, there is a nonzero committee index in play",
        "created_at": "2025-03-17T15:38:30.925000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "the \"obvious\" way is just not how it's correctly respesented",
        "created_at": "2025-03-17T15:38:46.361000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "it's not that high priority, but I'll say, we've been investigating an issue and it's wasted a bunch of time to double-check this because of this misleading endpoint documentation",
        "created_at": "2025-03-17T15:39:32.794000+00:00",
        "attachments": null
    },
    {
        "author": "nflaig",
        "category": "Consensus Layer",
        "parent": "",
        "content": "yeah agree, the example data shown should be as representative to the actual data as possible, might be worth adressing, I think we wanna cut a 3.1 release anyways with some follow-up changes",
        "created_at": "2025-03-17T15:40:51.451000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "it's probably overkill to get all the signatures etc correct",
        "created_at": "2025-03-17T15:42:09.053000+00:00",
        "attachments": null
    }
]
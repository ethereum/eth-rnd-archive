[
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "In general, BNs can get swapped out without prior warning for VCs, in both directions (unless/until mandatory via hardfork): supporting SSZ or not supporting SSZ. These HTTP REST connections by construction don't have a sense of identity or ongoing state",
        "created_at": "2025-04-22T04:06:58.574000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "The only reliable content type negotiation is per HTTP connection",
        "created_at": "2025-04-22T04:07:53.356000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Consensus Layer",
        "parent": "",
        "content": "For GET requests, content negotiation works per-request really easily. For POST requests, it's typically to cache which content type was actually accepted (ie remember that posting SSZ did or didn't work).  If the BN later changes and starts rejecting SSZ you'll get a rejection and can then fallback to JSON. It's a bit harder to notice that SSZ started being supported if you've cached that you should use JSON since you don't get an automatic notification - how to handle that depends on how much benefit you get from SSZ vs JSON and how likely you think the BN suddenly being upgraded is going to be. Typically I'd just cache that JSON is required and _maybe_ retry SSZ once a day or something very rare because it's not that big a deal and you'll upgrade to SSZ on the next restart.",
        "created_at": "2025-04-22T04:49:36.207000+00:00",
        "attachments": null
    },
    {
        "author": "inspector.butters",
        "category": "Consensus Layer",
        "parent": "",
        "content": "caching per route with a timeout seems reasonable",
        "created_at": "2025-04-22T09:04:14.493000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "It can be made to work by allowing more edge cases and fallbacks, yes. I'd prefer, for the purposes of Fusaka scope, to as much as feasible treat these things as required to avoid creating unnecessary/incidental complexity in validator client implementations",
        "created_at": "2025-04-22T09:06:19.787000+00:00",
        "attachments": null
    },
    {
        "author": "nflaig",
        "category": "Consensus Layer",
        "parent": "",
        "content": "in Lodestar we cache it per route per url (in case of fallbacks), adding a timeout to retry SSZ at some point again seems a bit overkill to me but there is no harm either, so why not",
        "created_at": "2025-04-22T10:45:12.136000+00:00",
        "attachments": null
    },
    {
        "author": "radekkapka",
        "category": "Consensus Layer",
        "parent": "",
        "content": "We can do failover, timeouts, etc etc. But why not simply require SSZ to be supported for all endpoints starting in Fusaka?",
        "created_at": "2025-04-22T13:00:11.739000+00:00",
        "attachments": null
    },
    {
        "author": "radekkapka",
        "category": "Consensus Layer",
        "parent": "",
        "content": "It should really be a small amount of work (I expect a week at most for Prysm)",
        "created_at": "2025-04-22T13:00:59.755000+00:00",
        "attachments": null
    },
    {
        "author": "nflaig",
        "category": "Consensus Layer",
        "parent": "",
        "content": "if other teams are up for it definitely, using hard fork boundry is a bit tricky though so I still rather like us to use a backward compatible approach",
        "created_at": "2025-04-22T13:02:29.454000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "how is it tricky",
        "created_at": "2025-04-22T13:45:46.002000+00:00",
        "attachments": null
    },
    {
        "author": "nflaig",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I guess you could just use this for requests, ie. once you are in Fusaka based on clock slot you start sending ssz data, for responses we can use q-weighted Accept headers either way, so this is already solved issue",
        "created_at": "2025-04-22T13:47:30.073000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "well, or that once in Fusaka, the BN REST servers have to provide it",
        "created_at": "2025-04-22T14:11:51.481000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Consensus Layer",
        "parent": "",
        "content": "VCs/clients can use it or not",
        "created_at": "2025-04-22T14:11:59.253000+00:00",
        "attachments": null
    }
]
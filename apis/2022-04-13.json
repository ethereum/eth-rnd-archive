[
    {
        "author": "lightclient",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Hi, for the Builder API we have message `builder_setFeeRecipient` which is a message signed by validator clients over their `feeRecipient`. The current idea would to add a new endpoint on the Beacon API where the validator client would periodically post their signed announcement of the `feeRecipient`. This raises the question as to what the beacon node should do if that `feeRecipient` conflicts with what is heard from `prepare_beacon_proposer`. Two possible approaches:\n* simply combine the two methods -- this would entail adding a signature field to `prepare_beacon_proposer` and any other important metadata. If someone could point me to documentation on usual flow for when this method is called, that would help me better understand if this is the best approach. At minimum, we'd want to send this to the bn when the vc starts up; maybe that is already the case.\n* alternatively, we could disregard the conflict and just ensure that blocks from the local EL match the requested `feeRecipient` in `prepare_beacon_proposer` and the `feeRecipient` from the new `setFeeRecipient` related endpoint matches what is received from the Builder API. We could also output some warnings when that happens?",
        "created_at": "2022-04-13T10:23:28.811000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Seems like the body would need to be an array of signed messages, something like:\n\n```\n[\n  {\n    \"message\": {\n      \"index\": \"1\",\n      \"fee_recipient\": \"0x...\",\n      \"timestamp\": \"1649846512\"\n    },\n    \"signature: \"0x...\"\n  },\n  ...\n]\n```\n\nOptions for how to implement this:\n1. create a `v2` of `prepare_beacon_proposer` with the new body\n2. upgrade `v1` in situ as we haven't used it in anger yet\n3. create a new endpoint",
        "created_at": "2022-04-13T10:43:56.774000+00:00",
        "attachments": []
    },
    {
        "author": "metachris_",
        "category": "Consensus Layer",
        "parent": "",
        "content": "the body would need to include the public key, for the builder to associate with the feerecipient. and would `timestamp` be encoded as QUANTITY (hex with 0x prefix) by convention?",
        "created_at": "2022-04-13T10:57:36.109000+00:00",
        "attachments": []
    },
    {
        "author": "m.kalinin",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Would builder be able to obtain a public key by validator index? This requires an access to the beacon state",
        "created_at": "2022-04-13T10:58:55.223000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "QUANTITY is a JSON-RPC convention, this is the REST API where numbers are encoded as quoted strings.",
        "created_at": "2022-04-13T10:59:32.362000+00:00",
        "attachments": []
    },
    {
        "author": "metachris_",
        "category": "Consensus Layer",
        "parent": "",
        "content": "The builder is expected to have access to the beacon state, to prepare payloads with feeRecipient only for the specific validator. So I guess yes that should be possible.",
        "created_at": "2022-04-13T11:03:40.769000+00:00",
        "attachments": []
    }
]
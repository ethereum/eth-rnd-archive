[
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "We do not know what fork 4844 will land in yet.",
        "created_at": "2022-12-21T05:51:53.764000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "This is going to be a recurring problem, as it has been with the EL.  No one has any idea which fork a particular feature is going to land in until basically the last minute, which is why ELs don't feature flag by fork but rather by EIP.",
        "created_at": "2022-12-21T05:52:34.813000+00:00",
        "attachments": []
    },
    {
        "author": "ajsutton",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Except most EIPs don‚Äôt change as any data structures let alone to the extent that tends to happen with consensus upgrades. So the changes aren‚Äôt independent and order matters as you have to know which combination of fields is actually in the state or block.",
        "created_at": "2022-12-21T06:09:43.797000+00:00",
        "attachments": []
    },
    {
        "author": "ajsutton",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Theoretically you could maybe make the data structure implementation highly dynamic to enable flexible feature toggling but it would come with performance and complexity costs.",
        "created_at": "2022-12-21T06:10:19.093000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus Layer",
        "parent": "",
        "content": "for capella it's owls btw: \n‚Äì¬†Lodestar: https://github.com/ChainSafe/lodestar/blob/dce508ccb53f6ef9065100753b5def19194d85e5/packages/beacon-node/src/chain/blocks/utils/ownBanner.ts\n‚Äì¬†Nimbus: https://github.com/status-im/nimbus-eth2/pull/4442",
        "created_at": "2022-12-21T07:26:41.283000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus Layer",
        "parent": "",
        "content": "hm? not sure how light client updates relate to naming",
        "created_at": "2022-12-21T07:28:47.921000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus Layer",
        "parent": "",
        "content": "If LC is not likely to change (the apis in dev) , could potentially release beacon-apis, but if we release it and they have to change you‚Äôd need to version it",
        "created_at": "2022-12-21T07:39:52.146000+00:00",
        "attachments": []
    },
    {
        "author": "sproul",
        "category": "Consensus Layer",
        "parent": "",
        "content": "we could mark them experimental like the rewards APIs",
        "created_at": "2022-12-21T07:57:05.613000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "We're currently pretty sure that it will be Deneb, with an outside chance it shows up in Capella.  So naming it in accordingly to the likeliest scenario and perhaps having to rename later seems saner than naming it with something that will definitely need to be renamed later.",
        "created_at": "2022-12-21T08:05:15.324000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I'm mildly concerned that naming it now will have a negative impact on the governance process.",
        "created_at": "2022-12-21T08:05:54.363000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Many people will take the fork naming as gospel and broadcast that \"4844 is definitely going into Deneb!\", then when Deneb rolls around and the *right* thing to do is delay to the following fork (for whatever reason) people will cry about being rugged.",
        "created_at": "2022-12-21T08:07:04.834000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "And governance will be more likely to push it to be in Daneb rather than next fork, even if that isn't the ideal path but \"because of optics\".",
        "created_at": "2022-12-21T08:07:35.650000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus Layer",
        "parent": "",
        "content": "ah, they are versioned though? it is a `v1` API",
        "created_at": "2022-12-21T08:08:59.330000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus Layer",
        "parent": "",
        "content": "the data is the same as on libp2p",
        "created_at": "2022-12-21T08:09:11.392000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I wouldn't equate what people may think with governance.  And I thought that it had already been made clear in the calls that 4844 would be in Capella or Deneb, so the only change would be if it came in sooner?",
        "created_at": "2022-12-21T08:10:53.449000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Deneb planning hasn't begun yet, and Ethereum (EL specifically) has never scheduled more than next-fork out.",
        "created_at": "2022-12-21T08:11:45.653000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "So we cannot say it *will* be in Deneb, only that it might not be in Capella and there is some desire to get it in \"as soon as possible\".",
        "created_at": "2022-12-21T08:12:11.127000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "If we aren't inured enough by \"merge delayed\" articles by now that we're still jumpy about making useful technical decisions that we are aware are probabilistic then fair enough, but seems like a very poor way of going about things.",
        "created_at": "2022-12-21T08:22:07.977000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "My concern is with the long term health of governance and various things influencing our decision making away from technical decisions and towards optics.  If 4844 isn't technically ready for Deneb for any reason, we should not feel pressure to include it \"because we already picked a name\" or \"because users were told it would be in Deneb\".",
        "created_at": "2022-12-21T09:33:01.871000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Even if we think that is unlikely with 4844, I feel like we should not fall into a pattern of behavior that leads to such situations in the future.",
        "created_at": "2022-12-21T09:33:29.444000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "If we *do* want to start doing hard fork planning multiple forks out that is fine with me, but we should actually do that planning rather than people just making assumptions about what will be in Deneb before we have actually had such conversations.",
        "created_at": "2022-12-21T09:34:12.780000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I suspect that more long term planning would require more meetings, which the various core devs have been quite resistant to historically.  We already can't do all of the planning we need for upcoming fork in the allotted time, so I think doing actual HF planning multiple forks out would first require addressing the \"time to coordinate\" problem.",
        "created_at": "2022-12-21T09:35:52.281000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "[We need some sort of 'misc' channel, this doesn't fit here but it's probably closest of the available channels.]\n\nIs there any (beacon node client-specific) reason why validator registrations sent to MEV relays have to be on the epoch boundary?  At current there is a spike of these and this causes problems for those running MEV relays and timeouts for the registrations, but it seems to me that these could be sent earlier without any downside.\n\nIf there is no reason why not, it would be great if beacon nodes sent the registrations at some random point in time in the 6 slots prior to the change of epoch, to spread the load.  Comments/thoughts?",
        "created_at": "2022-12-21T14:09:41.351000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "no reason other than it is spec‚Äôd out this way",
        "created_at": "2022-12-21T15:17:09.685000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "i think clients piggyback onto the local ‚Äúprepare beacon proposer‚Äù flow which is gated to epochs, just out of simplicity",
        "created_at": "2022-12-21T15:17:49.972000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "a somewhat simple fix is to just buffer the registrations in mev-boost and then have it just randomly upstream them to spread the load",
        "created_at": "2022-12-21T15:18:21.707000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "The registrations cannot easily go after the epoch boundary because they may miss registrations for newly-active validators that propose in that epoch.\n\nYou could say that validator registrations occur (1) when the validator client starts and (2) some time in the epoch _for the following epoch_, but that's basically the same thing as my original suggestion.",
        "created_at": "2022-12-21T15:50:13.945000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "However, if there is no reason then it makes sense to spread out the load a bit.  I'll have a think about the wording and then raise a PR somewhere.",
        "created_at": "2022-12-21T15:51:14.480000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus Layer",
        "parent": "",
        "content": "just that im not against changing an unreleased v1, and i'd be against changing a released v1... nvm...",
        "created_at": "2022-12-21T19:47:12.033000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus Layer",
        "parent": "",
        "content": "\u003c@144468805697929216\u003e where does ethdo get the capella schedule from - just `eth/v1/config/spec`? getting \n```\nError: failed to process: beacon node not providing capella fork schedule; provide manually with --fork-version\n```\nwith teku and will raise a ticket to fix it while im away",
        "created_at": "2022-12-21T21:11:54.124000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "There is no information that I'm aware of that directly informs us of which fork is capella, so we count entries in the fork schedule with 0 === phase0, 1 == altair, 2 == bellatrix etc.  If a chain is started without a full fork schedule (if it starts with a fork already in place, or combines forks) then we're out of luck and need to have a fork version supplied to us manually.",
        "created_at": "2022-12-21T21:49:53.699000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus Layer",
        "parent": "",
        "content": "just that i got the message on a devnet, and apparently lighthouse didnt, so was trying to figure out what might be missing... raised a ticket, will get someone to see if they can spot anything while im on holidays üôÇ",
        "created_at": "2022-12-21T21:50:53.177000+00:00",
        "attachments": []
    },
    {
        "author": "ajsutton",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Our config/spec and config/fork_schedule endpoints look right to me.",
        "created_at": "2022-12-21T21:58:19.687000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus Layer",
        "parent": "",
        "content": "hrm ok, not sure why lighthouse would not need to specify it and we do then",
        "created_at": "2022-12-21T22:07:08.204000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Yeah they're accurate for the devnet, just not the same as mainnet in terms of number of entries in the schedule (_i.e._ separate ones for each hard fork, with the first one for phase 0).\n\nIf you can think of a way of obtaining the fork version for a particular hard fork that may be in the future I'd love to hear it.  Couldn't think of a foolproof way of doing it.\n\n(Although note that the method I'm using will work for all of prater/sepolia/mainnet, so I'm not too bothered about the fact that it isn't able to ascertain it automatically for a devnet.)",
        "created_at": "2022-12-21T22:13:49.274000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus Layer",
        "parent": "",
        "content": "it'd be listed in config/spec",
        "created_at": "2022-12-21T22:14:17.196000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus Layer",
        "parent": "",
        "content": "with the fork epoch less than far future",
        "created_at": "2022-12-21T22:14:32.098000+00:00",
        "attachments": []
    },
    {
        "author": "ajsutton",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I'd be tempted to update the `fork_schedule` endpoint to include the milestone name with each fork to make this simpler (and it would then be meaningful to humans as well). Would be simple for teku at least, not sure about other clients.",
        "created_at": "2022-12-21T22:16:04.312000+00:00",
        "attachments": []
    },
    {
        "author": "ajsutton",
        "category": "Consensus Layer",
        "parent": "",
        "content": "But yes you could also match up the fork_version with `\u003cMILESTONE\u003e_FORK_VERSION` properties from the spec config to know which fork was which.",
        "created_at": "2022-12-21T22:16:44.411000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Yeah, that may do it.  Will see if I can update accordingly.",
        "created_at": "2022-12-21T22:19:32.539000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus Layer",
        "parent": "",
        "content": "fork schedule change sounds good though",
        "created_at": "2022-12-21T22:22:18.017000+00:00",
        "attachments": []
    }
]
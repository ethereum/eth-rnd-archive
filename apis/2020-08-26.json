[
    {
        "author": "paulhauner",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Hey ðŸ™‚ When it comes to the `justified` and `finalized` IDs in `../beacon/states/...`, it seems there's two potential options if the epoch-boundary state for that epoch is a skip slot:\n\n- The state of the block which corresponds to the finalized block root (`state.slot != start_slot(finalized_epoch)`)\n- The \"skip state\" so that `state.slot == start_slot(finalized_epoch)`\n\nI'm wondering if someone has someone across this before?",
        "created_at": "2020-08-26T01:53:20.942000+00:00",
        "attachments": []
    },
    {
        "author": "djrtwo",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Id assume almost certainly the skip slots included in the transition because thats what is actually finalized",
        "created_at": "2020-08-26T01:54:57.148000+00:00",
        "attachments": []
    },
    {
        "author": "paulhauner",
        "category": "Consensus Layer",
        "parent": "",
        "content": "\u003e Id assume almost certainly the skip slots included in the transition because thats what is actually finalized\n\u003c@!291925846556540928\u003e To me, this makes the most sense for a user. Unfortunately it naively makes our lookups `O(slots_since_head)` instead of `O(1)`, but I think it'll be fine.",
        "created_at": "2020-08-26T02:00:23.612000+00:00",
        "attachments": []
    },
    {
        "author": "djrtwo",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I would have assumed justified and finalized state were very cheap\n\nWhy do you have the state at the block rather than the finalized state?",
        "created_at": "2020-08-26T02:01:52.396000+00:00",
        "attachments": []
    },
    {
        "author": "paulhauner",
        "category": "Consensus Layer",
        "parent": "",
        "content": "\u003e Why do you have the state at the block rather than the finalized state?\nBeacuse then you get `get_state(get_block(head_state.finalized_checkpoint.root).state_root)`",
        "created_at": "2020-08-26T02:04:15.264000+00:00",
        "attachments": []
    },
    {
        "author": "paulhauner",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Instead of iterating backwards through `head_state.state_roots`, searching for the one at slot `start_slot(head_state.finalized_checkpoint.epoch)`",
        "created_at": "2020-08-26T02:04:30.962000+00:00",
        "attachments": []
    },
    {
        "author": "djrtwo",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I see",
        "created_at": "2020-08-26T02:08:56.311000+00:00",
        "attachments": []
    },
    {
        "author": "paulhauner",
        "category": "Consensus Layer",
        "parent": "",
        "content": "\u003e - The \"skip state\" so that state.slot == start_slot(finalized_epoch)\nI've just implemented it so we return this state ðŸ™‚",
        "created_at": "2020-08-26T02:50:03.351000+00:00",
        "attachments": []
    },
    {
        "author": "ppf.",
        "category": "Consensus Layer",
        "parent": "",
        "content": "right now there is no endpoint to get the participation rate easily with the current eth2-api-spec, or am I overlooking something?",
        "created_at": "2020-08-26T14:43:42.246000+00:00",
        "attachments": []
    },
    {
        "author": "ppf.",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I think for us (explorer) this is not a problem, since we gather all the data for every epoch anyway",
        "created_at": "2020-08-26T14:45:15.878000+00:00",
        "attachments": []
    },
    {
        "author": "djrtwo",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I use that convenience method all the time ðŸ˜…",
        "created_at": "2020-08-26T14:45:33.566000+00:00",
        "attachments": []
    },
    {
        "author": "djrtwo",
        "category": "Consensus Layer",
        "parent": "",
        "content": "It was not. The api was to include the \"basic\" accessors before deciding on more high level (higher load) requirements for the BN",
        "created_at": "2020-08-26T14:46:17.966000+00:00",
        "attachments": []
    },
    {
        "author": "djrtwo",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I think we could make a strong case for including it in the canonical api. I wouldn't imagine clients would deprecate their participation rate endpoints before then",
        "created_at": "2020-08-26T14:47:17.926000+00:00",
        "attachments": []
    },
    {
        "author": "djrtwo",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I was just talking with \u003c@!97774605351010304\u003e this morning. I think the current prysm particiaption endpoint might be insufficient to capture the range of what we might want in the query",
        "created_at": "2020-08-26T14:48:00.248000+00:00",
        "attachments": []
    },
    {
        "author": "djrtwo",
        "category": "Consensus Layer",
        "parent": "",
        "content": "for the common API, it would argue for more granualr information like is in lighthouse's today\nhttps://lighthouse-book.sigmaprime.io/http/consensus.html#consensusglobal_votes",
        "created_at": "2020-08-26T14:48:40.277000+00:00",
        "attachments": []
    },
    {
        "author": "butta",
        "category": "Consensus Layer",
        "parent": "",
        "content": "\u003chttps://github.com/prysmaticlabs/prysm/issues/7116\u003e quoted danny's wise words here",
        "created_at": "2020-08-26T14:49:16.152000+00:00",
        "attachments": []
    },
    {
        "author": "butta",
        "category": "Consensus Layer",
        "parent": "",
        "content": "we should get \u003chttps://lighthouse.beaconcha.in/\u003e back alive to compare the dataðŸ˜¢",
        "created_at": "2020-08-26T14:50:11.329000+00:00",
        "attachments": []
    },
    {
        "author": "ppf.",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I agree that more granular information for participation-rate is nice, in the end though the most important rate is the one which is used to determine if an epoch is finalized",
        "created_at": "2020-08-26T14:54:36.052000+00:00",
        "attachments": []
    },
    {
        "author": "ppf.",
        "category": "Consensus Layer",
        "parent": "",
        "content": "also I think if we use the participation-rate numbers from an api, maybe we should compare the numbers to our own numbers calculated by using other data from the api (sum of active validators effBalance and sum of attesting validators effBalance)",
        "created_at": "2020-08-26T14:56:15.678000+00:00",
        "attachments": []
    },
    {
        "author": "protolambda",
        "category": "Consensus Layer",
        "parent": "",
        "content": "The participation rate chart on prysm metrics has been buggy sometimes as well, maybe time to revisit that",
        "created_at": "2020-08-26T15:51:50.365000+00:00",
        "attachments": []
    },
    {
        "author": "protolambda",
        "category": "Consensus Layer",
        "parent": "",
        "content": "In E2DB I went as far as just calculating it all from raw post state data: https://github.com/protolambda/e2db/blob/651aa8398bc388bedc2ccf7ed3d42f49866bdc0b/e2db/feedproc/eth2_state_feed.py#L249\nDidn't get the time to deploy e2db and keep improving it, but it's there. If someone has the time and interest in python data-processing of eth2, there may be some paid opportunity here.",
        "created_at": "2020-08-26T15:54:57.986000+00:00",
        "attachments": []
    },
    {
        "author": "mpetrunic",
        "category": "Consensus Layer",
        "parent": "",
        "content": "\u003c@!361447803194441738\u003e Can't you use forkchoice to find finalized and justified state root?",
        "created_at": "2020-08-26T16:18:32.643000+00:00",
        "attachments": []
    }
]
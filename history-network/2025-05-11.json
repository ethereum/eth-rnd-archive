[
    {
        "author": "fearlessfe",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "In the offer post-shanghai block header test case in hive\n1. store the `historical_summaries_with_proof` with epoch 364328 in beacon network\n2.  offer `header_with_proof` content entries\n\nwhen validate the header, we should get `historical_summaries_with_proof` from beacon network with contentKey, we should know the epoch of `HeaderWithProof`\nIn trin,  epoch = `HeaderWithProof-\u003eProof-\u003eSlot` / 32 (slots per epoch), but I think the epoch is not equal to 364328, so how they get the right `historical_summaries_with_proof`",
        "created_at": "2025-05-11T07:17:48.076000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "The epoch the HistoricalSummaries were generated in doesn't change or affect proving",
        "created_at": "2025-05-11T07:36:51.009000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "\u003chttps://github.com/ethereum/trin/blob/fd0b3c19c20c68059370a51d9b433ed34daa0591/crates/validation/src/historical_summaries_provider.rs#L34-L37\u003e this is how you would convert the HeaderWithProof's slot to the respective index of the HistoricalSummary within the HistoricalSummaries",
        "created_at": "2025-05-11T07:38:33.363000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "The HistoricalSummaries at epoch 364328 contains 666 HistoricalSummary's if my math serves right, which is able to prove up to the fork boundry for Electra",
        "created_at": "2025-05-11T07:41:13.950000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "You should always be using the latest HistoricalSummaries you store",
        "created_at": "2025-05-11T07:41:54.627000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "As HistoricalSummaries are just an appending list of anchors to prove against",
        "created_at": "2025-05-11T07:42:34.835000+00:00",
        "attachments": null
    },
    {
        "author": "fearlessfe",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "When there is no data in cache, we should get from HeaderOracle, send json rpc with contentKey\n```\nlet content_key =\n            BeaconContentKey::HistoricalSummariesWithProof(HistoricalSummariesWithProofKey {\n                epoch,\n            });\n```\nAnd I think if the epoch in contentKey is not 364328, there will no response,",
        "created_at": "2025-05-11T07:44:15.449000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Your storage code should return the latest HistoricalSummaries you have",
        "created_at": "2025-05-11T07:45:14.287000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "`SELECT epoch FROM historical_summaries WHERE epoch \u003e= (?1) LIMIT 1` this is what we do",
        "created_at": "2025-05-11T07:46:11.240000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Ops I meant `SELECT value FROM historical_summaries WHERE epoch \u003e= (?1) LIMIT 1`, but same idea",
        "created_at": "2025-05-11T07:49:34+00:00",
        "attachments": null
    },
    {
        "author": "fearlessfe",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Got it, I will check our beacon network",
        "created_at": "2025-05-11T07:50:48.390000+00:00",
        "attachments": null
    }
]
[
  {
    "author": "developeruche",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "The benchmark report is ready;\n\nhttps://hackmd.io/nz8dncoPRY6btL_uOQmWpQ#Total-Round-Trip-Time\n\nRaw log: https://github.com/developeruche/witness-bench/blob/main/RAW_REPORT.md\n\nReport shows latency improvement whe `debug_executionWitness` is paired with `engine_newPayload`",
    "created_at": "2026-02-09T13:43:03.376000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "<@944007601400741989> can you inform us of what transport mechanism you used here? Was this http? Can you evaluate performance with ipc?",
    "created_at": "2026-02-09T13:55:33.683000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "Great work by the way",
    "created_at": "2026-02-09T13:55:51.315000+00:00",
    "attachments": []
  },
  {
    "author": "developeruche",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "Yeah‚Ä¶ http",
    "created_at": "2026-02-09T13:57:07.931000+00:00",
    "attachments": []
  },
  {
    "author": "developeruche",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "Sure, I can evaluate over IPC",
    "created_at": "2026-02-09T13:57:43.403000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "Awesome, thanks!",
    "created_at": "2026-02-09T13:58:53.461000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "My takeaway is that the transport and serialization overhead is huge for large witnesses. I think we want to bypass transport entirely. I think we will need to have both the prover and the node on the same server. Using either a fast ssd drive or ram (memfd) to pass the witness from the node to the prover. cc: <@774033563732541451> <@466102668138512394> <@427491045308235776>",
    "created_at": "2026-02-09T14:17:06.028000+00:00",
    "attachments": []
  },
  {
    "author": "jsign",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "I think makes sense. We can use files at the \"software layer\" (i.e. CL), and leave to the node operator to optimize further using memfd if everything runs in the same machine (which prob is a good idea in general).",
    "created_at": "2026-02-09T14:47:51.725000+00:00",
    "attachments": []
  },
  {
    "author": "jsign",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "Thanks for you analysis! Did you have the chance to experiment with doing some ssz serialization to experiment how to see how changes a bit the JSON-overhead?",
    "created_at": "2026-02-09T14:49:06.700000+00:00",
    "attachments": []
  },
  {
    "author": "kevaundray",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "> I think we will need to have both the prover and the node on the same server.\nThis would be non-ideal I think because then the prover would have a stateful component. Perhaps this is where we eventually land at though after more investigation. \n\nFor further investigation, I think it may make sense to play around with different serializations/compression formats. \n\nAnother route is pricing out these worse case witnesses (by having the witness size be a requirement instead of a byproduct) and or not fully committing until we verify what it looks like with binary trees",
    "created_at": "2026-02-09T15:24:34.782000+00:00",
    "attachments": []
  },
  {
    "author": "kevaundray",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "What does the /Overhead part mean in \"Transport / Overhead\" ?\n\nIf possible would be great if you had more detail on whats happening here üôè  (just trying to figure out exactly what and why its so high)",
    "created_at": "2026-02-09T15:29:33.166000+00:00",
    "attachments": []
  },
  {
    "author": "developeruche",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "<@774033563732541451> I haven't tested SSZ yet since I was sticking to the current Engine API JSON-RPC specs, but you're right sending 500MB of hex-encoded bytes is definitely a worst-case scenario for transport ovrhead.\n\nCould explain more on what you mean me here? with what I have in my head, it would entail changing the transport layer data format of the node to SSZ which is quite a heavy lift for a PoC üôÇ",
    "created_at": "2026-02-09T15:42:38.140000+00:00",
    "attachments": []
  },
  {
    "author": "jsign",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "Ah, I was thinking on maybe some potential benefit of a currently proposed EIP to use SSZ at the EL. \nI was thinking more like just compraing raw JSON vs SSZ serialization maybe isolated -- not sure it is worth redoing the whole engineAPI to use SSZ for this since hta sounds quite a lot of work.",
    "created_at": "2026-02-09T15:45:53.785000+00:00",
    "attachments": []
  },
  {
    "author": "developeruche",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "got you! this would be really nice IMO, it cuts down data size by 50%",
    "created_at": "2026-02-09T15:47:39.336000+00:00",
    "attachments": []
  },
  {
    "author": "jsign",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "> Another route is pricing out these worse case witnesses (by having the witness size be a requirement instead of a byproduct) and or not fully committing until we verify what it looks like with binary trees\nYeah, actually 500MiB will be small compared with upcoming gas limit increases. ha\nThese worst cases should become better with BT due to bytecode chunking -- this will be a must to solve the killers coming from the bytecode attacks that generate those cases, so makes senes to maybe not overfit trying to deal with those",
    "created_at": "2026-02-09T15:48:24.459000+00:00",
    "attachments": []
  },
  {
    "author": "jsign",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "Some extra thoguhts about the: \"files API interface\". Might be good to see what some CL-core-devs think about this.. feels like a new \"interface type\" that is quite weirdish compared with what exist today in their impls?",
    "created_at": "2026-02-09T15:50:42.114000+00:00",
    "attachments": []
  },
  {
    "author": "jsign",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "Sophisticated builders prob will build their own pipeline ofc",
    "created_at": "2026-02-09T15:51:14.427000+00:00",
    "attachments": []
  },
  {
    "author": "developeruche",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "The \"transport/overhead\" here is essentially how long it takes for the witness data to move from the EL to the CL via the EngineAPI.\n\nThis was the way it was calculated;\n`Total_Round_Trip_Latency (CL Side) - (Block_Execution + Witness_Generation + JSON_Serialization (EL Side))`",
    "created_at": "2026-02-09T15:54:28.678000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "> This would be non-ideal I think because then the prover would have a stateful component. Perhaps this is where we eventually land at though after more investigation. \n\nCould you elaborate on this a little more, please? I don't follow",
    "created_at": "2026-02-09T16:47:20.916000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "> Some extra thoguhts about the: \"files API interface\". Might be good to see what some CL-core-devs think about this.. feels like a new \"interface type\" that is quite weirdish compared with what exist today in their impls? \n\n<@774033563732541451>  Does the CL layer have to be involved here? The expectation would be that the prover has access to the witnesses required to execute the block / new payload request that the CL requests via the api.",
    "created_at": "2026-02-09T16:49:25.864000+00:00",
    "attachments": []
  },
  {
    "author": "kevaundray",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "Currently we can send a prover the initial witness + program to prove, so they don't hold any state and are not aware of \"Ethereum state\" essentially",
    "created_at": "2026-02-09T16:49:31.312000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "Yep that makes sense but it looked like transport was a pretty considerable overhead from the benchmarks.",
    "created_at": "2026-02-09T16:51:05.727000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "I 'd like to see if ipc improves things",
    "created_at": "2026-02-09T16:51:17.504000+00:00",
    "attachments": []
  },
  {
    "author": "kevaundray",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "Ah okay I see -- might be good to know exactly what is taking up the majority of the time",
    "created_at": "2026-02-09T16:52:10.685000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "http is likely a significant overhead",
    "created_at": "2026-02-09T16:52:26.573000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "ipc will improve it somewhat",
    "created_at": "2026-02-09T16:52:32.741000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "serialization format reduces data size",
    "created_at": "2026-02-09T16:52:46.021000+00:00",
    "attachments": []
  },
  {
    "author": "kevaundray",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "I also wonder how compressible it is on average",
    "created_at": "2026-02-09T16:52:50.001000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "good point, regarding compression.",
    "created_at": "2026-02-09T16:53:24.820000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "<@944007601400741989> was this benchmark performed on localhost?",
    "created_at": "2026-02-09T16:54:39.288000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "i.e. both services on the same machine?",
    "created_at": "2026-02-09T16:54:57.747000+00:00",
    "attachments": []
  },
  {
    "author": "kevaundray",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "This would make sense -- it would be good to get the exact measurements so I can extrapolate to what it means in terms of isolated components (haven't checked out the code, so I may just be being overly cautious)\n\nFor example, for the JSON part, I'm extrapolating that these benchmarks are saying that it takes 2 seconds to json serialize a 500MB payload",
    "created_at": "2026-02-09T16:57:44.767000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "yep that was my interpretation and then 4.6 seconds to transfer over the wire",
    "created_at": "2026-02-09T16:58:39.837000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "but 4.6 seconds seems very high for 500mb of data",
    "created_at": "2026-02-09T16:58:54.992000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "I wonder if JSON serialisation is bloating the size",
    "created_at": "2026-02-09T16:59:43.189000+00:00",
    "attachments": []
  },
  {
    "author": "developeruche",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "yeah... local host, same machine",
    "created_at": "2026-02-09T16:59:44.921000+00:00",
    "attachments": []
  },
  {
    "author": "taulepton_",
    "category": "Cross-layer",
    "parent": "l1-zkevm-protocol",
    "content": "<@944007601400741989> would you be able to report on the size of the json serialized witness please?",
    "created_at": "2026-02-09T17:02:15.888000+00:00",
    "attachments": []
  }
]
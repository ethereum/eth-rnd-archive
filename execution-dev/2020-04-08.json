[
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "What are people's general feelings of adding built-in functions for things that all nodes already have the code for, but isn't exposed to EVM?",
        "created_at": "2020-04-08T04:55:50.089000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "For example, RLP encoding or merkle-patritia proof validating.",
        "created_at": "2020-04-08T04:56:16.897000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Every client already has code to do both of these things, but if you want to do either in EVM the gas costs are incredibly high relative to the actual cost (especially since all clients likely have both heavily optimized).",
        "created_at": "2020-04-08T04:57:13.882000+00:00",
        "attachments": []
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003ctkstanczak\u003e generally we were discussing the previous cases as problematic ss they constrained wider changes, restricted ability to mutate via forks, etc.",
        "created_at": "2020-04-08T04:57:15.437000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "@tkstanczak Hmm, how would an RLP built-in constrain wider changes?",
        "created_at": "2020-04-08T04:58:16.584000+00:00",
        "attachments": []
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003ctkstanczak\u003e also the assumptions about optimizations within clients always restrict the ability of new entrants to support EVM",
        "created_at": "2020-04-08T04:58:18.620000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I would be fine with using non-optimized gas cost for the built-in, but I suspect it would be an order of magnitude cheaper than writing the code in EVM.",
        "created_at": "2020-04-08T04:59:01.123000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Virtualization is expensive.",
        "created_at": "2020-04-08T04:59:09.715000+00:00",
        "attachments": []
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003ctkstanczak\u003e @micah, the biggest of plammed changes suggest trie structure modifications and serialization format changes - adding them to EVM would set them in stone",
        "created_at": "2020-04-08T04:59:19.044000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Eh, such changes will break any contracts that do Ethereum merkle proof validation anyway.",
        "created_at": "2020-04-08T05:00:25.731000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Whether there is a built-in or not, you *will* break some people by changing the merkle-patritia tree structure.",
        "created_at": "2020-04-08T05:00:50.301000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "What about RLP encoding/decoding?  Is there an argument against such a primitive?",
        "created_at": "2020-04-08T05:01:26.592000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I suppose the biggest issue with that one may just be figuring out how to design it since Solidity doesn't have a great way of expressing a tree structure.  I'm more curious about the general feelings though, not these specific examples (though these specific examples are what lead me down this path).",
        "created_at": "2020-04-08T05:02:59.078000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "general",
        "parent": "",
        "content": "I've seen some pretty efficient RLP implementations over EVM. On the same note, one could argue ABI encoding should be a precompile too..",
        "created_at": "2020-04-08T14:48:01.965000+00:00",
        "attachments": []
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cjadler\u003e Not necessarily. You could have a precompile that takes in a byte array that corresponds to a Merkle proof against the Ethereum state. Then the precompile would just verify if the Merkle proof is valid based on the rules at the current block height. You'd only need to change the frontend code that passes in the Merkle proof, whose format could change. This is in fact way more resilient than hard coding things into contracts. It allows contracts to make use of these features (stateless proofs against Ethereum block hashes) and keep up with changes to the underlying data structures without changing the contracts themselves. (re @tkstanczak: @micah, the biggest of plammed changes suggest trie structure modifications and serialization format changes - adding them to EVM would set them in stone)",
        "created_at": "2020-04-08T16:11:27.525000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "A built-in for ABI encoding/decoding would be nice as well, though in that case I don't think clients necessarily have code to do that, so having a precompile for that would potentially be significantly more work for client devs (especially authors of new clients).",
        "created_at": "2020-04-08T16:43:16.986000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The reason I was asking about RLP/Merkle/Patritia Proof Validation is because it is a *requirement* for all clients to have code that handles them.  You cannot build an Ethereum client without implementing those things.",
        "created_at": "2020-04-08T16:44:06.949000+00:00",
        "attachments": []
    },
    {
        "author": "s1na",
        "category": "general",
        "parent": "",
        "content": "Also want to bring up a precompile which runs evm bytecode",
        "created_at": "2020-04-08T16:44:31.789000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "There are certainly a bunch of things that could be built-ins, including a lot of primitives for various data structures and whatnot.  However, each built-in like that potentially requires additional work on client devs beyond just pointing a built-in at some code they already have.",
        "created_at": "2020-04-08T16:44:53.154000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "\u003c@259648573401071617\u003e You mean like an `eval(...)` function?",
        "created_at": "2020-04-08T16:45:05.538000+00:00",
        "attachments": []
    },
    {
        "author": "s1na",
        "category": "general",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e yeah",
        "created_at": "2020-04-08T16:45:20.299000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Someone wrote an EVM in EVM bytecode.  ðŸ˜„",
        "created_at": "2020-04-08T16:45:24.137000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The EEVMVM or something.",
        "created_at": "2020-04-08T16:45:26.597000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "My *gut* tells me that even though clients already have an EVM implementation, that one in particular would be a bit trickier than others in the same situation?",
        "created_at": "2020-04-08T16:46:16.485000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Maybe I'm wrong, but it *feels* like that won't necessarily go smoothly...",
        "created_at": "2020-04-08T16:46:30.185000+00:00",
        "attachments": []
    },
    {
        "author": "s1na",
        "category": "general",
        "parent": "",
        "content": "I guess it'd depend how coupled the tx processing logic is to the actual bytecode interpretation in the client",
        "created_at": "2020-04-08T16:47:33.905000+00:00",
        "attachments": []
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003calexberegszaszi\u003e This was proposed as part of the PURE_CALL discussions in 2016 (re @eth1x_bridge_bot: \u003cs1na\u003e Also want to bring up a precompile which runs evm bytecode)",
        "created_at": "2020-04-08T16:51:28.126000+00:00",
        "attachments": []
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003calexberegszaszi\u003e The main challenge is to support para-virtualization, e.g. allow trapping on certain opcodes, so the caller can implement custom logic for them (ie. state access functions). The old discussions didn't consider that so they were less useful and restricted to non-state accessing snippets.",
        "created_at": "2020-04-08T16:54:27.410000+00:00",
        "attachments": []
    }
]
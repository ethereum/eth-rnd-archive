[
    {
        "author": "jwasinger",
        "category": "general",
        "parent": "",
        "content": "Geth/Besu/Reth use libsecp256k1 for the underlying implementation.  I looked into Nethermind but couldn't see what they are using.\n\nGiven that this precompile has existed on the network since genesis (?), sees a lot of use, has a simple gas schedule, and a battle-hardened multi-platform-optimized impl, I think it's fine to use as a baseline.  There's also precedent for using it as a performance baseline for justifying repricing (e.g. https://eips.ethereum.org/EIPS/eip-2565).",
        "created_at": "2024-09-23T07:18:17.681000+00:00",
        "attachments": []
    },
    {
        "author": "karalabe",
        "category": "general",
        "parent": "",
        "content": "That doesn't repro any difference for us",
        "created_at": "2024-09-23T07:30:53.506000+00:00",
        "attachments": []
    },
    {
        "author": "karalabe",
        "category": "general",
        "parent": "",
        "content": "I don't see why the 3 node example would show any interesting scenario. Basically all of it must be part of the witness, independent in which order you apply the deletes",
        "created_at": "2024-09-23T07:32:03.276000+00:00",
        "attachments": []
    },
    {
        "author": "karalabe",
        "category": "general",
        "parent": "",
        "content": "https://gist.github.com/karalabe/1dc2918b80fae996add5379f4887a1e2",
        "created_at": "2024-09-23T07:34:30.068000+00:00",
        "attachments": []
    },
    {
        "author": "karalabe",
        "category": "general",
        "parent": "",
        "content": "This is the repro I tried to create, it creates a state with 3 storage slots; and in one tx nukes them out, collectig the witness.",
        "created_at": "2024-09-23T07:35:01.541000+00:00",
        "attachments": []
    },
    {
        "author": "karalabe",
        "category": "general",
        "parent": "",
        "content": "The witness content is the same, independent of deletion iteration order",
        "created_at": "2024-09-23T07:35:10.818000+00:00",
        "attachments": []
    },
    {
        "author": "karalabe",
        "category": "general",
        "parent": "",
        "content": "So I guess there's something still that your repro case does?",
        "created_at": "2024-09-23T07:35:23.859000+00:00",
        "attachments": []
    },
    {
        "author": "jwasinger",
        "category": "general",
        "parent": "",
        "content": "Is there an agreed benchmark machine we",
        "created_at": "2024-09-23T07:47:42.368000+00:00",
        "attachments": []
    },
    {
        "author": "marekm3498",
        "category": "general",
        "parent": "",
        "content": "We (Nethermind) use the same library ðŸ˜‰",
        "created_at": "2024-09-23T10:43:54.496000+00:00",
        "attachments": []
    },
    {
        "author": "clab.by",
        "category": "general",
        "parent": "",
        "content": "Gotcha - I'll take a second look this afternoon, could be an issue on my end. This is the portion I was referring to: https://github.com/ethereum/go-ethereum/blob/564b6161637fe7e7c28e7c10a1f1978a22861bd2/trie/trie.go#L520-L523\n\nHere, if you delete children out of a branch in a different order, wouldn't you reveal a different node depending on the last child in the branch (and therefore add a different preimage to the witness)?",
        "created_at": "2024-09-23T14:13:23.864000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "general",
        "parent": "",
        "content": "libsecp256k1 is also the library that bitcoin core uses, fwiw.",
        "created_at": "2024-09-23T15:21:45.449000+00:00",
        "attachments": []
    }
]
[
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cjadler\u003e Re: commitment to state access list in header.",
        "created_at": "2020-03-23T00:45:36.009000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "assuming a merkle tree, how do we define a canonical witness other than it being complete and validating to the correct hash root?\n\nand without zkp tricks, I'm assuming completeness can only ascertained through the processing the of the block",
        "created_at": "2020-03-23T01:55:21.402000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "general",
        "parent": "",
        "content": "You can build a proper witness from the access list, so if you have a \"canonical access list\" you should be able to always derive the canonical witness from it",
        "created_at": "2020-03-23T01:58:17.075000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "general",
        "parent": "",
        "content": "In fact, I think that the access list is indeed more valuable since it unambiguously contains exact information like access to non existent accounts. A witness doesn't let you work backwards to the access list.",
        "created_at": "2020-03-23T01:59:27.554000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "general",
        "parent": "",
        "content": "In a witness you don't really know whether an account that is included was actually accessed or just there to satisfy the proof.",
        "created_at": "2020-03-23T02:00:41.245000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "general",
        "parent": "",
        "content": "Oooh, and we could include a hash to the access list in the header today without any dependencies on other roadmap items",
        "created_at": "2020-03-23T02:01:24.740000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "Is this the scheme:\nembed state root and hash of access list in the block header (pow/signed)\n\nprovide both access list and witnesses with the block. can verify access list against access hash, can verifiy that witnesses are correct wrt state root, and can verify that the witness only contains data about the access list",
        "created_at": "2020-03-23T02:03:27.668000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "general",
        "parent": "",
        "content": "Hrm, having to bundle both of them with the block isn't an ideal situation given that we have been working under the assumption that the network likely can't support those bandwidth requirements",
        "created_at": "2020-03-23T02:05:38.330000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "general",
        "parent": "",
        "content": "Given a header with a hash to the access list, the block and a witness, clients can just keep track of access during execution and then verify the witness was well formed after execution (and that the access list was accurate)",
        "created_at": "2020-03-23T02:07:15.350000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "general",
        "parent": "",
        "content": "which is the same dilemma as just having the witness hash, right? You can't verify the witness correctness (or completeness, or bloatedness) until you execute the block",
        "created_at": "2020-03-23T02:09:01.063000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "general",
        "parent": "",
        "content": "Correct. Seems we need to validate the idea that access lists are valuable for some known or projected use case and just focus on the witness of there aren't any compelling reasons to try and preserve access lists in the protocol. Alternatively, just accept two new header fields.",
        "created_at": "2020-03-23T02:35:08.052000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cSouptacular\u003e Yo! The bridge went down a few times the past few hours. Messages may have been missed.",
        "created_at": "2020-03-23T03:37:21.502000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "If there is a choice between using commitment to the access list and commitment to the witness, I would chose commitment to the access list. Because witness does often contain more leaves that there are in the access list, to satisfy the deletions with extension nodes. But under such choice, it might make sense to propagate access lists as a separate data packet (or series of packets) - separately from witnesses. Otherwise we would nullify the efforts of splitting witnesses in tiles (parts) to speed up relay. If we had to get the entire witness to decide whether it is valid, it means we cannot relay partial witnesses, and relay will be very slow",
        "created_at": "2020-03-23T13:52:29.315000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Therefore, I am still on the side of embedding canonical witness property into the state root calculation instead of introducing a new hash - but this still needs to be written up and tested",
        "created_at": "2020-03-23T13:53:20.221000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "general",
        "parent": "",
        "content": "\u003e Oooh, and we could include a hash to the access list in the header today without any dependencies on other roadmap items\n\u003c@!364458974906548225\u003e This is exactly what @jadler was suggesting.",
        "created_at": "2020-03-23T14:28:33.117000+00:00",
        "attachments": null
    },
    {
        "author": "s1na",
        "category": "general",
        "parent": "",
        "content": "\u003e witness does often contain more leaves that there are in the access list, to satisfy the deletions with extension nodes\ndoesn't this complicate verifying that the access list agrees with the witness?",
        "created_at": "2020-03-23T14:36:06.004000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "\u003e doesn't this complicate verifying that the access list agrees with the witness?\n\u003c@!259648573401071617\u003e It does. But there is a legitimate reason why witnesses contain this information. It is not like it has been designed to make access lists more complicated üôÇ",
        "created_at": "2020-03-23T14:37:21.775000+00:00",
        "attachments": null
    },
    {
        "author": "s1na",
        "category": "general",
        "parent": "",
        "content": "Yeah no I understand why witnesses contain this information. Just saying having both access lists and witness introduces some complications because they might diverge",
        "created_at": "2020-03-23T14:38:09.702000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "yes, that is why I think we really need to understand better why access list commitment needs to be in the header. At the moment it is just an idea",
        "created_at": "2020-03-23T14:40:31.271000+00:00",
        "attachments": null
    },
    {
        "author": "pauld.9606",
        "category": "general",
        "parent": "",
        "content": "Another possibility is to commit to leaf data. This allows executing the block while waiting for the witness to stream in.",
        "created_at": "2020-03-23T15:23:10.783000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "general",
        "parent": "",
        "content": "During the last weeks in the Ewasm team we were evaluating a lot of different potential avenues within Eth1x and Eth2.0. The design space in Eth2.0 Phase2 is enormous. One potential way to shrink that design space is Eth1x64. We want to take ‚Äústateless ethereum‚Äù and see which further (least invasive) changes are needed for the EVM to be suited for a sharded system. The outcome of this can be used in Phase 1.5 and Phase 2. It is definitely not proposed to be taken up as part of Eth1x! However, any feedback from this group would be appreciated. The short write up is here: https://notes.ethereum.org/abieJueHTbCB6IrabqF9jQ\n\nAlso as mentioned during the summit, our team is also very interested in other EVM changes, gas pricing, code merklization (and the broader witness size question) and witness metering and hoping to participate/contribute to those topics.",
        "created_at": "2020-03-23T15:29:44.528000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "general",
        "parent": "",
        "content": "\u003c@!425279588009246720\u003e I ‚ù§Ô∏è this.  It seems like best case, we learn that EVM as the execution layer across all the shards is viable and have a path forward which is already familiar and well understood.  *\"worst\"* case it proves non-viable but we learn about what is needed for cross-shard-stuff within a context (the EVM) that reduces the number of unknown things.",
        "created_at": "2020-03-23T17:07:34.053000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "\u003e If we had to get the entire witness to decide whether it is valid, it means we cannot relay partial witnesses, and relay will be very slow\n\u003c@456226577798135808\u003e \n\nbut if we do a blockchain of witness chunks it would solve that\n\nsay if we build from top to bottom, then the witness chunk for the trie root should contain some hash for the next chunk, etc. and the trie root chunk hash can be validated versus some canonical witness hash in the block",
        "created_at": "2020-03-23T19:10:07.300000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "then if you receive the first chunk you can see if it is valid and canon by checking the root hash and the witness hash, and they you are sure that the next chunk's hash is valid too, etc",
        "created_at": "2020-03-23T19:10:43.926000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "but that will add a hash per chunk to the witness size, of course",
        "created_at": "2020-03-23T19:11:08.862000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "general",
        "parent": "",
        "content": "Maybe the witness hash would be a merkle hash of the witness chunks, and each chunk contains a proof that it's part of the overall canonical witness?",
        "created_at": "2020-03-23T19:12:51.817000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "won't it take more space?",
        "created_at": "2020-03-23T19:13:40.723000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "so far we always need the full witness to run the blocks, so having a merkle tree from the start might be an overkill",
        "created_at": "2020-03-23T19:15:04.692000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "general",
        "parent": "",
        "content": "Maybe, but that might be acceptable to gain the property that we can prove a partial witness is a proper subset of the canonical witness as referenced by a hash in the header.",
        "created_at": "2020-03-23T19:15:22.168000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "general",
        "parent": "",
        "content": "also, the mini proof for the witness chunk could be quite small depending on how we construct things.",
        "created_at": "2020-03-23T19:16:01.774000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "might be, our format already allows simple chunking and the ability to check root hashes (which tells nothing about the trie having just enough information to run the block)",
        "created_at": "2020-03-23T19:20:50.932000+00:00",
        "attachments": null
    },
    {
        "author": "mandrigin",
        "category": "general",
        "parent": "",
        "content": "adding some kind of hashing there + the block header will make it possible to be sure that that is a canon. witness",
        "created_at": "2020-03-23T19:21:24.474000+00:00",
        "attachments": null
    }
]
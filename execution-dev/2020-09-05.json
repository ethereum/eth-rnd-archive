[
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cjadler\u003e Okay, so to conclude the discussion on refunds for storage clearing:\n1) Storing the gas price with which a storage slot is set is trivial to do and is at most one word per slot. Note that it should be easy to compress the gas price values in the working representation. I would estimate something like 1 byte per slot. This idea should not be dismissed until measurements are ran, because it's \"measure twice, cut once,\" not \"metric gas based on gut feelings and one guy's laptop\" (the latter would be crazy, no way anyone would do that!)\n2) In line with \"measure twice, cut once,\" the conclusion is categorically not to remove refunds and selfdestruct. If gastoken isn't actually being used much, then going after refunds isn't a solution. Measurements are needed.\n3) The obvious answer isn't removing refunds, or capping refunds at 100% of the gas used. It's actually to uncap refunds! The easiest way to do this without complex state rent is as follows: SSTORE costs X gas. C is paid as a fee to the miner and X-C is locked. When clearing the slot, X-C is refunded at the gas price the slow was set at. Uncapping refunds means that it's possible for miners to get paid to include their own transactions that clear state.",
        "created_at": "2020-09-05T01:16:26.161000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "\u003e 1) Storing the gas price with which a storage slot is set is trivial to do and is at most one word per slot. Note that it should be easy to compress the gas price values in the working representation. I would estimate something like 1 byte per slot. This idea should not be dismissed until measurements are ran, because it's \"measure twice, cut once,\" not \"metric gas based on gut feelings and one guy's laptop\" (the latter would be crazy, no way anyone would do that!)\nDo we believe that all of the clients *can* effectively store a single extra byte with a storage slot?  I don't know how they all have the datastructures setup, so that *may* not be trivial.",
        "created_at": "2020-09-05T02:45:16.186000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I think part of the argument re: gas refunds is that they are complexity in the EVM and they are not serving their intended purpose.  By just flat removing them, we simplify Ethereum client implementations, reduce complexity (which makes it easier to add new features), and the \"cost\" is that we lose a feature that wasn't doing what it was designed to do.",
        "created_at": "2020-09-05T02:47:28.330000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "For example, 2711 may end up having to drop one of its features because \"gas refunds and self destructs make it complicated\".  If we could drop self destructs and gas refunds, then that feature now becomes *much* easier to add, and it is a feature that is (hopefully) actually useful, unlike self destructs and gas refunds.",
        "created_at": "2020-09-05T02:48:45.277000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cjadler\u003e This is orthogonal to eliminating \"gastoken spam,\" but I agree that it's a good reason to remove refunds and selfdestruct! (re @eth1x_bridge_bot: \u003cMicah\u003e I think part of the argument re: gas refunds is that they are complexity in the EVM and they are not serving their intended purpose.  By just flat removing them, we simplify Ethereum client implementations, reduce complexity (which makes it easier to add new features), and the \"cost\" is that we lose a feature that wasn't doing what it was designed to do.)",
        "created_at": "2020-09-05T03:27:43.567000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Yeah, removing refunds and self destruct have multiple benefits.  They can greatly reduce complexity of client implementations (I have heard that these features are some of the worst in terms of client complexity), and their removal may also give us some minor relief to gas prices and general \"demand\".",
        "created_at": "2020-09-05T03:30:17.480000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cGuthL\u003e If refund gets removed, what would be the incentive to remove state for dApps dev?",
        "created_at": "2020-09-05T14:11:04.689000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "there will be no incentive. But most don't remove it anyway ðŸ™‚",
        "created_at": "2020-09-05T14:25:05.190000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cGuthL\u003e At 20$ a store, and 10$ a refund, refund is attractive",
        "created_at": "2020-09-05T14:38:14.206000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cGuthL\u003e (cost at 400gwei from the top of my mind)",
        "created_at": "2020-09-05T14:39:31.565000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "it is not like that, if you burn some GasToken or CHI within your transaction, they you can get up to 50% of the fees of your tx refunded",
        "created_at": "2020-09-05T14:39:37.053000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "so I was going to actually see what is the most popular way of doing that",
        "created_at": "2020-09-05T14:40:20.218000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cGuthL\u003e I know ðŸ™‚ I meant it in the context of StarkEx where we have a lot to expense out when we free storage. But I can understand that's not a common use case",
        "created_at": "2020-09-05T17:33:19.628000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "I became convinced over the last year and half (since starting to research State Rent) that there might be no good mechanism to clear out the storage other than for the protocol to do it forcibly (via eviction). But these rules can only be instituted if we introduced a new type of storage, which is perhaps much more efficient, but is subject to eviction",
        "created_at": "2020-09-05T17:40:31.205000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "and I think there is a demand for that",
        "created_at": "2020-09-05T17:41:05.544000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "my early idea was called \"Linear cross contract storage\", and it can be found on the pages 39-44 of this: https://github.com/ledgerwatch/eth_state/blob/master/State_rent.pdf",
        "created_at": "2020-09-05T21:23:09.388000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "but my main issue with that was that I could not find a good way of merklesing it",
        "created_at": "2020-09-05T21:24:03.611000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "perhaps it should not have been merklesed, but have some polynomial commitment on it",
        "created_at": "2020-09-05T21:24:45.783000+00:00",
        "attachments": null
    },
    {
        "author": "0xalizk",
        "category": "general",
        "parent": "",
        "content": "`SELFDESTRUCT` within a `CREATE2` phantom tx will still be allowed right?",
        "created_at": "2020-09-05T22:16:56.907000+00:00",
        "attachments": null
    }
]
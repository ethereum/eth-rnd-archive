[
    {
        "author": "spingel",
        "category": "general",
        "parent": "",
        "content": "I've notices some potential issues that Besu has with peering with Geth nodes.\nI've had a look at a few of our (Besu team) mainnet nodes and noticed that we do have a lot of Geth peers that have the following name in their peer info: Geth/v1.1.8-859186f2/linux-amd64/go1.16.13. Googling this version it looks like this is from 2020, but is not an official release. And if it is that old it should not be able to follow the chain after cancun. But they seem to be following fine!\nI can see that we have a few Geth peers that advertise Geth/v1.13.13 and v1.13.14, which are recent releases.\nOne of our nodes was connected to 13 Geth 1.1.8 nodes, but only 2 Geth 1.13.13 or 1.13.14 nodes. And a few other nodes that I checked looked similar.\nDoes anyone see similar problems or has any ideas what is happening? And what is the story with the old 1.1.8. Geth version?",
        "created_at": "2024-03-26T07:30:39.539000+00:00",
        "attachments": []
    },
    {
        "author": "spingel",
        "category": "general",
        "parent": "",
        "content": "Now I checked a few Besu nodes on Holesky, and Besu is not connecting to any Geth 1.1.8 peers, but they only connect to very few Geth 1.13.13 peers (2 to 3), most of the peers being Nethermind peers. One node had 17 Nethermind peers. \nHas anything lately changed in the area of peering for Geth nodes?  That does not look right. \nHas anyone else noticed problems with peering with Geth nodes?",
        "created_at": "2024-03-26T07:48:12.790000+00:00",
        "attachments": []
    },
    {
        "author": "0x2e",
        "category": "general",
        "parent": "",
        "content": "Maybe I'm seeing this wrong but `859186f2` seems to trace back to a [commit from a geth fork for bsc](\u003chttps://github.com/bnb-chain/bsc/commit/859186f299fa94fada3e92608db1392be1a45599\u003e)? I don't see how those nodes would be relevant in an ethereum mainnet environment to begin with, as the chainid should be different (56 instead of 1)?",
        "created_at": "2024-03-26T08:15:49.854000+00:00",
        "attachments": []
    },
    {
        "author": ".fjl",
        "category": "general",
        "parent": "",
        "content": "maybe someone is running bsc geth on mainnet?",
        "created_at": "2024-03-26T10:45:21.743000+00:00",
        "attachments": []
    },
    {
        "author": ".fjl",
        "category": "general",
        "parent": "",
        "content": "depending on how they structured their bsc patches, this might actually be possible",
        "created_at": "2024-03-26T10:45:45.305000+00:00",
        "attachments": []
    },
    {
        "author": ".fjl",
        "category": "general",
        "parent": "",
        "content": "we have also investigated this a bit yesterday",
        "created_at": "2024-03-26T10:46:15.553000+00:00",
        "attachments": []
    },
    {
        "author": ".fjl",
        "category": "general",
        "parent": "",
        "content": "no changes have been made to the p2p stack recently",
        "created_at": "2024-03-26T10:46:29.052000+00:00",
        "attachments": []
    },
    {
        "author": ".fjl",
        "category": "general",
        "parent": "",
        "content": "\u003c@725491180837666866\u003e if possible, please collect some message exchanges with these nodes so we can see how they actually behave",
        "created_at": "2024-03-26T10:47:13.720000+00:00",
        "attachments": []
    },
    {
        "author": "rjected",
        "category": "general",
        "parent": "",
        "content": "yeah this seems likely",
        "created_at": "2024-03-26T14:02:43.258000+00:00",
        "attachments": []
    },
    {
        "author": "rjected",
        "category": "general",
        "parent": "",
        "content": "we've run into peering failures in the past with forked geth nodes that have unknown commit hashes",
        "created_at": "2024-03-26T14:03:41.184000+00:00",
        "attachments": []
    },
    {
        "author": "rjected",
        "category": "general",
        "parent": "",
        "content": "not a cause for concern on our end really",
        "created_at": "2024-03-26T14:04:00.616000+00:00",
        "attachments": []
    },
    {
        "author": "rjected",
        "category": "general",
        "parent": "",
        "content": "recording hello and/or status messages is usually helpful",
        "created_at": "2024-03-26T14:04:30.583000+00:00",
        "attachments": []
    },
    {
        "author": "0x2e",
        "category": "general",
        "parent": "",
        "content": "even then the commit is still 2 years old - an execution client that old wouldn't function anymore with blobs and everything being a thing nowadays. tho the client identifier can simply be fake so it might be something completely different behind that, i guess",
        "created_at": "2024-03-26T14:33:40.957000+00:00",
        "attachments": []
    },
    {
        "author": ".fjl",
        "category": "general",
        "parent": "",
        "content": "yeah, the commit is wrong",
        "created_at": "2024-03-26T14:49:25.741000+00:00",
        "attachments": []
    },
    {
        "author": ".fjl",
        "category": "general",
        "parent": "",
        "content": "I think it's an attack, but not yet sure what the goal of the attack actually is",
        "created_at": "2024-03-26T14:49:40.193000+00:00",
        "attachments": []
    },
    {
        "author": ".fjl",
        "category": "general",
        "parent": "",
        "content": "It could be an attack on Geth peer discovery, which would manifest itself as Geth not connecting to other nodes as much",
        "created_at": "2024-03-26T14:50:46.860000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "I have a new question regarding AUTH/AUTHCALL. It specifies that if the gas sent to the subcall is invalid, then the frame will throw. However don't we have Chainstart-like situations now where we send a specific gas limit, but if the gas costs of this opcode get increased then this is now invalid? (So at a fork if we make the gas cost higher, then now suddenly contracts might fail?) Or should I interpret this as: you either send a certain portion of gas, or you send all gas (so gas is `0` on stack)",
        "created_at": "2024-03-26T17:16:41.412000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "I also have a question about EIP 7002. The contract is supposedly already deployed before the fork. So what happens if I invoke the contract before the fork?",
        "created_at": "2024-03-26T18:15:45.210000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "It seems to me that during a block, one can flood the exits (the price stays the same), is this correct and intended? Or should the price dynamically update? ðŸ¤”",
        "created_at": "2024-03-26T18:30:27+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "Ah wait they are only inserted in the block, not processed (although the price stays the same)",
        "created_at": "2024-03-26T18:33:11.074000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "So there's still the max",
        "created_at": "2024-03-26T18:33:16.797000+00:00",
        "attachments": []
    },
    {
        "author": "lucassaldanhaconsensys",
        "category": "general",
        "parent": "",
        "content": "Take everything I say here with a grain of salt as I have been away from EL world for a while (have been working on Teku - CL).\n\nFor the tx creating an exit, I believe it will behave in the same way as sending a tx to a random address/empty address. IIRC the transaction will succeed but ofc the user won't get their exit.\n\nFor the system call,  I believe the mechanism we are going to use for 7002 seems to be similar to the one used on 4788.\n\nIn 4788, there is a mention to when the contract does not exits at the address:\n\u003e if no code exists at BEACON_ROOTS_ADDRESS, the call must fail silently",
        "created_at": "2024-03-26T22:29:38.123000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "Right, but the problem is (see latest spec) you can still fill the exit queue, but the system txs will not be created (until at the fork) and that is the point where the exit queue starts to go empty ðŸ¤” Also, the blocks will not get filled with this exit Trie data, so CLs will likely not been able to process it? ðŸ¤”",
        "created_at": "2024-03-26T22:33:53.968000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "(Unless we can indefinitely fill the queue (this will raise the cost by a lot), and then system txs / the fork starts to clear it out ðŸ¤” )",
        "created_at": "2024-03-26T22:36:45.676000+00:00",
        "attachments": []
    },
    {
        "author": "lucassaldanhaconsensys",
        "category": "general",
        "parent": "",
        "content": "Let me see if I understand what you are raising here. You are saying that between the Validator Exit Contract deployment and Prague activation, users could send txs to the contract triggering `trigger_exit` and adding exits to the queue. But these won't be ever pop'd from the queue because we aren't in prague yet.",
        "created_at": "2024-03-26T22:40:18.243000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "Yes",
        "created_at": "2024-03-26T22:40:39.382000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "The EIP just got an update, we now have bytecode at the contract",
        "created_at": "2024-03-26T22:40:44.998000+00:00",
        "attachments": []
    },
    {
        "author": "lucassaldanhaconsensys",
        "category": "general",
        "parent": "",
        "content": "My understanding is that from the moment the contract is deployed, users can start queueing their exits, but they won't be processed until Prague. I believe this is by design?",
        "created_at": "2024-03-26T22:43:53.708000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "I am not sure, but I just checked and the gas price does not rise",
        "created_at": "2024-03-26T22:44:18.138000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "It will stay super low, so if this is the idea to make users queue their exits then that should change",
        "created_at": "2024-03-26T22:44:34.040000+00:00",
        "attachments": []
    },
    {
        "author": "lucassaldanhaconsensys",
        "category": "general",
        "parent": "",
        "content": "I see what you mean",
        "created_at": "2024-03-26T22:46:04.024000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "But if we add that it also means one extra SSTORE on each exit (so 5k gas extra for each exit)",
        "created_at": "2024-03-26T22:46:38.784000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "CC \u003c@543900561460822016\u003e",
        "created_at": "2024-03-26T22:49:54.040000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "general",
        "parent": "",
        "content": "i plan to update the contract so that the fee is like max uint, so that no one will be able to submit before the fork",
        "created_at": "2024-03-26T22:52:38.727000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "general",
        "parent": "",
        "content": "Ahhh that works ðŸ˜„",
        "created_at": "2024-03-26T22:52:54.361000+00:00",
        "attachments": []
    },
    {
        "author": "atris.",
        "category": "general",
        "parent": "",
        "content": "hey, anyone have an optimism-goerli node that I could peer off-of? I'm testing my fork of op-reth that supports goerli and mainnet (incl. pre-bedrock state), but can't find any peers.",
        "created_at": "2024-03-26T23:44:48.352000+00:00",
        "attachments": []
    }
]
[
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "Does anyone have some context around this comment? https://github.com/ethereum/EIPs/pull/2583#discussion_r402940625 - I would like to know some more about that idea",
        "created_at": "2020-04-04T10:39:52.326000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "it has been something that I proposed, but have not made a detailed write up about. This is an old idea of introducing the second gas counter. You can call one of the gas, another - oil, for example. At the start of a transaction, both gas and oil counter start with the same number. There are now 2 schedules - one for gas cost, another - for oil cost. As we introduce new charges for things, we keep gas schedule intact, but we change the oil schedule. Then there is out-of-oil exception as well as out-of-gas exception. One of the properties of oil which is different from gas is that it always only have one pool, it never gets split up and \"forwarded\" (by CALL instructions)",
        "created_at": "2020-04-04T11:26:12.824000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "I don't remember who proposed the \"oil\" term, probably \u003c@!393833580033474560\u003e but when I use it, it becomes much easier to explain. Mainly because I don't need to say \"gas 1\" and \"gas 2\", and \"schedule 1\", \"schedule 2\"",
        "created_at": "2020-04-04T11:36:05.601000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cgichiba\u003e Yeah and the whole thing then can be called \"2-stroke\"! Because 2 stroke engines (chain saws, dirt bikes and weed-whackers) use a gas/oil mix",
        "created_at": "2020-04-04T11:48:58.481000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "Hm. I can't say the \"oil\" metaphor makes it any clearer for me.. ðŸ™‚ . As an alternative to my proposed EIP,  \u003c@!206016661470314496\u003e and I discussed something similar, or, at least I think it's somewhat similar:\n\n- We have a global 'penalty' counter. It's at zero from the start. \n- Whenever a penalized state access is made, we bump it with `N` (let's say 2K). \n- If, at any point during the transasction, the `gas` goes below `penalty`, then the transaction (the full outer one) exits with error (all sideeffects reverted). \n- After tx has completed, the `gas` is deducted with `penalty`. \n\nThe upside with that scheme would be that we remove the 'bypass' to 2583-penalty scheme which currently puts a ceiling on the effectiveness of a penalty at around ~800. The drawback would be previously, a  `CALL`,  could only burn whatever gas was given it. With this global-counter scheme, it can increase the `penalty` and cause global abort. \n\nAnother variant would be:\n\n- We have a global 'penalty' counter. It's at zero from the start. \n- Whenever a penalized state access is made, the `2K` is deducted from `gas`. If gas cannot cover it, we bump the `penalty` with whatever remains after paying with gas (e.g. `700`) \n- If, at any point during the transasction, the `gas` goes below `penalty`, then the transaction (the full outer one) exits with error (all sideeffects reverted). \n- After tx has completed, the `gas` is deducted with what the penalty counter holds. \n\nThis second scheme means that any inner call can only bump the global counter with at most `penalty` gas.",
        "created_at": "2020-04-04T12:04:28.494000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "I think the oil-scheme above resembles the first variant: where any inner `CALL` can happily burn all the available oil.",
        "created_at": "2020-04-04T12:05:22.612000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "So my penalty could be translated as \"For trie-misses, we charge 2K oil, but otherwise zero oil\"",
        "created_at": "2020-04-04T12:06:46.623000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "The difference might be that in the scheme I and peter discussed, the gas and oil would be reconciliated later on, and not totally separate. You will have to pay the oil with gas later on, and if at some point we notice that you won't be able to cover it, we abort",
        "created_at": "2020-04-04T12:09:04.986000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "I know that \u003c@!273808422753796097\u003e didn't quite like the penalty-idea, because it was (my interpretation) a side step on the path towards statelessness / paying for witnesses. But maybe there's some path forward here which does both these things: \n\n1. Short-term: gives DoS resistance to mainnet trie-access attacks, and\n2. is also a path towards witness metering",
        "created_at": "2020-04-04T12:12:17.795000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e oh I think we should just triple the gas costs for state access regardless of whether or not they're empty",
        "created_at": "2020-04-04T12:13:25.191000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e I just read the comment about the relay attack",
        "created_at": "2020-04-04T12:13:46.629000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e I'm not getting it",
        "created_at": "2020-04-04T12:13:48.813000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e Wouldn't the malicious still have to provide the gas to the relay to pay the penalty cost?",
        "created_at": "2020-04-04T12:14:01.670000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e Aaaaaah or is the idea that the relay would not have enough gas to pay the full penalty",
        "created_at": "2020-04-04T12:14:19.487000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e Right, this is why when I proposed a gas cost for accessing contracts based on size, my proposal was to make it be in the form of a higher ahead-of-time gas cost, plus a refund whenever the penalty is not hit",
        "created_at": "2020-04-04T12:14:49.468000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e Basically, I think that if we are willing to break the invariant that a child call has a strictly bounded amount of resources that it can consume, and untrusted children can't impose extra costs on the parent",
        "created_at": "2020-04-04T12:15:43.957000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e Then we should just simplify the whole thing by getting rid of the illusion that different call frames have different gas, and make gas a tx-level thing",
        "created_at": "2020-04-04T12:16:03.485000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e But I think that the invariant that a child call has a strictly bounded amount of resources that it can consume is valuable, and we should try to preserve it somehow (and I had two suggestions for how to do this in a way compatible with us mucking around with gas costs later)",
        "created_at": "2020-04-04T12:16:40.372000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e but this is getting into 1.x UNGAS discussion land",
        "created_at": "2020-04-04T12:16:47.162000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "In my second scheme above, the invariant would not be completely thrown out the window, just mildly bent. The bound would be 'desired-bound+N' where N has an upper bound",
        "created_at": "2020-04-04T12:35:59.763000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e wait but if you have an upper bound then wouldn't a dos attacker just go above that bound?",
        "created_at": "2020-04-04T12:38:22.126000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "The upper bound would be e.g the 2K of the penalty. So if I give a subcall 1 gas, then it can bump the global counter by 1999 (after burning it's own gas)",
        "created_at": "2020-04-04T12:39:54.662000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "But it would also exit on OOG",
        "created_at": "2020-04-04T12:40:14.687000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e aaah I see",
        "created_at": "2020-04-04T12:42:45.855000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e right",
        "created_at": "2020-04-04T12:42:46.988000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e so the parent would be liable for the child's debt up to a maximum of whatever the penalty is",
        "created_at": "2020-04-04T12:43:07.976000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e We canâ€™t connect to the server at www.dfohub.eth.link",
        "created_at": "2020-04-04T12:43:57.384000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "Wasn't that just spam?",
        "created_at": "2020-04-04T12:44:12.602000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e the comment above?",
        "created_at": "2020-04-04T12:44:49.939000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "I'm not admin on this discord, can't block/clean spam though :/",
        "created_at": "2020-04-04T12:44:55.439000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e Aaah I guess I was subconsciously assuming this room was limited to only \"approved people\" without realizing it",
        "created_at": "2020-04-04T12:45:28.839000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "Yeah.. the gates are wide open :)",
        "created_at": "2020-04-04T12:46:06.394000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "\u003e \u003cvbuterin\u003e so the parent would be liable for the child's debt up to a maximum of whatever the penalty is\n\nAnyway, yes. Well, the global scope, if not the immediate parent",
        "created_at": "2020-04-04T12:48:25.381000+00:00",
        "attachments": null
    },
    {
        "author": "basedtoschi",
        "category": "general",
        "parent": "",
        "content": "\u003c@211091239112671234\u003e sorry wrong chat ðŸ˜‚",
        "created_at": "2020-04-04T13:02:13.394000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e ðŸ˜‚",
        "created_at": "2020-04-04T13:02:25.471000+00:00",
        "attachments": null
    },
    {
        "author": "eth2_gitter_bot",
        "category": "general",
        "parent": "",
        "content": "\u003cvbuterin\u003e no problem",
        "created_at": "2020-04-04T13:02:28.119000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "Ah, no worries \u003c@362898943291555850\u003e !",
        "created_at": "2020-04-04T13:08:40.184000+00:00",
        "attachments": null
    },
    {
        "author": "babarali7238",
        "category": "general",
        "parent": "",
        "content": "\u003c@211091239112671234\u003e\u003c:nethermind:657593276701999106\u003e",
        "created_at": "2020-04-04T14:06:58.358000+00:00",
        "attachments": null
    },
    {
        "author": "babarali7238",
        "category": "general",
        "parent": "",
        "content": "\u003c@599067043790323712\u003e\u003c:nimbus:599245969967808522\u003e",
        "created_at": "2020-04-04T14:08:04.680000+00:00",
        "attachments": null
    }
]
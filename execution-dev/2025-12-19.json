[
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "IIUC, there is the following chain: `A \u003c- B (invalid) \u003c- C \u003c- D`\n1) `CL: FCU(B), EL: {status: INVALID, lvh: A}`\n2) `CL: newPayload(C), EL: SYNCING` as the `B` might have been discarded because it is invalid\n3) `CL: FCU(C) or newPayload(D), EL: {status: INVALID, lvh: A}`",
        "created_at": "2025-12-19T04:14:07.448000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "This is how i see it from the spec perspective, don't want to speculate on the implementations behaviour, but they also can potentially respond `CL: newPayload(C), EL: {status: INVALID, lvh: A}` as they know that `C.parent == B` and `B` is invalid",
        "created_at": "2025-12-19T04:16:06.304000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "general",
        "parent": "",
        "content": "Agree with your description. Looking at the code, I think Besu may actually respond with either SYNCING or INVALID depending on how the parent was invalid ðŸ¥´",
        "created_at": "2025-12-19T04:47:48.548000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "you mean depending on what exact check has failed?",
        "created_at": "2025-12-19T05:20:48.926000+00:00",
        "attachments": null
    },
    {
        "author": "siladu",
        "category": "general",
        "parent": "",
        "content": "yeh it looks like if it's something akin to a 400 like missing/bad request data we don't remember the block, whereas we do if it's invalid during block processing. We could fairly easily fix it to always return invalid I reckon, if it's an issue for CLs. Maybe there's some nuance if the block is technically valid but engine api data isn't ðŸ¤”",
        "created_at": "2025-12-19T05:44:21.988000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Hmm, I was counting with the same spec reading as Misha above and I am moving Prysm to potentially ignore the FCU return from C in some cases, but if the EL will continue returning SYNCING on that chain instead of INVALID, we'd be bricked and being optimistic",
        "created_at": "2025-12-19T10:07:30.712000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "I am confused. There would be no `FCU(C)` if after `INVALID` response to `FCU(B)` prysm invalidated `B`, so you have to ignore `FCU(B)` to be able to ignore `FCU(C)`.",
        "created_at": "2025-12-19T10:13:31.700000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Yes I'm moving to ignore the result of some FCU because we're going to be calling it async",
        "created_at": "2025-12-19T10:28:50.568000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "My understanding is that all ELs today actually reply valid/invalid if they can sync the block on new payload even if it's not canonical.",
        "created_at": "2025-12-19T10:30:44.609000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "In fact I'm not going to ignore it, but it will leave Prysm in a funky place of removing the forkchoice node async",
        "created_at": "2025-12-19T10:32:11.218000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "So I want to know the consequences of having this node even if temporarily",
        "created_at": "2025-12-19T10:32:34.029000+00:00",
        "attachments": null
    }
]
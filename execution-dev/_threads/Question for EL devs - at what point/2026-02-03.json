[
  {
    "author": "cskiraly",
    "category": "general",
    "parent": "execution-dev",
    "content": "<@833706406699073536> <@531934490826768418> continuing on this: you are only calling GetBlobs before FCU, right?",
    "created_at": "2026-02-03T12:26:55.693000+00:00",
    "attachments": []
  },
  {
    "author": "__kasey__",
    "category": "general",
    "parent": "execution-dev",
    "content": "We call getBlobs inside the DA check loop, and we only call FCU when the DA check completes. I guess an edge case could be if a block includes the same commitments as a block we have already included?",
    "created_at": "2026-02-03T15:37:46.408000+00:00",
    "attachments": []
  },
  {
    "author": "cskiraly",
    "category": "general",
    "parent": "execution-dev",
    "content": "Thanks. The edge case might worth checking although it should be critical even if getBlobs fails there.\n\nI've asked for two reasons:\n- on FCU we move to the blob to limbo, and then we don't serve it with the current getBlobs implementation. We could though, if needed.\n- after FCU, i.e. once the tx is on chain, we will not request the transaction, even if we missed it before and we receive an announcement for it. This is a change I'm introducing, and was wondering if it can create issues for you.",
    "created_at": "2026-02-03T15:43:52.071000+00:00",
    "attachments": []
  },
  {
    "author": "__kasey__",
    "category": "general",
    "parent": "execution-dev",
    "content": "What do reorgs look like wrt the second point?",
    "created_at": "2026-02-03T16:09:08.347000+00:00",
    "attachments": []
  },
  {
    "author": "__kasey__",
    "category": "general",
    "parent": "execution-dev",
    "content": "I think that second point means when we give you an FCU that includes blob txs, if you have not seen the blob(s) attached to the tx, you will not try to retrieve it? If that's right, I guess even if you do serve blobs out of limbo, a reorg failure mode could be:\n- First block: We have all data columns. We are able to pass DA check without getBlobs, we call FCU. Blob tx is now on chain from EL pov, blob won't ever be requested.\n- Reorg block: We are having peering issues, we can't get one of the data columns. EL will not give it to us via getBlobs, because EL did not have to download it for the first block, it won't try to get it.\n\nThat said, it should be fine to rely on CL alone to diffuse sidecars, and this seems like an edge case.",
    "created_at": "2026-02-03T16:17:56.479000+00:00",
    "attachments": []
  },
  {
    "author": "cskiraly",
    "category": "general",
    "parent": "execution-dev",
    "content": "after reorg: the tx will not be on chain, so a new announcement will result in a fetch. Old announcements are not cached.",
    "created_at": "2026-02-03T16:19:02.198000+00:00",
    "attachments": []
  },
  {
    "author": "__kasey__",
    "category": "general",
    "parent": "execution-dev",
    "content": "Right but we won't get to the reorg FCU until we pass DA check on CL, which the EL isn't able to help with. So it just means we are 100% reliant on the CL for that blob. It looks like a private tx.",
    "created_at": "2026-02-03T16:19:55.420000+00:00",
    "attachments": []
  },
  {
    "author": "__kasey__",
    "category": "general",
    "parent": "execution-dev",
    "content": "> It looks like a private tx.\n\nIn other words the \"failure more\" here looks like something we already handle. So it doesn't raise a big red flag for me.",
    "created_at": "2026-02-03T16:21:18.376000+00:00",
    "attachments": []
  },
  {
    "author": "cskiraly",
    "category": "general",
    "parent": "execution-dev",
    "content": "For that blob, we are not backfilling it into limbo even if a late announcement, one after FCU, arrives. (We could do it, it is just a bandwidth compromise).",
    "created_at": "2026-02-03T16:21:25.095000+00:00",
    "attachments": []
  },
  {
    "author": "__kasey__",
    "category": "general",
    "parent": "execution-dev",
    "content": "IMO this seems fine.",
    "created_at": "2026-02-03T16:23:51.565000+00:00",
    "attachments": []
  },
  {
    "author": "cskiraly",
    "category": "general",
    "parent": "execution-dev",
    "content": "Thanks. We can refine this later, I just want to make sure it's not creating immediate issues.",
    "created_at": "2026-02-03T16:24:41.871000+00:00",
    "attachments": []
  },
  {
    "author": "cskiraly",
    "category": "general",
    "parent": "execution-dev",
    "content": "Regarding reorg:\n- on the first branch\n  - EL did not have the blob\n  - CL still passed DA, so it had the relevant cells of the blob\n  - EL is not backfilling\n- then there's the reorg. That might move blob txs from the orphaned branch to the new canonical.\n  - The EL might see this as an immediate change, with no chance to download the blob in-between\n  - but the CL already had the relevant cells, so why would it ask for it in getBlobs?",
    "created_at": "2026-02-03T16:42:14.433000+00:00",
    "attachments": []
  },
  {
    "author": "__kasey__",
    "category": "general",
    "parent": "execution-dev",
    "content": "> but the CL already had the relevant cells, so why would it ask for it in getBlobs?\n\nThe sidecars are totally different messages from the CL pov because they reference different blocks. The CL would need to be aware that the commitments are the same. The CL doesn't store/index/cache commitments in that way.",
    "created_at": "2026-02-03T16:59:46.698000+00:00",
    "attachments": []
  },
  {
    "author": "cskiraly",
    "category": "general",
    "parent": "execution-dev",
    "content": "I see. Why not index then them by vhash/columnID ?",
    "created_at": "2026-02-03T18:24:37.054000+00:00",
    "attachments": []
  },
  {
    "author": "__kasey__",
    "category": "general",
    "parent": "execution-dev",
    "content": "We certainly could, but we'd only be doing it for this edge case. Ultimately we should be able to get columns (ideally partial) from the network.",
    "created_at": "2026-02-03T18:34:51.911000+00:00",
    "attachments": []
  },
  {
    "author": "cskiraly",
    "category": "general",
    "parent": "execution-dev",
    "content": "I think I would still use a block->(blobtx->)vhash mapping, and a vhash/columnID indexed store. The mapping is there anyway right in the block. But I agree it's not necessary, just seems nice to me.",
    "created_at": "2026-02-03T18:45:10.581000+00:00",
    "attachments": []
  }
]
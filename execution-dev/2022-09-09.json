[
    {
        "author": "cheerful_piglet_95568",
        "category": "general",
        "parent": "",
        "content": "Hi team, quick question. Currently we run several nodes (with geth/lighthouse) behind a load balancer. We use the age of the latest block that a node has as a criterion for the load balancer health checks. i.e if the age of the latest block on a  node is  \u003e 20mins, load balancer will consider the node unhealthy , not send traffic to it and evict that node. This is to ensure traffic goes to the nodes that are at the tip or close to it. Now, during the actual merge on the 13th/15th, is there any expectation that blocks would not generated for a period of time? If that happens, our ALBs may evict all the nodes from the cluster because the block age on all nodes may exceed the threshold. If it is the case that no blocks may be generated for a period of time, we may have to make some changes to prevent such a situation ..Appreciate the help. thank you",
        "created_at": "2022-09-09T09:37:32.797000+00:00",
        "attachments": null
    },
    {
        "author": "daniellehrner",
        "category": "general",
        "parent": "",
        "content": "No, block production will not stop. The transition is seamless. There will be a terminal PoW block and around 12 seconds later the first PoS block.",
        "created_at": "2022-09-09T09:42:22.507000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Hello, I want to confirm that the notion of safe block for the engine is just opaque, it's just a label that they take from the CL to respond to RPC requests for the safe block. That they don't make any checks like for example check that it's justified. I'm looking into returning something different than the justified block from prysm",
        "created_at": "2022-09-09T09:55:58.028000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "Right, `safe` block is a \"safe\" block pointed out by CL, the only check that may happen on EL side is that this block does exist and is from the canonical chain. What thoughts on the safe block algorithm do you have?",
        "created_at": "2022-09-09T13:32:16.130000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I want to return `unrealized` justified",
        "created_at": "2022-09-09T13:37:23.843000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "instead of justified. It has the same guarantees under the same latency assumptions",
        "created_at": "2022-09-09T13:37:38.549000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "so it makes no sense to return justified.",
        "created_at": "2022-09-09T13:37:46.918000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "general",
        "parent": "",
        "content": "And it will be ~10 blocks earlier than justified in the normal case reducing `safe` block delay to ~22 blocks. Pretty good improvement üëç",
        "created_at": "2022-09-09T13:45:12.602000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "general",
        "parent": "",
        "content": "While _unlikely_ on mainnet, _theorhetically_ block production can halt for arbitrary lengths of time, and the merge is a time when block production is _more likely_ to halt (but still IMO very unlikely).  A safer heuristic might be to compare the block times of each node w/ the maximum blocktime of all your nodes instead of the current timestamp.  That way if they all halt at the same block, they all remaining healthy (which is _probably_ what you want vs them all going unhealthy).  Basically `if max(latest.blockTime for latest in all nodes) - latest.blockTime \u003e 20m then unhealthy`",
        "created_at": "2022-09-09T21:50:18.034000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "general",
        "parent": "",
        "content": "^ while less of an issue now, this approach would work on PoA networks like pre-merge Goerli/Rinkeby where chain halts were \"common\" (roughly a couple times a year).",
        "created_at": "2022-09-09T21:51:29.233000+00:00",
        "attachments": null
    }
]
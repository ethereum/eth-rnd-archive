[
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@543900561460822016\u003e I have a question regarding an edge-case of EIP-7702. In `EXTCODEHASH` if the account we try to get the hash from does not exist, we push `0` on the stack. If the account exists, but it is empty, we put `keccak256(\"\")` on the stack. \n\nIf an EIP-7702 delegated account points to a non-existing account, what should it report? Should it report `0` or the `keccak256(\"\")`?\n\nI am not sure, I think solidity checks for EXTCODESIZE \u003e 0 when calling a contract (not extcodehash) but I am not sure here",
        "created_at": "2024-08-19T04:40:52.013000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i would report `0` since the target doesn't exist",
        "created_at": "2024-08-19T12:46:45.847000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ok, so it differs from extcodehash on delegating to non-existing accounts to report `keccak256(\"\")` and not 0?",
        "created_at": "2024-08-19T12:54:32.564000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ah sorry i meant `0`",
        "created_at": "2024-08-19T12:58:57.611000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think you mean `0`, not keccak256 of 0, since extcodehash pushes that on the stack if the account does not exist? \n\nThis is in our code for EXTCODEHASH:\n\n```typescript\n      const account = await runState.stateManager.getAccount(address)\n      if (!account || account.isEmpty()) {\n        runState.stack.push(BIGINT_0)\n        return\n      }\n```",
        "created_at": "2024-08-19T13:00:45.071000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "you're right, sorry it's early ðŸ˜„",
        "created_at": "2024-08-19T13:07:02.628000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Cool! Could you add this to the EIP-7702? This is not specced out yet ðŸ™‚ (or, at least would be nice to have a clarification)",
        "created_at": "2024-08-19T13:08:03.101000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It does say \"For example, EXTCODESIZE would return the size of the code pointed to by address instead of 23 which would represent the delegation designation.\"\n\nwouldn't you infer you need to take the EXTCODEHASH of the address pointed to? and EXTCODEHASH of non-existing account is `0` like you say",
        "created_at": "2024-08-19T13:11:15.612000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think you are right. When I wrote \"this is not specced out yet\" I realized that it is actually specced out. And when I think of it, it indeed does not make much sense to change behavior here",
        "created_at": "2024-08-19T13:13:40.448000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Will have to edit my code though since I now report `keccak256(\"\")` and not 0 ðŸ™‚",
        "created_at": "2024-08-19T13:14:02.071000+00:00",
        "attachments": null
    }
]
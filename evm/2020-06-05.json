[
    {
        "author": "_drinkcoffee",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "EVM: From Solidity to bytes code, memory and storage: \nI am giving a talk at the Ethereum Engineering Group meet-up next Wednesday 12:30pm Brisbane, Australia time zone. \nTo register for this online event: https://www.meetup.com/ethereum-engineering/events/270455594/",
        "created_at": "2020-06-05T03:18:36.853000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@425279588009246720\u003e yes I translated your script into my framework",
        "created_at": "2020-06-05T04:59:57.404000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@211091239112671234\u003e did you include cbor decoding to ensure it is not picking up random bytes? :)",
        "created_at": "2020-06-05T08:35:16.703000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Nope, must have missed that...",
        "created_at": "2020-06-05T08:38:40.248000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Here's the filter I used: https://github.com/holiman/go-ethereum/blob/subroutine_restrictions_analysis/cmd/contractanalyzer/main.go#L139",
        "created_at": "2020-06-05T08:39:14.871000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Actually, your script skipped it too..",
        "created_at": "2020-06-05T08:40:26.849000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "....And your script gives false positives if the op indeed _is_ in the metadata, but also earlier \u003c@!425279588009246720\u003e ?",
        "created_at": "2020-06-05T08:41:06.892000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "... it'd be great if I've done it wrong, because I had been hoping that this step would remove some more contracts...",
        "created_at": "2020-06-05T08:45:02.555000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It seems I've uploaded the wrong code but don't have the correct one anymore. However the logic should be as follows:\n1. Read the last 2 bytes of contract as a big-endian number. Call this value `metadata_size`.\n2. Read the bytes between `[len - metadata_size - 2, len - 2]` and consider it as a CBOR encoded data.\n3. Decode it -- fail if it doesn't decode or if it is not a CBOR mapping.\n4. If it contains any of the following keys, it is valid solidity metadata: bzzr0, solc, experimental, ipfs\n5. If it is valid, drop it from the code and conduct analysis on the remainder.",
        "created_at": "2020-06-05T09:04:48.206000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm not 100% sure now the metadata_isze includes the size of the length field itself or not, so perhaps `[len - metadata_size, len - 2]` is the correct slice.",
        "created_at": "2020-06-05T09:06:23.224000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "pdobacz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so, if 'verbatim', that would translate to bytecode `0xe834`, and exchange 5th and 10th stack items (1-based), correct?",
        "created_at": "2024-12-19T10:33:16.450000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is why I think we need punctuation for verbatim and effective values.  EXCHANGE really leaned into execution efficiency at the expense of casual readability.",
        "created_at": "2024-12-19T15:46:46.164000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ahh so you mean there would be two ways to write it?",
        "created_at": "2024-12-19T15:50:55.166000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "EXCHANGE !0x34 for verbatim and EXCHANGE 5,10 for effective.  But SWAPxx is already off by 1 for DUPxxx, so it's a hot mess any way we code it.",
        "created_at": "2024-12-19T15:53:38.689000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "wait, why does `0xe834` exchange 5 and 10? I thought it would exchange `4` and `5`?",
        "created_at": "2024-12-19T15:54:59.093000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ahh, reading EIP",
        "created_at": "2024-12-19T15:55:57.030000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e the n + 1‘th stack item is swapped with the n + m + 1‘th stack item.",
        "created_at": "2024-12-19T15:55:59.649000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Not the way things are named now, but SWAP[2] (swap 2n'd with 1st, currently SWAP @ 0x90), DUP[2] (dup the second item, current DUP2 @ 0x81)) and EXCHANGE[2,3] (0xe800)",
        "created_at": "2024-12-19T15:56:12.915000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and then SWAP[!0x01], DUP[!0x02], EXCHANGE[!0x00] would be literal encodings.",
        "created_at": "2024-12-19T15:57:29.734000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I would just use the `[xxx]` for specifying verbatim immediates (without `!`)",
        "created_at": "2024-12-19T16:19:53.830000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So `DUP 2` `SWAP 2` `EXCHANGE 5, 10` would be `DUP[01]`  `SWAP[00]` `EXCHANGE[00]`",
        "created_at": "2024-12-19T16:22:01.200000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yes",
        "created_at": "2024-12-19T16:22:11.489000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I could live with that",
        "created_at": "2024-12-19T16:22:26.441000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ok, require fully zero-ed out nybbles, so `JUMP[0003]` would be the literal `JUMP :label` if label resolved to 3?",
        "created_at": "2024-12-19T16:22:51.665000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and JUMPV -- YOLO?",
        "created_at": "2024-12-19T16:23:01.478000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "well, you don't have to write the verbatim encoding usually",
        "created_at": "2024-12-19T16:23:16.169000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "for example, in geas right now, I support the syntax `jump @label` and it expands into `pushX @label; jump`",
        "created_at": "2024-12-19T16:24:01.550000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right, it's a fallback for stunts like `RJUMPI[FFFD]` to clear all non-zero stack items",
        "created_at": "2024-12-19T16:24:02.440000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so in geas, all instructions can have an immediate syntax-wise, but it's only supported for jump and push",
        "created_at": "2024-12-19T16:24:48.241000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "in EOF, more instructions can have an immediate, and for jumps one would usually write `rjumpv @label`",
        "created_at": "2024-12-19T16:25:14.076000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but it's a good idea to support the verbatim syntax as a separate concept",
        "created_at": "2024-12-19T16:26:07.082000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, that is the best case.  But crazy coders and decompilers will still have a fallback.  `self: RJUMPI @self` is much more readable anyway",
        "created_at": "2024-12-19T16:26:10.054000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "btw I don't have the time right now to implement EOF in geas",
        "created_at": "2024-12-19T16:26:47.707000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but it's good to have the syntax ironed out ahead of time.",
        "created_at": "2024-12-19T16:27:11.944000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I worked on it a bit around devcon, and finished some important precursor changes, but now I'm busy with other things",
        "created_at": "2024-12-19T16:27:25.987000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "on the topic of syntax, what might be a good way to handle sections?",
        "created_at": "2024-12-19T16:27:45.481000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "there are two approaches",
        "created_at": "2024-12-19T16:28:19.189000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "one is delimiting them explicitly, for example with",
        "created_at": "2024-12-19T16:28:39.800000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "```\n#section XXX {\n   op\n   op\n}\n```\n\nthis would kind of go with the data section notation that is still pending https://github.com/fjl/geas/issues/7",
        "created_at": "2024-12-19T16:28:55.521000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "another way would be just declaring the start of a section, ending the current one:\n\n```\n#section XXX\n  op\n  op\n\n#section YYY\n  op\n  op\n```",
        "created_at": "2024-12-19T16:29:14.747000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I guess it depends on the container model, does EOF support nesting a section in the middle of another one?",
        "created_at": "2024-12-19T16:29:42.604000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "probably not",
        "created_at": "2024-12-19T16:29:48.471000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "No nesting sections, but also no jumps crossing section boundaries.",
        "created_at": "2024-12-19T16:36:48.594000+00:00",
        "attachments": null
    },
    {
        "author": "pdobacz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "code section within another code section - no. But a container in the container section is an EOF container so contains moar sections nested, but that is probably not interresting to the assembler",
        "created_at": "2024-12-19T16:37:13.811000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And sections needs at least two metadata items, input stack and output stack.   Max stack height/extra stack should be computed by the assembler.",
        "created_at": "2024-12-19T16:37:49.734000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We could presume 0 in the absence of the metadata, but it needs to be settable.",
        "created_at": "2024-12-19T16:38:37.327000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes yes",
        "created_at": "2024-12-19T16:45:28.700000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "sections are rather functions",
        "created_at": "2024-12-19T19:38:26.427000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, so I've been thinking how to represent that. The geas language is kind of sigil-based, so there has to be a prefix for section names.",
        "created_at": "2024-12-19T20:52:05.654000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u0026 is still free, so it'll be that most likely",
        "created_at": "2024-12-19T21:12:35.029000+00:00",
        "attachments": null
    },
    {
        "author": "frangio_",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this kind of confusion is why verbatim is probably not the best option!",
        "created_at": "2024-12-19T21:21:54.286000+00:00",
        "attachments": null
    },
    {
        "author": "frangio_",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "rjumpi[fffd]",
        "created_at": "2024-12-19T21:24:05.242000+00:00",
        "attachments": null
    }
]
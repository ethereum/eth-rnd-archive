[
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "FWIW, the looser rules of EIP-2315 take care of the de-duplication you want as well as tail optimization and others.  The cost of that is that you can't specify anything about subroutine stack use up-front, that gets inferred.  And, by design, you can't restrict subroutines to syntactic boundaries - all safety constraints are handled semantically at validation time.\n\nMy notion going forward is that rather than introduce special opcodes for special optimizations we introduce expanded code sections -- modules -- with multiple entry points.  Within (and only within) a code section we expose the unrestricted EIP-2315 JUMPSUB instructions, which are the underlying mechanism for CALLF.\n\nThat would give us the safety of higher-level, specified interfaces for code sections at the EOF level, and maximal safe optimization within code sections.",
        "created_at": "2023-01-18T02:50:25.968000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Wasm has structured controlled flow and Java has stack maps for the same reason -- to ensure that not only the height of the stack but also the types on the stack match up.  This is necessary for writing linear-time compilers -- otherwise tracking the types is too difficult.",
        "created_at": "2023-01-18T02:52:57.416000+00:00",
        "attachments": null
    }
]
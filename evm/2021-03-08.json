[
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "thanks!!",
        "created_at": "2021-03-08T00:46:38.671000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e I think one bigger problem may be with libraries (such as for wallets). One must make sure to not deploy a contract compiled for the new address scheme but linking to an old library. A lot of possibility for user error, we may try make this foolproof in various levels but likely we'll miss something ðŸ˜…",
        "created_at": "2021-03-08T15:14:43.742000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Though that may be solved with \"more recent\" libraries which have the \"library-check\" code, which checks the library is not executed directly, but through delegatecall. That should bail out if the delegatecall context originates from a new-address contract.",
        "created_at": "2021-03-08T15:15:47.251000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "IIUC, not bail out but rather do the 32 byte to 20 byte lookup?",
        "created_at": "2021-03-08T15:17:31.505000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(I still haven't read the address resizing post)",
        "created_at": "2021-03-08T15:17:44.158000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Libraries have their address hard coded into them during deploy them (by the deploy code). The \"library-check\" or \"delegatecall-check\" performs `address()` at every single execution and compares it against he hard coded value.\n\nOne option in extending the address space is that the `address()` opcode just aborts if it is executed in a new-address context. So if delegatecall is in such a context, this should just abort execution.",
        "created_at": "2021-03-08T15:20:19.185000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is present on most deployed code in use currently, so can't really change it.",
        "created_at": "2021-03-08T15:22:07.074000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or maybe since we can't easily go over 32 bytes we should _reserve_ some of the 32 bytes for versioning instead of expanding from 20 -\u003e 32 in one go?",
        "created_at": "2021-03-08T17:23:18.771000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is the tentative plan.  Extend the \"address\" portion to 26 bytes and leave the rest available for \"future expansion\".",
        "created_at": "2021-03-08T17:34:48.968000+00:00",
        "attachments": null
    },
    {
        "author": "underbasic",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "makes sense, generally its nice to have a byte if you can spare it as a \"version\" and have the code now, say if the version isn't one of the ones I support up to then its an issue, allows you to release a \"new\" version that might use the bytes for a different purpose in the future should you decide that there is a better use",
        "created_at": "2021-03-08T18:23:27.132000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think a new-style address would be able to call into an old-style address as a library without any problems with my address extension scheme",
        "created_at": "2021-03-08T21:08:58.693000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!425279588009246720\u003e what exactly would the format of the jumptable be? can you make a simple example?",
        "created_at": "2021-03-08T21:10:18.296000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also, what would go into metadata?",
        "created_at": "2021-03-08T21:10:23.005000+00:00",
        "attachments": null
    }
]
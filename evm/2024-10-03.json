[
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Somewhat on this topic, I wanted to propose a simple \"do a few things and done\" roadmap for EVM efficiency improvement:\n\n------",
        "created_at": "2024-10-03T07:50:40.224000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "1. \"EVMMAX + SIMD\"",
        "created_at": "2024-10-03T07:50:50.151000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Basically, the idea here is to take the EVMMAX spec, and change it so that instead of the indices being `x_offset, y_offset, z_offset`, they are: `x_start, x_skip, y_start, y_skip, z_start, z_skip, count`",
        "created_at": "2024-10-03T07:52:36.164000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And you make it work for moduluses of small size, basically cover every modulus from 3 all the way up to `2**768-1`",
        "created_at": "2024-10-03T07:53:09.237000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And design gas costs around that, so eg. an op with  `count=8` and `modulus \u003c 2**32`  would cost as much as a single 256-bit EVM op does today, or even less",
        "created_at": "2024-10-03T07:53:54.777000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think of this as being \"numpy for the EVM\", it gives us a high-performance coprocessor inside the EVM that can be used to implement a very wide range of cryptographic operations highly efficiently - not just elliptic curve stuff, but also low-modulus operations, such as 32- bit STARKs (incl 32-bit Poseidon) and even lattice cryptography",
        "created_at": "2024-10-03T07:54:45.158000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "2. Identify EVM operations that are cheaper than the others, and reduce their gas cost to 1\n\neg. ADD, SUB, PUSH, POP...... all of those are quite a bit cheaper than MUL\n\nBasically find everything that is \"too expensive\" today relative to our benchmark goals, and make it cheaper",
        "created_at": "2024-10-03T07:56:27.933000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "-----",
        "created_at": "2024-10-03T07:56:34.505000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We had an EIP for this ðŸ˜…",
        "created_at": "2024-10-03T08:38:20.049000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "even moduli as well?  or just power of two and odd moduli?",
        "created_at": "2024-10-03T08:46:37.768000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I remember EVMMAX as written before only covered power of two and odd, because those are the easy special cases for the montgomery mechanism, right?",
        "created_at": "2024-10-03T08:51:34.312000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I've never seen an even modulus that's not a power of two ever used in cryptography in the wild",
        "created_at": "2024-10-03T08:51:48.736000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so I'm ok with saying odd or power of 2 only",
        "created_at": "2024-10-03T08:51:56.709000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Then let's bring it back!\n\nACCEEELLLLLEEEEEEEERRRRRRRRRRRRRAAAAAAAAAAAAAAAAAAAAATTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE",
        "created_at": "2024-10-03T08:53:19.677000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The last EVMMAX spec only covered odd moduli because afaik it is not possible to do efficient montgomery multiplication with even moduli.  I don't really know how efficient binary modular ~~arithmetic~~ multiplication is done.",
        "created_at": "2024-10-03T08:58:46.475000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Multiplication modulo powers of two is just the base case, right?",
        "created_at": "2024-10-03T09:14:53.405000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ie. it's the underlying native operation that everything else is being built on top of already",
        "created_at": "2024-10-03T09:15:15.475000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "One thing you could do with even moduli is chinese remainder decompose into `p * 2^k`, and montgomery the `p` part",
        "created_at": "2024-10-03T09:15:44.973000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But IMO that's pointless extra complexity, let's just stick with powers of 2 and odd ðŸ˜†",
        "created_at": "2024-10-03T09:16:08.830000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(powers of 2 are useful primarily for (i) hash functions operating over 32-bit numbers, and (ii) lattices)",
        "created_at": "2024-10-03T09:16:35.666000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ah right the reduction step is just a bit shift ...",
        "created_at": "2024-10-03T09:17:36.762000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah you don't even do the montgomery, you just apply a bit mask",
        "created_at": "2024-10-03T09:27:47.806000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "A couple more related things things that are frequently requested\n* Raising the contract Size Limit (can easily be set to 64k for runtime, possibly more for initcode)\n* Uncapping the Contract Size Limit, but that would require some things like varint jumps and headers values",
        "created_at": "2024-10-03T13:57:25.318000+00:00",
        "attachments": null
    }
]
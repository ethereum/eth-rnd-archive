[
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Itâ€™s no more complex than DAO code",
        "created_at": "2021-10-27T17:43:34.423000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Technical complexity isn't the issue. It will become a trojan horse that will make it harder to fight censorship resistance. We are literally going back and censoring code because it got in the way of an EIP.",
        "created_at": "2021-10-27T18:14:33.256000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Given that two of the three contracts provably do nothing, and the third contract the author told us does nothing and serves no purpose, I think we still have a sturdy schelling fence.",
        "created_at": "2021-10-27T18:17:02.200000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We are not removing any code that does anything useful for anyone.  The schelling fence can still be that we will not remove any code that serves a useful purpose.",
        "created_at": "2021-10-27T18:17:34.516000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And in fact I *wish* this schelling fence existed pre-DAO hardfork.",
        "created_at": "2021-10-27T18:18:25.548000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I believe that fence still leaves us with all of our credible neutrality intact.",
        "created_at": "2021-10-27T18:19:03.852000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Disagree on that, I think you (us) have a much more nuanced view of things than the average observer.,",
        "created_at": "2021-10-27T18:35:30.309000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we constantly try to appeal to the lowest common denominator then the protocol will continue to deteriorate over time as more and more technical debt piles up that we are unwilling to clean up.  While this one is pretty small/insignificant, it isn't the only instance of catering to the lowest common denominator biting us.",
        "created_at": "2021-10-27T18:38:23.250000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I can see that, I still think the tech debt is \"worth it\", but that's easy to say as a non-client maintainer ðŸ˜… . These weird quirks kind of seem like the price we pay for having a permisionless system.",
        "created_at": "2021-10-27T18:42:03.152000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Contracts that \"provably do nothing\" are just one spilled beer away from contracts that are \"probably broken\".  No shelling fence is that strong. The slope is too slippery to allow a second ISC.",
        "created_at": "2021-10-27T19:07:31.801000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Third I think.  We also did the dust cleanup a long time ago I believe?  Something after the Shanghai attacks I think (or maybe it was before that even)?",
        "created_at": "2021-10-27T19:13:00.895000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "No data was removed from the ledger.  How zero values were merkelized changed in those two forks.",
        "created_at": "2021-10-27T19:13:47.357000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e Contracts that \"provably do nothing\" are just one spilled beer away from contracts that are \"probably broken\".\nI disagree pretty strongly that \"provably do nothing\" (in the mathematic sense) is one slip away from \"probably broken\".  I think there are a number of very strong fences between these two things.",
        "created_at": "2021-10-27T19:14:10.324000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The mobs will tear it down.",
        "created_at": "2021-10-27T19:14:46.646000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I do not deny that there will be some people who will *try* to use this against us.  I don't think they will be successful nor do I think we should fear them.",
        "created_at": "2021-10-27T19:16:40.566000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "These contracts are not side effect free.  Send a TX call to one it will aways revert.  Send a TX to an empty account no revert. So in a mathematical sense there is one (tiny) impact.",
        "created_at": "2021-10-27T19:16:44.288000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "_that_ is why the designated invalid opcode was used.",
        "created_at": "2021-10-27T19:17:28.313000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "While I'm not convinced by this, it is a reasonable argument.",
        "created_at": "2021-10-27T19:17:32.027000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We have two discussions here.  I have strong opinions about the DAO, immutability, and the rest that are not relevant to EVM design, that I do not believe are relevant to the non-problem of these contracts that begin with 0xEF, and I don't want to get into here or now.\n\nhttps://eips.ethereum.org/EIPS/eip-3540 says, \n\u003e To summarise, EOF bytecode has the following layout:\n\u003e    format, magic, version, (section_kind, section_size)+, 0, \u003csection contents\u003e\nand that the magic is 0xCA 0xFE and is subject to change.  I may have gotten lost in this long thread, but that seems to solve the problem.",
        "created_at": "2021-10-27T19:19:26.634000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There is a desire to get rid of the magic bytes to save space.",
        "created_at": "2021-10-27T19:21:03.508000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is silly.",
        "created_at": "2021-10-27T19:21:21.996000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I see this issue largely as a canary issue.  It is pretty rare that we have a desire to do an irregular state change with this clear of a no-harm impact.  I think there will be times in the future where an irregular state change will be necessary for one reason or another in order to keep the protocol healthy and competitive.  If we cannot get this one through (with such clear no-harm), then it seems very unlikely we'll be able to get *any* through in the future.",
        "created_at": "2021-10-27T19:21:44.323000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "How about framing this as \"exploring\" the idea of getting rid of the extra byte and what all the implications of that are.",
        "created_at": "2021-10-27T19:21:58.151000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I don't see the authors of the EIP here.",
        "created_at": "2021-10-27T19:22:38.113000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Axic engaged a bit above, and I think they are an author.",
        "created_at": "2021-10-27T19:23:15.140000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we are, in fact, saying \"absolutely no irregular state changes ever even when there is incredibly clear no-harm\" then I worry that we will eventually fail to remain competitive with chains who are either starting from scratch or willing to make such changes.  As I have argued previously, I am of the opinion that Ethereum isn't mature enough to calcify like Bitcoin has calcified, and while I do think that it needs to calcify *eventually*, I don't think now is that time.",
        "created_at": "2021-10-27T19:24:33.086000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I still think going into this big controversy to save one or two bytes is not worth it.",
        "created_at": "2021-10-27T19:25:04.592000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think at *least* sometime after sharding for calcification, though I can appreciate an argument for \"after zk blocks\".",
        "created_at": "2021-10-27T19:25:05.599000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I personally *like* having the controversy on such a simple issue, rather than waiting until there is some bigger issue that muddies the discussion.  With such a simple trade-off here (3 useless contracts deleted in exchange for saving 1 byte on all future deployments), it is really easy to keep the conversation cleanly about \"are we willing to do an irregular state change?\"",
        "created_at": "2021-10-27T19:26:13.702000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Then I say, 'no.'",
        "created_at": "2021-10-27T19:28:16.304000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Which stii in the end means, 'it depends,'",
        "created_at": "2021-10-27T19:29:29.217000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I reject the notion this is a \"clear no-harm\" change.  The ISC itself is the harm, a higher standard (like fixing a halted chain) is needed.",
        "created_at": "2021-10-27T19:29:29.511000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "exactly.",
        "created_at": "2021-10-27T19:30:01.393000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "minor incremental benefit is not enough.",
        "created_at": "2021-10-27T19:30:28.318000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Bring me a real lesser of two harms situation, that's the only case an ISC should be considered.",
        "created_at": "2021-10-27T19:31:40.625000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "One point of EOF is to allow for tables of info outside of the bytecode itself.  those take more than a byte even if empty.",
        "created_at": "2021-10-27T19:32:52.774000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I guess I was saying that the change itself causes no harm, and was ignoring the political argument of harm.  The goal being to focus the discussion on the \"harm\" of irregular state changes, when there is a strong schelling fence backing them up.",
        "created_at": "2021-10-27T19:33:16.376000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also to allow for version numbers.  Again, more than a byte.",
        "created_at": "2021-10-27T19:33:38.286000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It doesn't cause no harm.  little harm (the revert-on-call option is removed), but not no.",
        "created_at": "2021-10-27T19:34:03.086000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The argument isn't that EOF is free, it is that we are spending +1 byte on every contract for all of time or increasing code complexity for all of time to avoid deleting 3 contracts that don't do anything useful for anyone.",
        "created_at": "2021-10-27T19:34:19.829000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think we (humans) can assert that there is no rational reason to use these contracts to halt execution.  There are many simpler and cheaper ways to halt execution.",
        "created_at": "2021-10-27T19:34:56.986000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We're talking about censoring transactions because it's interfering with the design space for an EIP. This is insane.",
        "created_at": "2021-10-27T19:35:16.758000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Not censoring a transaction.  Deleting 3 contracts that don't do anything.  One of which the author gave permission to do, and two of which are literally one-byte contracts.",
        "created_at": "2021-10-27T19:35:57.425000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Where are we spending that byte?  Clients can store things in more compressed ways.",
        "created_at": "2021-10-27T19:36:10.592000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "All 3 were deployed after the EIP was created as well, which *suggests* that the authors did it specifically to troll this EIP (or possibly force this discussion).",
        "created_at": "2021-10-27T19:36:29.148000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "At the least, the deployment transaction will be one byte larger.",
        "created_at": "2021-10-27T19:37:06.606000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It's better to add a section to the EIP on how to handle contracts that start with 0xEF but don't parse properly.",
        "created_at": "2021-10-27T19:37:11.156000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Layer 2s will benefit from that.",
        "created_at": "2021-10-27T19:37:25.577000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So the average transaction will be a fraction of a percent larger?",
        "created_at": "2021-10-27T19:37:52.992000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The average deployment transaction.",
        "created_at": "2021-10-27T19:38:09.204000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, thanks.",
        "created_at": "2021-10-27T19:38:23.243000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ISC or not, the EIP should address what to do with parsing errors. That moots the whole discussion TBH.",
        "created_at": "2021-10-27T19:38:35.699000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Your thinking here is that the EIP would assert that if the first byte is 0xEF then the contract must be parsed in a certain way, and if that parsing fails (for example because there are no additional bytes) then a well defined thing should occur (e.g., contract reverts)?",
        "created_at": "2021-10-27T19:39:38.025000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think the idea with EOF (someone correct me if I'm wrong here) is that parsing happens on deployment, not at runtime.",
        "created_at": "2021-10-27T19:39:56.891000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Right.  And https://eips.ethereum.org/EIPS/eip-3670 deals with that.",
        "created_at": "2021-10-27T19:40:18.040000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I thought I remember that being one of the primary motivations for EOF contracts.",
        "created_at": "2021-10-27T19:40:19.527000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes!",
        "created_at": "2021-10-27T19:41:22.260000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "defense in depth, don't expect code to be 100% valid.  Good clients can cache/memoize the validation results.  Easier to keep a deployed but invalid hash list and pre-populate it with those three contracts. \"EIP-716\" established that mistakes can get canonized on the chain instead of going back and changing them.",
        "created_at": "2021-10-27T19:45:04.107000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And I think one point of the two-phase introduction (first deprecate 0xEF, then do something with it) and the magic being changeable was in part to deal with this exact situation.  Those contracts got deployed before it was invalid to do so, or else I misunderstand badly (which I might).",
        "created_at": "2021-10-27T19:47:46.165000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "IIUC, an explicit motivation with this EIP is to make it so we don't have to waste resources parsing contracts on every execution.  We can assert that if a contract starts with the magic bytes, then it means it has already been validated according to some validation algorithm and that work does not need to be done again.",
        "created_at": "2021-10-27T19:54:31.979000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This reduces the cost (and thus gas) of such contract calls I believe, because less work needs to be done.",
        "created_at": "2021-10-27T19:55:26.011000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We certainly could add a bit of technical debt here instead of an extra byte.  The options currently are:\n1. Irregular state change.\n2. Add tech debt.\n3. Add byte.",
        "created_at": "2021-10-27T19:56:35.673000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "All 3 are epsilon sized in terms of their individual impacts.  (1) is just 3 contracts deleted, (2) is just checking 3 hashes, (3) is just adding a single byte.",
        "created_at": "2021-10-27T19:57:36.177000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So this is certainly a comparison of very small things.",
        "created_at": "2021-10-27T19:58:07.131000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "3 is the least contentious choice.  1 will result in significant community push back. 2 is an option if a fraction of one percent of storage is important in the long run.",
        "created_at": "2021-10-27T20:17:01.605000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we were talking 10-20% that's when it gets viable IMHO.",
        "created_at": "2021-10-27T20:17:40.591000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e  \u003c@!301186049323958275\u003e  if a contract starts with the magic bytes, then it means it has already been validated according to some validation algorithm and that work does not need to be done again.\nExactly.  And over time we will want version numbers as our notion of what is valid evolves (e.g. as we add new opcodes they are no longer invalid.). Which makes the relative overhead if the magic even less.\n\u003e \u003c@!403707149043105803\u003e  [magic number] is the least contentious choice.\nBy far.  Very far.  Especially given that is what the original EIP specifies.",
        "created_at": "2021-10-27T23:04:29.767000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "_drinkcoffee",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e On line 41/42 contracts start with `0xff` which is selfdestruct. Are those data contracts?\n\u003c@!425279588009246720\u003e Even if it was a data contract, surely starting a contract (really just a data blob) with 0xff is bad idea. If someone sent a transaction to the contract, wouldn't the self desctruct opcode execute and then the contract would be deleted...? Or am i missing something obvious?",
        "created_at": "2020-05-05T02:55:38.609000+00:00",
        "attachments": null
    },
    {
        "author": "hmijail",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "un/fortunately, those contracts have 0 balance. But this together with the state rent changes would have been an interesting development",
        "created_at": "2020-05-05T03:48:40.407000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e  If someone sent a transaction to the contract, wouldn't the self desctruct opcode execute\n\nNope, selfdestruct pops one item off the stack, so it would error out on that",
        "created_at": "2020-05-05T07:28:48.125000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So a 'random data' contract would have to have something like `NUMBER/TIMESTAMP/PC ; SELFDESTRUCT` for that to happen, which lowers the likelihood (a bit)",
        "created_at": "2020-05-05T07:30:37.024000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e  lot of them may have a valid first opcode (but would halt anyway, such as CODECOPY as first instruction) \nI filtered out most of those already, but I missed some, e.g. `CODECOPY` (what I meant by \"and filtering a bit more aggressively on the first (a few slipped by me)\")",
        "created_at": "2020-05-05T07:31:52.605000+00:00",
        "attachments": null
    },
    {
        "author": "s1na",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is it possible these data contracts are used via  `EXTCODECOPY`?",
        "created_at": "2020-05-05T09:18:06.363000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That's the only way they are used ðŸ™‚",
        "created_at": "2020-05-05T09:18:57.196000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It became more prevalent after 1884 which raised SLOAD costs and for longer data it is worth using data contracts.",
        "created_at": "2020-05-05T09:20:49.263000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e To continue from previous room: I'm analyzing all contract code at block `9666637`. I dumped out all code (22G), and am now doing a filtering: only code containing \n\u003e \n\u003e - At least one `JUMP` or `JUMPI`,\n\u003e - At least one `BEGINSUB` (0xB2)\n\u003e - And a `JUMPDEST` _after_ the `BEGINSUB`\n\u003c@!211091239112671234\u003e The `JUMPDEST BEGINSUB JUMP` is also invalid",
        "created_at": "2020-05-05T09:22:16.316000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Looks I'm late to the party...",
        "created_at": "2020-05-05T09:24:32.493000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Here's the metadata checking hack I used: https://gist.github.com/axic/aaee2f0252d519d9adde0bb83a7c0524",
        "created_at": "2020-05-05T09:24:55.674000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!259648573401071617\u003e here's one of the first relevant comments (and there's more analysis later on) on the 1884 vs. data contracts topic: https://ethereum-magicians.org/t/eip-1884-repricing-for-trie-size-dependent-opcodes/3024/35?u=axic",
        "created_at": "2020-05-05T09:32:42.125000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e JUMPDEST BEGINSUB JUMP is also invalid\n\nright... I guess the analysis left out half of the cases ðŸ˜¦",
        "created_at": "2020-05-05T09:49:13.323000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@425274498732916736\u003e wait. How would you get to the wrong side of the beginsub in the first place if there isn't a jump across it to begin with?",
        "created_at": "2020-05-05T11:15:14.922000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "JUMPSUB?",
        "created_at": "2020-05-05T11:15:52.885000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah but in that case it's broken today",
        "created_at": "2020-05-05T11:16:09.043000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So no need to worry about breaking it",
        "created_at": "2020-05-05T11:16:24.710000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e \u003c@!425274498732916736\u003e wait. How would you get to the wrong side of the beginsub in the first place if there isn't a jump across it to begin with?\n\u003c@!211091239112671234\u003e Seems correct.",
        "created_at": "2020-05-05T11:20:18.760000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So what to do with the remaining codes?",
        "created_at": "2020-05-05T11:23:25.357000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The list from me still needs to be cleared from \"obviously broken\"/data contracts. Then probably need to look at one (the shortest) to see if beginsub changes anything.",
        "created_at": "2020-05-05T11:30:48.754000+00:00",
        "attachments": null
    }
]
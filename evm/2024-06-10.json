[
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Could someone explain this test to me: \n```\n ./eofdump eof --hex 0xef0001010004020001000e04000000008000045f6000e100025f5f6000e1fffd00\n0 PUSH0 0 \u0026{0 0}\n[0]\n1 PUSH1 1 \u0026{1 1}\n[2]\n3 RJUMPI 2 \u0026{2 2}\n[5 7]\n6 PUSH0 2 \u0026{1 1}\n[6]\n7 PUSH0 2 \u0026{2 2}\n[7]\n8 PUSH1 3 \u0026{1 3}\n[9]\n10 RJUMPI 4 \u0026{2 4}\n[12 9]\n13 STOP 4 \u0026{1 3}\n[13]\nok.\n```\nIt should error with `EOF_ConflictingStackHeight`, is it because the RJUMPI self-references? \nWhich rule guards against that?",
        "created_at": "2024-06-10T07:21:24.728000+00:00",
        "attachments": null
    },
    {
        "author": "draganrakita",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is about having same stack height for backward jumps",
        "created_at": "2024-06-10T08:21:58.627000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Weird, I do have a rule for that",
        "created_at": "2024-06-10T08:23:59.975000+00:00",
        "attachments": null
    },
    {
        "author": "draganrakita",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Where is your code?",
        "created_at": "2024-06-10T08:25:44.633000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "```go\n\n// target reached via backwards jump\n                    nextBounds, ok := stackBounds[nextPC]\n                    if !ok {\n                        return 0, ErrInvalidBackwardJump\n                    }\n                    change := int(params.StackLimit) - jt[nextOP].maxStack + jt[nextOP].minStack\n                    if have, want := nextBounds.max+change, currentBounds.max; have != want {\n                        return 0, fmt.Errorf(\"%w want %d as max got %d at pos %d,\", ErrInvalidBackwardJump, want, have, pos)\n                    }\n                    if have, want := nextBounds.min+change, currentBounds.min; have != want {\n                        return 0, fmt.Errorf(\"%w want %d as min got %d at pos %d,\", ErrInvalidBackwardJump, want, have, pos)\n                    }\n```",
        "created_at": "2024-06-10T08:26:21.521000+00:00",
        "attachments": null
    },
    {
        "author": "draganrakita",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I am getting `BackwardJumpBiggestNumMismatch` so it is about `max_stack_height`",
        "created_at": "2024-06-10T08:28:20.119000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This update to EOF testing is going to land soon: https://github.com/ethereum/execution-spec-tests/pull/613\n\nNot nuclear change fortunately  (based on the number of modified tests).",
        "created_at": "2024-06-10T09:02:43.915000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yep, I still don't get it. Its one of the last tests that I can't pass",
        "created_at": "2024-06-10T09:06:34.307000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "My old version got a stack underflow there",
        "created_at": "2024-06-10T09:06:45.020000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'll try to debug this manually.\n\nCan you explain this notation?\n\n```\n3 RJUMPI 2 \u0026{2 2}\n[5 7]\n```",
        "created_at": "2024-06-10T09:08:09.038000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "position, opcode, maxStackHeight, stackbounds (min, max)",
        "created_at": "2024-06-10T09:09:50.507000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and the following instructions (-1) in the next line",
        "created_at": "2024-06-10T09:11:31.210000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The second RJUMPI calls itself",
        "created_at": "2024-06-10T09:13:35.464000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And pops one item from the stack, so it should result in an underflow at some point?",
        "created_at": "2024-06-10T09:14:04.626000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah I figured it out I think",
        "created_at": "2024-06-10T09:16:47.834000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "```\nif currentStackMax != nextBounds.max {\n                        return 0, ErrInvalidBackwardJump\n                    }\n```\nThis clause was missing",
        "created_at": "2024-06-10T09:17:17.261000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think `RJUMPI` calling itself is always a failure ðŸ™‚",
        "created_at": "2024-06-10T09:17:49.239000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yes, because it will run down the stack to 0",
        "created_at": "2024-06-10T09:18:15.943000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm passing all tests of ethereum/tests except for two now, but those two were also not passed by my previous implementation",
        "created_at": "2024-06-10T09:18:59.669000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For `RJUMP` itself the algo compares stack after with stack before and they are never equal as `RJUMP` pops one item",
        "created_at": "2024-06-10T09:19:11.608000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "nice. you should try https://github.com/ethereum/execution-spec-tests/releases/tag/eip7692%40v1.0.1 now ðŸ™‚",
        "created_at": "2024-06-10T09:20:17.635000+00:00",
        "attachments": null
    },
    {
        "author": "draganrakita",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "was in the call, here is code that throws this: https://github.com/bluealloy/revm/blob/561fbdbb117a5613475a8f099981a36fedd0104b/crates/interpreter/src/interpreter/analysis.rs#L522",
        "created_at": "2024-06-10T09:20:50.469000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e Passed 984 tests out of 986",
        "created_at": "2024-06-10T09:21:02.927000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "the EEST may be already superior to ethereum/tests",
        "created_at": "2024-06-10T09:21:13.416000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "tell me what's failing",
        "created_at": "2024-06-10T09:21:41.555000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "```\nExecuting Tests: jumpf_backward.json\n0, Prague: expected success, got unreachable code\n\nExecuting Tests: rjumpi_max_backward.json\n0, Prague: expected success, got invalid backward jump\n```",
        "created_at": "2024-06-10T09:22:06.670000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In the first `JUMPF` works as terminating instruction (?)",
        "created_at": "2024-06-10T09:28:43.136000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Anyway, in the test itself there should be an ID allowing for finding the test source: https://github.com/ethereum/execution-spec-tests/blob/main/tests/prague/eip7692_eof_v1/eip4200_relative_jumps/test_rjumpi.py#L256",
        "created_at": "2024-06-10T09:36:59.566000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, the problem is that my implementation requires the following rule:\n- A section that is not visited by a previous section is unreachable\n\nSince we have 0 -\u003e 2 -\u003e 1, we don't know when validating 1 that it can be reached by 2.\n\nI have to rewrite my algorithm for scheduling the visits",
        "created_at": "2024-06-10T11:49:06.641000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Sounds like dp to me",
        "created_at": "2024-06-10T11:49:46.520000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "dp?",
        "created_at": "2024-06-10T11:53:42.381000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I thinking if we can/should require this to be in order",
        "created_at": "2024-06-10T11:54:39.094000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Dynamic Programming",
        "created_at": "2024-06-10T11:57:46.474000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I fixed it now",
        "created_at": "2024-06-10T11:57:50.907000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://github.com/ethereum/go-ethereum/pull/29518/commits/a89872c5f045b8e01266f346c9444662b4146787\nThis is the diff, I think we will loose something if we require the sections to be in order though",
        "created_at": "2024-06-10T11:59:24.625000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, I think we also have a queue here.",
        "created_at": "2024-06-10T12:02:59.716000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is this still the main EOF channel?",
        "created_at": "2024-06-10T13:24:40.486000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is there any appetite for including an ORIGIN ban in the first version of EOF?",
        "created_at": "2024-06-10T13:24:57.171000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes",
        "created_at": "2024-06-10T13:28:13.079000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Easy to do technically, but I think this would need to go though All-Core-Devs meeting.",
        "created_at": "2024-06-10T18:42:13.385000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The ol' runaround. ðŸ˜‚ On the ACD call, they said it would need to be decided here first.",
        "created_at": "2024-06-10T18:58:32.432000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And as part of that I had asked for some commentary from security auditors supporting this change.  The ball is in your court to provide this.",
        "created_at": "2024-06-10T18:59:40.290000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "More than a lukewarm \"This would be neat\" but more of an endorsement of \"this will improve the security of EOF\"",
        "created_at": "2024-06-10T19:00:19.125000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So, no, not runaround.  Awaiting further information.",
        "created_at": "2024-06-10T19:01:06.969000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hang on, the conclusion from EOF call was that it's technically feasible but not up to eof to decide. It's up to ACD.",
        "created_at": "2024-06-10T20:07:03.785000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And in ACD is also where I made my second opinion request. I don't care if it comes in ACD or the EOF calls, I'm pushing back without it.",
        "created_at": "2024-06-10T20:08:22.818000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "With all due respect, I'm not going to do this. It is *well* established by now that ORIGIN sucks and serves no real purpose. Banning its continued misuse in EOF would be an easy win that everyone *should* agree on.",
        "created_at": "2024-06-10T20:09:37.844000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Not sure what spinning up any auditors would accomplish.",
        "created_at": "2024-06-10T20:09:49.789000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If that is the case you can get at least one other person with credeitials to back that statement up.",
        "created_at": "2024-06-10T20:10:10.198000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I've had private conversations with some people who feel the opposite, so I will need some public evidence other than a claim it's \"well established by now\"",
        "created_at": "2024-06-10T20:11:42.770000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Can they point to a legitimate use case?",
        "created_at": "2024-06-10T20:14:37.006000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I feel like\nalias ORIGIN to SENDER\nand\nban ORIGIN in EOF\nhave gotten confused in the air here.",
        "created_at": "2024-06-10T20:15:18.334000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "aliasing ORIGIN to SENDER went over like a lead balloon",
        "created_at": "2024-06-10T20:15:55.013000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this is about banning ORIGIN in EOF",
        "created_at": "2024-06-10T20:16:08.287000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Gonna need more than a use case and an argument.  What would persuade me is a second concurring opinion.",
        "created_at": "2024-06-10T20:16:18.815000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hard to parse the back and forth of this chat, but v was initially supportive of either the alias or the ban. Not sure if he still is. https://discord.com/channels/595666850260713488/718596092828057631/1210829500632539156",
        "created_at": "2024-06-10T20:17:08.755000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://github.com/ethereum/solidity/issues/683",
        "created_at": "2024-06-10T20:17:37.105000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This thread is a discussion of all the reasons ORIGIN sucks. The consensus of the thread was to not remove it from *Solidity*, though which is a completely different subject than banning it in EOF.",
        "created_at": "2024-06-10T20:18:22.012000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But the consensus *was* that ORIGIN sucks.",
        "created_at": "2024-06-10T20:18:46.907000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "To disclaim: banning ORIGIN in EOF does nothing for me. After all, it's a future-facing fix. I just like to get rid of bad tech debt whenever possible.",
        "created_at": "2024-06-10T20:19:42.872000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What was the basis for their hesitation on an ORIGIN ban in EOF? (Or were they still thinking about the aliasing?)",
        "created_at": "2024-06-10T20:24:21.163000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What consensus? It seems you just posted two threads where people enthusiastically _defend_ the usefulness of tx.origin",
        "created_at": "2024-06-10T20:25:07.126000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Any perceived use case mentioned can and should be done some other way.",
        "created_at": "2024-06-10T20:26:15.161000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It was a private conversation.  Based on that, however, what matters to me is a second opinion stating that banning ORIGIN in EOF is a good idea and would be effective.",
        "created_at": "2024-06-10T20:27:34.175000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Well it's self-evident that banning ORIGIN in EOF would be effective at stopping people from using ORIGIN.",
        "created_at": "2024-06-10T20:28:30.181000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "They could still work around it with legacy deployments, of course.",
        "created_at": "2024-06-10T20:29:04.123000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I've made my position clear, and I don't think it's an unreasonable ask.  I am going to disengage until a second party actively supports this position.",
        "created_at": "2024-06-10T20:29:16.355000+00:00",
        "attachments": null
    },
    {
        "author": "fivedogit",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Anybody know how to get in touch with Peter Borah? ðŸ˜‚",
        "created_at": "2024-06-10T20:29:52.401000+00:00",
        "attachments": null
    }
]
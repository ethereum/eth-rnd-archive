[
    {
        "author": "wjmelements",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm trying to verify that calling a contract selfdestructs it.\nI'm surprised that, after the contract selfdestructs, `EXTCODEHASH` returns the hash of the prior code. Of course, after the transaction completes, `EXTCODEHASH` returns 0. But that's no good for me because I'm trying to check the code after selfdestruct within the same transaction, so I can revert if it didn't.",
        "created_at": "2022-01-07T02:40:24.972000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Self destruct is only applied at the end of the transaction.",
        "created_at": "2022-01-07T03:31:13.547000+00:00",
        "attachments": null
    },
    {
        "author": "wjmelements",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So, EXTCODESIZE wouldn't work then either. Is there no way for a caller to know their CALL ended in SELFDESTRUCT, or whether there is a pending destruction?",
        "created_at": "2022-01-07T04:12:42.903000+00:00",
        "attachments": null
    },
    {
        "author": "wjmelements",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Perhaps `EXTBALANCE` can be used.",
        "created_at": "2022-01-07T04:21:06.394000+00:00",
        "attachments": null
    },
    {
        "author": "wjmelements",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I have verified that the eth transfer of selfdestruct resolves immediately, so I can use EXTBALANCE for this purpose",
        "created_at": "2022-01-07T23:16:07.963000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!425274498732916736\u003e re https://ethereum-magicians.org/t/eip-2315-simple-subroutines-for-the-evm-analysis/4229/41?u=holiman . I don't understand the 'shadow map' implementation. Is it limited to handing `1024` byte long subroutines?",
        "created_at": "2020-06-02T12:25:51.060000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or rather: how do you encode a 24K long subroutine into six bits?",
        "created_at": "2020-06-02T12:26:26.929000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also, we don't have to distinguish betweej JUMPDEST?BEGINSUB in the map, since we can check that in the code before we even consult the analysis. So one bit should be sufficient, leaving 7 bits instead of 6",
        "created_at": "2020-06-02T12:30:29.647000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think I got the gist of the leb encoding now.. I think I'll try out the shadowmap alternative, with 7-bit encoding instead of 6",
        "created_at": "2020-06-02T13:01:02.231000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "True, but that requires two lookups in different arrays. On the other hand we are jumping there anyway...",
        "created_at": "2020-06-02T14:02:58.029000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I made an implementation. The speed difference of the analysis is definitely noticeable (a factor of 2-3), and that's _with_ the cap. If we don't have a cap on code, things become slower still (e.g then the LEB-encoder needs to handle larger numbers). So I would really _not_ want to roll that out without the cap",
        "created_at": "2020-06-02T15:35:44.571000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://github.com/ethereum/go-ethereum/pull/21161",
        "created_at": "2020-06-02T15:35:48.759000+00:00",
        "attachments": null
    }
]
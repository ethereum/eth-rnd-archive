[
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "okay i will draft some prs to the EIPs",
        "created_at": "2022-12-16T13:56:56.797000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I wander if container format should go to 3540 or 4750... You did it originally to 4750.",
        "created_at": "2022-12-16T13:58:08.552000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i was thinking to put it in 3540 and require 4750 from it",
        "created_at": "2022-12-16T13:58:42.502000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Sounds good to me",
        "created_at": "2022-12-16T14:00:38.902000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm a bit worried about the rigidity of this - in the future (esp post eip-663) we may want/need more inputs/outputs and i think we're increasingly against actually bumping eof versions - so this should be future compatible",
        "created_at": "2022-12-16T15:44:20.757000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "if we bound each item to 7 bits we could later add support for LEB128 or some other arbitrary-length integer format, but 128 max stack elements may be too small",
        "created_at": "2022-12-16T15:45:56.752000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "basically trying to figure out to make the happy case for the type signature to be 3 bytes (but with the generality for larger), seems like we either need to explicitly bound max stack size to 128 or introduce leb128 for max stack size in eof v1",
        "created_at": "2022-12-16T15:47:03.744000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "3 bytes packing was a joke",
        "created_at": "2022-12-16T15:48:57.969000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "still annoying that the majority of functions will not have max stack size greater than 128 so it's a wasted byte",
        "created_at": "2022-12-16T15:50:33.179000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "True. Any quick ideas how to fix it?",
        "created_at": "2022-12-16T15:51:58.616000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "we could use the high bit in max stack size to denote (0) 7-bit size or (1) 15-bit size",
        "created_at": "2022-12-16T15:53:23.184000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`ceil(max_stack_height / 8)`",
        "created_at": "2022-12-16T15:54:13.541000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and then just encode that as 1 byte?",
        "created_at": "2022-12-16T15:55:40.683000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "that could work",
        "created_at": "2022-12-16T15:55:56.813000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "seems less hacky than using the high bit",
        "created_at": "2022-12-16T15:56:07.419000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Still hacky...",
        "created_at": "2022-12-16T16:04:31.198000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Solidity may need to know about this hack in the end.",
        "created_at": "2022-12-16T16:05:25.962000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "PR to 3540, 4750, and 5450 to mainly i) update the container format as we've discussed and ii) add a validation condition so no unreachable code can pass validation: https://github.com/ethereum/EIPs/pull/6156",
        "created_at": "2022-12-16T16:43:25.228000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "PTAL!",
        "created_at": "2022-12-16T16:43:45.785000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "TODO still:\n* don't clear stack on retf / jumpf\n* introduce DEEPPOP",
        "created_at": "2022-12-16T16:44:06.028000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What happens if I use RETF but the return stack is empty?",
        "created_at": "2022-12-16T21:51:28.191000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And what is the motivation to change JUMPDEST to NOP..? Why not invalidate it?",
        "created_at": "2022-12-16T21:52:28.132000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah wait this is motivated in rationale ðŸ™‚",
        "created_at": "2022-12-16T21:52:55.933000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And this also ðŸ™‚ I should read the full EIP first",
        "created_at": "2022-12-16T21:53:30.549000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we take both 5450 and 4750, then this rule in https://github.com/ethereum/EIPs/blob/e1afcba84ddf1ae5903297218ce437f00900f6a5/EIPS/eip-4750.md#retf\n\n\u003e If data stack has more than caller_stack_height + type[code_section_index].outputs items, discards the items between caller_stack_height and top type[code_section_index].outputs items, so that there are exactly caller_stack_height + type[code_section_index].outputs items left.\n\u003e \n\nThis is not possible if we do 5450 right, since rule (1) validates:\n\n\u003e If data stack has more than caller_stack_height + type[code_section_index].outputs items, discards the items between caller_stack_height and top type[code_section_index].outputs items, so that there are exactly caller_stack_height + type[code_section_index].outputs items left.",
        "created_at": "2022-12-16T23:11:26.168000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hey guys, for the `ethereum/tests`, I have a request on the open PRs there, could it be included which commit the tests are based on (so  from `ethereum/EIPs`?) It is otherwise unknown if (1) an implementation is wrong or (2) the implementation am on the wrong version of the EIP spec (or the test is)",
        "created_at": "2022-12-16T23:50:25.078000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Thanks, \u003c@!425274498732916736\u003e.  I'm trying to interpret these results.  Imight be missing something, but where did the 100Mgas/s value come from?  And in the final table, if I'm understanding it, I can scale the 3-gas ops by their mean to find that they are consistently priced, but that JUMPDEST is underpriced at 1 gas and MUL is underpriced at 5 gas.\n```\n               Avg     Avg*3/m3g\n--------------------------------\nJUMPDEST/n0     0.40    2.14\n\nMUL/b0          1.60    8.57\nMUL/b1          1.30    6.96\n\nNOT/u0          0.50    2.68\nPUSH32/p0       0.60    3.21\nPUSH32/p1       0.70    3.75\nDUP8/d0         0.50    2.68\nDUP8/d1         0.50    2.68\n====================\nmean3gas        0.56\n```",
        "created_at": "2022-02-11T00:15:02.775000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I measured both time and CPU cycles in the same time for 4 different hardware configs (two CPUs with turbo enabled/disabled). The CPU cycles values are quite close. \nThen I picked target CPU frequency and gas rate: 2.3 GHz and 100Mgas/s. These are rather conservative in my opinion.\nBased on these measurements and picked targets I computed what the gas cost should be. For the estimated gas costs you can see min/avg/max values but they are close so this also can be ignored.",
        "created_at": "2022-02-11T20:54:04.540000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There are also different schemes to measure some instructions (e.g. \"b0\" and \"b1\"). And this is done for evmone which is ~4x faster than Geth.",
        "created_at": "2022-02-11T20:59:59.067000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The results for the worst cases of manually picked instructions:\n```\nEstimated gas cost\n------------------\nJUMPDEST       0.4\nNOT            0.5\nMUL            1.6\nPUSH32         0.7\nDUP8           0.6\n```",
        "created_at": "2022-02-11T21:00:37.600000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Those look to be almost the same as the numbers I'm using.",
        "created_at": "2022-02-11T21:02:25.371000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "My question is whether the scaling I did is a legitimate way to interpret the data?",
        "created_at": "2022-02-11T21:04:15.149000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, I copied the same numbers. I just don't understand why you need any scaling.",
        "created_at": "2022-02-11T21:30:48.357000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Rather than assume that all of our gas prices are wrong I wondered, if I assume the 3-gas opcodes are correct, how do the others compare.  I'm worried about JUMPDEST being underpriced, because the relative jumps proposal essentially assumes they don't cost anything.",
        "created_at": "2022-02-11T21:39:05.185000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is really strong assumption considering this data where JUMPDEST and NOT have similar performance but first cost 1 and the second 3.",
        "created_at": "2022-02-11T21:46:30.724000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, that is what worries me.",
        "created_at": "2022-02-11T21:47:34.688000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Anyway, this data is not really representative. I was mostly exploring \"methodology\" but it has some statistical holes. At lest you would need to repeat the process for the recent Geth.",
        "created_at": "2022-02-11T21:48:53.414000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "OK.  The scaling assumption was just to make the pattern more obvious to me -- that the 3-gas operations all are reasonable close to each other, but the  1-gas operation is way off.  I guess it will take more testing to know if there is a problem, but I could see a DoS  attach where a tight loop of relative jumps would not be charged for whatever it is that is causing JUMPDEST to be so slow.  I guess we wait on a more complete set of tests.",
        "created_at": "2022-02-11T21:57:57.211000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm not working on this any more. This is also for older evmone. In the new one this should look a bit better. And also `NOT` is really bad example because implementation is exceptionally cheap (~3 cycle of additional latency, 2 additional cycles in benchmarks).  That would be quite different if zoomed on `ADD`, `SHL` and some others.",
        "created_at": "2022-02-11T22:08:04.054000+00:00",
        "attachments": null
    }
]
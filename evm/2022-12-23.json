[
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This removes the JUMPF instruction?",
        "created_at": "2022-12-23T01:19:18.781000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think removing JUMPF while RJUMP is required to maintain the data stack invariant is problematic",
        "created_at": "2022-12-23T01:20:08.303000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There is no way to share code between sections which don't have the same number of stack items at the time of the jump",
        "created_at": "2022-12-23T01:22:47.021000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Good to me. Any objections?",
        "created_at": "2022-12-23T09:28:49.336000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "EIP-3540 change accepted. We need `CREATE` unified spec ðŸ™‚",
        "created_at": "2022-12-23T09:30:40.679000+00:00",
        "attachments": null
    },
    {
        "author": "demiurgos_23",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hi guys, in terms of Traces, is there any changes that should be added for EOF ?",
        "created_at": "2022-12-23T11:53:08.461000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i think it might be nice to also say what code section is executing?",
        "created_at": "2022-12-23T14:29:21.740000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "jumpf was moved to a separate EIP so it could depend directly on 5450 - the runtime validation that 4750 performs didnâ€™t really make sense for jumpf",
        "created_at": "2022-12-23T14:31:15.065000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://eips.ethereum.org/EIPS/eip-6206",
        "created_at": "2022-12-23T14:31:34.446000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Nice observation. Anyway, `CALLF+RETF` works as `JUMPF`.",
        "created_at": "2022-12-23T14:52:02.364000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I see, so it's still in big EOF?",
        "created_at": "2022-12-23T14:56:40.502000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There are some doubts. It works as `CALLF+RETF` except it is just cheaper. But we are collecting use cases.",
        "created_at": "2022-12-23T16:24:17.724000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "@pawel Can tail calls be optimized in one pass when compiling from code without JUMPF to code for a different (virtual or real) machine?",
        "created_at": "2022-12-23T16:44:43.091000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "To my understanding yes, but I'm still learning this. Everytime you see `CALLF RETF` next to each other this is a tail call. But you still need to check the call stack depth.",
        "created_at": "2022-12-23T16:48:35.633000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "OK.  Seems it should not impede optimized compilation _from_ EVM code.  But maybe OK if  prevents optimized compilation _to_ EVM code.",
        "created_at": "2022-12-23T16:54:34.431000+00:00",
        "attachments": null
    },
    {
        "author": "gcolvin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\"It\" being the removal of JUMPF.  A compiler _from_ EVM can trace the CFG and when it hits a CALLF RETF it generates jump code for the target machine    The first time any CALLF is hit the compiler also generates the function code.  So one pass.\n\nI don't know how a compiler _to_ EVM even expresses this.",
        "created_at": "2022-12-23T17:17:06.207000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "CALLF RETF also occupies return stack space.  With JUMPF there are a class of recursive algorithms that can be done without limit.",
        "created_at": "2022-12-23T17:20:09.133000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "there are a class of loops too that cannot be expressed with either RJUMP or CALLF. (i'm not sure if they are easily expressible from a high level language, but it would be the loop equivalent of a tail recursive algorithm between functions which don't have the same stack height invariants)",
        "created_at": "2022-12-23T17:36:24.311000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For Besu I've been adding a `section` element when section != 0:\n```\n{\"pc\":4,\"op\":176,\"gas\":\"0x2540b91f2\",\"gasCost\":\"0x5\",\"memory\":\"0x\",\"memSize\":0,\"stack\":[\"0x1\",\"0x2\"],\"returnData\":\"0x\",\"depth\":1,\"refund\":0,\"opName\":\"CALLF\",\"error\":\"\"}\n{\"pc\":0,\"section\":1,\"op\":1,\"gas\":\"0x2540b91ed\",\"gasCost\":\"0x3\",\"memory\":\"0x\",\"memSize\":0,\"stack\":[\"0x1\",\"0x2\"],\"returnData\":\"0x\",\"depth\":1,\"refund\":0,\"opName\":\"ADD\",\"error\":\"\"}\n```",
        "created_at": "2022-12-23T17:43:35.913000+00:00",
        "attachments": null
    }
]
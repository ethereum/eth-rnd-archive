[
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Not \"our\" idea. https://eips.ethereum.org/EIPS/eip-7645",
        "created_at": "2024-03-20T08:53:12.051000+00:00",
        "attachments": null
    },
    {
        "author": "draganrakita",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ty for sharing",
        "created_at": "2024-03-20T09:29:45.553000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The name `EXCHANGE` is very far away from `SWAP`. Maybe just `SWAPNM`?",
        "created_at": "2024-03-20T13:29:16.724000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And I'd like to see a real usage example of this.",
        "created_at": "2024-03-20T13:29:40.465000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://github.com/vyperlang/vyper/blob/05ec5a17b0bcfc6f4af083e264f468ed407ddb5b/vyper/venom/venom_to_assembly.py#L151-L167",
        "created_at": "2024-03-20T15:15:11.156000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it was originally named SWAPNM but the rename was suggested here https://ethereum-magicians.org/t/eip-663-unlimited-swap-and-dup-instructions/3346/48",
        "created_at": "2024-03-20T15:17:14.969000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This does not explain why you need it.",
        "created_at": "2024-03-20T15:18:22.304000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it's to reduce stack traffic",
        "created_at": "2024-03-20T15:18:55.758000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i don't really know how to explain it at this point besides, \"try writing a stack scheduler\" -- you run into the need for it when you need to schedule a stack item for last-use that is somewhere besides the top of stack",
        "created_at": "2024-03-20T15:20:20.112000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Does solidity have the same issues?",
        "created_at": "2024-03-20T15:22:17.905000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i don't know in detail, it sounds like, yes it would help their stack scheduler, but their biggest pain point is they are not able to come up with a general algorithm to spill from stack to memory, which is why they want SWAP_N",
        "created_at": "2024-03-20T15:26:58.526000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The SWAPN is fine ðŸ™‚ I just don't see direct need for EXCHANGE. Is there a way to give an example of a sequance of instructions where it helps?",
        "created_at": "2024-03-20T15:28:46.949000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`SWAP2 SWAP3 SWAP2` can be replaced by SWAP_2_3",
        "created_at": "2024-03-20T15:30:01.192000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ok, something that has side effects outside of EVM stack ðŸ™‚ or at least produces a desired value on the stack.",
        "created_at": "2024-03-20T15:32:28.733000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "maybe a longer example is like `JUMPDEST SWAP2 SWAP3 SWAP2 MULMOD`",
        "created_at": "2024-03-20T15:35:26.923000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "you can be passed stack variables in the \"wrong\" order at a jumpdest, but then you need to reorder them for the instructions that come next",
        "created_at": "2024-03-20T15:36:06.301000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "you don't need multi-argument instructions necessarily either :), like `JUMPDEST SWAP2 SWAP3 SWAP2 SUB SUB` i think also illustrates the same thing",
        "created_at": "2024-03-20T15:37:35.675000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Can't you produce them in different order in the block you jump from?",
        "created_at": "2024-03-20T15:40:01.359000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i mean, blocks are mostly only useful when they are multiple-entry ðŸ™‚",
        "created_at": "2024-03-20T15:40:31.504000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so two parent blocks can produce them in different orders",
        "created_at": "2024-03-20T15:40:48.032000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this is especially clear when you implement function calls -- the function call can accept arguments in any order",
        "created_at": "2024-03-20T15:41:05.173000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, this is a bit my issue. The calling convention is the only example that comes to my mind where this cannot be optimized by other means. But in EOF we have special instructions for functions...",
        "created_at": "2024-03-20T15:43:35.162000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i think it can happen any time you have multiple-entry blocks really",
        "created_at": "2024-03-20T15:44:26.456000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(and not necessarily those you can see from user code, like weird loop algorithms which produce weird CFGs)",
        "created_at": "2024-03-20T15:44:47.610000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but dedicated function calling instructions don't really help with the problem either",
        "created_at": "2024-03-20T15:45:12.662000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "a really simple one is\n```\nif cond:\n    a, b = \u003csome fenced expr\u003e\nelse:\n    b, a = \u003csome fenced expr\u003e\n```",
        "created_at": "2024-03-20T15:46:00.417000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "your hands are tied here because you cannot \"fix\" the ordering of production of `a` and `b` due to fencing",
        "created_at": "2024-03-20T15:46:31.511000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so you _must_ produce them out of order (compared to what the consuming block wants)",
        "created_at": "2024-03-20T15:46:46.464000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ah yes, my memory about this is coming back online -- when you consider fencing, there are cases within a single block which produce stack items out of order",
        "created_at": "2024-03-20T15:59:48.564000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "coming to the call in 3 mins",
        "created_at": "2024-03-20T16:00:29.285000+00:00",
        "attachments": null
    },
    {
        "author": "big_tech_sux",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "e.g.\n```\n%call ...\n%1 = mload \u003cfrom output buffer\u003e\n%call ...\n%2 = mload \u003cfrom output buffer of second call\u003e\n%3 = div %2, %1 // or %1, %2; i don't remember the ordering convention\n```",
        "created_at": "2024-03-20T16:02:16.589000+00:00",
        "attachments": null
    },
    {
        "author": "draganrakita",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "About return code for extcall, what do people think about having:\n0 - ok\n1 - revert\n2 - light failure (not all gas is spent, `CallTooDeep`, `OutOfFunds`)\n3 - system failure (all subcall gas is spent, `OutOfGas`, `StackOverflow`, etc.)",
        "created_at": "2024-03-20T16:55:21.386000+00:00",
        "attachments": null
    },
    {
        "author": "pdobacz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Today's EOF Implementers call short summary:\n- client team updates: various EIPs getting implemented / are in-review. Status should be reflected by https://github.com/ipsilon/eof/blob/main/spec/implementation_matrix.md\n- compiler teams no updates\n- spec updates: various EIPs PRs in review. Also a [change to the EXT*CALLs failure mode of the MIN_CALLEE_GAS check](https://github.com/ethereum/EIPs/pull/8287/commits/743a3fb41ed4c16d26087ecd03f901af27db0397), but that's **subject to discussion and possibly change** see next points\n- the EXT*CALL instruction new status codes (currently \"0-ok, 1-light failure (call depth check, min callee gas check, balance check) or revert in callee frame, 2-hard failure (static mode check) or exceptional abort in callee frame\") have been discussed and there are still issues with.\n- an idea to properly visualize current logic and rules for old and new CALLs was raised and we're planning to open an issue or hackmd to discuss this",
        "created_at": "2024-03-20T17:07:18.939000+00:00",
        "attachments": null
    },
    {
        "author": "poojaranjan",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "**EOF Implementers Meeting 38** \nhttps://youtu.be/bjcTxsTWd4w",
        "created_at": "2024-03-20T19:33:52.218000+00:00",
        "attachments": null
    }
]
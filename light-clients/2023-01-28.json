[
    {
        "author": "uink45",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "In the case where the sync committee produces a single fraudulent block header for a particular slot, assuming the block proposer is honest, would they not accept the fraudulent sync committee contributions? And, even if the block proposer is not honest, then by including those contributions then the network will reject the proposed block because when they process the `sync_aggregate` they will be unable to reconstruct the signing root that the malicious sync committee produced (the network will need the fraudulent block header in its head state)?",
        "created_at": "2023-01-28T02:33:34.304000+00:00",
        "attachments": null
    },
    {
        "author": "uink45",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I was also wondering about the case where an application requests the `finality_branch` in order to check if the light client has stored `finalised_header` that has been part of the Beacon Node's state, however, if the `finality_branch` is different then it won't be able to verify that.",
        "created_at": "2023-01-28T02:38:48.990000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "The sync committee does not produce block headers. Its members signs CL block roots.\nAn honest block proposer builds on top of a fully validated chain, so can only include sync contributions signing the (validated) parent block.\nThe state transition function rejects blocks that do not follow validity requirements.\n\nThe attacks discussed here are about sync committee signing blocks that are not part of the canonical chain, with signatures that are never included onto the canonical chain.\nA light client cannot distinguish such malicious signatures from canonical ones.\n\nAs far as the light client libp2p endpoints are concerned, they sort of suffer from the same issue, as they track the best update found so far. There may be an update that ranks better than the best canonical one. However, the full node specification contains language forbidding providing or propagating any updates that are not part of the canonical chain as selected by fork choice.",
        "created_at": "2023-01-28T09:28:05.605000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "The `finality_branch` is not included in `LightClientStore`. How can an application request it?\nThere are cases where `store.finalized_header` does not match `post_state(store.optimistic_header).finalized_checkpoints.root`, btw.\nNamely, after initial bootstrap and after manual override through force update, `store.finalized_header` will match `store.optimistic_header`,",
        "created_at": "2023-01-28T09:30:18.566000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Or, also, after a re-org. `store.finalized_header.slot` will always increase, but `block(post_state(store.optimistic_header).finalized_checkpoints.root).slot` can decrease.",
        "created_at": "2023-01-28T09:31:33.181000+00:00",
        "attachments": null
    },
    {
        "author": "uink45",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Right, however, if a sync committee wanted to sign a fraudulent block header (assuming all members are malicious), they would need to agree on which fraudulent block header they want to sign. They would all need to have the fraudulent block header in their storage in order to generate its hash tree root before signing it.",
        "created_at": "2023-01-28T09:31:57.605000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Sure, if they are malicious, they can just make up some own chain, sign it, and distribute those signed messages to clients (who will then switch to the malicious chain).\nThe libp2p network, and honest REST servers won't serve those malicious messages, but they could be produced and distributed out of band.",
        "created_at": "2023-01-28T09:34:11.497000+00:00",
        "attachments": null
    },
    {
        "author": "uink45",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Right that makes sense!",
        "created_at": "2023-01-28T09:34:45.404000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "btw, tested and fixed Nimbus for capella support. If you want to play with it on devnets, image shows sample format. \nPass custom config directory from current https://github.com/ethpandaops/withdrawals-testnet as `--network` (many of those are short-lived).",
        "created_at": "2023-01-28T12:02:54.379000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "be95b0001460fb581aea89525a7f16a6d76953af21f49aa92a230f34ba25d864"
            }
        ]
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "(with caveat that the `transactions_root` and `withdrawals_root` are incompatible with the ones in EL block header. See \u003c#779922457631916064\u003e discussion)",
        "created_at": "2023-01-28T12:03:53.152000+00:00",
        "attachments": null
    },
    {
        "author": "ncitron",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Hi all! I've opened a PR to the execution-apis repo detailing a new RPC method that will make it more efficient for light clients to prove a transaction receipt's correctness. Would appreciate any feedback.\nhttps://github.com/ethereum/execution-apis/pull/372",
        "created_at": "2023-01-28T21:58:12.637000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "There are ongoing discussions to change `receiptsRoot` from a Merkle-Patricia trie to an SSZ tree with Deneb/Cancun (the next hard fork).\nWould be great to standardize after that conversion hits.",
        "created_at": "2023-01-28T22:02:41.007000+00:00",
        "attachments": null
    },
    {
        "author": "ncitron",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Oh interesting. Why use ssz trees? It feels a bit weird given everything else on the execution layer is an mpt",
        "created_at": "2023-01-28T22:04:40.231000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "The idea is to get rid of all the MPTs (except `state` which will move to a verkle trie over time).",
        "created_at": "2023-01-28T22:06:22.932000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "See \u003c#779922457631916064\u003e",
        "created_at": "2023-01-28T22:06:26.779000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "SSZ trees are easier to prove, and easier to verify (e.g., in a zk circuit)",
        "created_at": "2023-01-28T22:07:12.804000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "It also eliminates the disparity between CL `ExecutionPayload` and EL block structure",
        "created_at": "2023-01-28T22:12:06.195000+00:00",
        "attachments": null
    },
    {
        "author": "ncitron",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Makes sense. I'll add a comment to the PR to mention this. Agree it's better to wait until those changes land.",
        "created_at": "2023-01-28T22:12:19.989000+00:00",
        "attachments": null
    }
]
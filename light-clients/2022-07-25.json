[
    {
        "author": "shresth",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "\u003c@881905303011086387\u003e are the sync updates transferred as JSON objects between the fullnode and lightclient? or there is some serialisation for efficiency ?",
        "created_at": "2022-07-25T14:40:05.061000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Over libp2p? It's just compressed snappy SSZ frames. Over REST? That's not standardized yet but the proof of concepts use JSON for now. SSZ would be good as an additional choice but is tricky as the response may contain multiple objects from different forks",
        "created_at": "2022-07-25T14:43:24.163000+00:00",
        "attachments": []
    },
    {
        "author": "shresth",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "can you elaborate what you mean by \"is tricky as the response may contain multiple objects from different forks\"",
        "created_at": "2022-07-25T14:44:35.636000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "https://github.com/ethereum/beacon-APIs/pull/181#issuecomment-1172910910",
        "created_at": "2022-07-25T14:45:28.013000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "https://github.com/ethereum/beacon-APIs/issues/167 (but this doesn't help for array responses and event streams)",
        "created_at": "2022-07-25T14:45:47.215000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "There are multiple ways to do it, still debating on what's best.\n\n– HTTP chunk extensions, to annotate each chunk with the correct fork. Downside: HTTP libraries don't really support that, and it's not intended for such metadata.\n– Multiple HTTP headers to describe the fork, one for each chunk. Downside: Needs to write all headers before the first body, may waste server memory to build such a response.\n– Simply concatenating the individual response items. Downside: Need to lock `attested_header.slot` to be the first item forever, and is not generally applicable, e.g., states use a different offset for slot / current_fork.\n– Interleaving the individual response items with forkDigest / length. Downside: Can no longer just process the HTTP response as a `LightClientUpdate` due to the leading extra data\n– ...",
        "created_at": "2022-07-25T14:49:29.082000+00:00",
        "attachments": []
    },
    {
        "author": "shresth",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I still don't understand why elements could from different forks if its SSZ serialised and not if they are JSON?",
        "created_at": "2022-07-25T14:52:17.486000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Ah, they can also do that on JSON, but for JSON the existing solution already works well",
        "created_at": "2022-07-25T14:52:38.038000+00:00",
        "attachments": []
    },
    {
        "author": "shresth",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "How do we handle it for JSON?",
        "created_at": "2022-07-25T14:53:17.248000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "https://github.com/ethereum/beacon-APIs/blob/master/apis/beacon/blocks/block.v2.yaml\nJSON includes a `version` field",
        "created_at": "2022-07-25T14:53:18.369000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "So, if the response is a list, each item could just include that",
        "created_at": "2022-07-25T14:53:30.832000+00:00",
        "attachments": []
    },
    {
        "author": "etan_status",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "But, the proof-of-concept light client endpoints don't include that yet, but that's trivial to add. It's better to combine this with the SSZ support, instead of breaking the API multiple times, hence it's just kept as is for now.",
        "created_at": "2022-07-25T14:54:12.742000+00:00",
        "attachments": []
    },
    {
        "author": "shresth",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I see",
        "created_at": "2022-07-25T14:56:11.209000+00:00",
        "attachments": []
    },
    {
        "author": "shresth",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "thanks for the response, I feel I have a better understanding now",
        "created_at": "2022-07-25T14:56:30.262000+00:00",
        "attachments": []
    }
]
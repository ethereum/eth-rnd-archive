[
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Has there been any thought/consideration on whether it is possible to make the ETH yields from staking withdrawable via ZK proofs of some kind that would allow people to withdraw to a fresh account that is unlinked to the validator?",
        "created_at": "2022-08-17T12:57:54.562000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "you want a zk proof that some eth can be withdrawn but it is not clear from which validator?",
        "created_at": "2022-08-17T13:41:25.480000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "i think the set of validators is small enough that it will be hard to provide any privacy on withdrawals",
        "created_at": "2022-08-17T13:41:55.188000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Yeah, that would be ideal.",
        "created_at": "2022-08-17T13:43:17.906000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "yes but the anonymity set is too small for that to be helpful",
        "created_at": "2022-08-17T13:43:43.672000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Why do you think it would be too small?",
        "created_at": "2022-08-17T13:43:51.550000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Do we have a rough estimate of how many individual actors are staking?",
        "created_at": "2022-08-17T13:44:10.173000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "bc there will only be like 16 withdrawals happening at a given time over a set of roughly ~500k",
        "created_at": "2022-08-17T13:44:24.121000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Ah, your concern is that exits and withdraws will be temporally close to each other, thus one can correlate exits with withdraws?",
        "created_at": "2022-08-17T13:45:07.327000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "not even correlation",
        "created_at": "2022-08-17T13:45:20.830000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "it will be 1:1",
        "created_at": "2022-08-17T13:45:24.442000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "You can exit without withdrawing though right?",
        "created_at": "2022-08-17T13:45:36.434000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "One can imagine that if there was a mechanism for withdrawing anonymously people may choose to exit and then wait before withdrawing.",
        "created_at": "2022-08-17T13:45:48.026000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "not really",
        "created_at": "2022-08-17T13:45:49.120000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Hmm, you can exit today though and you *cannot* withdraw today.",
        "created_at": "2022-08-17T13:46:00.444000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "This implies to me that one can exit without withdrawing.",
        "created_at": "2022-08-17T13:46:08.671000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Or is the tentative plan to remove that ability once withdraws are implemented?",
        "created_at": "2022-08-17T13:46:19.603000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Withdrawals are triggered automatically if the validator meets the correct state (i.e. is withdrawable and has a destination for the funds).",
        "created_at": "2022-08-17T13:46:27.446000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "so technically but it’s not the preferred route",
        "created_at": "2022-08-17T13:46:27.835000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "eg future guidance will be to set an EL address",
        "created_at": "2022-08-17T13:46:50.138000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "The only reason that validators don't withdraw today is that the functionality is not in place.  They are sitting in the \"withdrawable\" state and once the protocol is updated to handle it, they will withdraw according to the spec.",
        "created_at": "2022-08-17T13:47:07.569000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Hmm, I see.  Well, if we wanted to provide anonymity on withdraws then we would need to make it so withdraws were separate from exits.",
        "created_at": "2022-08-17T13:47:10.278000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "then privacy-wise it’s just like depositing or withdrawing from any other smart contract",
        "created_at": "2022-08-17T13:47:12.136000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "So we would both need to make it so withdrawing requires submitting a \"proof of being in withdraw queue\", and we would need to make it so that the withdraw queue isn't pumped automatically.",
        "created_at": "2022-08-17T13:48:02.271000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "In theory there could be a `0x02` withdrawal credential that batched up a bunch of withdrawals in to a proof to attempt to provide privacy, but not sure how the rest of the components would make it on to the chain to build the proof.",
        "created_at": "2022-08-17T13:48:19.514000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "and i would guess the anonymity set is too small in those schemes to be helpful",
        "created_at": "2022-08-17T13:49:05.063000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "FWIW I'm not proposing we build something like this prior to withdraws being implemented.  I'm trying to think long term if it is possible/reasonable to enable anonymity of staker withdraws (and maybe deposits too).",
        "created_at": "2022-08-17T13:49:26.220000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "sure",
        "created_at": "2022-08-17T13:49:41.163000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "One could imagine people depositing without any intention of staking, only to help build the anonymity set and to eventually withdraw anonymously.",
        "created_at": "2022-08-17T13:49:55.465000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "and i would also strongly oppose putting more than the minimum amount of complexity into the base CL",
        "created_at": "2022-08-17T13:50:05.780000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Consensus Layer",
        "parent": "",
        "content": "they could",
        "created_at": "2022-08-17T13:50:18.408000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Yeah, I think that is a fairly reasonable argument.  However, I am starting to lean more and more toward anonymity needing to be in the base layer these days.",
        "created_at": "2022-08-17T13:50:38.307000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "And that privacy is worth the complexity.",
        "created_at": "2022-08-17T13:50:49.512000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I'm not super hard-lined on that for Ethereum at the moment, but I do think it is something that we should be considering and evaluating at least.",
        "created_at": "2022-08-17T13:51:10.800000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Being able to withdraw to an arbitrary address hidden behind a ZK-proof provides the ability for issued (non-tainted) ETH to be made available to new addresses, which certainly is of interest.  Not sure about deposits and validator operations, though, because validators are only really pseudo-anonymous at best (as per thread in other channel regarding tracking validator operations, let alone all of the footprints left by client implementations, propagation delays and more).",
        "created_at": "2022-08-17T13:52:51.463000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "My initial thinking here would be something like:\nValidator can deposit from an ETH1 account but the new validator public key wouldn't be directly associated with the deposit, it would just be that now there exists a valid validator key that didn't exist before.\nWhen validating, you would prove that you are allowed to validate (you have a deposit/enter and you don't have an exit) but you wouldn't reveal your key or the deposit address.\nWhile validating, your validation would all be just pseudoanonymous like now, so your performance would be tracked as it is today.\nWhen you exit, you go into a withdraw queue.\nWhen you exit, you submit a proof that you are in the withdraw queue and haven't exited yet but you wouldn't state which validator you were.  We would need to make it so you can split your withdraws into pieces and choose not to withdraw all at once.",
        "created_at": "2022-08-17T13:57:27.211000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Plus some other features like the ability to declare a withdraw address at deposit time (and maybe update it as well) such that the validator cannot withdraw to an arbitrary address (provides users security in that they can define a contract as their withdraw address rather than an EOA).",
        "created_at": "2022-08-17T13:58:28.038000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I suspect that anything like that would blow up the size of the beacon chain. It's only as small as it is due to attestation aggregations, and they require to know which committee members have voted for what and that all ties back to the validator's public key and signatures based on the related private key.  Anything proof system would, as far as I am aware, make it impossible to aggregate votes and would make the chain non-viable in terms of running on anything other than top-end hardware with 10s of TB of disk.",
        "created_at": "2022-08-17T14:01:06.568000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Arguing for keeping the state size small is certainly reasonable.  I wonder if there is any magic we can do to aggregate this state somehow so it doesn't need to be grow unboundedly?",
        "created_at": "2022-08-17T14:10:06.105000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm about to do a scan of recent blocks to collect some stats re code merkelization, while I'm here is there additional data that people want me to collect? My plans so far:\n- For each block record the total size of all the contract bytecodes which are executed (except initcode, since that'll already be paid for)\n- For each block record the total number of contract bytecode bytes which are actually executed\n- The same, but instead of drilling down by block, drill down by contract bytecode, to see if there are any contracts which routinely execute a lot of bytes (require a large witness)",
        "created_at": "2020-04-02T16:50:04.380000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Commonly used contracts in blocks (both contracts called by multiple transactions, and indirect contracts which are called by the transaction targets, such as libraries or tokens).",
        "created_at": "2020-04-02T17:07:22.082000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Currently I'm logging, for each block, the list of contracts which were used, so that'll be easy to report!",
        "created_at": "2020-04-02T17:09:12.994000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Do you plan to record the actually used number of bytes (instructions) for those as well? Not just the tx targets?",
        "created_at": "2020-04-02T17:10:01.359000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I assume you plan to record all these for \"the list of contracts which were used\". That should be a good dataset.",
        "created_at": "2020-04-02T17:11:48.497000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "",
        "created_at": "2020-04-02T17:12:04.251000+00:00",
        "attachments": [
            {
                "type": "",
                "origin_name": "Selection_124.png",
                "content": "38fddeea900bfaebff681683538541cd7a73fb62bb9ce32655fc2a9648b31a8d"
            }
        ]
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`0xdc41...`, etc are EOAs?",
        "created_at": "2020-04-02T17:13:02.809000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So far I've got this ^ \n\nI'm recursing into all the subcalls, so \"reads\" and \"total_code_size\" for the transactions and for the block summary include every contract bytecode which is executed (except for initcode)",
        "created_at": "2020-04-02T17:13:03.192000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I assume so",
        "created_at": "2020-04-02T17:13:26.178000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I mean those with 0 reads",
        "created_at": "2020-04-02T17:13:29.614000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, it looks like it: https://etherscan.io/address/0xdc41bfacfaaf8b0f0949ab5a3f18f47063ae62fb",
        "created_at": "2020-04-02T17:13:59.671000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Interesting side note: targets of `coinbase` and `selfdestruct` are not executed. Those should not be needed to be provided in the witness. Did anyone think about these edge cases?",
        "created_at": "2020-04-02T17:17:24.430000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Their code is not needed, but their account may be if it had a balance.",
        "created_at": "2020-04-02T17:18:04.083000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!296630428754771968\u003e maybe also record accounts which are targets of those two in a block and are never executed",
        "created_at": "2020-04-02T17:19:08.698000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "IIInteresting, I didn't realize coinbase txns don't execute any code, though it makes sense",
        "created_at": "2020-04-02T17:20:00.808000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I *think* those will show up as addresses with code but zero reads, but it's worth checking before I start this thing running",
        "created_at": "2020-04-02T17:20:22.332000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Although, `selfdestruct` will have some reads, won't it? We need to read the `selfdestruct`!",
        "created_at": "2020-04-02T17:21:13.464000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In the caller yes, but the callee of the selfdestruct is not executed.",
        "created_at": "2020-04-02T17:23:25.832000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Maybe what you want to record is the kind of \"touch\" each account receives: tx target, coinbase, selfdestruct, call, callcode, delegatecall, staticcall, extbalance, extcodehash, extcodesize.",
        "created_at": "2020-04-02T17:24:31.183000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm still a little confused about the `selfdestruct`. You're talking about the case where I do a callcode and then the other contract's code calls `selfdestruct`?",
        "created_at": "2020-04-02T17:25:29.553000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The destination of `selfdestruct`, who receives the balance, is not executed. The contract in which `selfdestruct` is running *is* executed.",
        "created_at": "2020-04-02T17:27:17.173000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ahhh",
        "created_at": "2020-04-02T17:27:48.500000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I like the idea of recording why an account was included in this list. You also just made me realize that I'm not recording `extcodesize` calls",
        "created_at": "2020-04-02T17:30:43.507000+00:00",
        "attachments": null
    },
    {
        "author": "__lithp__",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oops, I also wasn't recording reads caused by `extcodecopy`, thanks for the help!",
        "created_at": "2020-04-02T17:37:36.907000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Well and also create/create2 :)\n\nBecause those definitely don't need to be submitted",
        "created_at": "2020-04-02T17:39:23.392000+00:00",
        "attachments": null
    }
]
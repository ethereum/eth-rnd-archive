[
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Assuming there are no empty accounts on Mainnet, can we ditch the account \"touching\" introduced in Spurious Dragon?",
        "created_at": "2022-09-08T15:41:56.199000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You should *definitely* talk to \u003c@243183686562873344\u003e in \u003c#856943705209569291\u003e.",
        "created_at": "2022-09-08T16:02:35.922000+00:00",
        "attachments": null
    },
    {
        "author": "jlokier",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Assuming that ELs still need to be able to execute historical blocks from genesis, so the code for touching has to be present, what's the benefit of removing it in a more recent spec?",
        "created_at": "2022-09-08T16:06:20.905000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Empty accounts existed on Mainnet up until https://etherscan.io/tx/0xf955834bfa097458a9cf6b719705a443d32e7f43f20b9b0294098c205b4bcc3d, which is fairly recent.",
        "created_at": "2022-09-08T16:06:42.824000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If you write a post-merge only client, you don't have to implement empty account handling at all.",
        "created_at": "2022-09-08T16:07:44.987000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The more interesting thing to note is that clearing empty accounts has quite a lot of complex edgecases, most of which never occured (e.g. no one ever cleared an account with `STATICCALL`).",
        "created_at": "2022-09-08T16:09:05.190000+00:00",
        "attachments": null
    },
    {
        "author": "jlokier",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "As it happens, I am writing a post-merge only client ðŸ™‚ but it still feels like being able to verify state from genesis has some value.  Is there an intention to move away from that being a thing people can easily do?",
        "created_at": "2022-09-08T16:10:17.392000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We could potentially delete all the empty account testcases and say the only requirement is that you can sync historical blocks. If we do nothing we will end up with pointless Shanghai empty account tests, for example.",
        "created_at": "2022-09-08T16:11:00.506000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "No, but it is an option that is likely to be taken increasingly seriously. If you choose not to implement state verification from genesis you will save yourself a reasonable amount of implementation work.",
        "created_at": "2022-09-08T16:12:22.384000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Syncing from genesis is likely to get increasingly hard especially if statelessness allows us to increase state size significantly.",
        "created_at": "2022-09-08T16:14:30.714000+00:00",
        "attachments": null
    },
    {
        "author": "jlokier",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It would be a big change from how the testsuite currently works, for it to stop being sufficient to validate EVM corner cases for all known blocks. That would mean any EL with a sync-from-genesis feature could only test its code in, e.g. CI-style nightly tests, by actually syncing from mainnet history every time, which will also become more difficult with time.  Or the code will go untested.  I would advocate for keeping the tests but moved to a \"historical\" section of the testsuite in that case.",
        "created_at": "2022-09-08T16:15:43.058000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Do the tests not have blocks associated with them?",
        "created_at": "2022-09-08T16:17:33.037000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There is behavior changes depending on the block, so it seems like tests *must* have blocks they apply to?",
        "created_at": "2022-09-08T16:17:55.505000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I would remove any testcase that had empty accounts and was Byzantium onwards. I would then explicitly add the two transactions that involved empty accounts since Byzantium as test cases.",
        "created_at": "2022-09-08T16:18:11.834000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Each test is duplicated for each fork",
        "created_at": "2022-09-08T16:18:22.769000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah, I see.",
        "created_at": "2022-09-08T16:18:32.536000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So we should remove the empty account handling test cases for forks after this block?",
        "created_at": "2022-09-08T16:18:51.461000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think that should be straightforward. Just add `\u003c=London` requirement to those tests.",
        "created_at": "2022-09-08T16:20:44.563000+00:00",
        "attachments": null
    }
]
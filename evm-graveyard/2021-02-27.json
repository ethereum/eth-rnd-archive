[
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I believe \u003c@!329594653097721856\u003e is arguing that it should become an invalid opcode and revert/assert essentially.",
        "created_at": "2021-02-27T04:54:27.987000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "My counter to that is that `SENDALLETH` does a subset of what `SELFDESTRUCT` does, and there is value in adding a `SENDALLETH` opcode, so it is strictly better (IMO) to have `SELFDESTRUCT` become `SEND_ALLETH` than to make `SELFDESTRUCT` assert and then add a new opcode for `SENDALLETH`.",
        "created_at": "2021-02-27T04:55:41.232000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It will make it so people who are using `SELFDESTRUCT` today to sweep an account will still be able to do so (at higher gas cost), so we will break fewer people.",
        "created_at": "2021-02-27T04:56:37.600000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I would support a layered approach.  For one fork or so both SELFDESTRUCT and SENDALLETH work, and solidity exposes their sendalleth mapping and marks selfdestruct as a lint error.  After a transition period either selfdestruct becomes an invalid call, a no-op, or a SENDALLETH.  For the last option we would want to add contract scanning code that would make _new_ deployments with SELFDESTRUCT fail.",
        "created_at": "2021-02-27T16:21:21.345000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But what's tricky is that eth has never removed an opcode or precompiled contract, so it's unexplored territory.",
        "created_at": "2021-02-27T16:21:58.697000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Maybe the cost of a SELFDESTRUCT could be increased to a higher cost.  Combine this with the option of SENDALLETH, eliminating refunds, and Solidity lint errors we will get _mostly_ there.  But the state delete still poses a verkle trie risk.",
        "created_at": "2021-02-27T16:23:23.334000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Sharing for visibility: https://ethereum-magicians.org/t/eip-3300-phase-out-refunds/5434\n\nAlternative to straight up removing refunds, which reduces their amount over ~1 year",
        "created_at": "2021-02-27T17:32:58.169000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Basically GasToken holders upset that they won't abuse the network anymore\n\nBoo hoo",
        "created_at": "2021-02-27T18:49:13.092000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think a gradual incentive to clear out the inventory is better than a deadline and the preceding fire sale. I expect we would see more state cleanup in the gradual scenario.",
        "created_at": "2021-02-27T18:55:07.926000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I do think we should get it, and then reGenesis done as soon as possible",
        "created_at": "2021-02-27T18:59:53.914000+00:00",
        "attachments": []
    },
    {
        "author": "evanvanness",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "why do you think so?   my intuition is we get more cleanup if it's not phased out",
        "created_at": "2021-02-27T19:00:05.718000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "State size is a red herring here anyway. We should optimize it through other means anyway, for which selfdestruct phase out may be a prerequisite",
        "created_at": "2021-02-27T19:03:54.082000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So the sooner certain EVM vestiges are gone, the sooner we can do reGenesis and cut a lot of complexity from the clients",
        "created_at": "2021-02-27T19:04:51.980000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Generally agree, although 1m blocks (~1y) seems _very_ long, especially given the \"advance warning\" w.r.t. this actually hitting mainnet. IMO if we're planning to, say, have another upgrade around Q4/Q1, we should aim to have the refund at 0 by then, and then we can maybe simplify a lot of code on the next fork.",
        "created_at": "2021-02-27T19:07:38.771000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So, in other words, ~1 year from today seems fine, but not ~1 year from London hitting mainnet ðŸ˜…",
        "created_at": "2021-02-27T19:08:05.483000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Need reGenesis to simplify, mind you",
        "created_at": "2021-02-27T19:08:22.070000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We have block history to execute",
        "created_at": "2021-02-27T19:08:32.710000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I feel like \"regenesis\" is combining together multiple concepts that are best separated...",
        "created_at": "2021-02-27T19:08:50.281000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we just want clients to be able to sync from block 11m and forget about history, that's one thing",
        "created_at": "2021-02-27T19:09:09.093000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Zeroing out the state is another thing",
        "created_at": "2021-02-27T19:09:14.539000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Strictly speaking we need the first, not the second",
        "created_at": "2021-02-27T19:09:23.468000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(though I see value in both eventually)",
        "created_at": "2021-02-27T19:09:29.789000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You mean shadowing and reconstructing from witnesses?",
        "created_at": "2021-02-27T19:09:35.449000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah",
        "created_at": "2021-02-27T19:09:44.349000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, this thought occurred to me too",
        "created_at": "2021-02-27T19:10:21.313000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Actually, the merge is already a natural regenesis in the first sense of the word (forgetting all previous history, at least on the eth1 side)",
        "created_at": "2021-02-27T19:11:02.887000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Technically, first may be very quick to implement, just need to have standardized snapshot format",
        "created_at": "2021-02-27T19:11:31.313000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right, just need to put the state on bittorrent in some standard format",
        "created_at": "2021-02-27T19:11:52.418000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(I suspect it may be that turbogeth will propose one as pioneer, who knows)",
        "created_at": "2021-02-27T19:11:58.405000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We have it on bittorrent already, but it's just libmdbx database, so cannot be deterministically reconstructed",
        "created_at": "2021-02-27T19:13:13.965000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "used in our bittorrent sync",
        "created_at": "2021-02-27T19:13:38.138000+00:00",
        "attachments": []
    },
    {
        "author": "vorot93",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We do have a prototype of rlp+raw deterministic format which is geared towards batch packing and quick random access",
        "created_at": "2021-02-27T19:15:01.127000+00:00",
        "attachments": []
    }
]
[
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "How you checked out the rust implementation of Enr? \u003chttps://github.com/sigp/enr/blob/master/src/lib.rs\u003e",
        "created_at": "2025-02-06T15:10:14.829000+00:00",
        "attachments": null
    },
    {
        "author": "dawid_sz",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Checking it right now. I see that their use a random seed when signing, Iâ€™m not yet sure how to replicate it in Zig.",
        "created_at": "2025-02-06T15:11:31.131000+00:00",
        "attachments": null
    },
    {
        "author": "dawid_sz",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "`sign_v4` uses OsRng but I'm not sure what OsRng does by default: https://github.com/sigp/enr/blob/master/src/keys/k256_key.rs#L33",
        "created_at": "2025-02-06T15:13:06.693000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "https://docs.rs/signature/2.2.0/signature/trait.RandomizedDigestSigner.html#tymethod.try_sign_digest_with_rng",
        "created_at": "2025-02-06T15:18:00.445000+00:00",
        "attachments": null
    },
    {
        "author": "dawid_sz",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Okay, so OsRng is a CSPRNG. I can create one in Zig, but need seed and if I use `std.posix.getrandom` I get a different signature each time (expected I guess, but then not sure why Rust library uses OsRng...). \n\nAnyways, I checked RLP again and it's correct. It's `[seq, k, v, ...]` just as the spec say. I supply the same private key as found in the spec and generate KeyPair (Zig exposes Signer through KeyPair). The public key in the KeyPair is same as in record's `secp256k1` field. So, RLP and keys are correct. I cannot understand why I keep getting different signature...",
        "created_at": "2025-02-06T15:45:23.748000+00:00",
        "attachments": null
    },
    {
        "author": "dawid_sz",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "I'm using Zig standard library to sign it (and verify - this part works): `std.crypto.sign.ecdsa.Ecdsa(secp256k1, keccak256)` -- I don't see anything fancy in ENR spec so I think the standard library should be able to do the job",
        "created_at": "2025-02-06T16:35:26.372000+00:00",
        "attachments": null
    }
]
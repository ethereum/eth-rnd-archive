[
    {
        "author": "acolytec3",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!360491619402776577\u003e follow-up question, if a node gets a `NEW_BLOCK` announcement where the block's parent hash doesn't match the current tip of the node's local instance of the chain (so presumably the node has fallen behind whichever peer made the announcement), how does geth handle this today?  Does it still re-broadcast it to other peers following the devp2p guidelines (some small percentage of peers get NEW_BLOCK once the header is validated and then the rest of the peers get NEW_BLOCK_HASHES)?",
        "created_at": "2021-09-08T19:40:06.708000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm not 100% sure but from what I read in the code geth does the following:\n- discard the block if too many blocks were sent from a peer (dos)\n- discard the block if it is too old or too new (more than 7 blocks old or more than 32 blocks newer than current head)\n- if we don't have the parent anywhere in the db -\u003e abort\n- verify the header (pow check)\n- broadcast the block\n- try to actually execute the block \n- properly announce the block",
        "created_at": "2021-09-08T19:56:30.685000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "most of the logic can be found in eth/fetcher/blockfetcher.go:786 and eth/handler.go:434",
        "created_at": "2021-09-08T19:57:49.706000+00:00",
        "attachments": []
    },
    {
        "author": "acolytec3",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "cool, thanks!",
        "created_at": "2021-09-08T23:31:57.399000+00:00",
        "attachments": []
    }
]
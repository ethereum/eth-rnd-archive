[
    {
        "author": "pipermerriam",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!296630428754771968\u003e that sounds like it's in the \"good news\" realm.\n\nAt our weekly call tomorrow I want to start mapping out next steps for the state network, probably with some focus on the network component itself and how we model the network.",
        "created_at": "2021-02-22T20:31:27.159000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So address by path, and this dramatically simplifies removing ~~unused~~ unreachable state?",
        "created_at": "2021-02-22T20:32:25.575000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, it allows for garbage collection that doesn't require refcounting",
        "created_at": "2021-02-22T20:32:54.158000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "That is good news!",
        "created_at": "2021-02-22T20:33:18.652000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Does that also reduce round trips while looking something up in the trie?",
        "created_at": "2021-02-22T20:34:13.199000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I don't think so, since we are addressing by `(path, node_hash)` which doesn't allow you to *jump* down into the trie since you won't know the hash of the node...",
        "created_at": "2021-02-22T20:35:00.521000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "and if we remove `node_hash` then we run into problems with de-duplicating data that is present in multiple state roots....",
        "created_at": "2021-02-22T20:35:27.888000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Oh, another thing for us to look at...  How would migrating to Verkle Tries effect our plans.",
        "created_at": "2021-02-22T20:36:49.417000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So I actually think that because each node is so wide, you probably can't practically store them in the current immutable-data-structure style, unless you make a base-16 overlay over them; you would probably have to just store the tree in-place",
        "created_at": "2021-02-22T20:39:08.413000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Which is not that hard, there's a PoC: https://github.com/ethereum/research/blob/master/generic_in_place_tree/tree.py",
        "created_at": "2021-02-22T20:39:24.176000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Can you explain what you mean by \"each node is so wide\"",
        "created_at": "2021-02-22T20:39:49.264000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Each node in a verkle tree has 256 members (or possibly more, witnesses get a bit smaller if you go up to 2048)",
        "created_at": "2021-02-22T20:40:09.033000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "got it, so the individual \"nodes\" are just large",
        "created_at": "2021-02-22T20:40:23.066000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yeah",
        "created_at": "2021-02-22T20:40:29.514000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And you don't actually _want_ to give people these nodes",
        "created_at": "2021-02-22T20:40:39.409000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Unless you're passing down the whole state",
        "created_at": "2021-02-22T20:40:48.432000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You want to give people a proof, and a proof just requires a short chain of commitments plus the proof object",
        "created_at": "2021-02-22T20:41:00.583000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "so at present, to walk down into the trie, you'd fetch all the nodes along the path, which currently in the hexary patricia trie means getting up to 15 \"extra\" sibling node hashes per node you retrieve.\n\nIIUC, in the Verkle world, that would mean getting at worst 255 \"extra\" sibling node hashes per node if we did it the \"naive\" way\n\nAnd you're saying that the \"better\" way would be each node would come back with a \"committment + proof\" that only contains the node at the index we are drilling down through (eliminating the extra 1-255 sibling nodes)?",
        "created_at": "2021-02-22T20:43:03.164000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "by fetch you mean from the network or the DB?",
        "created_at": "2021-02-22T20:47:17.082000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "from the DB you can't avoid fetching siblings, but then again, page sizes are 4 kB anyway",
        "created_at": "2021-02-22T20:47:47.961000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "from the network, the better way would be to have an explicit method to fetch the commitment+proof directly",
        "created_at": "2021-02-22T20:48:07.974000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Cool, still filling in large swaths of knowledge gaps for Verkle stuff, this helps",
        "created_at": "2021-02-22T20:48:10.030000+00:00",
        "attachments": null
    }
]
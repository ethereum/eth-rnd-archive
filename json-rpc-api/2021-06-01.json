[
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!543900561460822016\u003e have you folks started thinking about the receipt of 1559 txs? Maybe the current one is fine, but maybe it would make sense to include something like the \"effective fee\"",
        "created_at": "2021-06-01T13:10:56.574000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I mean, that can be inferred from the tx and the block's base fee",
        "created_at": "2021-06-01T13:11:07.439000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "But perhaps it should be included in the receipt too?",
        "created_at": "2021-06-01T13:11:37.114000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "Are you wanting it in the receipt object or just to be returned from the RPC?",
        "created_at": "2021-06-01T13:21:07.582000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "What is the difference?",
        "created_at": "2021-06-01T13:21:26.720000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "The original 1559 spec had effective tip as an element in the receipt object. The value was serialized and hashed into the receipt trie root. We removed it because the value can be computed. I believe it was decided to return the value via the json-rpc. Iâ€™m guess the spec doesnâ€™t have this element?",
        "created_at": "2021-06-01T13:27:12.079000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Oh, I see what you mean, it's not included at the protocol level",
        "created_at": "2021-06-01T13:55:28.307000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "And no, the spec doesn't mention the RPC at all",
        "created_at": "2021-06-01T13:55:34.338000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "ah okay i am remembering now - we were thinking of having transaction objects in the rpc return their effective gas price",
        "created_at": "2021-06-01T14:10:42.195000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "but that wouldn't include receipts",
        "created_at": "2021-06-01T14:10:48.891000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Does that make sense? You can have a tx object from a tx that is not mined, and therefore you can't know the effective gas price",
        "created_at": "2021-06-01T14:11:39.202000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think it makes more sense to have it in the receipt",
        "created_at": "2021-06-01T14:11:46.249000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I agree, receipt is where this type of information lives currently for legacy transactions.",
        "created_at": "2021-06-01T14:21:03.312000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Like logs (derived data) are in the receiipt.",
        "created_at": "2021-06-01T14:21:13.712000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "but you can't compute an effective gas price for tx if it isn't mined, because it is dependent on the block's base fee",
        "created_at": "2021-06-01T14:24:14.521000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I suspect we may all be saying the same thing.",
        "created_at": "2021-06-01T14:24:56.038000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "That's what I'm saying too? ðŸ˜…",
        "created_at": "2021-06-01T14:25:09.132000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Haha yeah",
        "created_at": "2021-06-01T14:25:14.548000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Effective gas price should be included in the `eth_getTransactionReceipt` JSON-RPC response.",
        "created_at": "2021-06-01T14:25:15.792000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "and not `eth_getTransactionBy*`?",
        "created_at": "2021-06-01T14:26:09.812000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Correct.",
        "created_at": "2021-06-01T14:26:42.577000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "`eth_getTransactionBy*` currently returns the transaction object, not derived data about the transaction's execution.",
        "created_at": "2021-06-01T14:27:03.047000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "it also returns `blockHash` and `blockNumber`",
        "created_at": "2021-06-01T14:27:32.106000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "i think it should return `effectivePrice`",
        "created_at": "2021-06-01T14:27:50.234000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yeah, it isn't 100% consistent, but *most* additional data is in the receipt.",
        "created_at": "2021-06-01T14:27:53.999000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "i don't have a strong opinion about the receipt, but there is currently no fee info in the receipt so it seems less intuitive",
        "created_at": "2021-06-01T14:28:25.744000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I wouldn't be terribly against changing the `eth_getTransactionBy*` functions to return additional data like logs and such *when available*, but currently they are pretty narrowly focused (minus a couple oddities).",
        "created_at": "2021-06-01T14:28:26.828000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "i would be for changes like that",
        "created_at": "2021-06-01T14:28:58.711000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "i think we can start with `effectiveTip` in the tx object?",
        "created_at": "2021-06-01T14:29:12.572000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "`blockHash`, `blockNumber`, `from`, `transactionIndex` are the only things that aren't actually in the hashed data of a transaction.",
        "created_at": "2021-06-01T14:29:28.153000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "`getTransactionReceipt` includes all of that plus a bunch of derived data (some of which is actually in the receipt, some which is not).",
        "created_at": "2021-06-01T14:30:03.419000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think there's no fee info right now because it wasn't needed. But if you think of the receipt as containing \"information that can only be computed after mining the tx\", like the gas used, then it makes sense to have the effective fee there",
        "created_at": "2021-06-01T14:31:00.522000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "~~A lot~~ Most of the current JSON-RPC endpoints have somewhat random/arbitrary data that was asked for or needed by developers for some task circa 2016.  I do feel that this data (effective fee) is more appropriate in the receipt, even though the transaction object is not internally consistent with its named function.",
        "created_at": "2021-06-01T14:31:51.388000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I also feel that including blockNumber/hash in the tx object was a mistake in retrospect, so I wouldn't add more stuff like that",
        "created_at": "2021-06-01T14:31:52.931000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "`from` seems ok because it's derived from the same data in the tx",
        "created_at": "2021-06-01T14:32:37.493000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "I can get on board with that one.",
        "created_at": "2021-06-01T14:32:48.234000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "updated with the `effectiveGasPrice` as a return value on `eth_getTransactionReceipt`: https://github.com/ethereum/eth1.0-specs/pull/206",
        "created_at": "2021-06-01T16:51:31.519000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "What would `eth_getBlockByNumber` return as `baseFee` for blocks before the hardfork? Options that come to mind are:\n\n1) Don't show this property\n2) Use a `baseFee` of 0\n3) Use `null`",
        "created_at": "2021-06-01T18:07:37.737000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Option 1 wouldn't be very consistent, since transactions pre-Berlin return a `type` value of 0",
        "created_at": "2021-06-01T18:09:14.276000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think using a `baseFee` of 0 makes sense (no fee is being burned), but I don't know if that could cause issues or be misleading",
        "created_at": "2021-06-01T18:09:52.261000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "i don't think transactions pre-berlin are supposed to show type value of 0?",
        "created_at": "2021-06-01T18:21:03.434000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Check this\n\n```\ncurl -s -X POST --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionByHash\",\"params\":[\"0x8cd030cb5c760d76badf6e44b87b00210219a2180f044376f2ed3041d1f7e27b\"], \"id\": 1}' URL -H 'Content-Type: application/json' | jq .result.type\n```",
        "created_at": "2021-06-01T18:23:28.696000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "This is geth youâ€™re seeing this?",
        "created_at": "2021-06-01T19:15:11.586000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yes",
        "created_at": "2021-06-01T20:38:54.585000+00:00",
        "attachments": null
    }
]
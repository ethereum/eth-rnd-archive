[
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "This has probably been discussed before, but what do you think about exposing the revert reason of a transaction somewhere (my guess is in the transaction receipt)",
        "created_at": "2021-08-20T11:05:58.098000+00:00",
        "attachments": []
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I mean, not the parsed reason string, but the returned bytes",
        "created_at": "2021-08-20T11:06:06.018000+00:00",
        "attachments": []
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "`debug_traceTransaction` includes that, but that's not always available, so tools can't rely on it",
        "created_at": "2021-08-20T11:06:22.948000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "Gas pricing on it is hard (but not impossible) if it is part of consensus.",
        "created_at": "2021-08-20T11:21:01.959000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution Layer",
        "parent": "",
        "content": "If it is just part of the JSON-RPC but not part of the receipt it means that fetching the transaction's receipt suddenly becomes much harder because either you need to store additional information for every transaction (increases state growth) or you need to re-execute the transaction (which essentially means running a trace, and has the same availability problem).",
        "created_at": "2021-08-20T11:21:48.488000+00:00",
        "attachments": []
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I see. That makes sense, thank you. Maybe `debug_traceTransaction` should have a way to only return that (since the main reason to not expose it seems to be that the result can be huge), or a new method should do that, I don't know.",
        "created_at": "2021-08-20T16:58:51.731000+00:00",
        "attachments": []
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think you can reduce the size of each item in the trace, but you can't omit the trace entirely",
        "created_at": "2021-08-20T16:59:15.897000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Execution Layer",
        "parent": "",
        "content": "Adding the revert reason as part of the transaction receipt is an optional flag that can be enabled for Hyperledger Besu (`--enable-revert-reason`).",
        "created_at": "2021-08-20T21:09:45.276000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Execution Layer",
        "parent": "",
        "content": "I'm not sure why it doesn't default to on.  My theories are size impact in storage and conformance with existing APIs by default.",
        "created_at": "2021-08-20T21:10:23.949000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Execution Layer",
        "parent": "",
        "content": "The main problem is that you need to have executed the transaction to have the revert reason, so a fast or snapshot sync would not have revert reasons prior to the pivot because the reason is not stored in the over-the-wire RLP",
        "created_at": "2021-08-20T21:16:44.852000+00:00",
        "attachments": []
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yeah, that makes sense. The reason I'm interested is because it would be nice to have a (somewhat) standard way to assert a revert reason in unit tests.",
        "created_at": "2021-08-20T22:28:58.403000+00:00",
        "attachments": []
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "So at the very least it should be supported by Hardhat and exposed by providers like Alchemy/Infura if a testing library wants to rely on that",
        "created_at": "2021-08-20T22:30:20.191000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think we were copying the API of  how one of the dev chains did it (Truffle?)",
        "created_at": "2021-08-20T23:49:21.252000+00:00",
        "attachments": []
    }
]
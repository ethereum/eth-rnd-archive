[
    {
        "author": "enchantress3669",
        "category": "Execution Layer",
        "parent": "",
        "content": "Hi everyone, I have been looking at using the state override feature provided for geth. I have a doubt and I was hoping that someone here could point me in the right direction.\n\nAdvanced geth feature state override allows us to query RPC methods in Geth by providing fake slot values for state variables.\nplease see this example to fake an ERC20 approval before making an eth_call -  https://www.libevm.com/2022/01/12/advance-geth-pt-2-stateoverrides/\nIn the above example, they use const slot = 3; for the DAI contract allowance mapping. How can I find the slot number for allowance mapping for other ERC20s?\nWe tried doing this for USDT, and via trial and error got a valid output for slot 5 (allowance mapping in USDT). So itâ€™s not the same for all tokens and it depends on the order of the variable in the deployed contract.\n\nWeb3js and ethersjs libraries provide a function called getStorageAt(), which takes a contract address and a slot number to return a Bytes32 representation of the value stored at that slot. We need a method to retrieve the slot number given the contract address and name of the state variable.\n\nReference to this question posted on Ethereum stack exchange - https://ethereum.stackexchange.com/questions/158785/how-to-find-the-slot-number-for-state-variable-overrides-in-eth-call-eth-estima",
        "created_at": "2024-01-04T09:21:47.840000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Execution Layer",
        "parent": "",
        "content": "I don't think you can generalize beyond reverse engineering (or reading the code of) each contract.  Importantly note that slots and mappings are solidity level constructs, there's _technically_ no reason why someone can't code an ERC20 contract in another language or via raw opcodes that doesn't use these concepts.  _Practically_ I've no idea if any common ERC20 contracts have taken this route though.\n\nFor solidity contracts, if you have access to the JSON output from the compiler the slot is available, see: https://docs.soliditylang.org/en/v0.8.5/internals/layout_in_storage.html#json-output\n\nTake all of the above w/ a grain of salt though, I don't actually work w/ Solidity much. :). (Also I think this question is probably off topic for this channel, though I'm not sure which channel would be better.. edit: Oh I see you also asked in \u003c#706868829900505180\u003e )",
        "created_at": "2024-01-04T16:31:06.101000+00:00",
        "attachments": null
    },
    {
        "author": "enchantress3669",
        "category": "Execution Layer",
        "parent": "",
        "content": "Thanks Ryan.. Yes I haven't managed to find a good solution yet. I did come across the link you just shared. But the storage Layout is visible in remix only for newer versions of the solidity compiler. But most of the tokens are written in early compiler versions.",
        "created_at": "2024-01-04T16:35:59.932000+00:00",
        "attachments": null
    }
]
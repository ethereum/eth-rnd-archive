[
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think you might be misinterpreting this - `withdrawals` are _always_ returned if `withdrawalsHash` is not `nil` -- `withdrawalsHash` is added by `RPCMarshalHeader`: https://github.com/ethereum/go-ethereum/blob/9842301376b4328421e8a6163f12766dfa6641f8/internal/ethapi/api.go#L1217-L1219",
        "created_at": "2023-02-08T13:46:46.897000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Execution Layer",
        "parent": "",
        "content": "Sorry my comment was a bit convoluted. I agree that geth seems to be implementing it correctly in `RPCMarshalHeader`.  I wasn't sure what client `rpc.zhejiang.ethpandaops.io` was using, but the RPC behavior of that endpoint was what seemed inconsistent at the time (see my snippet above from block `0x9402` where `withdrawals` is included even when `withdrawalsRoot` isn't.\n\n*but* it looks like `rpc.zhejiang` was updated, since if I try to request that block again now it is (IMO correctly) returned w/o `withdrawals`.  So I think everything is good now. And sure enough it seems to be running a recent version of `geth`:\n\n```\ncurl https://rpc.zhejiang.ethpandaops.io/ -H 'Content-Type: application/json' -d '{\"method\":\"web3_clientVersion\",\"params\":[],\"id\":1,\"jsonrpc\":\"2.0\"}'\n\n{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"Geth/v1.11.0-unstable-2f73f4f0-20230207/linux-amd64/go1.19.5\"}\n```\n\nI think it was your fix here that got everything to expected behavior: https://github.com/ethereum/go-ethereum/pull/26565/files#diff-c426ecd2f7d247753b9ea8c1cc003f21fa412661c1f967d203d4edf8163da344L1250",
        "created_at": "2023-02-08T19:59:18.439000+00:00",
        "attachments": null
    }
]
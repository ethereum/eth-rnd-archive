[
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!543900561460822016\u003e does some branch of geth return the `baseFeePerGas` field when calling `eth_getBlockByNumber`?",
        "created_at": "2021-06-08T16:34:20.938000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@!130156954273316865\u003e this should be available on `master` - are you not seeing it return?",
        "created_at": "2021-06-08T16:38:11.334000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Nop",
        "created_at": "2021-06-08T16:38:20.363000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Maybe I'm doing something wrong",
        "created_at": "2021-06-08T16:38:24.906000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I'll double check",
        "created_at": "2021-06-08T16:38:33.241000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Nop, not getting it",
        "created_at": "2021-06-08T16:39:39.207000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I can DM you the `genesis.json` file I'm using if that helps",
        "created_at": "2021-06-08T16:39:46.886000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "you aren't running with `--calaveras` flag?",
        "created_at": "2021-06-08T16:41:23.491000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "shouldn't matter though",
        "created_at": "2021-06-08T16:41:38.554000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "No, but I set the `londonBlock` to 0 in the genesis file",
        "created_at": "2021-06-08T16:41:49.446000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I'll try `--calaveras` anyway",
        "created_at": "2021-06-08T16:42:29.017000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "london doesn't kick in until block `500` on the testnets",
        "created_at": "2021-06-08T16:44:04.620000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "```console\n$ curl -H \"Content-Type: application/json\" -d '{\"id\": 1, \"method\": \"eth_getBlockByNumber\", \"params\": [\"latest\",false]}' localhost:9045\n{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"baseFeePerGas\":\"0x7\",\"difficulty\":\"0x2\",\"extraData\":\"0x4e65746865726d696e6420312e31302e37322d33352d6631303931646463612d709ee0a82f10562a6125a573f655f6ff010e635d5cc67fbda445383b42e81fed10e24a8908d9a7810d23ece3c711c236d4fb1c01394bcd99d65d3d39985af09901\",\"gasLimit\":\"0x1c9c380\"\n...\n\"transactionsRoot\":\"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\"uncles\":[]}}\n```",
        "created_at": "2021-06-08T16:44:37.326000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "my output",
        "created_at": "2021-06-08T16:44:41.138000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Even if I set the block to 0 in the genesis.json?",
        "created_at": "2021-06-08T16:44:58.081000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Maybe that's just being ignored for now",
        "created_at": "2021-06-08T16:45:04.305000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Anyway, I'll try that, thanks!",
        "created_at": "2021-06-08T16:45:15.337000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "are you trying to sync to a testnet or run your own?",
        "created_at": "2021-06-08T16:45:15.344000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "My own",
        "created_at": "2021-06-08T16:45:20.546000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "ah okay i see - when you start up geth it should say what block each fork is beginning on, what does it say for london?",
        "created_at": "2021-06-08T16:46:05.282000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "This?\n\n```\nINFO [06-08|13:46:39.069] Initialised chain configuration          config=\"{ChainID: 123 Homestead: 0 DAO:\n\u003cnil\u003e DAOSupport: false EIP150: 0 EIP155: 0 EIP158: 0 Byzantium: 0 Constantinople: 0 Petersburg: 0 Istanbul\n: 0, Muir Glacier: \u003cnil\u003e, Berlin: 0, YOLO v3: \u003cnil\u003e, Engine: clique}\"\n```",
        "created_at": "2021-06-08T16:46:52.785000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "what's your `geth version`?",
        "created_at": "2021-06-08T16:47:25.431000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Built from master, but:\n\n```\n$ ./build/bin/geth version\nGeth\nVersion: 1.10.4-unstable\nGit Commit: c503f98f6d5e80e079c1d8a3601d188af2a899da\nGit Commit Date: 20210608\nArchitecture: amd64\nGo Version: go1.14.7\nOperating System: linux\nGOPATH=/home/fvictorio/.go\nGOROOT=go\n```",
        "created_at": "2021-06-08T16:48:00.701000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "how are you instantiating geth? you shouldn't be seeing `YOLO v3`, that makes me think you're calling an old executable there",
        "created_at": "2021-06-08T16:49:39.020000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Ugh",
        "created_at": "2021-06-08T16:57:08.479000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yeah, I'm an idiot, sorry",
        "created_at": "2021-06-08T16:57:12.721000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "I was using the globally installed one",
        "created_at": "2021-06-08T16:57:16.435000+00:00",
        "attachments": null
    },
    {
        "author": "fvictorio",
        "category": "Execution Layer",
        "parent": "",
        "content": "Now it works, thank you and sorry for wasting your time ðŸ˜…",
        "created_at": "2021-06-08T16:57:54.107000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution Layer",
        "parent": "",
        "content": "haha all good, many times i've pulled out my hair over the same thing",
        "created_at": "2021-06-08T16:58:15.317000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "I found a tiny difference between nethermind and our JSON-RPC regarding eip-1559 transactions. \nWe reject a transaction with negative fee cap while nethermind turns it into a legacy transaction with the gas price set to tip",
        "created_at": "2021-06-08T17:49:06.227000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "Might be good to come to a consensus what to do here",
        "created_at": "2021-06-08T17:49:23.221000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@\u0026652918665943056397\u003e \u003c@!211091239112671234\u003e ^",
        "created_at": "2021-06-08T17:49:44.013000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution Layer",
        "parent": "",
        "content": "Is there a use case for a negative fee cap txn?",
        "created_at": "2021-06-08T17:53:10.519000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "No, they should not be allowed",
        "created_at": "2021-06-08T17:54:02.444000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution Layer",
        "parent": "",
        "content": "Got it, that's my intuition too ðŸ™‚",
        "created_at": "2021-06-08T17:54:16.395000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "Geth rejects all transactions where feecap is smaller than tip, but nethermind turns them into legacy tx's",
        "created_at": "2021-06-08T17:54:44.906000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution Layer",
        "parent": "",
        "content": "Ah, got it. Doesn't Nethermind's behavior contradict the constraint we added to the EIP in the last ACD? \n```\nrequire(maxFeePerGas \u003e= maxPriorityFeePerGas) # Makes sense that the total is larger than a part thereof\n```",
        "created_at": "2021-06-08T17:56:42.299000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "It should, but the others don't reject the transactions either",
        "created_at": "2021-06-08T17:57:39.961000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "It's super weird",
        "created_at": "2021-06-08T17:57:45.217000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "I'm probably wrong about something here",
        "created_at": "2021-06-08T17:57:58.682000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yeah, or the teams didn't update their implementation yet, but you would hope they did before joining Calaveras ðŸ˜…",
        "created_at": "2021-06-08T17:58:27.044000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "Nah, my local node is updated and it verifies the blocks too",
        "created_at": "2021-06-08T17:58:52.328000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution Layer",
        "parent": "",
        "content": "yeah, and this seems merged in Nethermind: https://github.com/NethermindEth/nethermind/pull/3090",
        "created_at": "2021-06-08T17:59:07.275000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution Layer",
        "parent": "",
        "content": "Same for Besu: https://github.com/hyperledger/besu/pull/2338/files",
        "created_at": "2021-06-08T18:00:05.046000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "Hmm now I can't repro it anymore",
        "created_at": "2021-06-08T18:04:46.183000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "Nethermind still seems to accept transactions like this over RPC:\n```\ntip := new(big.Int).Mul(big.NewInt(100), big.NewInt(params.GWei))\nfeecap := new(big.Int).Mul(big.NewInt(1), big.NewInt(params.GWei))\n\ntx := randomTx(f, nonce, price)\ntx = to1559Tx(tx, chainid, tip, feecap, price)\n```\nbut they are not mined afaict. Still they should be rejected by the RPC",
        "created_at": "2021-06-08T18:07:30.996000+00:00",
        "attachments": null
    }
]
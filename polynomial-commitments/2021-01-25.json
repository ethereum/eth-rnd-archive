[
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@!203220829473996800\u003e is that the correct way of bencharking? somehow on my PC (i9-9980XE overclocked and watercooled), FFT is almost 2x slower than on yours",
        "created_at": "2021-01-25T17:26:54.720000+00:00",
        "attachments": [
            {
                "type": "",
                "origin_name": "unknown.png",
                "content": "55e6772f16b3b905778c4da28f29c85cec156b3927883fc8bd5c4debc2584667"
            }
        ]
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "Afk, but will look into that. Check which build tag you're using. And G1 or F_r FFT. And there's another special-purpose extension FFT.",
        "created_at": "2021-01-25T18:53:59.075000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@!570268431522201601\u003e So for a F_r FFT scale 15, you're getting 44 ms, using Kilic BLS? With Herumi BLS, I get 79 ms. Using Kilic BLS, I get 26 ms. (on old laptop, `i7-6700HQ @ 8x 3.5GHz`). I'll re-run the latest code and see if anything changed significantly. And will try a different machine.",
        "created_at": "2021-01-25T19:18:39.545000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "us",
        "created_at": "2021-01-25T19:20:29.332000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "I would recommend you set the Go bench time param, to run it 10 seconds (that's what I did), instead of the default single second benchmark",
        "created_at": "2021-01-25T19:20:30.034000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "it didn't seem to change anything",
        "created_at": "2021-01-25T19:20:47.733000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "And what do you get with herumi BLS?",
        "created_at": "2021-01-25T19:21:28.526000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "FYI my own implementation is somehow 6 times faster",
        "created_at": "2021-01-25T19:21:32.603000+00:00",
        "attachments": [
            {
                "type": "",
                "origin_name": "unknown.png",
                "content": "316d9b522fdcff3dafd9615f1d764f636fa726c458afb0c0d52f0910c62f7064"
            }
        ]
    },
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "herumi",
        "created_at": "2021-01-25T19:21:52.528000+00:00",
        "attachments": [
            {
                "type": "",
                "origin_name": "unknown.png",
                "content": "4092017373352a1f00d8d9d8cd14f6915a44505e1df3901bf9bc21b75bd6755c"
            }
        ]
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "There's another 2x waiting for Go-kate in open PR",
        "created_at": "2021-01-25T19:21:56.288000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "Kilic BLS + use mont. red. multiplication",
        "created_at": "2021-01-25T19:22:36.442000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "you can use this to test my code\n```\ngit clone -b kate-poly-commitment https://github.com/mratsim/constantine\nnim c -r --debugger:native -d:danger --outdir:build/ --hints:off --warnings:off --verbosity:0 research/kate/fft.nim\n```",
        "created_at": "2021-01-25T19:23:56.982000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "assuming you have the latest Nim stable (1.4.2) or devel",
        "created_at": "2021-01-25T19:24:11.265000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "So your Herumi BLS benchmarks look slightly better than mine, but you've a better CPU too, no surprise there",
        "created_at": "2021-01-25T19:24:17.576000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "But surprised about kilic BLS being 2x slower for you",
        "created_at": "2021-01-25T19:24:45.134000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "yes that's why I want to make sure I didn't forget something silly like compiling the benchmark in release mode",
        "created_at": "2021-01-25T19:26:15.862000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "how to compile just fft_fr_bench_test.go? I can run it under VTune to find the perf bottlenecks",
        "created_at": "2021-01-25T19:28:02.520000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "Not sure about vtune, go has its own tooling I used a little for go-kate.",
        "created_at": "2021-01-25T19:29:30.371000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "VTune works for go, i used it to trace bottlenecks in \"addchain\" iirc.",
        "created_at": "2021-01-25T19:31:16.566000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "but I don't know the first thing about compiling go binaries :p",
        "created_at": "2021-01-25T19:31:31.727000+00:00",
        "attachments": null
    },
    {
        "author": "mratsim",
        "category": "Cross-layer",
        "parent": "",
        "content": "I just used go get ðŸ˜‰",
        "created_at": "2021-01-25T19:31:36.099000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "fyi, just tried on my new pc, and getting 41 ms (fft f_r, scale 15) with kilic BLS. Will boot old laptop and check what's up. Regression maybe? Or just lucky platform choice? Hmm",
        "created_at": "2021-01-25T19:33:31.561000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "That's on a `AMD Ryzen 9 5950X 16-Core @ 32x 3.4GHz` (core count doesn't matter though, I didn't parallelize it yet)",
        "created_at": "2021-01-25T19:34:41.176000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "Also, let's move to DM before we spam this channel too much",
        "created_at": "2021-01-25T19:35:22.329000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Cross-layer",
        "parent": "",
        "content": "Update for others, after a bunch more benchmarks: my laptop just runs Kilic BLS better than the ryzen PC. Different architecture optimizations, and meanwhile the FFT code by \u003c@!570268431522201601\u003e has great performance on my ryzen.",
        "created_at": "2021-01-25T20:22:10.828000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://github.com/ethereum/EIPs/pull/3312",
        "created_at": "2021-03-03T00:14:41.361000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think that's acceptable, but ðŸ¤·",
        "created_at": "2021-03-03T00:14:59.487000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@689161464829050960\u003e What are your thoughts on `CALL_FROM` as the opcode name?",
        "created_at": "2021-03-03T05:13:51.315000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it breaks the `*CALL` scheme though ðŸ˜¦",
        "created_at": "2021-03-03T05:14:11.292000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`FROMCALL`?  ðŸ˜¬",
        "created_at": "2021-03-03T05:14:21.557000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`SPONSOREDCALL`?",
        "created_at": "2021-03-03T05:14:54.992000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`IMPERSONATEDCALL`?",
        "created_at": "2021-03-03T05:15:17.253000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "we came up with a couple: `TXCALL` `SIGNEDCALL`",
        "created_at": "2021-03-03T05:15:22.729000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`TXCALL` is what is currently in the EIP.",
        "created_at": "2021-03-03T05:15:33.667000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm not a fan of it personally, as I don't think it accurately captures what it is doing.",
        "created_at": "2021-03-03T05:15:49.083000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i agree, not quite a tx",
        "created_at": "2021-03-03T05:15:58.683000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`SIGNEDCALL` I like more, but I still feel it isn't a *great* description of the *what*, but rather a description of the *how*.",
        "created_at": "2021-03-03T05:16:11.380000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I generally think functions should be named after their *what* not their *how*.",
        "created_at": "2021-03-03T05:16:23.526000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(and opcodes are like little tiny functions)",
        "created_at": "2021-03-03T05:16:38.895000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`IMITATECALL`",
        "created_at": "2021-03-03T05:17:23.939000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is most certainly not a hill I want to die on, or even spend a large amount of time fighting on.  I would just prefer to come up with a name that indicates *what* this does rather than *how* it does it.",
        "created_at": "2021-03-03T05:17:34.988000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think `IMPERSONATE` is used more often in software for this purpose than imitate.",
        "created_at": "2021-03-03T05:17:59.999000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`CALLAS` and `CALLFROM` are the best IMO if it were not for breaking the naming convention",
        "created_at": "2021-03-03T05:18:01.653000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Both imitate/impersonate I think are basically the same though.",
        "created_at": "2021-03-03T05:18:06.088000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i went to the thesaurus result for impersonate ðŸ˜„",
        "created_at": "2021-03-03T05:18:28.449000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I like `IMPERSONATECALL` the best so far.",
        "created_at": "2021-03-03T05:19:26.535000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or `CALLAS` if we are willing to break the convention.",
        "created_at": "2021-03-03T05:19:36.857000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "we would be stealing `IMPERSONATECALL` from 2997 (not that it's a very big deal)",
        "created_at": "2021-03-03T05:20:07.754000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "maybe we float `CALLAS` to broader community?",
        "created_at": "2021-03-03T05:20:27.959000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Are we allowed to use underscores?  ðŸ˜¬",
        "created_at": "2021-03-03T05:20:41.780000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`CALL_AS`",
        "created_at": "2021-03-03T05:20:45.224000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i mean, if we're breaking conventions - why not!",
        "created_at": "2021-03-03T05:21:03.131000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@689161464829050960\u003e Did you disagree with the additional changes I proposed in https://ethereum-magicians.org/t/eip-3074-sponsored-transaction-precompile/4880/5, or have you just not yet had a chance to read about/think about/integrate them?  If it is the latter, I would be curious to hear your arguments on the matter.",
        "created_at": "2021-03-03T12:56:43.821000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also, I have submitted two PRs related to some stuff we have discussed in here on 3074.  My hope is to give us a place to catalog discussion and (if you ultimately agree) to make it easy to make the change.",
        "created_at": "2021-03-03T12:57:16.445000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I forgot about the reordering, so I'll get to that. I really don't think we should remove chainID though.",
        "created_at": "2021-03-03T16:03:58.893000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Can you remind me why, or better yet encode your reasoning in the magicians thread so I don't keep asking you.  ðŸ˜„",
        "created_at": "2021-03-03T16:12:14.637000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Sure thing!",
        "created_at": "2021-03-03T16:19:08.093000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "tl;dr is that I think chain-id agnostic invokers will be exceedingly rare.",
        "created_at": "2021-03-03T16:19:28.514000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is there a reason you think that contracts cannot implement replay handling logic?",
        "created_at": "2021-03-03T16:35:26.828000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or do you just think the EVM should be programmed to do that for the user?",
        "created_at": "2021-03-03T16:35:40.793000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@689161464829050960\u003e Can you help me understand the `sponser != sponsee` check?",
        "created_at": "2021-03-03T16:47:13.187000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What is the attack vector where a sponsor sponsors themselves?",
        "created_at": "2021-03-03T16:47:39.537000+00:00",
        "attachments": []
    },
    {
        "author": "ryanleeschneider",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This one is my initial favorite, but might be overly specific RE: the \"what\" vs \"how\"",
        "created_at": "2021-03-03T16:49:17.192000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The chain-id check can be implemented in the invoker, but it's gonna be in practically every invoker, no?",
        "created_at": "2021-03-03T16:50:59.361000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If a contract currently assumes that `tx.origin == msg.sender` only happens in the top-level stack frame, they might rely on it for reentrancy protection.",
        "created_at": "2021-03-03T16:51:48.213000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In my PR where I removed the changes to `ORIGIN`, I mentioned that I hated it but didn't like coupling the change of semantic meaning of `tx.origin`.  However, I have zero problem breaking contracts that use it despite security experts and core developers telling them not to for half a decade.",
        "created_at": "2021-03-03T16:53:15.632000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So my preference is to leave `ORIGIN` to still mean `ORIGIN`, but not create additional checks in the opcode execution to protect people who are doing things they were advised against doing.",
        "created_at": "2021-03-03T16:53:56.402000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "To put it another way, I don't think we should go out of our way at all to help people who have been using `tx.origin`.",
        "created_at": "2021-03-03T16:55:11.913000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The primary use case for replayable transactions is one-time contract deployments.",
        "created_at": "2021-03-03T16:55:46.614000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Though, thinking more on this I guess this cannot be used for sponsored deployments since we don't do a `CREATE` in the case where `to == 0`?",
        "created_at": "2021-03-03T16:55:58.728000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, you'd have to call into a standardized deployer contract to do it.",
        "created_at": "2021-03-03T16:57:21.015000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Do we *want* to enable sponsored contract deployments?",
        "created_at": "2021-03-03T16:57:36.814000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`if (to == 0) create(...) else call(...)`",
        "created_at": "2021-03-03T16:57:53.532000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!415548822983278593\u003e was arguing for that as well.",
        "created_at": "2021-03-03T16:58:13.702000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`CALL` doesn't create a new contract, so for consistency, I think we shouldn't do that.",
        "created_at": "2021-03-03T16:58:45.267000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And you _can_ still create contracts, just less ideally.",
        "created_at": "2021-03-03T16:59:26.229000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think the only thing that I'm undecided on is returning gas used.",
        "created_at": "2021-03-03T18:05:11.095000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(took `valueSponseeMax` back out since it has weird mempool implications)",
        "created_at": "2021-03-03T18:05:34.506000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Meaning you cannot send value to the sponsored transaction from the sponsee?",
        "created_at": "2021-03-03T18:07:45.382000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "FWIW I'm still pretty against this.  It doesn't align with how any CALL opcodes behave and we don't have a good place to put it that doesn't totally change the behavior of how call semantics works.",
        "created_at": "2021-03-03T18:08:43.811000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Exactly. Any value has to come from the invoker.",
        "created_at": "2021-03-03T18:09:10.407000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We can put it on the stack, no?",
        "created_at": "2021-03-03T18:09:25.773000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Much easier as an opcode.",
        "created_at": "2021-03-03T18:09:31.103000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh, so you still can pass value along?",
        "created_at": "2021-03-03T18:09:42.008000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "is the reason for gas used incase gas becomes unobservable?",
        "created_at": "2021-03-03T18:09:45.901000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes",
        "created_at": "2021-03-03T18:09:46.856000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Exactly.",
        "created_at": "2021-03-03T18:09:52.070000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This would be a surprising behavior seeing as how none of the other CALL opcodes push more than just success boolean onto the stack.",
        "created_at": "2021-03-03T18:10:22.584000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And I feel like adding gas observability in case we remove gas observability isn't a great argument.  ðŸ™‚",
        "created_at": "2021-03-03T18:10:43.090000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We don't want to remove gas observability in a way that makes it still observable, we want to remove gas observability period.",
        "created_at": "2021-03-03T18:11:08.208000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And force developers to come up with paradigms that don't require gas observability.",
        "created_at": "2021-03-03T18:11:24.240000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "gas observability is a requirement of sponsored txs",
        "created_at": "2021-03-03T18:11:28.871000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We're already pushing two stack elements ðŸ˜‰",
        "created_at": "2021-03-03T18:11:29.908000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hmm, really?  What?",
        "created_at": "2021-03-03T18:11:37.842000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I thought it was just the success/failure?",
        "created_at": "2021-03-03T18:11:44.036000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "*grumble* (found it)",
        "created_at": "2021-03-03T18:12:23.702000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://github.com/ethereum/EIPs/blob/master/EIPS/eip-3074.md#outputs\n\n`success` and `calleeSuccess`",
        "created_at": "2021-03-03T18:12:24.542000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm against that for the same reason I was before.",
        "created_at": "2021-03-03T18:13:00.987000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We should be returning a single success boolean and an appropriate revert reason.",
        "created_at": "2021-03-03T18:13:16.481000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This particular flavor of gas observability is safe, so it shouldn't be a problem.",
        "created_at": "2021-03-03T18:13:31.590000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "No other opcodes set a revert reason though, and none of them modify a user supplied revert reason, afaik",
        "created_at": "2021-03-03T18:13:59.334000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What prevents people from using `TXCALL` to gain access to gas observability?",
        "created_at": "2021-03-03T18:14:00.332000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "They could!\n\nBut the contract can never reduce the amount of gas below what the EOA signed, so there's always a way for a human to set the gas limit.",
        "created_at": "2021-03-03T18:14:54.232000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e No other opcodes set a revert reason though\nPerhaps they should. ðŸ™‚",
        "created_at": "2021-03-03T18:15:02.399000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Useful errors are useful.  Consistent error mechanics are useful too.",
        "created_at": "2021-03-03T18:15:24.802000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm getting quite tired (very late here), would you mind writing up your arguments for gas observability (why we want them, and why they aren't bad, and why it wouldn't create a way to get around gas observability removal) and also why you think two return values is better than one return value and a revert reason.  I would like to continue to press on getting 3074 into a state everyone is happy with so it has a high chance of landing in Berlin, but I acknowledge that I'm below useful in a discussion at the moment.",
        "created_at": "2021-03-03T18:18:56.950000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Perhaps on the discussions-to thread.",
        "created_at": "2021-03-03T18:19:11.724000+00:00",
        "attachments": []
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I can do that, sure. I really appreciate your input!",
        "created_at": "2021-03-03T18:21:05.043000+00:00",
        "attachments": []
    }
]
[
    {
        "author": "ryanleeschneider",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Just out of curiosity I did a little tracing into any potential cost savings with EIP-2930, using a random Tether transfer I found on etherscan (tx hash 0x1378e6a020918719bfa8169d21fba63eff6d1db4556aeb7612f949e0a56251ae).  If anyone wants to double check my math üôÇ \n\n- This transfer uses 7 `SLOAD` ops which will go from costing (800 * 7) = `5600` to (2100 * 7) = `14700` after Berlin\n- Building an Access List for 1 address w/ 7 storage keys costs (1 * 2400) + (7 * 1900) = `15700` gas, plus (100 * 7) = `700` for the warm reads, so `16400` total.\n\nSo at least for simple transactions an Access List will be marginally more expensive, but could be cheaper with more `SLOAD` ops from the same address.  Basically the access list costs `2400` but makes each `SLOAD` 100 cheaper (2100 vs 1900 + 100).",
        "created_at": "2021-02-20T00:54:23.386000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I thought it was supposed to result in the same gas costs in all cases?",
        "created_at": "2021-02-20T01:36:16.809000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(I may be mixing up my EIPs)",
        "created_at": "2021-02-20T01:36:31.866000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I added a specific rpc debug endpoint for doing exactly that. You need to calc the sstores too.",
        "created_at": "2021-02-20T12:03:06.888000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There's a 10% discount on 2930 declarations",
        "created_at": "2021-02-20T12:03:42.945000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hi guys, does someone have a hash test for EIP2930? The Geth implementation has something which looks like it, but does not have a hardcoded hash (https://github.com/ethereum/go-ethereum/blob/6a18663c677eca546c92482e74af822667c7f35d/core/types/block_test.go#L72). \n\nI'd like the input transaction data and the corresponding hash (hardcoded) so I can verify that my implementation has the right hash. (For both the entire signed transaction and the message to sign).",
        "created_at": "2021-02-20T15:47:25.008000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Could maybe \u003c@\u0026595684226221735986\u003e or \u003c@\u0026652918665943056397\u003e point me to some test cases?",
        "created_at": "2021-02-20T16:03:51.116000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Tx root hash or header hash?",
        "created_at": "2021-02-20T17:00:57.406000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or tx signing hash?",
        "created_at": "2021-02-20T17:01:22.754000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!211091239112671234\u003e the raw transaction hash (so the hash which we sign using a private key) and also the transaction hash of the signed transaction (this one would be used in the transactions trie)",
        "created_at": "2021-02-20T17:51:17.582000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This thing went wrong in the Geth implementation which you fixed like ~2 weeks back \u003c@!211091239112671234\u003e",
        "created_at": "2021-02-20T17:52:28.893000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes. I'll generate a bunch and make a PR as transaction testcases in the test repo.",
        "created_at": "2021-02-20T18:20:37.344000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "FWIW I often use the private key from this page on my tests since it's already publicly compromised: https://goethereumbook.org/transfer-eth/\n\nI have some sample tx tests here for my EIP-2930 implementation (which mainly focuses on readability/my own understanding of the process vs performance): https://github.com/INFURA/go-ethlibs/blob/master/eth/transaction_from_raw_test.go#L28\n\nThe first one uses an example tx from one of Martin's gists, the second uses modified versions of the txs from NetherMind's tests (both linked in the comments).  I actually forgot to add a new explicit EIP-2930 signing test but will do so on Monday.",
        "created_at": "2021-02-20T18:37:43.806000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is great üòÑ Thanks üëç",
        "created_at": "2021-02-20T18:53:51.621000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!508125616940515329\u003e",
        "created_at": "2021-02-20T22:28:30.681000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=ascii",
                "origin_name": "message.txt",
                "content": "de58bd1a84bceba6509f486c6b1c8c929b2a706c14bbfe329bce2a7bfd382fe5"
            }
        ]
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Thanks! These are EIP2930 transactions? Why do they not start with the 0x01 byte?",
        "created_at": "2021-02-20T22:30:32.220000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The first five txs in the Nethermind test cases are EIP-2930 txs, but for some reason wrapped in an RLP list (I assume to make the test output compatible with a legacy test harness), those are the same ones I used in my test, I just stripped off the RLP list prefix.",
        "created_at": "2021-02-20T23:28:37.788000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah, makes sense, thanks üëç",
        "created_at": "2021-02-20T23:37:18.497000+00:00",
        "attachments": null
    }
]
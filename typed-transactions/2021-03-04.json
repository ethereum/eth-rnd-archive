[
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I feel like we should be using the stack more for parameters to the opcode rather than `argsOffset/argsLength`.  Especially the arguments that need to be validated by the opcode itself.",
        "created_at": "2021-03-04T14:14:58.368000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "```\npush gas\npush value\npush y_parity\npush r\npush s\npush sponsee\npush type\npush signed_data_offset\npush signed_data_length\npush return_data_offset\npush return_data_length\ntxcall\n```",
        "created_at": "2021-03-04T14:19:45.598000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It does appear you are intentionally leaving out `invoker` and `chainid` to save resources, this should be discussed in the rationale.  I would personally prefer that the entire signed data package is included in the transaction as I tend to prefer readability over micro-optimizations (saving 24 bytes), but I can appreciate the argument against that in this case.  If `invoker` and `chainid` are not explicitly included, I think we should just put everything on the stack and not have an `args`.",
        "created_at": "2021-03-04T14:20:10.649000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I was actually thinking about that. It seems like it should be possible to structure your function arguments so that they can be straight `calldatacopy`'d into memory for the opcode, no?\n\nI'd like to put all the signed arguments in memory, and the unsigned arguments on the stack. Seems... appropriate?\n\nAs more of a moonshot argument, if we use `type`  we could introduce more types of TLPs and if all of the signed arguments are in memory, we won't need to introduce new opcodes.",
        "created_at": "2021-03-04T17:40:40.770000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This *feels* like an over-optimization.  I *suspect* that most contracts will be written in Solidity and are unlikely to benefit from such things.  Also, the cost of pulling 10 extra fixed size (less than 32 bytes) items out of calldata and pushing them onto the stack is quite negligible.",
        "created_at": "2021-03-04T17:55:25.414000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The problem with over-optimizations, of course, is that they are really difficult to argue against.  ðŸ™‚",
        "created_at": "2021-03-04T17:55:44.595000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The argument against is basically, \"I have over-optimized before in my life, and it did not end well.\"",
        "created_at": "2021-03-04T17:56:01.483000+00:00",
        "attachments": null
    },
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'd actually say that's a nice property, and not a real argument for putting everything in memory.",
        "created_at": "2021-03-04T17:56:12.490000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "aren't the arguments always in memory already as part of `CALLDATACOPY`?",
        "created_at": "2021-03-04T17:56:13.064000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah.  I'm proposing moving them to the stack, which would require pulling them *out* of memory.",
        "created_at": "2021-03-04T17:56:37.977000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "the advantage being it more closely follows existing `*CALL` ops?",
        "created_at": "2021-03-04T17:57:00.212000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah.",
        "created_at": "2021-03-04T17:57:05.977000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Lower chance of bugs and all of that abstract stuff around \"consistency is valuable\".",
        "created_at": "2021-03-04T17:57:23.378000+00:00",
        "attachments": null
    }
]
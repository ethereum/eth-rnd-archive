[
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Thanks!  You are correct, nothing new, but I am glad for the writeup as it will make it much easier to show to other people.",
        "created_at": "2020-11-24T03:16:46.007000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If someone wants to help sell SSZ for Berlin, I think benchmarking of block merklization of some real world blocks would be very valuable.  I suspect this is likely to be a source of pushback from core devs on SSZ transaction lists.",
        "created_at": "2020-11-24T03:17:06.155000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The only way SSZ makes berlin is if it slips 6 more months.  London is a better target.",
        "created_at": "2020-11-24T03:29:51.499000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Why do you think the introduction of SSZ will take 6 months?",
        "created_at": "2020-11-24T03:32:24.476000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And are you referring to *any* SSZ or all transactions SSZ plus SSZ merklization?",
        "created_at": "2020-11-24T03:33:08.786000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Clients need to write SSZ serialization and integrate it.  And be satisfied it's rock solid.  Besu is in a better position as Teku's SSZ is fairly well isolated, but I don't know that the same can be said for rust, go, or C#.  And the pluming work isn't a week-long task.",
        "created_at": "2020-11-24T03:34:13.762000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If anything more gets added it slips into Q2.  No matter how \"small\".  Typed transaction wrapping is already too large for my taste.",
        "created_at": "2020-11-24T03:34:48.869000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Prior to that I felt we could start talking testnet blocks next week, but with the wrappers i feel that puts us a month or two from that.",
        "created_at": "2020-11-24T03:35:31.342000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I certainly can appreciate the concern of scope creep.  The counter concern I have is that if we *don't* do all of this stuff in Berlin, then Berlin is going to introduce a bunch of technical debt that we have to pay for later.",
        "created_at": "2020-11-24T03:36:58.980000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It is sort of the \"do it fast vs do it right\" problem, which doesn't always have an obviously correct answer... especially when the thing in question is holding up other stuff.",
        "created_at": "2020-11-24T03:37:31.460000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I feel the right time to introduce SSZ is on 1559 wrapped transactions.  2930 tx wrappers I feel will be a compatibility aid to un-block wedged contracts, but won't see widespread use in downstream tools.",
        "created_at": "2020-11-24T03:38:19.070000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "hence my desire to keep legacy transactions as much the same as possible, to have the downstream big bang be 1559 TXes.",
        "created_at": "2020-11-24T03:39:01.999000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "SSZ in the other parts (block headers, bodies, tx and receipt lists, etc) feel better at Shanghai or Cancun or Eth2 merge.",
        "created_at": "2020-11-24T03:40:44.347000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i.e. the only reason to SSZ anything existing is to get it in the form it needs to be for Eth2 merge, to not introduce unneeded technical debt bridge loans.",
        "created_at": "2020-11-24T03:41:29.662000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "* I believe everyone agrees we need 2929 in Berlin.\n* 2929 without 2930 is feared to cause compatibility issues with poorly written contracts that depend heavily on gas prices being fixed.\n* 2930 without 2718 means we have to introduce a new transaction shape without a mechanism to easily distinguish them.\n* 2718 without 2972 or some other legacy wrapping means we have the debt of mixed processing.\n* 2930 or 2972 with RLP instead of SSZ means we'll have to deprecate both legacy transactions **and** 2930 transactions at some point in the (near?) future and deal with phasing out of both.\n* SSZ serialization without SSZ merklization means we'll have deal with a change in transaction hash at some point in the (near?) future.",
        "created_at": "2020-11-24T03:43:05.794000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I would not be opposed to 2929 without 2930, but I don't think there is general support for that.  It would introduce no new technical debt, and also require no work.",
        "created_at": "2020-11-24T03:43:48.442000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "making 2930 wrappers be SSZ is the same as giving up on a Q1 release of Berlin.",
        "created_at": "2020-11-24T03:44:23.770000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm pretty strongly opposed to 2930 without 2718 because that feels like we are just continuing to dig ourselves into a hole that has caused us and users pain in the past.",
        "created_at": "2020-11-24T03:44:26.782000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Remember when Berlin was Q2 2020?  Pepperidge Farms remembers",
        "created_at": "2020-11-24T03:45:06.932000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The *impression* I get is that not everyone agrees on this statement, though I may be misreading the room.",
        "created_at": "2020-11-24T03:45:08.269000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "2718 without 2972 may be reasonable, but it doesn't solve the \"no SSZ\" problem, and if we have SSZ for other reasons then it seems like not a big step to just have 2972 use SSZ as well.",
        "created_at": "2020-11-24T03:46:12.172000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "2930 txes will be legacy anyway when 1559 ships.  wether it is rlp or ssz is a red herring.",
        "created_at": "2020-11-24T03:46:23.987000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "generally speaking I don't see 2972 as needed in any form.  We can do it all without it.",
        "created_at": "2020-11-24T03:47:17.309000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, but there is a difference between \"legacy\" and \"actually removed\".  We really want to get to fully removed from the protocol, and introducing *more* stuff that we have to remove later just makes that even harder.",
        "created_at": "2020-11-24T03:47:20.499000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Nothing will be actually removed until the eth 2 merger.",
        "created_at": "2020-11-24T03:47:43.972000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There are paths that fully remove RLP encoded transactions from blocks long before The Merge.",
        "created_at": "2020-11-24T03:48:05.150000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Regenesis is just as much work as the merge.",
        "created_at": "2020-11-24T03:48:35.845000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We can get to \"no RLP encoded transactions\" by Berlin if we are willing to bite the bullet and introduce SSZ now.",
        "created_at": "2020-11-24T03:49:07.755000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or by London if not (though, harder if we wait until London I think).",
        "created_at": "2020-11-24T03:49:11.594000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is that even a good thing?  There is no way downstream will be ready with rlp-free stuff by berlin.",
        "created_at": "2020-11-24T03:49:54.731000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "stuff like metamask, web3.js, etc.",
        "created_at": "2020-11-24T03:50:12.263000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "```\n* All transactions are SSZ serialized both for hashing, transport, and merklization.\n* Legacy transactions are included in blocks and sent over the wire in SSZ format, but for the purpose of signing they are first re-encoded as `rlp(keccak256(tx))` to maintain signature compatibility.\n* We solve the problem of transient dual-hashing in the clients\n   * simplest solution is to just provide a bad UX around the fork block\n   * better solution is to store both hashes (legacy and new) in memory for about a week around the fork block so users can lookup transactions that were submitted prior to the fork but mined after the fork\n```",
        "created_at": "2020-11-24T03:50:27.669000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Tooling doesn't need to do anything, clients can convert on receipt over JSON-RPC.",
        "created_at": "2020-11-24T03:50:51.370000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Are you trying to burn out core developers even more?",
        "created_at": "2020-11-24T03:50:56.282000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Technical debt is as much about humanity as it is about meeting deadlines",
        "created_at": "2020-11-24T03:51:25.454000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think you have no idea the stresses this will put on the developers writing the clients.",
        "created_at": "2020-11-24T03:53:08.056000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Which part?  The addition of SSZ or the dual hashing bit?",
        "created_at": "2020-11-24T03:53:48.916000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes.",
        "created_at": "2020-11-24T03:53:53.872000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The perceived difficulty of those two things is definitely something I look forward to getting more feedback from core devs on.",
        "created_at": "2020-11-24T03:54:31.277000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What do you think this thread was?",
        "created_at": "2020-11-24T03:54:45.390000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I agree that they are the \"hard part\" of this path forward.",
        "created_at": "2020-11-24T03:54:46.285000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Your feedback is definitely valuable, and if the other core devs echo it then we will have to go down a different path.",
        "created_at": "2020-11-24T03:55:23.220000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Unless you are saying that you feel strongly enough to cast a \"veto vote\" (meaning, even if all other client devs agree, you would rather fork than go down this path)?",
        "created_at": "2020-11-24T03:55:49.632000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Enough with the voice or exit BS.",
        "created_at": "2020-11-24T03:56:30.057000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I wasn't trying to suggest an ultimatum or anything.  I was merely saying that I hope to get feedback on this proposal from all of the core dev teams to see if everyone agrees with your sentiment or not.  If they do, we'll find another way to proceed.  If they don't, we'll likely continue the discussion on this path forward.  However, it is an open secret that core clients have a limited amount of veto power that they can choose to exercise, and knowing sooner rather than later if a client will exercise that veto power is valuable so we can not waste time exploring a path forward that will end up being vetoed.",
        "created_at": "2020-11-24T03:59:45.851000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The reason it's an \"open secret\" is that vetos are a net negative.  Working collaboratively is net positive.  So it's best to pretend the veto doesn't exist because the mere acknowledgement of it takes value out of the equation.   So the veto should not be discussed unless it's being invoked.  So enough with the voice or exit talk.",
        "created_at": "2020-11-24T04:01:20.061000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Eh, I'm not a fan of avoiding discussion of open secrets personally.  I have a pretty strong preference for everyone being up front with their thoughts/plans.  However, I'm also fine with not pressing the issue. ðŸ™‚",
        "created_at": "2020-11-24T04:02:23.323000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There are also some middle-ground paths that include SSZ but no dual hashing, so better understanding if the various core devs consider both SSZ and dual hashing a problem or only dual hashing a problem can help us choose an alternative.",
        "created_at": "2020-11-24T04:02:50.583000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!403707149043105803\u003e What are your thoughts on 2929 without 2930?",
        "created_at": "2020-11-24T04:02:59.080000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Still valuable.  More valuable with 2930.  But if we want to ssz encode it  I dont see that shipping before q2.  So slipping it to London would be a viable path.",
        "created_at": "2020-11-24T04:05:55.465000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e \u003c@!403707149043105803\u003e should we add this to the ACD agenda?",
        "created_at": "2020-11-24T15:35:23.694000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Although I'm not sure either of you may end up making it ðŸ˜…",
        "created_at": "2020-11-24T15:37:29.327000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "we should probably make a decision on these questions ASAP",
        "created_at": "2020-11-24T15:48:16.936000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I do think Geth and Nethermind and OE should weigh in too.  And ACD is the most reliable place to do that.",
        "created_at": "2020-11-24T16:09:59.157000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Wrapped legacy transactions is not on the current YoloV3 list - https://github.com/ethereum/eth1.0-specs/blob/master/client-integration-testnets/YOLOv3.md - none of them specify adding SSZ support.",
        "created_at": "2020-11-24T16:13:04.049000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So this long winding discussion about double hashes, wrapped legacy, and SSZ was never _really_ scoped for berlin to being with.",
        "created_at": "2020-11-24T16:13:50.465000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!403707149043105803\u003e would besu plan on implementing SSZ yourselves or would you likely use the Teku library?",
        "created_at": "2020-11-24T16:17:01.436000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I see no reason to re-implement ssz when teku has a functional library.",
        "created_at": "2020-11-24T16:18:40.741000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e should we add this to the ACD agenda?\n\u003c@552133098075193354\u003e Yes.  I plan on putting together something that summarises the options and their pros and cons.  I have learned a lot since we discussed this in the last ACD.",
        "created_at": "2020-11-24T22:09:51.159000+00:00",
        "attachments": null
    }
]
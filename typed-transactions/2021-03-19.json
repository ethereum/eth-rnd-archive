[
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is there anything I can do to convince us to have `require(value == 0)` for initial launch and defer decision on its provenance to a future hard fork?",
        "created_at": "2021-03-19T03:52:22.025000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The arguments against value from sponsee feel like FUD to me, and I feel like we should have a good reason for choosing value from sponsor besides uncertainty and fear.",
        "created_at": "2021-03-19T03:53:35.022000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`require(value == 0)` as a solution is essentially the \"lets take time to resolve or validate our fears before making a decision that we cannot undo\".",
        "created_at": "2021-03-19T03:54:08.247000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You can all thank \u003c@415548822983278593\u003e for reminding me with their recent PR to rationale.  üòõ",
        "created_at": "2021-03-19T03:54:48.340000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm not really convinced by either of the newly introduced rationale items.  They both come off like FUD to me.",
        "created_at": "2021-03-19T03:55:15.695000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For example, I don't think the behavior described for transaction selection is how any miners *actually* function today (and it seems like a kind of silly pattern to follow for a miner).",
        "created_at": "2021-03-19T03:55:36.325000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm also pretty sure we are going to have to break the other mentioned invariant at some point because it has constrained us on a number of different fronts and I'm not sure it is *actually* providing significant value.  I think the real constraint is that we need to ensure that invalidating an account's pending transactions costs sufficient gas to protect against DoS, not that only a top level transaction can invalidate an account's transactions.",
        "created_at": "2021-03-19T03:57:20.021000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it's not just how miners function though, you can get an amplification effect across the network with non-mining nodes gossiping txs that are invalid - they just don't know it because they aren't fully executing the tx",
        "created_at": "2021-03-19T04:22:46.835000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i don't really see a reason to require value to be set to 0 to start - taking value from the invoker will *always* be cheaper than getting it out of the EOA and is therefore functionality we would want to support",
        "created_at": "2021-03-19T04:23:32.356000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "if you can deduct value from the sponsee, you can invalidate an arbitrary number of pending txs (e.g. make 100 `AUTHCALL`s to empty sponsee accounts that also had pending txs) and now you wasted compute and bandwidth on those) - it *seems* like if we make these transfers very expensive (25-30k gas) then it wouldn't be an ddos vector, but again, it would be nice to be able to also send the funds to an invoker 1 time and access them for cheap later",
        "created_at": "2021-03-19T04:31:37.527000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You can already do this by sending the following set of transactions:\nnonce 1: send all ETH away\nnonce 2: do something\nnonce 3: do something\nnonce 4: do something",
        "created_at": "2021-03-19T04:32:26.504000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The rationale section should (IMO) include the reasoning why we should take value from the invoker.  Right now it just says why we *don't* take value from the sponsee (and the reasons are very weak and FUD like IMO).",
        "created_at": "2021-03-19T04:33:11.174000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yes but this can be validated by non-mining nodes statically",
        "created_at": "2021-03-19T04:34:18.856000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It cannot.  The first transaction may result in the account *receiving* ETH by the end.",
        "created_at": "2021-03-19T04:34:47.155000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We **could** disallow that on the network, but that isn't currently an invariant we have.",
        "created_at": "2021-03-19T04:35:07.038000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this is inverse of what we're talking about though, it wouldn't lead to an amplification of invalid txs across the network because the later nonces would be valid?",
        "created_at": "2021-03-19T04:35:32.750000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm saying you cannot statically validate that the first transaction results in the account not having gas money for the following transactions.",
        "created_at": "2021-03-19T04:36:09.250000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The only way to validate that is to run the transactions.",
        "created_at": "2021-03-19T04:36:18.395000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i'm saying that i can make N txs and have 1000s of nodes propogating them, knowing full well in the next block i'll have a 3074 tx invalidate them all",
        "created_at": "2021-03-19T04:36:24.309000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "you can't do that today",
        "created_at": "2021-03-19T04:36:27.471000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Sure you can.",
        "created_at": "2021-03-19T04:36:40.157000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://discord.com/channels/595666850260713488/779922457631916064/822326629254037514",
        "created_at": "2021-03-19T04:36:50.973000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Repeat 1000 times.  üôÇ",
        "created_at": "2021-03-19T04:36:56.782000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "nodes would drop nonce 2 because it would see the account can no longer pay, therefore would not amplify the txs",
        "created_at": "2021-03-19T04:37:24.961000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I don't believe that is true at the moment.",
        "created_at": "2021-03-19T04:37:37.300000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I don't think nodes currently statically account for value sends when determining account balance for future nonces.",
        "created_at": "2021-03-19T04:38:11.316000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i believe they don't currently because it hasn't been attacked",
        "created_at": "2021-03-19T04:39:11.106000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "üëç My point is that we wouldn't be *introducing* a DoS vector with sponsee value in 3074.",
        "created_at": "2021-03-19T04:39:22.531000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but we *can* prevent these attacks, even if they aren't being taken advantage of today",
        "created_at": "2021-03-19T04:39:35.755000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "with 3074 we would not have the ability to prevent this",
        "created_at": "2021-03-19T04:40:14.880000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I will concede that we are \"closing a door\".  I think it is an acceptable door to be closed and would like to have more time to debate this since I *feel* like the current debate is being shut down hurriedly in order to try to get 3074 into London, rather than because the arguments against sponsee pays are strong.  Which is why I want `require(value==0)` so we have more time to properly debate this.",
        "created_at": "2021-03-19T04:41:15.951000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "do you think that sending value from the invoker is just not valuable?",
        "created_at": "2021-03-19T04:41:35.303000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I haven't seen any meaningful utility from it.",
        "created_at": "2021-03-19T04:41:44.793000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it's going to be much cheaper than deducting from an EOA",
        "created_at": "2021-03-19T04:41:59.912000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Why?",
        "created_at": "2021-03-19T04:42:04.714000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because of the DoS protection we would need?",
        "created_at": "2021-03-19T04:42:13.355000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "because you need to charge at least 25k gas for the potential txs you'll invalidate",
        "created_at": "2021-03-19T04:42:25.046000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Why 25k instead of \u003c21k?",
        "created_at": "2021-03-19T04:42:35.764000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Presumably some portion of that 21k is \"signature validation\" and \"state loading\" which we are already doing so can be discounted.",
        "created_at": "2021-03-19T04:42:58.742000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i don't recall how the numbers were calculated, i'll see if i can find the document",
        "created_at": "2021-03-19T04:43:58.833000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this was research done to determine the feasibility of different AA schemes",
        "created_at": "2021-03-19T04:44:13.309000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is, the 21k for transactions is an aggregation of several \"costs\" to the network including state access, state mutation, pending transaction cancellation, signature validation, etc.  We already are accounting for a few of those costs when the `AUTH` call happens (signature validation and state access I think), so we only need to cover state mutation and pending transaction cancellation costs additionally.",
        "created_at": "2021-03-19T04:44:25.342000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh, the 21k *also* accounts for block body size increase (state growth) which is already accounted for in this case (by way of transaction calldata).",
        "created_at": "2021-03-19T04:44:51.553000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "regardless of the exact number, i think we can agree that deducting from sponsee is several thousand gas more expensive (at minimum)",
        "created_at": "2021-03-19T04:45:16.452000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, but I cannot imagine a useful situation where you *wouldn't* want to have the sponsee pay.",
        "created_at": "2021-03-19T04:45:43.567000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We won't *actually* gain anything if every sponsee just has to do two transactions: 1 to transfer ETH to the invoker and then 2 to use that ETH in a call.",
        "created_at": "2021-03-19T04:46:03.036000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Especially since that will likely result in even more gas costs due to needing to track sponsee balances across transactions in the invoker.",
        "created_at": "2021-03-19T04:46:29.198000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i) we aren't even sure if it's *possible* to have the sponsee pay ii) if it is possible, it is with almost *certainty* going to cost much more",
        "created_at": "2021-03-19T04:46:40.891000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this would be done once and be used for many use cases?",
        "created_at": "2021-03-19T04:47:25.755000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For (i) I'm willing to debate that more.  I'm not convinced but am open to being convinced, which is why I want `require(value == 0)` so you all have time to convince me.  üòÑ",
        "created_at": "2021-03-19T04:47:27.110000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For (ii), I'm not convinced of this in the real world.  I *suspect* that when it comes to real world use cases we won't actually save anything because ultimately the sponsee is the one that wants to send ETH, so they need to send ETH *somehow*.",
        "created_at": "2021-03-19T04:47:50.254000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Perhaps it would help if someone wrote down the actual *use cases* for invoker pays (meaning where the invoker is actually the source of funding, not just that the ETH was routed through the invoker but is sourced from the sponsee in a round about way).",
        "created_at": "2021-03-19T04:49:01.266000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this is really a hack and says 3074 isn't ready imo",
        "created_at": "2021-03-19T04:49:06.356000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i think as-is, 3074 is very ready and will provide a lot of utility -- i think we can add future support via an opcode if we can make it work",
        "created_at": "2021-03-19T04:49:34.740000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I don't think so.  I think it is saying that there is significant value to be had from 3074 transactions without being able to send ETH in them, and we can defer that decision to a later time and gain the rest of the value of 3074 sooner rather than later.",
        "created_at": "2021-03-19T04:49:50.130000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i think we'll have to disagree on this",
        "created_at": "2021-03-19T04:50:02.601000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You think there isn't value in 3074 if you can't attach ETH?",
        "created_at": "2021-03-19T04:50:11.928000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Approve \u0026 Call alone is a *massive* usability improvement by itself IMO.",
        "created_at": "2021-03-19T04:50:33.884000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "there is definitely value, but it is a hack because we're trying to rush something",
        "created_at": "2021-03-19T04:50:47.649000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Someone can create, audit, deploy an invoker *just* for that and MM can reference it and approvals can go away entirely.",
        "created_at": "2021-03-19T04:50:52.801000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\"we weren't sure if we could do this, so we just turned it off until we could figure it out\"",
        "created_at": "2021-03-19T04:51:07.657000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think we are trying to build an MVP that doesn't constrain future choices.  We shouldn't try to solve every problem at once if we can defer *some* decisions until later while still gaining significant value today.",
        "created_at": "2021-03-19T04:51:27.383000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think this is an amazingly great strategy and wish *more* changes followed it!",
        "created_at": "2021-03-19T04:51:40.290000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "we aren't at all constraining future choices",
        "created_at": "2021-03-19T04:51:58.241000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We are, we are constraining our ability to do sponsee pays.",
        "created_at": "2021-03-19T04:52:09.711000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "we can add `AUTHCALL2` that sends value from the sponsee",
        "created_at": "2021-03-19T04:52:14.165000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Which adds technical debt from opcode bloat (we have relatively few opcodes available).",
        "created_at": "2021-03-19T04:52:29.181000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this is trivial to add",
        "created_at": "2021-03-19T04:52:29.532000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "there are great approaches to increase the opcode space",
        "created_at": "2021-03-19T04:53:16.369000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Which would be nice if we didn't need.  üòÑ",
        "created_at": "2021-03-19T04:53:25.759000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i mean we'll need it eventually",
        "created_at": "2021-03-19T04:53:47.459000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm not convinced of that.",
        "created_at": "2021-03-19T04:53:57.929000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we do EVM versioning and we can drop some opcodes, then we may never need to expand.",
        "created_at": "2021-03-19T04:54:14.865000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "However, if we run out of opcodes *before* EVM versioning lands then we'll have to expand the opcode range.",
        "created_at": "2021-03-19T04:54:31.232000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we can delay running out of opcodes until *after* EVM versioning, then we may never need to expand the opcode range.",
        "created_at": "2021-03-19T04:54:53.219000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this is getting off topic - i'm as certain as i can be that deducting the balance from the `sponsee` will *never* be cheaper than from the `invoker` and i believe that is good enough reason to give developers the ability support use cases where those gas savings matter",
        "created_at": "2021-03-19T04:56:27.234000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I suggest you write up some reasons why deducting from the invoker is *useful*.",
        "created_at": "2021-03-19T04:56:54.554000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That would certainly help I think.",
        "created_at": "2021-03-19T04:56:57.310000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it's useful because it is the cheapest way to transfer ether via a sponsored call",
        "created_at": "2021-03-19T04:57:20.323000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Every use case I can think of is just a more expensive/complex/indirect mechanism for deducting from sponsee.",
        "created_at": "2021-03-19T04:57:23.550000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "there is no other use case",
        "created_at": "2021-03-19T04:57:32.525000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This only is true if the funds aren't being *sourced* from the sponsee.",
        "created_at": "2021-03-19T04:57:42.476000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If you just require the sponsee to do two transactions (one to fund the invoker, then second to have the invoker send those funds) you aren't actually saving anything, you are just shuffling gas costs around.",
        "created_at": "2021-03-19T04:58:09.940000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or if you introduce an `AUTHORIZEDTAKE` later, you again are just moving gas costs around and not actually saving anything.",
        "created_at": "2021-03-19T04:58:32.791000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We need a use case where the invoker *actually* pays.",
        "created_at": "2021-03-19T04:58:45.828000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "at worst case it's as expensive as shuffling around, at best it's amortized over many txs",
        "created_at": "2021-03-19T04:59:05.941000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "if the invoker was going to pay, it could always first send ether to the sponsee and then make the `AUTHCALL`",
        "created_at": "2021-03-19T04:59:28.730000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(for context re: above, the JVM has less than 255 opcodes)",
        "created_at": "2021-03-19T04:59:43.038000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i don't disagree that it would be better if the sponsee can just pay, i'm just saying that from our experience with AA this is a big can of worms",
        "created_at": "2021-03-19T05:00:36.732000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, I think we agree that invoker pays is possible (ignoring operational costs) in all cases.",
        "created_at": "2021-03-19T05:00:37.436000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It is a can of worms that in my experience is *mostly* FUD.  I don't like making decisions by FUD.",
        "created_at": "2021-03-19T05:01:01.082000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i don't understand what you mean by FUD",
        "created_at": "2021-03-19T05:01:12.159000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Fear, Uncertainty, and Doubt.",
        "created_at": "2021-03-19T05:01:18.911000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "we spent roughly 6 months working on AA, so we have more than FUD of breaking this tx pool invariant",
        "created_at": "2021-03-19T05:01:35.362000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i'm not sure what can convince you this is a problem? you agree that 3074 makes an attack that we can stop today impossible to stop?",
        "created_at": "2021-03-19T05:02:20.477000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Perhaps \u003c@689161464829050960\u003e has a document that explains why the transaction pool invariants cannot be broken?",
        "created_at": "2021-03-19T05:02:25.608000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "or \u003c@!415548822983278593\u003e",
        "created_at": "2021-03-19T05:02:46.246000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It is possible I'm missing some context or some arguments as to why we cannot break this invariant, but every time I have debated people about it I have heard *basically* the same things you are saying, which IMO aren't particularly strong arguments.",
        "created_at": "2021-03-19T05:03:15.978000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "* We may one day need to close this attack vector that has been open for 6 years and no one has ever really cared about.\n* Gas costs would have to be higher.",
        "created_at": "2021-03-19T05:04:02.531000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i don't understand what isn't strong about \"this will make a ddos vector impossible to stop\"?",
        "created_at": "2021-03-19T05:04:31.943000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "maybe there is less value in exploiting something that can be pretty easily patched?",
        "created_at": "2021-03-19T05:04:50.724000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Why haven't we bothered to close it in the last 6 years it has been open?",
        "created_at": "2021-03-19T05:04:52.607000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also, I think that we have run into the \"invaliding transactions in the pool\" invariant repeatedly over the last couple years and it is clearly an invariant that is causing us a huge amount of pain.  The arguments for keeping such an invariant need to be incredibly strong IMO.",
        "created_at": "2021-03-19T05:05:51.600000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "FWIW, I *do* think that arguing that avenue is the best way to go to convince me.  The \"costs are higher\" I think is simply incorrect and instead you are just moving costs around.",
        "created_at": "2021-03-19T05:06:44.743000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "the cost is higher though",
        "created_at": "2021-03-19T05:07:14.515000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "the only time it isn't if it is a 1 for 1 transfer",
        "created_at": "2021-03-19T05:07:25.576000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "most people will hold their ether balance in the invoker",
        "created_at": "2021-03-19T05:07:33.612000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Only if the source of funds is the invoker, which I don't think is ever going to be the case.",
        "created_at": "2021-03-19T05:07:33.710000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "the invoker is like a smart contract wallet, it stores their nonce",
        "created_at": "2021-03-19T05:07:49.458000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah, this may be where we disagree.",
        "created_at": "2021-03-19T05:07:51.134000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "no issues with storing ether there",
        "created_at": "2021-03-19T05:07:55.654000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "One of the big arguments for why we need full AA is because it sucks having to store your ETH in two different accounts, one to pay for gas and one to actually spend.",
        "created_at": "2021-03-19T05:08:29.401000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i don't disagree, but i don't think we're going to have full AA for a long time",
        "created_at": "2021-03-19T05:08:53.669000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I currently use a contract wallet and can agree that this is really annoying.",
        "created_at": "2021-03-19T05:08:54.169000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "My point is that I don't think people will actually follow this pattern.",
        "created_at": "2021-03-19T05:09:08.927000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "They *could have* for all this time yet they don't because it is a UX PITA.",
        "created_at": "2021-03-19T05:09:22.690000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "with 3074, at least if you have ether in your account you can afford to send it to the invoker to use - in fact if we could get rid of the self sponsoring issues we could send it to the invoker during a routine call!",
        "created_at": "2021-03-19T05:09:51.943000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think the way invokers will *actually* be used is for call batching like approve \u0026 call.",
        "created_at": "2021-03-19T05:09:52.788000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i think getting rid of self sponsoring is *far* more likely than deducting value directing from the user",
        "created_at": "2021-03-19T05:10:13.407000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That means you cannot send ETH via invoker if your transaction is sponsored though.  That being said, sponsored transactions are notably less useful if you have ETH.",
        "created_at": "2021-03-19T05:10:44.837000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "why not?",
        "created_at": "2021-03-19T05:10:59.341000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because you don't have an initiating transaction to send the ETH to the invoker so the invoker can then send that ETH along on your behalf.",
        "created_at": "2021-03-19T05:11:27.995000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "if you call the invoker yourself with value, it just passes it on?",
        "created_at": "2021-03-19T05:11:46.042000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Which isn't a sponsored transaction.  üôÇ",
        "created_at": "2021-03-19T05:11:57.909000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yes but it could be batched or expiring",
        "created_at": "2021-03-19T05:12:06.668000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "you don't need sponsored tx if you can pay",
        "created_at": "2021-03-19T05:12:17.592000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Sponsored Transaction: Someone else pays for gas, you cannot pass along ETH.\nSelf Sponsored Transaction: You pay for gas, you can pass along ETH.",
        "created_at": "2021-03-19T05:12:30.808000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "sure",
        "created_at": "2021-03-19T05:12:40.871000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I agree that the use cases for sponsorship when the sponsee has ETH are relatively few.",
        "created_at": "2021-03-19T05:13:00.809000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but if you have the eth, it shouldn't matter to you - in fact, there could be complex scheme which sends the eth to a sponsor and you are deducted dai",
        "created_at": "2021-03-19T05:13:08.689000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "IMO if we can convince people to accept one of the potential mechanisms to allow self sponsoring then we're 98% of the ideal solution",
        "created_at": "2021-03-19T05:13:47.708000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it's slightly less nice in the flow that you might have to originate a tx yourself sometime, but wallets + sponsors should fully abstract that",
        "created_at": "2021-03-19T05:14:34.166000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it's *almost* the same as deducting value from the sponsee",
        "created_at": "2021-03-19T05:14:49.874000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "One use case:\nI have a bunch of USDC and I want to call a contract that requires ETH.  I use a sponsor + invoker to batch a sequence of calls that will swap my USDC for ETH and then send that ETH along.\n\nTo do that with invoker pays, I would have to use a specialized invoker that knows how to swap USDC for ETH and then have them transfer my USDC to the invoker, swap it for ETH, then pass the ETH along to the target contract.\n\nTo do that with sponsee pays, I would just batch a swap of USDC to ETH and then the target contract call.",
        "created_at": "2021-03-19T05:16:06.300000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The latter uses a *very* generic sequencing invoker that is likely to be supported by most wallets.  The former needs a highly specialized invoker, which is opinionated about what exchange it uses.",
        "created_at": "2021-03-19T05:16:54.343000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ü§î some exchanges allow swap-and-send, which would mitigate this, but I don't think all exchanges support that functionality (that functionality is a huge opportunity for scammers in Uniswap v2 and I wouldn't be surprised if they removed it in Uniswap v3).",
        "created_at": "2021-03-19T05:17:21.314000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "okay, self-sponsoring would only work for deducting value at the beginning of a tx",
        "created_at": "2021-03-19T05:18:34.538000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "not much help during",
        "created_at": "2021-03-19T05:18:37.343000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but these *can* be solved at the application level",
        "created_at": "2021-03-19T05:19:00.436000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You mean by using specialized invokers?",
        "created_at": "2021-03-19T05:20:01.574000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i think there are quite a few ways to solve \n* specialized invokers\n* standard for receiving eth for a certain account in an invoker\n* specialized sponsor that understands the invoker\n* probably others",
        "created_at": "2021-03-19T05:21:01.534000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but sure, ideally it would just increment the user's account balance",
        "created_at": "2021-03-19T05:21:26.068000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "okay i need to get offline, but to recap - i'd like to allow invokers to send value. it's not as ideal as the sponsee, but it can be made pretty good. if we don't allow it, we completely disallow a whole class of use cases. it would be great if we could self-sponsor, i think the approaches we laid out in the EIP are very viable, we just need people to agree to it and that would help alleviate the need for sponsee deductions",
        "created_at": "2021-03-19T05:23:34.251000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "worst case, we can figure out how to do sponsee deduction and we'll add another opcode (if opcodes are really that scarce, we can just do a precompile)",
        "created_at": "2021-03-19T05:24:16.832000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The two things I would like to see (and be convinced by) before I back down on `require(value == 0)`:\n1. Clearly drafted arguments for the specific attack vectors we are trying to protect against by disallowing account balance changes outside of top level transactions.  I would like to not debate against straw men, and I feel like there is enough nuance that we need something more permanent than repeated Discord debates.\n2. Reasons why invoker-pays is useful **other** than as a hack around the fact that we don't support sponsee-pays.",
        "created_at": "2021-03-19T05:24:25.760000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(for (2), it may be that is really the *only* reason it is useful, in which case really (1) is the only point of debate)",
        "created_at": "2021-03-19T05:25:19.462000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://eips.ethereum.org/EIPS/eip-191",
        "created_at": "2021-03-19T17:56:46.647000+00:00",
        "attachments": []
    }
]
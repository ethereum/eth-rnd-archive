[
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Shit I think I found a bad bug in the spec that was never tested because we didn't use execution requests \u003c@641548687813902336\u003e \u003c@363800010518822915\u003e",
        "created_at": "2025-08-22T15:45:37.520000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Will open a PR that will break every single test with them I assume",
        "created_at": "2025-08-22T15:45:48.591000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "i can help with the tests if you need it",
        "created_at": "2025-08-22T15:50:16.347000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "nvm, itÂ´s not so bad if we accept that `state.state_roots` has a different meaning and will not coincide with the `state_root` committed in the beacon block, but this makes the above situation discussed about EIP-4788 much worse. However with the new semantics of `state.state_roots`, the problem above is kinda solved. Because the beacon block root contains a state root to which you can prove something about the state after processing the beacon block of N but not the payload. Let that one be `state`, then `state.state_roots[N-1]` will have the post-state root of processing the full payload. Will add a full description of this issue in the next breakout cc \u003c@935504619554107392\u003e as you guys may be affected",
        "created_at": "2025-08-22T16:07:33.521000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "Cross-layer",
        "parent": "",
        "content": "do we care more about making the sematics the same as today or do we care more about exposing both state roots?",
        "created_at": "2025-08-22T16:13:03.998000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "Cross-layer",
        "parent": "",
        "content": "if we wanna make the sametics of `payload.state_root` the same as today, it would be something like the beacon state root after applying the payload in `N-1` but before appyling the beacon block of `N`",
        "created_at": "2025-08-22T16:14:05.925000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "Cross-layer",
        "parent": "",
        "content": "unless `N-1` is skipped or empty.. then it would be the result of applying the beacon block `N`",
        "created_at": "2025-08-22T16:15:15.440000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "Cross-layer",
        "parent": "",
        "content": "which seems.. horrible",
        "created_at": "2025-08-22T16:15:21.502000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "there's no \"semanthics the same as today\" . If I say the state root means the post state after the CL block, then I broke semantics, if I say the state root means the post state after the payload then I keep the same meaning. The thing is that both are the same today and are different tomorrow.",
        "created_at": "2025-08-22T17:22:40.364000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "And yes, the state root does make the same meaning of today according to your own wording: it is the post-state of the payload of N-1 before the block of N",
        "created_at": "2025-08-22T17:23:28.402000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "if N-1 is skipped of empty yes, the state root is still the post state of the payload of N-1 (which is empty)",
        "created_at": "2025-08-22T17:24:26.394000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "is this right?\nif `N` is full: should be execution's post state root\nif `N` is empty: should be consensus's post state root\nif `N` is skipped: at `N+1` process slot, it should be filled with `N-1`'s state root",
        "created_at": "2025-08-22T17:54:21.068000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "yes, but the consensus post-state root is also the execution poststate root if N is empty.",
        "created_at": "2025-08-22T20:48:27.308000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "This is how it would look if we overload the consolidations contracts to onboard builders https://discord.com/channels/595666850260713488/688075293562503241/1408552963382972416",
        "created_at": "2025-08-22T20:48:56.810000+00:00",
        "attachments": null
    }
]
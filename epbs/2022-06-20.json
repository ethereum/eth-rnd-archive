[
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "So, to follow up the reasoning. To me the issue is more on the update, not on the initial registration process. Think about a staking service who manage 1k validators. They want to change the feeRecipient from `feeRecipientMapA` to `feeRecipientMapB`.\n1. BN has a `feeRecipientMapA` cached in memory.\n2. VC resign all registrations for `feeRecipientMapB` and calls the API against BN.\n3. BN then calls mev-boost which then calls relays that update the builders.\n4. BN receives the OK from mev-boost and update its local cache to `feeRecipientMapB`\nif the entire call chain is synchronous, BN could easily receive after 1s. If we are crossing a slot boundary and one of the validator is the proposer, local cache still points to `feeRecipientMapA`  and the builder could have already started using the new fee recipient from `feeRecipientMapB`. This is not a trust issue but a data synchronizations issue.\n\nIf I'm correct, it means that CL cannot be 100% sure that its local view of the fee recipient corresponds to the one implied in the Bid. So if BN wants to log `rewards-\u003efeeRecipient`  it may not be guaranteed to be accurate.\n\nWe may say: We don't care. My feeling is that we should, because BN has the concept of feeRecipient and has the responsibility of distributing it. It also has the concept of rewards (and he might be compare it with local EL rewards once we have an easy way to do that). Thus I think is legit to expect BN to know about  `rewards-\u003efeeRecipient`  and could be a legit expectation from users.",
        "created_at": "2022-06-20T07:56:41.988000+00:00",
        "attachments": []
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "And if we move from rest api to p2p, I think it weaken the assumption that BN and builder have the same view of the registration data at the time of Bid proposal",
        "created_at": "2022-06-20T08:37:09.982000+00:00",
        "attachments": []
    },
    {
        "author": "cristofue",
        "category": "Cross-layer",
        "parent": "",
        "content": "Hello humans ‚òÄÔ∏è\nI've been following your work and it's amazing. So many cool things since we met. I appreciate this a lot!",
        "created_at": "2022-06-20T12:21:20.909000+00:00",
        "attachments": []
    },
    {
        "author": "cristofue",
        "category": "Cross-layer",
        "parent": "",
        "content": "We now want to make a call for testing and start our communications to get feedback and adoption from validators. Please take a look:\nhttps://github.com/flashbots/mev-boost/issues/163\n\nPing \u003c@654267572107083777\u003e \u003c@363800010518822915\u003e \u003c@607055410104500244\u003e \u003c@504202741933932544\u003e \u003c@792822129019584562\u003e",
        "created_at": "2022-06-20T12:25:35.145000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "but the honest behavior is to send the fee recipient far ahead of the proposal?",
        "created_at": "2022-06-20T13:55:55.590000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "you could also get this same situation w/ the local flow, no?",
        "created_at": "2022-06-20T13:56:05.049000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "using this: https://ethereum.github.io/beacon-APIs/#/Validator/prepareBeaconProposer\n\nif you send in a way that races w/ the proposal then we don't have clear semantics on what happens",
        "created_at": "2022-06-20T13:56:43.341000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "i think we say: validators are expected to send their registrations far ahead of any expected proposals",
        "created_at": "2022-06-20T13:57:10.852000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "then we can ask the separate question: ok, how do i know who was paid for a given builder bid?",
        "created_at": "2022-06-20T13:57:49.776000+00:00",
        "attachments": []
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yes it is the same situation in local, but in thet case you see the true feerecipoent in the payload",
        "created_at": "2022-06-20T14:32:42.350000+00:00",
        "attachments": []
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "In the builder case, that option is not available and we reconnect to the beginning of the thread here :)",
        "created_at": "2022-06-20T14:33:41.460000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "its not guaranteed that your local node will write the fee recipient in the payload, you could imagine reasons similar to why builders retain the flexibility and its just something you configure locally",
        "created_at": "2022-06-20T14:36:41.807000+00:00",
        "attachments": []
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "Mmm...this is a good point",
        "created_at": "2022-06-20T14:39:30.153000+00:00",
        "attachments": []
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "But yes the local el will is in any case under your control so if pays elsewhere you should know. While builder is not.",
        "created_at": "2022-06-20T14:40:46.033000+00:00",
        "attachments": []
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "But from a BN prespective there is still an unknown",
        "created_at": "2022-06-20T14:41:25.602000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "i could construct some scenario where there is an intermediate case where you are attached to some kind of \"EL pool\" and you have less certainty",
        "created_at": "2022-06-20T14:41:31.759000+00:00",
        "attachments": []
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah",
        "created_at": "2022-06-20T14:41:45.023000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "and this is my point -- the issue is knowing for a given block, who was paid what",
        "created_at": "2022-06-20T14:42:00.260000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "and i think we can find this out \"off the critical path\" of the proposal flow",
        "created_at": "2022-06-20T14:42:13.966000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "which is why i was suggesting above we put the responsbility on relays etc",
        "created_at": "2022-06-20T14:42:38.620000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "i think even for the MVP payment proofs they still expect you to know who is getting paid",
        "created_at": "2022-06-20T14:43:02.312000+00:00",
        "attachments": []
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "Ahh k. So a query based on a given block is convincing me",
        "created_at": "2022-06-20T14:43:22.077000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "(Note that an earlier comment \"So if BN wants to log rewards-\u003efeeRecipient  it may not be guaranteed to be accurate\" is correct.  And I would suggest that the BN shouldn't even be trying to be doing this, because it requires information from the EL and additional intelligence that will soon make this a tricky problem to solve.)",
        "created_at": "2022-06-20T14:44:13.799000+00:00",
        "attachments": []
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "All right",
        "created_at": "2022-06-20T14:45:16.743000+00:00",
        "attachments": []
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "Now I'm with you:) thanks for the conversation!",
        "created_at": "2022-06-20T14:46:34.734000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "sure, thank you for the conversation !",
        "created_at": "2022-06-20T14:48:16.918000+00:00",
        "attachments": []
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "now we have to go pressure the relays or someone to do what we want üôÇ",
        "created_at": "2022-06-20T14:48:31.189000+00:00",
        "attachments": []
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "(tldr: we give up to know in advance the real feerecipient but we want something to query post-facto which feerecipient has been used for a given block)",
        "created_at": "2022-06-20T14:52:29.322000+00:00",
        "attachments": []
    }
]
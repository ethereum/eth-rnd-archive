[
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think `extraData` is deprecated and we'd love to bring it back",
        "created_at": "2022-06-06T07:54:18.300000+00:00",
        "attachments": null
    },
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "On gas limit in `PayloadAttributesV1` - I think it should be there and should be respected by ELs, regardless of boost builder capabilities\n\n1) Off-the-shelf software lacks a couple more things to become a builder, for example the block's profit. Modifying `PayloadAttributesV1` is not the best way to do it - relying on FCU is a way to make it work, but it's not something that will be good enough for production use.\nRelay \u003c-\u003e builder API is not yet specced out, but as we think of it it'll require some more modifications to EL clients past the profit that might not fit well with the EL spec\nHaving said that I think it makes a lot of sense for EL teams to implement the requirements for block building, I'm not sure if it has to be done through the EL spec, maybe it should be it's own thing.",
        "created_at": "2022-06-06T10:15:43.081000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "Hey, I'm failing the gasLimit check I do on the builder bid:\nthis is the reason:\n```\nProposed gasLimit not honouring validator preference. Parent gasLimit: 30000000 Proposed gasLimit: 29970705 Preferred gasLimit: 20000000 Expected proposed gasLimit: 29970704\n```\nSo the 30 million divided by 1024 is 29296 so I'm expecting a gasLimit set to 30million - 29296 = 29970704 since the registered gas limit is 20million",
        "created_at": "2022-06-06T13:41:41.391000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "who is right? ðŸ™‚",
        "created_at": "2022-06-06T13:42:25.541000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "this is happening in the opposite side too, you hardcoded 30million as max gasLimit. I'm not a EL expert so in this case I don't know If I should permit such a big gasLimit\n```\nProposed gasLimit not honouring validator preference. Parent gasLimit: 30000000 Proposed gasLimit: 30000000 Preferred gasLimit: 40000000 Expected proposed gasLimit: 30029296\n```",
        "created_at": "2022-06-06T13:54:15.186000+00:00",
        "attachments": null
    },
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'm using geth's internal `CalcGasLimit` which does `delta := parentGasLimit/params.GasLimitBoundDivisor - 1` https://github.com/ethereum/go-ethereum/blob/3038e480f5297b0e80196c156d9f9b45fd86a0bf/core/block_validator.go#L109\nhttps://github.com/flashbots/boost-geth-builder/compare/de23cf910b814867d5c5d1ad6164835d79069638...master#diff-689874b30f6f905ce6c47cdefeddcf052b467a7936a981f4b6cf38939e10d924R1009",
        "created_at": "2022-06-06T15:06:25.183000+00:00",
        "attachments": null
    },
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "Can't find the spec for it, but it's unfortunate if the clients differ",
        "created_at": "2022-06-06T15:19:28.636000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "Interesting. I think we should have clarifications in the builder spec somewhere. In the meantime I'll consider geth as reference.",
        "created_at": "2022-06-06T17:06:29.994000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "not deprecated afaik, builders have between 0-32 bytes to put whatever",
        "created_at": "2022-06-06T18:53:40.104000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah, the general point comes down to how much we modify the engine api to respect multiple pathways \n\nspecifically re: the gas limit, most consumers of the local build process will just configure their EE once with the desired amount",
        "created_at": "2022-06-06T18:55:56.969000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "i can raise a PR to see if there is interest one way or another",
        "created_at": "2022-06-06T18:56:22.373000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "this particular line just refers to the ability of the proposer to change the block gas limit by **up to but excluding** 1/1024 of the parent",
        "created_at": "2022-06-06T19:23:58.748000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "Ok clear, I doublechecked besu and it is consistent. But I still don't get why gasLimit has not increased if parent block was at 30m and the gasLimit of the registered validator was 40m",
        "created_at": "2022-06-06T19:26:52.120000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "the gas limit can be whatever you want, there is unspoken consensus atm that 30 mil is a good upper bound",
        "created_at": "2022-06-06T19:28:25.123000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "if the fb relay is failing over 30 mil then they have effectively soft-forked the protocol ðŸ˜›\n\ni personally wouldnâ€™t set a max (although there is room to bar something outrageous)\n\nthat being said it is better for network health if there is a soft cap enforced so i wonâ€™t take any further action here right now",
        "created_at": "2022-06-06T19:31:26.648000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "so to close the loop the gas limit ending in 5 which i think is what the relay provides is correct wrt the protocol",
        "created_at": "2022-06-06T19:32:48.331000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "otherwise the block would be invalid",
        "created_at": "2022-06-06T19:32:57.151000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "what i said above, you are using a builder that has effectively implemented a soft fork",
        "created_at": "2022-06-06T19:34:21.497000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "this isnâ€™t the worst type of thing a builder can do so i donâ€™t think cause for alarm at the moment",
        "created_at": "2022-06-06T19:34:56.887000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "another builder could in the long run out compete this builder by squeezing just that much more mev out of the mempool",
        "created_at": "2022-06-06T19:35:35.351000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "yep, good. I'll update my delta calculation.",
        "created_at": "2022-06-06T19:35:35.630000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "this type of stuff will be fun to watch play out in the coming years ðŸ˜‡",
        "created_at": "2022-06-06T19:35:57.813000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "It means I need to relax the check when expecting GL over 30m",
        "created_at": "2022-06-06T19:36:33.393000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah but i thought this was hard coded into the flashbots relay? havenâ€™t looked at the code yet",
        "created_at": "2022-06-06T19:37:15.260000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "or not permitting GL over 30 in our conf",
        "created_at": "2022-06-06T19:37:22.476000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "i wouldnâ€™t just go changing this in your client",
        "created_at": "2022-06-06T19:37:38.677000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "it has ramifications for the overall health of the protocol so if someone put in an effective hard cap they have good reason for doing so",
        "created_at": "2022-06-06T19:38:13.323000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "there was an eip to make this a protocol constant a bit ago",
        "created_at": "2022-06-06T19:38:35.475000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "https://eips.ethereum.org/EIPS/eip-3756",
        "created_at": "2022-06-06T19:39:22.809000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "you can imagine it got some pushback",
        "created_at": "2022-06-06T19:39:29.428000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "interestingly there have been eips in the past to do the same thing just with smaller caps",
        "created_at": "2022-06-06T19:39:52.552000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "interesting. But my question is: since we decided to send GL preference via registration, it means we expect builder to act in respect to this param. It is a bit strange that it applies it only  under certain conditions.",
        "created_at": "2022-06-06T19:42:24.757000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "If i configure my local EL to 40m it will be respected I guess",
        "created_at": "2022-06-06T19:42:54.059000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "right i mean if iâ€™m following then the fb relay has gone off spec to enforce a cap",
        "created_at": "2022-06-06T19:44:45.369000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "there is no cap right now according to the specs",
        "created_at": "2022-06-06T19:45:21.443000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "I suspect that ðŸ™‚ lets wait for a feedback from them",
        "created_at": "2022-06-06T19:45:33.612000+00:00",
        "attachments": null
    },
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "Iâ€™ll see to it, we should be allowing to go over 30M",
        "created_at": "2022-06-06T20:01:18.056000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Cross-layer",
        "parent": "",
        "content": "I wouldn't have thought we'd reject a block (and give up all the rewards) because the gas limit wasn't what we expected. At most we'd log a warning.  I'd kind of like to avoid implementing the difficulty calculation in Teku though as it may change with hard forks.  I'd be very tempted to log a warning if the gas limit didn't move in the direction of our request (but not do the actual calculation to check if it moved as far as possible).",
        "created_at": "2022-06-06T21:07:10.544000+00:00",
        "attachments": null
    }
]
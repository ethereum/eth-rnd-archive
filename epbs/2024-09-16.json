[
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "simple one, shouldn't `value: Gwei` be `value: uint256` in the header?",
        "created_at": "2024-09-16T08:34:55.055000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "generally speaking, on CL interfaces it's Gwei",
        "created_at": "2024-09-16T08:36:30.746000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "where is this?",
        "created_at": "2024-09-16T08:36:41.502000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "The modified `ExecutionPayloadHeader`, I have just been comparing it to the builder bid in the builder-specs https://github.com/ethereum/builder-specs/blob/main/specs/bellatrix/builder.md#builderbid but  actually `Gwei` (uint64) is more accurate, so can ignore this question.",
        "created_at": "2024-09-16T08:48:50.523000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "oh, yeah EPH would have Gwei",
        "created_at": "2024-09-16T08:49:49.045000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "it's firmly a CL creature",
        "created_at": "2024-09-16T08:50:02.307000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "If value is the value of the execution payload then it should be a `uint256`, as it could be (pretty much) any value of Wei.",
        "created_at": "2024-09-16T10:05:50.883000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "it is the value of the execution payload, ah yeah  the `blockValue` from the engine api is wei, forgot about that",
        "created_at": "2024-09-16T10:11:44.865000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "would be I think the first `UInt256` in a CL layer proper if it's put in EPH. worth considering, since this ends up in `BeaconState` etc",
        "created_at": "2024-09-16T10:16:24.514000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "the engine/builder approach amounts to having a wrapper object with the block (or block + blobs, or bid, or etc) + the value",
        "created_at": "2024-09-16T10:17:02.007000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "It is the value of the bid, and it stays Gwei over my dead body",
        "created_at": "2024-09-16T10:56:43.162000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "I suspect you have your idiom the wrong way around.  Are you trying to say that it should stay as a gwei value, and not be turned into a uint256?\n\nIf so, will there not be issues when the gwei value is incorrect compared to reality?  And if not, why is this value in state?",
        "created_at": "2024-09-16T11:00:48.619000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "This value is what is deducted from the builder in a payment to the proposer for including his block. There is no need for this value to be WEI since we can only deduct Gwei in the beaconchain anyway. This value **may be obtained** from comparison reasons, from the corresponding Wei value in the engine API from the local block, but that Wei value is useless for purposes of this beacon state entry. The reason this has to be in the state it is because the builder's payment is part of consensus",
        "created_at": "2024-09-16T11:04:02.561000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "we could always lift the API decision to the CL spec, and that's the part that I say \"over my dead body\", no way in hell this turns into a 32 byte unnecessary object as it is already unnecessary in the API",
        "created_at": "2024-09-16T11:04:45.736000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "So does the builder supply this value in gwei, or could it supply it in wei?",
        "created_at": "2024-09-16T11:25:18.180000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "it supplies it in gwei, that's the header that they are talking about, it's signed by the builder",
        "created_at": "2024-09-16T11:27:26.557000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "Oh yes of course, all BN operations are in Gwei. Forgot to convert the engine `value` from wei to gwei in the code, and failed the gossip builder's balance validation. That's why I brought it up here. Now it's clear. Thanks.",
        "created_at": "2024-09-16T12:43:18.689000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "ohh crap you guys may beat us to devnet, I should probably focus more and stop slacking",
        "created_at": "2024-09-16T13:11:04.192000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Cross-layer",
        "parent": "",
        "content": "happy to have a call!",
        "created_at": "2024-09-16T13:29:14.060000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "haha no no, I wish, just implemented the \"naive\" VC bid building approach that Terence was talking about, but everything fails in the fork choice obviously.",
        "created_at": "2024-09-16T13:29:45.388000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "wanna use the audio channels here?",
        "created_at": "2024-09-16T13:29:50.875000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Cross-layer",
        "parent": "",
        "content": "let's try it out in 5 mins",
        "created_at": "2024-09-16T13:31:37.667000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Sure, I'll be waiting in the party lounge",
        "created_at": "2024-09-16T13:31:50.733000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "spotted a small one https://github.com/ethereum/consensus-specs/pull/3923",
        "created_at": "2024-09-16T16:01:07.194000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Left a comment there, I don't think this is correct, that field is overwritten with the first ePBS block",
        "created_at": "2024-09-16T16:03:47.226000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "At any rate it seems that we are moving most likely withdrawals to the payload",
        "created_at": "2024-09-16T16:04:27.139000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "ah yes, you are right, it's a bug on my side, didn't see it in the spec",
        "created_at": "2024-09-16T16:10:35.705000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@981249983196041218\u003e in slot auction, for the proposer to use mev-boost, the relayer/builders have to trust the proposer not to unbundle them in the same slot right? It seems like it's easier to unbundle in the same slot in ePBS slot auction than mev-boost today since PTC just votes for timeliness and the next slot proposer could simply choose to build on top of the \"stolen-mev\" block",
        "created_at": "2024-09-16T18:49:07.171000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "Don't want to raise PR again to close seconds after ðŸ˜€ , but looking at the state upgrade and we have `latest_execution_payload_header=ExecutionPayloadHeader()`,we should set the block_hash from the `pre.latest_execution_payload_header` rather than \"ZERO\" it. The `is_parent_block_full` function relies on it.",
        "created_at": "2024-09-16T19:53:03.086000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think you also will want to set `state.latest_block_hash`? Alternatively we could say that `is_parent_block_full` should always return true before `EIP7732_FORK_EPOCH` if we worry about edge cases",
        "created_at": "2024-09-16T20:02:24.493000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah, fork.md sets the state.latest_block_hash to the same",
        "created_at": "2024-09-16T20:03:35.641000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "Ya this makes sense to me",
        "created_at": "2024-09-16T20:17:42.897000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "https://github.com/ethereum/consensus-specs/pull/3924",
        "created_at": "2024-09-16T20:40:01.954000+00:00",
        "attachments": null
    }
]
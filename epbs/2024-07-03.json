[
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "Definitely. Just saying both are vulnerable to this: `the builder can start building two blocks up to the last second, release late, and bid higher on the next block because of the extra info`.",
        "created_at": "2024-07-03T00:00:06.996000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "yes, both are, but slot auctions are worse",
        "created_at": "2024-07-03T00:00:33.787000+00:00",
        "attachments": []
    },
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "Do we assume the payload times out on the proposer? If it times out for the proposer, would the proposer just build on empty? or wait? or full? We probably need to discuss what the correct action should be here.",
        "created_at": "2024-07-03T00:02:18.344000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "the proposer calls `get_head` to build, if the payload hasn't validated, it will build on his head, which is empty",
        "created_at": "2024-07-03T00:07:07.353000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Who's the sadistic person that wrote the linters for the python spec?",
        "created_at": "2024-07-03T00:07:33.576000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I got everything to pass except one silly error",
        "created_at": "2024-07-03T00:10:19.699000+00:00",
        "attachments": []
    },
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "Ah you are right. In my head I had your attack reversed:\n1. the payload doesnt time out for proposer, so proposer builds on `n, full`\n2. the payload times out for attesters at `n+1` so attestsers votes for `n-1`. But this is also wrong! The attesers would still vote for `n` and follow the PTC votes on whether it's empty or full",
        "created_at": "2024-07-03T00:14:05.521000+00:00",
        "attachments": []
    },
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "I added an agenda item to p2p bid filtering discussion for Friday. \n```\nRegarding the gas limit, I wonder if the current P2P specification needs modification. Assume the following setup: `validator_a` wants a gas limit of 30M, while `validator_b` wants a gas limit of 40M. The builder knows this disparity and broadcasts two individual bids, one for 40M and one for 30M. The bids need to hop through `validator_a` to get to `validator_b`.\n\nIf `validator_a` receives the 30M bid first, it will pass the 30M bid to `validator_b` and drop the 40M bid. Depending on who is proposing, either `a` or `b` will use the 30M bid, even though the `b` prefers the 40M bid.\n\nIf `validator_a` receives the 40M bid first, it will pass the 40M bid to `validator_b` and drop the 30M bid. Depending on who is proposing, `a` cannot propose with the 40M bid while `b` can.\n```",
        "created_at": "2024-07-03T17:56:03.543000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think nothing has to be done in the p2p stack for this, as for the gas_limit, that's already in the agenda",
        "created_at": "2024-07-03T18:05:46.026000+00:00",
        "attachments": []
    },
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah. This post is responding to the gas limit topic. Whether to consider p2p.\n\nI worry about a potential P2P split where validators won't receive the correct gas limit bids. This issue persists unless we can assume that builders are really well-peered.",
        "created_at": "2024-07-03T18:11:10.798000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I don't understand any of this, why would a validator care about the gas_limit over P2P, this isn't even checked",
        "created_at": "2024-07-03T18:13:18.634000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "the builder can send whatever bid they want",
        "created_at": "2024-07-03T18:13:25.017000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "and yes, if they send something that the proposer is not interested in, then it won't be accepted",
        "created_at": "2024-07-03T18:13:48.879000+00:00",
        "attachments": []
    },
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "But not every node is connected directly to the builder; some nodes are connected through second or third hops. As the current P2P specification is constructed, you accept one bid and then drop the rest. This means the builder can't send multiple bids with different gas limits. Maybe this isn't a significant use case anyway. \n\nI was thinking that for RPC, you could have a use case where `get_header` specifies a gas limit amount, and the builder constructs the bid with that gas limit on the fly.",
        "created_at": "2024-07-03T18:17:32.064000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yes, for RPC in the beacon API we will add the gas_limit as a suggestion in the API I think",
        "created_at": "2024-07-03T18:19:35.589000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I don't care much about the P2P stack. Since anyway it's a suggestion, so if the proposer is not getting headers for the limit it wants, it will have to use any of the ones he's getting",
        "created_at": "2024-07-03T18:20:29.286000+00:00",
        "attachments": []
    },
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah I agree. I also think bids over p2p should be treated as baseline anyway and the builders should be sufficiently peer'd",
        "created_at": "2024-07-03T18:25:40.856000+00:00",
        "attachments": []
    },
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "Fyi here. The EIP is merged and we have a number (EIP-7732) now: https://eips.ethereum.org/EIPS/eip-7732",
        "created_at": "2024-07-03T20:07:26.030000+00:00",
        "attachments": []
    }
]
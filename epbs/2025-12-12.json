[
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "i suppose information about how the proposer will rank bids could be useful to include as well in the preferences? or in the get bid request https://discord.com/channels/595666850260713488/692078615269212180/1448993425415344179",
        "created_at": "2025-12-12T11:08:56.684000+00:00",
        "attachments": null
    },
    {
        "author": "l03443",
        "category": "Cross-layer",
        "parent": "",
        "content": "some protocols like preconfs require an opted in proposer to always pick headers from the protocol relay and never fallback to local building (since this would be breaching the preconf and risk slashing), afaik this is done in a bit hacky way by adding a large value to the bid. it could also make sense to support this use case if possible",
        "created_at": "2025-12-12T11:13:08.153000+00:00",
        "attachments": null
    },
    {
        "author": "povilas8490",
        "category": "Cross-layer",
        "parent": "",
        "content": "Hello, I have trouble understanding the spec, please help me out:\n\n```\n*    If block.slot == current_slot (i.e., data.slot), then always set data.index = 0.\n*    Otherwise, set data.index based on the payload status in the validator's fork-choice:\n        Set data.index = 0 to signal that the payload is not present in the canonical chain (payload status is EMPTY in the fork-choice).\n        Set data.index = 1 to signal that the payload is present in the canonical chain (payload status is FULL in the fork-choice).\n\n```\n(https://github.com/ethereum/consensus-specs/blob/v1.6.1/specs/gloas/validator.md#attestation)\n\nDoes that mean that when validators attest a block produced in the same slot during propose duty, attestation `data.index` will always be 0?\n\nIf so, does that mean in fork choice during head selection nodes without a payload usually will have bigger weight than nodes with payload?\n\nWhat am I missing here?",
        "created_at": "2025-12-12T12:02:48.847000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "FYI we've moved the WIP builders branch from my fork to the ethereum org:\n* https://github.com/ethereum/consensus-specs/compare/master...builders",
        "created_at": "2025-12-12T15:06:59.702000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Still very much a work in progress. I'm going to work on getting tests passing today.",
        "created_at": "2025-12-12T15:07:20.373000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Any feedback would be appreciated.",
        "created_at": "2025-12-12T15:07:29.820000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "So far I like the changes üôÇ",
        "created_at": "2025-12-12T15:07:46.390000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "I will push to get this into a ready-to-review state asap",
        "created_at": "2025-12-12T15:08:31.563000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Can you open a PR, even if draft? it makes reviewing it much better",
        "created_at": "2025-12-12T15:10:44.646000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I can review this afternoon",
        "created_at": "2025-12-12T15:10:52.072000+00:00",
        "attachments": null
    },
    {
        "author": "fradamt",
        "category": "Cross-layer",
        "parent": "",
        "content": "I was  temporarily worried about the 1 ETH thing because of being able to drown out honest bids in p2p, but I guess the concept of \"honest bid\" is somewhat pointless when the payment is enforced. Just only forwarding the currently highest bid should be perfectly fine regardless of how many bids are theoretically floating around",
        "created_at": "2025-12-12T15:19:40.146000+00:00",
        "attachments": null
    },
    {
        "author": "fradamt",
        "category": "Cross-layer",
        "parent": "",
        "content": "(I think this was well understood already, just repeating it in case someone else had the same concern)",
        "created_at": "2025-12-12T15:20:02.123000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "we where thinking on forwarding highest paying as long as it increases the bid by \u003e x, or x% where x is to be determined. But since we only forward a single bid per validator, perhaps x = 0 is already good enough",
        "created_at": "2025-12-12T15:24:41.911000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "What worries me about the 1ETH is the possible state bloat, I didn't understand your explanation to be the same as today",
        "created_at": "2025-12-12T15:25:03.287000+00:00",
        "attachments": null
    },
    {
        "author": "fradamt",
        "category": "Cross-layer",
        "parent": "",
        "content": "Can I not make e.g. 100k 1 ETH deposits today? Is the difference that, though the state bloat is ~the same, that the cost and budget are actually much lower because I would then not be able to withdraw those validators without first activating them, which would require another 3.1M ETH?",
        "created_at": "2025-12-12T15:34:24.675000+00:00",
        "attachments": null
    },
    {
        "author": "fradamt",
        "category": "Cross-layer",
        "parent": "",
        "content": "Anyway, what would be a good solution, assuming we're not constrained by the deposit contract? Just contract-side rate limits on the amount of deposited builders?",
        "created_at": "2025-12-12T15:36:02.815000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I still don't understand, ahhhh I think I do, you mean depositing just 1 ETH to create a validator, but yeah you can't withdraw it",
        "created_at": "2025-12-12T15:42:01.868000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think the solution should be have a very very large window for exits",
        "created_at": "2025-12-12T15:42:34.379000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Most builders would not want to exit anyway",
        "created_at": "2025-12-12T15:43:02.119000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Will make it into a PR. But just know that it's still a WIP and tests will fail.",
        "created_at": "2025-12-12T17:00:50.892000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Can you expand upon this? I don't understand.",
        "created_at": "2025-12-12T17:01:10.561000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Also it would be **really** great if we could get these PRs merged soon.\n* https://github.com/ethereum/consensus-specs/pull/4765\n* https://github.com/ethereum/consensus-specs/pull/4766",
        "created_at": "2025-12-12T17:01:57.434000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "I hate working with the existing version of it. It's awful.",
        "created_at": "2025-12-12T17:02:16.847000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Didn't I review those? they seem good to me",
        "created_at": "2025-12-12T17:03:05.707000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yes you did. But I need other devs to review it too.",
        "created_at": "2025-12-12T17:03:19.286000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Also, there have been several changes since your last review.",
        "created_at": "2025-12-12T17:03:28.619000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I mean that if we make a large window for exits, then the attack of depositing and withdrawing just to blow the beacon state is not really an issue.",
        "created_at": "2025-12-12T17:03:57.104000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Large window == slow exits/withdrawals for builders?",
        "created_at": "2025-12-12T17:04:24.843000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "yes, for builders",
        "created_at": "2025-12-12T17:04:31.332000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yes. We can do this üëç",
        "created_at": "2025-12-12T17:04:43.152000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "should be immediate deposit, very slow withdrawal",
        "created_at": "2025-12-12T17:04:43.981000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Agreed üëç",
        "created_at": "2025-12-12T17:04:53.699000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "4096 epochs (18 days)?",
        "created_at": "2025-12-12T17:05:35.626000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "More?",
        "created_at": "2025-12-12T17:05:42.108000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I honestly don't see why we can't onboard them pre-fork. When processing deposits you can just deposit to the builder one if there is one in the builder slice and if not, deposit to the validator.",
        "created_at": "2025-12-12T17:06:26.040000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "This shouldn't affect builder payments though, right? Payments == ~instant; exits == very slow?",
        "created_at": "2025-12-12T17:07:20.423000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah this doesn't change builder payments",
        "created_at": "2025-12-12T17:07:49.944000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "How would you make deposits/withdrawals to the validator after the the builder exists with the same pubkey?",
        "created_at": "2025-12-12T17:13:47.726000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "How do implementers feel about tracking balances in the builder structure? cc \u003c@641548687813902336\u003e \u003c@363800010518822915\u003e",
        "created_at": "2025-12-12T17:14:52.442000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "https://github.com/ethereum/consensus-specs/pull/4787",
        "created_at": "2025-12-12T17:19:37.926000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Please leave as much feedback as you want. Happy to take suggestions here too.",
        "created_at": "2025-12-12T17:21:22.276000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "A quick read and I find two performance hit: one is the balance in the builder, this may not be so problematic, but passing pubkeys to helpers is",
        "created_at": "2025-12-12T17:25:30.845000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think you should keep the builder index in the pending builder withdrawal",
        "created_at": "2025-12-12T17:25:53.932000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I dont see why you need to move to pubkeys",
        "created_at": "2025-12-12T17:26:03.810000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "I converted it to use pubkeys because it simplified `get_pending_balance_to_withdraw`:",
        "created_at": "2025-12-12T17:27:46.764000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "",
        "created_at": "2025-12-12T17:27:47.990000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "47d09ce28f4e9f34b213ce1fb7f9624f064cb0f7c98778eef7489f374e6b8a43"
            }
        ]
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah I see that, but I think that's most probably a bad choice",
        "created_at": "2025-12-12T17:28:10.148000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Maybe. We can change this if we want.",
        "created_at": "2025-12-12T17:30:17.318000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "oh  I realized I never left these comments",
        "created_at": "2025-12-12T17:40:35.758000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@755590043632140352\u003e why do you want this? I see no benefit in a separate field for builder balances.",
        "created_at": "2025-12-12T18:10:10.764000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Same as for validator avoid hashing.",
        "created_at": "2025-12-12T18:11:03.600000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Hmm I see.",
        "created_at": "2025-12-12T18:11:40.472000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Does it make a difference that only a single builder's balance would change each slot?",
        "created_at": "2025-12-12T18:12:16.821000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "But yeah, if that turns out to be really inefficient, we will add a new `state.builder_balances` field.",
        "created_at": "2025-12-12T18:24:42.190000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Nah it's probably fine as is",
        "created_at": "2025-12-12T18:31:25.378000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "The other one of the pubkey I'm pretty sure it's a bad idea",
        "created_at": "2025-12-12T18:32:03.435000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah I'll think about this some \u0026 have \u003c@520034910149410861\u003e weigh in too. Reverting this would be easy.",
        "created_at": "2025-12-12T18:33:43.420000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "regarding this, https://discord.com/channels/595666850260713488/874767108809031740/1442324025266143284\n\ni.e. using a `validator_index` helps with proof of possession",
        "created_at": "2025-12-12T18:57:40.855000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "if this makes other signature verification less efficient, it might be a false economy",
        "created_at": "2025-12-12T18:58:31.640000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "This doesn't make any signature verification easier since these helpers don't verify any signature",
        "created_at": "2025-12-12T19:05:37.219000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "those helpers don't, no",
        "created_at": "2025-12-12T19:06:23.042000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "but other things use that field",
        "created_at": "2025-12-12T19:06:28.678000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "So this stems from changing in the builder pending payment which is never signed so I think this will save zero lookups",
        "created_at": "2025-12-12T19:07:22.040000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "ah ok",
        "created_at": "2025-12-12T19:07:48.070000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "And introduces at least one per payment",
        "created_at": "2025-12-12T19:07:49.426000+00:00",
        "attachments": null
    },
    {
        "author": "fradamt",
        "category": "Cross-layer",
        "parent": "",
        "content": "It would be worth it to build in reusing of indices, so that it's actually impossible to permanently bloat the state without keeping capital locked up earning no yield",
        "created_at": "2025-12-12T23:10:31.746000+00:00",
        "attachments": null
    },
    {
        "author": "fradamt",
        "category": "Cross-layer",
        "parent": "",
        "content": "I never looked into the efforts to do this for validators, but presumably it should be quite simple here since there's  no slashing?",
        "created_at": "2025-12-12T23:16:05.127000+00:00",
        "attachments": null
    },
    {
        "author": "fradamt",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@\u0026595685821026271242\u003e",
        "created_at": "2025-12-12T23:19:45.397000+00:00",
        "attachments": null
    },
    {
        "author": "fradamt",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@\u0026595685821026271242\u003e",
        "created_at": "2025-12-12T23:22:43.584000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "metachris_",
        "category": "Cross-layer",
        "parent": "",
        "content": "The problem with balance-diff block-level scoring is that a proposer can make a specific builder always win the bids for their slot, by providing a transaction that increases the feeRecipient balance, either directly or indirectly through smart contracts. This is not something that should be ignored lightly.",
        "created_at": "2022-10-04T10:02:02.239000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "But given the proposer can provide a transaction from an arbitrary address how to know the difference between actual MEV and \"fake\" MEV in this way?\n\n(Also, doing this is still against the proposer's best interests as they are promoting builder A over builder B, where builder B may have a better block for the proposer.)",
        "created_at": "2022-10-04T10:28:09.453000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "And apropos to yesterday's conversation, there are currently no MEV-built blocks on mainnet that paid anything other than that which their bid said they would, outside of a few very early blocks when the relays had known bugs.\n\nGiven the complexities involved, I'd be inclined to think that as long as someone is looking out for bad relays and reporting them it isn't something that is required to be built in to all beacon nodes.",
        "created_at": "2022-10-04T10:30:07.272000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "A builder wanting preferential treatment can already do this essentially by just paying more to the proposer.",
        "created_at": "2022-10-04T11:30:35.506000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "How do we know this?",
        "created_at": "2022-10-04T11:31:19.720000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "I had a chunk of the data already lying around, and ran the numbers.\n\nObviously it makes sense to have a couple of independent implementations, but if someone else can also do the work to calculate this it puts us in a relatively good place without further work.",
        "created_at": "2022-10-04T11:35:26.192000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "How do you figure out how much the relay claimed the block was worth?",
        "created_at": "2022-10-04T11:41:50.257000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "The relays provide an API to obtain that information, for example https://boost-relay.flashbots.net/relay/v1/data/bidtraces/proposer_payload_delivered",
        "created_at": "2022-10-04T11:47:33.055000+00:00",
        "attachments": []
    },
    {
        "author": "metachris_",
        "category": "Cross-layer",
        "parent": "",
        "content": "And there's this tool to check the value from on-chain data (using getBalance) and comparing it to the claim in the API: https://github.com/dvush/check-relay-value",
        "created_at": "2022-10-04T12:07:10.414000+00:00",
        "attachments": []
    },
    {
        "author": "metachris_",
        "category": "Cross-layer",
        "parent": "",
        "content": "Here's the API docs btw: https://flashbots.notion.site/Relay-API-Spec-5fb0819366954962bc02e81cb33840f5#417abe417dde45caaff3dc15aaae65dd (I'm happy that this data transparency API has been adopted by all the relays, even though it still requires a bit of trust in the data. at some point soon the relay monitors will be fully working, and have the signed bid data directly from the `getHeader` API).",
        "created_at": "2022-10-04T12:09:38.648000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "This is still just trusting the relay.",
        "created_at": "2022-10-04T12:17:18.861000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "My argument here is that we have no idea if the relays are lying right now because we have no way to actually validate their claims, we are just blindly trusting them on every front.",
        "created_at": "2022-10-04T12:17:48.587000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Of course a lying relay would not publish its lies: it would just send one number to the proposer and then publish the *real* number to their publicly viewable metrics.",
        "created_at": "2022-10-04T12:18:27.742000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Who provides this signed bid to the monitoring system, the relay or the proposer?",
        "created_at": "2022-10-04T12:19:26.092000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "Proposers receive a signed copy of the bid so they can prove what the relay told them.  They can check this information against the publicly posted numbers at the endpoint and yell if there is a discrepancy (which would require no significant effort on their part, and importantly no back-and-forth with any chain data).",
        "created_at": "2022-10-04T12:25:58.832000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@\u0026595685821026271242\u003e",
        "created_at": "2022-10-04T12:40:03.812000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Are the signed proposals written to disk or database?  Are they at *least* written to the logs?",
        "created_at": "2022-10-04T13:38:47.506000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Do we know of *anyone* who is actually validating that the signed proposals they receive match what the relay later returns to its public API?",
        "created_at": "2022-10-04T13:40:02.934000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "Up to each individual beacon node.",
        "created_at": "2022-10-04T13:40:36.085000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "We (Attestant) are, although it's part of a wider range of checks that we carry out rather than an individual thing.",
        "created_at": "2022-10-04T13:41:23.166000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "Is the software you have written to do this publicly available and/or easy for validators to run?",
        "created_at": "2022-10-04T13:41:59.915000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Cross-layer",
        "parent": "",
        "content": "It is good to know that *someone* is actually validating the data, but I feel like we should be striving towards *everyone* validating the data with automated warning systems for when the relayer lies.  I don't like having everyone just kinda trust the relayers to be good.  It may work for a bit, but at any point in time that can fail and we should have a system in place that ensures we'll notice it when it does.",
        "created_at": "2022-10-04T13:43:00.496000+00:00",
        "attachments": []
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "It's getting there: https://github.com/wealdtech/comptrollerd\n\nBut it is unlikely ever to be easy for individual validators to run, as it does more than just check for inconsistent bids and for that it leans on https://github.com/wealdtech/execd for transaction trace information.  A much simpler system could be written if users just wanted to check before/after balances, I'd imagine.",
        "created_at": "2022-10-04T13:46:52.076000+00:00",
        "attachments": []
    }
]
[
    {
        "author": "julianma_",
        "category": "Cross-layer",
        "parent": "",
        "content": "In the sense of your earlier message yes that makes sense because a proposer could release an equivocating payload if it had committed to itself in the beacon block. If the proposer commits to a trusted third party like a relay though, then both the proposer and builder would trust the third party not to release an equivocating payload. This is probably also the more efficient solution because then there is no extra communication hop from the relay to the proposer for signing",
        "created_at": "2024-09-17T07:34:53.144000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@641548687813902336\u003e \u003c@363800010518822915\u003e regarding the discussion above. I do not think this is needed. You never check against that blockhash",
        "created_at": "2024-09-17T12:18:16.319000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "And `latest_block_hash` is already taken care of in the spec",
        "created_at": "2024-09-17T12:19:52.448000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "What about \n\n```\ndef is_parent_block_full(state: BeaconState) -\u003e bool:\n    return state.latest_execution_payload_header.block_hash == \nstate.latest_block_hash\n```",
        "created_at": "2024-09-17T12:20:43.470000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "left a comment in the PR, there is no call to that function except in process_withdrawals, which is now moved to the payload",
        "created_at": "2024-09-17T12:22:10.562000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "in the current spec it would simply delay withdrawals one slot",
        "created_at": "2024-09-17T12:22:29.301000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I am not strictly against this, but since semantically that header is just a bid, it does make sense to keep it defaulted since there wasn't any bid in the previous state",
        "created_at": "2024-09-17T12:23:41.338000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "In current spec, I think it will mess up `assert hash_tree_root(payload.withdrawals) == state.latest_withdrawals_root` while processing the payload since parent block was technically full. But yeah actually not needed when we move the processing withdrawals to the payload. I was looking at current spec.",
        "created_at": "2024-09-17T12:30:09.107000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "nope, in the current spec it will return early since the parent block is empty,.",
        "created_at": "2024-09-17T12:45:38.571000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "that on the fork block, the next block processes withdrawals fine",
        "created_at": "2024-09-17T12:45:51.903000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah but that assertion is when we process the payload in `process_execution_payload`",
        "created_at": "2024-09-17T12:46:57.226000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "ahh that's a nice catch, to fix the current spec we need to set the `latest_withdrawals_root` to be the root of the empty list. Similar to KZG commitments. These aren't catched by my next PR because there's no tests with payload envelopes yet",
        "created_at": "2024-09-17T12:51:43.012000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "instead of your PR I think it's better to fix that, although if we are moving to withdrawals in the payload, the whole `latest_withdrawals_root` dissapears",
        "created_at": "2024-09-17T12:52:13.279000+00:00",
        "attachments": null
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah agree, let's keep the bid defaulting and just wait wait for moving to the withdrawals PR, will close the PR, thanks for the discussion",
        "created_at": "2024-09-17T12:52:58.262000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "Well, you can think of an attack where the attacking proposers gain a networking edge and front-run the block released by the relayer, making most of the network see their block first. Would it be fair to say such out-of-protocol trust in the slot auction isn't a deal breaker because the trusted party has to trust the proposer to not perform a same-slot unbundle attack?",
        "created_at": "2024-09-17T13:23:06.388000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "If you listen to the call this is precisely what I raised there, but the point is that there is never any market that will develop for the proposer signing for himself",
        "created_at": "2024-09-17T13:25:44.105000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "they will sign for a trusted intermediary",
        "created_at": "2024-09-17T13:25:55.216000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "making this attack mute and still keeping the trusted advantage",
        "created_at": "2024-09-17T13:26:07.817000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "Fair point, the `builder_index` will never be proposer index, it'll be for example: relayer's index such that proposer can't attack here",
        "created_at": "2024-09-17T13:30:49.170000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "Is it for certain that `realized_value` at `t=6` is always going to be higher than `estimated_value` at `t=0`? Using the `realized_value`, you always have to pay the trusted auctioneer in the middle. Like today relayer takes a cut between proposer and builder",
        "created_at": "2024-09-17T14:18:20.503000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "no, it's not, we are using the case in whih it may even be negative as a point against block auctions",
        "created_at": "2024-09-17T14:36:51.093000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah, my only counter to the trusted argument is  \n1.) You lose unconditional payment  \n2.) You may have more parties to pay in the middle  \n\nThese are pretty weak arguments though, and I can't think of any better ones at the moment",
        "created_at": "2024-09-17T14:46:55.887000+00:00",
        "attachments": null
    }
]
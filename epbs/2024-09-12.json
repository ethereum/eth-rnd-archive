[
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think this is wrong: https://hackmd.io/@potuz/rJ9GCnT1C#Withdrawals\n```\nThe reason for this two-step approach rather than simply processing withdrawals with the execution payload is that withdrawals are beacon state based and can only be known at the moment of preparing the payload. However, the payload's hash is committed in the beacon block body which is revealed before the prestate for the payload is known.\n```",
        "created_at": "2024-09-12T00:00:00.030000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah that's outdated",
        "created_at": "2024-09-12T00:00:33.169000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "We can easily move the whole thing to the Payload",
        "created_at": "2024-09-12T00:00:48.151000+00:00",
        "attachments": []
    },
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "+1 on moving process withdrawals to the second half",
        "created_at": "2024-09-12T00:01:33.841000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I just didn't want to continue changing the spec when there were implementations in the way. It's a minor change and I consider interop more valuable and we keep a list of things that we agree to change in a second devnet",
        "created_at": "2024-09-12T00:02:06.536000+00:00",
        "attachments": []
    },
    {
        "author": "ethdreamer",
        "category": "Cross-layer",
        "parent": "",
        "content": "how far are people on their impls? cause I'm stil a ways off :/",
        "created_at": "2024-09-12T00:02:39.681000+00:00",
        "attachments": []
    },
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "true, might as well combine this with slot auction changes",
        "created_at": "2024-09-12T00:03:06.308000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think if Prysm ramps up, aka don't let Terence code alone, we can have single client devnet in a week or so. Problem is forkchoice that we can't come up with an effective impl",
        "created_at": "2024-09-12T00:16:20.332000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Lucas's PR is also invasive and I think it'll take me a few days to get the CL spec up to date after that merges. For some reason my local python testing is broken",
        "created_at": "2024-09-12T00:18:05.761000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "But I thought about the issue of moving withdrawals to the Payload. I don't mind if we decide this early. I can describe the trade-off tomorrow in the breakout although this was already discussed in the very first or second breakout",
        "created_at": "2024-09-12T00:20:54.317000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Can add it to the agenda",
        "created_at": "2024-09-12T00:21:03.117000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Instead that outdated the justification for this design is that it makes the minimum change in both layers, so that it's easier to prove the same safety guarantees. By processing with the beacon block we keep withdrawals exactly as they are today from the point of view of the beacon chain until the point in which a Payload is missing and we stop. By processing on the Payload the first ones that are processed are withdrawn less money and there are edge cases to think about with queued withdrawals in Electra. It's easier to reason about the safety of the current mechanism. If we move to the Payload I believe it's easier to implement, but someone should write the security justification. At least I want it to be clear that the problem is that someone that would guarantee withdrawing 32 ETH today, even if payloads are missing, will not get this guarantee in the other design. Cc \u003c@554799849288105986\u003e",
        "created_at": "2024-09-12T00:36:47.432000+00:00",
        "attachments": []
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "For Teku, not sure since we haven't touched fork choice yet  ðŸ¥²",
        "created_at": "2024-09-12T04:38:38.754000+00:00",
        "attachments": []
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "Just finished another round of reviewing https://github.com/status-im/nimbus-eth2/pull/6443 (it's an EPF project). Not yet to fork choice or networking.",
        "created_at": "2024-09-12T04:41:37.885000+00:00",
        "attachments": []
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah, for the moment, we're following the `consensus-specs` version of this, rather than hunting through different PRs, et cetera.",
        "created_at": "2024-09-12T04:44:09.051000+00:00",
        "attachments": []
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "Does it make sense to add `slot` to `ExecutionPayloadEnvelope`? It would  help to pass the correct epoch to  `get_domain` when signing the envelope.",
        "created_at": "2024-09-12T06:27:23.570000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Neither did we ðŸ™‚",
        "created_at": "2024-09-12T06:41:23.512000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Ah we had this issue, since you typically can't do anything with an envelope unless you have already a block, and the block has to be in forkchoice meaning you have to have its info in forkchoice, I assumed that you have the slot with fast access",
        "created_at": "2024-09-12T06:44:00.371000+00:00",
        "attachments": []
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "I was thinking more about VC signing and remote signers as well",
        "created_at": "2024-09-12T06:49:28.116000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Is there a situation in which you want to sign with anything other than your wall clock?",
        "created_at": "2024-09-12T06:51:01.371000+00:00",
        "attachments": []
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "Technically no, but don't think web3signer keeps track of the current slot, anyways can pass the slot in the request and keep it out of the envelope, will think about it later when we spec the remote signing API",
        "created_at": "2024-09-12T07:16:42.075000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah, we did discuss this issue internally, cc \u003c@363800010518822915\u003e you raised the same issue about the web3signer. I'm reluctact to adding extra 8 bytes everwhere, already pissed that the header has them, and ultimately it's included in the block making the slot being included at least twice in a block",
        "created_at": "2024-09-12T09:50:52.414000+00:00",
        "attachments": []
    },
    {
        "author": "stefanbratanov",
        "category": "Cross-layer",
        "parent": "",
        "content": "I agree, I don't like adding fields as well which are not used in the spec, let's keep it simple for now and change possibly if it causes concerns",
        "created_at": "2024-09-12T10:16:35.265000+00:00",
        "attachments": []
    }
]
[
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "i'm in the \"boolean\" camp too. having the payload hash is just redundant to me.",
        "created_at": "2025-06-24T07:33:38.067000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "do we want to take the opportunity to drop the committee index since we are changing it?",
        "created_at": "2025-06-24T07:34:51.736000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "I mean the `index` field which now is always 0",
        "created_at": "2025-06-24T07:35:22.490000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'd like to bring \u003c@425572898787426305\u003e in the conversation.\nLittle summary for him: we are thinking about changing `attestation_data` to give ability to validators to vote for presence of the execution payload.\nAs a consequence I think we should rise the block attestations from 8 to 16.",
        "created_at": "2025-06-24T07:46:24.922000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think 8 attestations is most likely still fine though: you can only attest to a Payload when you attest to a previous slot.",
        "created_at": "2025-06-24T09:18:48.045000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "If we really want to be hacky we can just use the index as a boolean and rename it",
        "created_at": "2025-06-24T09:20:09.136000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "honestly that's not a bad hack, it's really tedious/pointless-seeming to create the disruption otherwise",
        "created_at": "2025-06-24T09:30:06.688000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I wouldn't oppose the hack. Technically the field can be renamed and clients can do whatever they want",
        "created_at": "2025-06-24T09:32:42.451000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "sure",
        "created_at": "2025-06-24T09:44:14.625000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "though, would need to check for web3signer/etc, it's probably easier not to rename it, depending on people's serialization setups",
        "created_at": "2025-06-24T09:44:50.421000+00:00",
        "attachments": null
    },
    {
        "author": "fradamt",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah, we could/should enforce that the payload bit is 0 when `beacon_block_root` is from the current slot, so it still preserves that all votes are the same as long as there is no equivocation or conflicting view of the canonical chain prior to the current slot",
        "created_at": "2025-06-24T10:31:01.780000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah I got that already as a validation in pubsub. What's not kosher is that I think it's fine to accept in pubsub an attestation for a older block that you have but with a Payload that you don't have. It's fine to propagate the attestation but it should only be included once you've validated the Payload",
        "created_at": "2025-06-24T12:03:39.012000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "It's easier for Prysm at least not to rename it. Happy if we don't but I'm pretty certain that people will complain",
        "created_at": "2025-06-24T12:08:23.995000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "it only says `index`. `index` of what, who knows",
        "created_at": "2025-06-24T12:20:45.721000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "who can say",
        "created_at": "2025-06-24T12:20:52.346000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "but in the edge case in which 50% of the network is constantly seeing late payload and 50% sees the payload, we will consume double the block space. Am I correct?",
        "created_at": "2025-06-24T13:26:53.807000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "No, you only can vote for payload or not payload when you're voting for an old block",
        "created_at": "2025-06-24T13:27:27.782000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "If you're voting for the incoming block you vote without payload",
        "created_at": "2025-06-24T13:27:42.286000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "not old block. current block",
        "created_at": "2025-06-24T13:27:43.875000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "For current block you can't vote for the Payload content, that attestation counts for both",
        "created_at": "2025-06-24T13:28:28.517000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "It's only when the incoming block is not your head (or there's no incoming block) that you signal the Payload branch",
        "created_at": "2025-06-24T13:29:07.374000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "ohh I see.",
        "created_at": "2025-06-24T13:29:28.439000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "okok",
        "created_at": "2025-06-24T13:30:17.373000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "this is relevant if network splits and a good portion of the network votes for the previos head. and maybe there is even a split on that half where some votes for payload present and other for missing",
        "created_at": "2025-06-24T13:37:08.038000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "like: 50% votes for current N, 25% for N -1 with payload, 25% for N-1 without payload",
        "created_at": "2025-06-24T13:42:39.159000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "yes, if the chain is split AND on each branch of the split people are struggling to sync the payload in time, you may see a 4 way split counting with or without payload",
        "created_at": "2025-06-24T13:50:24.118000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "even in this scenario, 8 attestations should be fine for LMD",
        "created_at": "2025-06-24T13:50:41.237000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "my only concern is that even today, with a very stable participation, we tend to use all 8 attestations in the block (I assume they are all valuable). Some analysis show that the inclusion distance received an impact when ELECTRA activated. Ok, we are gradually improving clients and we will see better usage of the block space soon, but never the less, when networks become a bit unstable i think we will have a longer tail of votes struggling being included.",
        "created_at": "2025-06-24T14:04:56.907000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yes I agree, and we need to check if indeed more space is needed, I doubt ePBS makes this actually worse though. I suspect (and not have any actual data but I'm only going on a gut feeling) that the last few attestations are irrelevant for FFG and are even duplicate in a bunch of cases and just a result of bad aggregation. Those that come with higher inclusion distance are usually a couple of bits so not relevant even for LMD so I wouldn't worry about chain security. If anything it's about some validators rewards",
        "created_at": "2025-06-24T14:08:02.444000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "like in a situation like https://light-mainnet.beaconcha.in/slot/11995779 , instead of having the majority of votes on 2 attestations, we might need 3 on ePBS. I do agree we are talking about few validators on the long tail, in a healthy network.",
        "created_at": "2025-06-24T14:13:38.815000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "well, so it takes 6 of 8 rather than 4 of 8 possible attestations?",
        "created_at": "2025-06-24T14:16:11.287000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "not really, that' s only if there' s also a split along the payload",
        "created_at": "2025-06-24T14:19:42.074000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "I mean, the struggling long tail of validators might use double the space. But an \"healthy\" network split like that, where the last block is on the edge, might require 3 attestations, in the case the previous payload was on the edge too",
        "created_at": "2025-06-24T14:20:25.113000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Cross-layer",
        "parent": "",
        "content": "right, but either way it just doesn't look like that scenario pushes the 8-attestation-limit",
        "created_at": "2025-06-24T14:20:50.630000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "would you say the full degraded case here is two missing slots in a row? then there's a new block",
        "created_at": "2025-06-24T15:29:12.591000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'll go ahead and prioritize work this week on the blockchain changes for ePBS with the above hack of overloading the attestation index (cc \u003c@425572898787426305\u003e your input was called upon). Plan is for the following\n- Keep the attestation data exactly as is, not even rename\n- Add a new 0x03 builder prefix.\n- Allow self building for any validator, but enforce bid value 0\n- Add the payment queue\n- Pay via a withdrawal to a fee recipient\n- Remove any PTC reward logic\n- Add millisecond timelines. \n- Add the slot to the envelope structure\n\nI will not touch forkchoice as Francesco is already doing that. I will not add the two deadlines that \u003c@554799849288105986\u003e suggested because I am not rebasing to Fulu yet. WIll get the main Electra changes first and then rebase onto Fulu. This in particular means that the PTC attestation will not have a DA component yet, will however remove the option for the payload to be withheld",
        "created_at": "2025-06-24T15:50:32.718000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Cross-layer",
        "parent": "",
        "content": "guys, I will take a look at it tomorrow. Have been busy with other things today",
        "created_at": "2025-06-24T15:53:29.623000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "Any thoughts on where we should specify the \"proposer -\u003e builder (RPC)\" flow? High level, I’m thinking:\n\n* Remove registration\n* Keep `GetHeader` with the new format\n* Remove `SubmitBlindedBlock`\n* Once the header is fetched via RPC, the proposer runs `validate_header` before signing\n\nI’m torn between putting this in `validator.md` or `builder-api`. Either way, I’ll sketch it out in a hackmd first and get feedback from everyone. Then we can decide the best place to put it, does that plan sound reasonable?",
        "created_at": "2025-06-24T19:20:04.512000+00:00",
        "attachments": null
    }
]
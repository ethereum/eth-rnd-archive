[
    {
        "author": "fradamt",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think \u003c@539495253418180618\u003e is in the process of reviewing/wants to review the withdrawal flow. As for me, I looked at it again and it seems fine as is",
        "created_at": "2025-09-09T11:03:01.823000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah i wouldn't stop writing tests etc",
        "created_at": "2025-09-09T14:10:13.530000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "i think at the least we can refactor some so its more manageable",
        "created_at": "2025-09-09T14:10:23.580000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "i think in general withdrawals has gotten a bit unwieldy but the proper fix is likely its own EIP to overhaul how they work",
        "created_at": "2025-09-09T14:10:57.533000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah withdrawals are pretty bad pre-ePBS and ePBS makes it horrible, with some unspecified parts that have to be accounted for in clients that will be pretty bad to test. Example is if the payload is skipped, the next payload needs to have the same withdrawals that the previous payload did not fullfil, but those withdrawals are no longer obtainable from the head state, so clients need to cache them. \n\nSo in addition to the protocol ugliness of withdrawals post-Electra (they weren't so horrible in Capella, Electra made them really ugly) and the even weirder additions that ePBS brings, there are these new candies that have to be dealt at the client level without spec tests (at least none that I know how to do). \n\nWe could avoid the cache thing by enshrining the list of withdrawals that need to be fullfiled in the beacon state (instead of the root as it is currently) but that's ugly in itself.  Anyway, I fully agree that an overhaul of how withrawals work (or even if we keep the same functionality but change how the code looks) is in order.",
        "created_at": "2025-09-09T17:14:19.172000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "we could do a spec test with a block, skipped slot, and then another block, to ensure withdrawals conformance there",
        "created_at": "2025-09-09T17:25:04.286000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "but yeah, agree on the general point they have gotten a bit too complex",
        "created_at": "2025-09-09T17:25:18.221000+00:00",
        "attachments": null
    },
    {
        "author": "fradamt",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e but those withdrawals are no longer obtainable from the head state, so clients need to cache them. \n\nIs it maybe better to store `latest_withdrawals` instead of `latest_withdrawals_root`, tradeoff some extra state for avoiding the complexity?",
        "created_at": "2025-09-09T17:37:09.004000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah that's the content of this:\n\u003e ... (instead of the root as it is currently) but that's ugly in itself.",
        "created_at": "2025-09-09T18:43:53.261000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "We had a long discussion in a breakout over this and decided not to make the spec uglier for this, but happy to revisit it anyway. I don't think \u003c@539495253418180618\u003e' test really works for this cause the problem is at proposing, not in processing.",
        "created_at": "2025-09-09T18:45:05.318000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I am not entirely sure, but I think these types of bugs (proposing packing, etc) are usually tested in Kurtosis.",
        "created_at": "2025-09-09T18:45:51.655000+00:00",
        "attachments": null
    },
    {
        "author": "blockkshane",
        "category": "Cross-layer",
        "parent": "",
        "content": "crafted a PR to add/modify epbs related endpoints to the beacon api spec. would say it's in good shape for review! could discuss in epbs breakout room as well if think a good forum for it\n\nwill be great to have a standard for how the VC will communicate with the BN in a post-epbs world\nhttps://github.com/ethereum/beacon-APIs/pull/552",
        "created_at": "2025-09-09T20:05:24.880000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "haven't read the PR yet, will review tomorrow, but the description says you removed the value? why so?",
        "created_at": "2025-09-09T20:20:13.264000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "The local validator would need the value to compare with other bids they receive",
        "created_at": "2025-09-09T20:21:21.316000+00:00",
        "attachments": null
    },
    {
        "author": "blockkshane",
        "category": "Cross-layer",
        "parent": "",
        "content": "the `execution_payload_value`? i proposed removing that from the call from VC to the BN to get an unsigned block. figured the bid comparison logic would have already happened in the BN itself. then, the winning bid value gets sent along with this endpoint in the `BeaconBlock::BeaconBlockBody::SignedExecutionPayloadBid::value`",
        "created_at": "2025-09-09T20:24:50.177000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "ahhh yeah definitely, thanks... will look in detail tomorrow",
        "created_at": "2025-09-09T21:27:48.301000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I came across this just by chance. Out of pure curiosity would you mind telling me how does it work? Will the middleware take the call from the CL client and reply immediately faking the EL and then rely only relevant information to the builders?",
        "created_at": "2022-03-31T00:46:16.697000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@!755590043632140352\u003e it is no longer designed as middleware, instead the CL will request the relay (`mev-boost` is essentially  a relay multiplexer) to send it an `ExectuionPayload` except instead of the raw txs, the payload only includes the hash of txs. This is enough for the CL to \"blind sign\" the payload and return it to the relay. The relay will validate the signature and return the hydrated payload to the CL so it can propagate it to the network.",
        "created_at": "2022-03-31T00:50:14.236000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "AFAIK, the current design using the `engine_forkchoiceUpdated` only expects the CL to send fcu to the relay when `attributes` is not `nil`",
        "created_at": "2022-03-31T00:50:55.415000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'm aware of blinded blocks, but I'm concerned how to handle a reply to fcu",
        "created_at": "2022-03-31T00:51:09.902000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "this is why i'm requesting we remove fcu from this flow, it doesn't really make sense",
        "created_at": "2022-03-31T00:51:47.758000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "As far as I can see our implementation we send fcu essentially every block",
        "created_at": "2022-03-31T00:52:12.376000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "And every head change",
        "created_at": "2022-03-31T00:52:17.367000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "It's not difficult for the CL to only send fcu to it's builder when `attributes` is not nil though",
        "created_at": "2022-03-31T00:52:42.471000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "This is not about building, we need to validate our head",
        "created_at": "2022-03-31T00:53:00.907000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Even without a validator client, a beacon will send fcu every slot",
        "created_at": "2022-03-31T00:53:18.604000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "To know if the El has validated it's head",
        "created_at": "2022-03-31T00:53:34.798000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'm not sure I understand, the beacon will continue sending fcu to its ELs",
        "created_at": "2022-03-31T00:53:53.474000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "the relay is not an EL",
        "created_at": "2022-03-31T00:54:11.993000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "it determines the head of chain separately from validators interacting with it",
        "created_at": "2022-03-31T00:54:27.875000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Oh I see, this is my confusion, I was thinking as mev boost as a middleware between a builder that would replace our El and the CL. And that we could use a fallback when we weren't proposing",
        "created_at": "2022-03-31T00:55:31.472000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Thanks that explains it",
        "created_at": "2022-03-31T00:55:37.772000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yep! That was the old design, but the design has pivoted to the relay sitting beside the EL",
        "created_at": "2022-03-31T00:57:16.682000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "",
        "created_at": "2022-03-31T00:57:17.314000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "unknown.png",
                "content": "cc0b17806e307562f8025f6d938d9ec65206c38fb8ebf8a09de387304e733653"
            }
        ]
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Thanks, will have to catch up, impossible to stay up to date in this environment",
        "created_at": "2022-03-31T00:57:47.358000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "^ indeed",
        "created_at": "2022-03-31T00:58:32.771000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "We've taken over this channel for relay/builder related things, so please post any questions you have here",
        "created_at": "2022-03-31T00:58:59.297000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "I've added a `relay` subcommand to `mergemock`: https://github.com/protolambda/mergemock/pull/19",
        "created_at": "2022-03-31T01:56:09.252000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "will merge tomorrow afternoon, review welcomes in the meantime",
        "created_at": "2022-03-31T01:56:19.638000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Cross-layer",
        "parent": "",
        "content": "I have put a comment with my thoughts on that. I am also thinking about verifying `prevRandao`, `timestamp` and `feeRecipient` field values of returned payload header. Should it be CL or mev-boost responsibility?",
        "created_at": "2022-03-31T13:04:22.368000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@!425572898787426305\u003e hmm that might be an argument for including those values in the `getPayloadHeader` request - it would allow `mev-boost` to quickly filter through responses that actually match the request. Otherwise, we'll ship the header to the CL who will realize the values are wrong and then have to communicate to `mev-boost` they were invalid. I think that communication channel _does_ need to exist to let `mev-boost` know that a revealed payload was invalid though.",
        "created_at": "2022-03-31T16:45:39.995000+00:00",
        "attachments": null
    }
]
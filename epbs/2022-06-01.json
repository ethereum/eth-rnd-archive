[
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "yes, that part is meant a bit abstractly",
        "created_at": "2022-06-01T04:36:25.492000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Cross-layer",
        "parent": "",
        "content": "the overall thing there is the ‚Äúbuild process‚Äù\n\n\nif you elect to use the external builder network you would call for the header at the right time and then do the exchange to ultimately get the block",
        "created_at": "2022-06-01T04:37:22.571000+00:00",
        "attachments": null
    },
    {
        "author": "terence0083",
        "category": "Cross-layer",
        "parent": "",
        "content": "Got it. Thanks for the clarification!",
        "created_at": "2022-06-01T05:13:25.924000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think there's an issue with the calculation of `transactions_root` on the kiln relay. I was sent a `transactions_root` of `0x654d4dc29887d8f761d66aca0d385d72b2acadb7153eb95c09647ebe7e4eb575` in a blinded block. Attached is the payload revealed by the relay after the signed blinded block was returned.  Based on the revealed payload I think the `transactions_root` should have been: `0x61f1c1f38386bd84a499c7bc178fcd5a307b27ddde27c749e1300692a187b507`",
        "created_at": "2022-06-01T15:56:59.694000+00:00",
        "attachments": [
            {
                "type": "application/json; charset=utf-8",
                "origin_name": "payload.json",
                "content": "3c6299da764618675866e09fa1f644e3f2374a226c7d3853d60ff7803f29a0e7"
            }
        ]
    },
    {
        "author": "realbigsean",
        "category": "Cross-layer",
        "parent": "",
        "content": "Would appreciate if another CL team could verify what the tx root should be based on the attached payload as well üôè",
        "created_at": "2022-06-01T16:09:00.977000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "I don't have the HTR of just the payload, but I calculated the HTR of the entire struct you posted above as `0x17c84ab5a52679abebdfee21d6ce788ff384b6ef7cc03b7d79f7beba3859c526` if that helps.",
        "created_at": "2022-06-01T16:15:33.470000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Cross-layer",
        "parent": "",
        "content": "that's what I got for the struct as well, thanks",
        "created_at": "2022-06-01T16:19:47.619000+00:00",
        "attachments": null
    },
    {
        "author": "metachris_",
        "category": "Cross-layer",
        "parent": "",
        "content": "ping \u003c@861612909854588938\u003e \u003c@543900561460822016\u003e",
        "created_at": "2022-06-01T16:28:19.747000+00:00",
        "attachments": null
    },
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "Alright, I'll review the implementation then. Really cool to see the progress!",
        "created_at": "2022-06-01T16:30:32.421000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "a question about signing domain: given this: https://github.com/ethereum/consensus-specs/blob/20a90f1df7c5bf1eda45122e6a74abc07e02fd98/specs/phase0/beacon-chain.md#domain-types shouldn't the BUILDER domain be different than the MASK? I remember somewhere I read to be `0x10000001` but I can't find it atm. Can we confirm which is the right one?",
        "created_at": "2022-06-01T17:16:28.690000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "Ah yes, I think get it from the PR description: https://github.com/ethereum/consensus-specs/pull/2884",
        "created_at": "2022-06-01T17:18:00.193000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Cross-layer",
        "parent": "",
        "content": "well, technically having the type and the mask the same works..",
        "created_at": "2022-06-01T17:21:07.940000+00:00",
        "attachments": null
    },
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@144468805697929216\u003e I calculated the transactions_root using geth's `tx.UnmarshalBinary(hexutil.MustDecode(txData))` and `types.NewBlock(header, txs, []*types.Header{}, []*types.Receipt{}, trie.NewStackTrie(nil))` and it gave back `0x654d4dc29887d8f761d66aca0d385d72b2acadb7153eb95c09647ebe7e4eb575`, I can share the whole script if you'd like to take a look.\nShould it be calculated in some other way?",
        "created_at": "2022-06-01T17:22:26.680000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Cross-layer",
        "parent": "",
        "content": "Not sure on the execution side, but I suspect that would be using RLP for encoding and then hash the result.  Instead, the transactions should be encoded using SSZ and the hash tree root calculated.",
        "created_at": "2022-06-01T17:24:10.072000+00:00",
        "attachments": null
    },
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "Alright, let me try that. I can see it's also implemented like that in mergemock.",
        "created_at": "2022-06-01T17:27:36.264000+00:00",
        "attachments": null
    },
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@607055410104500244\u003e adjusted in the kiln relay!",
        "created_at": "2022-06-01T17:57:17.119000+00:00",
        "attachments": null
    },
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "You can also confirm by looking at the data at https://builder-relay-kiln.flashbots.net/",
        "created_at": "2022-06-01T17:57:50.542000+00:00",
        "attachments": null
    },
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@388610194608750595\u003e flagging for visibility",
        "created_at": "2022-06-01T17:58:21.782000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Cross-layer",
        "parent": "",
        "content": "Thanks! It looks the new transactions root is correct! I got a step closer to proposing but now I am getting an error from my local execution engine when validating the payload:\n\n`ExecutionPayloadError(RejectedByExecutionEngine { status: InvalidBlockHash { validation_error: None } })`\n\nSo I think there might be an issue with how `blockHash` is being calculated: \n\nhttps://github.com/ethereum/execution-apis/blob/main/src/engine/specification.md#specification\n\n```\nClient software MUST validate blockHash value as being equivalent to Keccak256(RLP(ExecutionBlockHeader)), where ExecutionBlockHeader is the execution layer block header (the former PoW block header structure). Fields of this object are set to the corresponding payload values and constant values according to the Block structure section of EIP-3675, extended with the corresponding section of EIP-4399.\n```",
        "created_at": "2022-06-01T18:53:03.746000+00:00",
        "attachments": null
    },
    {
        "author": "ruteri",
        "category": "Cross-layer",
        "parent": "",
        "content": "Alright, moving forward!\nI‚Äôll check if its implemented correctly",
        "created_at": "2022-06-01T19:17:46.369000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "ethdreamer",
        "category": "Cross-layer",
        "parent": "",
        "content": "So I'm digging into forkchoice changes. Your change to `get_ancestor()` is a bit complex. There's a trivial simpler version that's closer to the existing spec, but it would return something slightly different.\n\nIf we have blocks:\n(`B1`,`B2`,`B3`)\nwith roots:\n(`R1`,`R2`,`R3`)\nand slots:\n(`S1`, `S2`, `S3`)\n\nThen your existing `get_ancestor()` function when called with `get_ancestor(Store, R3, S1)` would return\n`ChildNode(R1, S1, is_parent_node_full(B2))`\nwhile the trivially modified version of this function would return:\n`ChildNode(R1, S1, is_payload_present(Store, R1))`",
        "created_at": "2024-10-04T18:23:34.743000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "Cross-layer",
        "parent": "",
        "content": "In other words, your existing `get_ancestor(Store, R3, S1)` function will return whether the chain from `B1` to `B3` is built with the payload for `B1` as present. The trivial version of this function will return whether the PTC voted that it is present",
        "created_at": "2024-10-04T18:27:46.501000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "Cross-layer",
        "parent": "",
        "content": "The trivial version would be this:\n```python\ndef get_ancestor(store: Store, root: Root, slot: Slot) -\u003e ChildNode:\n    block = store.blocks[root]\n    If block.slot \u003e slot:\n        return get_ancestor(store, block.parent_root, slot)\n\n    return ChildNode(root=root, slot=slot, is_payload_present=is_payload_present(store, root))\n```",
        "created_at": "2024-10-04T18:28:31.280000+00:00",
        "attachments": null
    },
    {
        "author": "ethdreamer",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'm not sure I understand the significance of the difference. I assume this difference is what motivated the more complex version of this function",
        "created_at": "2024-10-04T18:29:15.688000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah you can't use the PTC vote because the actual attestation chain may be different than the PTC vote. That is, the PTC may not vote for a Payload to be timely but the next proposer for example build on it anyway",
        "created_at": "2024-10-04T18:32:04.519000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "And attestations that voted for full will be miss counted if you use PTC",
        "created_at": "2024-10-04T18:32:50.868000+00:00",
        "attachments": null
    }
]
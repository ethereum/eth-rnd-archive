[
    {
        "author": "jed1559",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!743352062481530970\u003e https://medalla.launchpad.ethereum.org/",
        "created_at": "2020-08-17T01:10:35.679000+00:00",
        "attachments": null
    },
    {
        "author": "dhananjay2772",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Keep it ðŸ‘†",
        "created_at": "2020-08-17T05:16:16.696000+00:00",
        "attachments": null
    },
    {
        "author": "butta",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Out of curiosity, how much time are we giving Medalla? Assuming the worst case... \nI'd rather have a plan now than waiting for weeks ðŸ˜…",
        "created_at": "2020-08-17T11:24:24.974000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It's no longer recoverable?",
        "created_at": "2020-08-17T11:31:28.064000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Sorry just checking in after the weekend.",
        "created_at": "2020-08-17T11:31:36.506000+00:00",
        "attachments": null
    },
    {
        "author": "butta",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "we are trying to revive it, prysm pushed a new release ~12hours ago",
        "created_at": "2020-08-17T11:36:25.107000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Should be recoverable, just need more participants to update their nodes, get synced, and converge on something to attest",
        "created_at": "2020-08-17T11:37:40.167000+00:00",
        "attachments": null
    },
    {
        "author": "butta",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "i've said in the prysm discord: \nMy i7 6700k is currently sitting at 30-50% CPU usage, assuming many users have pi's and other weaker CPU's, they probably won't be able to stay in sync",
        "created_at": "2020-08-17T11:39:29.062000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "How many peers is it serving? How many validators is it running? (affects amount of gossipsub work)",
        "created_at": "2020-08-17T11:40:19.157000+00:00",
        "attachments": null
    },
    {
        "author": "butta",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "30 peers, 50 validators",
        "created_at": "2020-08-17T11:40:45.500000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I've done a \"Medalla Meltdown\" special edition of What's new in Eth2. Enjoy! https://hackmd.io/@benjaminion/eth2_news/https%3A%2F%2Fhackmd.io%2F%40benjaminion%2Fwnie2_200817",
        "created_at": "2020-08-17T22:18:34.421000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Hi \u003c@!573787335796326400\u003e , awesome! Would be nice to clarify that the issue was not due to clock sync, but rather a critical bug in our fix for it",
        "created_at": "2020-08-17T22:19:39.052000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We are working on a blog post detailing the entire incident",
        "created_at": "2020-08-17T22:19:46.493000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "basically, the roughtime issue resolved itself in 90 minutes, but we pushed out a fix for it that was critically flawed and broke everything",
        "created_at": "2020-08-17T22:20:10.970000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "if we hadnt acted, the network would have gone back to normal",
        "created_at": "2020-08-17T22:20:19.462000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!573787335796326400\u003e interesting point about switching clients \"mid-bug\", that almost suggests that not only do we want validator interoperability but also the ability for a validator to import/export their history which would simplify a lot of these slashing scenarios",
        "created_at": "2020-08-17T22:25:35.150000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Many validators actually got slashed by doing this migration process",
        "created_at": "2020-08-17T22:26:12.119000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "oh you basically say this, should have kept reading",
        "created_at": "2020-08-17T22:26:32.738000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "i imagine raul",
        "created_at": "2020-08-17T22:26:48.696000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "They migrated to a different client, and due to having produced a block 4 hours in the future in Prysm due to the roughtime bug, they got slashed 4 hours later once they were attesting in the other client",
        "created_at": "2020-08-17T22:26:50.398000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "makes sense",
        "created_at": "2020-08-17T22:26:58.104000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We gotta think about how to migrate the slashing protection history as well",
        "created_at": "2020-08-17T22:27:06.019000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Seems like keys might not be enough",
        "created_at": "2020-08-17T22:27:17.254000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e We gotta think about how to migrate the slashing protection history as well\n\u003c@311971895828283393\u003e  A JSON/YAML interchange format would be good for interop and also debugging around when you actually signed attestations vs when the network lost them.",
        "created_at": "2020-08-17T22:28:18.462000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "That sounds great, we can definitely write a tool to migrate our internal representation of slashing protection into a readable format",
        "created_at": "2020-08-17T22:28:50.271000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e That sounds great, we can definitely write a tool to migrate our internal representation of slashing protection into a readable format\n\u003c@311971895828283393\u003e I think we could do the same, would need to run it past Michael",
        "created_at": "2020-08-17T22:32:30.113000+00:00",
        "attachments": null
    },
    {
        "author": "benjaminion",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e Would be nice to clarify that the issue was not due to clock sync, but rather a critical bug in our fix for it\n\u003c@311971895828283393\u003e I looked through the incident report but couldn't really get a handle on the details of that bug. I'm not entirely convinced the network would have easily returned to normal even w/o the bug - but I'll add a note.",
        "created_at": "2020-08-17T22:37:22.770000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Sounds good, we'll post here once our report is out. Roughtime recovered by itself within the span of 90 minutes. The reason it got worse was because we pushed a fix that removed all critical features for our beacon nodes to function, and everyone tried to update at once",
        "created_at": "2020-08-17T22:38:36.852000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Do we have evidence that users got slashed when trying to migrate or we just assume. Just curious, I know its possible in this scenario",
        "created_at": "2020-08-17T22:39:01.046000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes indeed, we can try to get in touch with some of them if needed",
        "created_at": "2020-08-17T22:39:23.863000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "it happened to people that switched clients in the period of the roughtime bug",
        "created_at": "2020-08-17T22:39:35.142000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "One thing to consider is that as long as a VC never signs an attestation with an earlier justified epoch than justified in latest message and as long as  VC never signs an attestation for same or earlier epoch than latest message, then you only need the validators latest message to migrate safely.",
        "created_at": "2020-08-17T22:40:39.826000+00:00",
        "attachments": null
    },
    {
        "author": "raulj",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It also happened to some of our stakers that cleared their validator DB during that period of time, or didn't have a persistent volume in their running cloud instance / docker container",
        "created_at": "2020-08-17T22:40:57.906000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "These two rules would need to be enforced on both VCs so you take the risk of both pieces of software during the migration",
        "created_at": "2020-08-17T22:41:11.145000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But the rules can be extremely well audited and only pertain to the vc logic",
        "created_at": "2020-08-17T22:41:31.890000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Teku only records the highest block number, target epoch and source epoch that we've signed for our slashing protection.  It means if we'd had the time sync issue and signed something 4 hours in the future we wouldn't have signed anything else for 4 hours but it makes slashing protection dramatically simpler and use a tiny amount of disk space which is nice.",
        "created_at": "2020-08-17T22:43:44.207000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "nice",
        "created_at": "2020-08-17T22:44:09.619000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yeah, so again IF VCs always respect the following two rules, then import/export latest message provides safety in migration\n1. Never sign an attestation with an earlier justified epoch than previous max\n2. Never sign an attestation with head epoch as less than or equal to previous max",
        "created_at": "2020-08-17T22:45:36.125000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You also want to avoid signing a block with a slot less than or equal to previous max",
        "created_at": "2020-08-17T22:46:10.839000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yes, sorry! block as well. doh",
        "created_at": "2020-08-17T22:46:23.960000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "so we have two options\n1. standardize import/export of latest message (block and attestation) [or just a subset of the data, e.g `attestation_source: epoch, attestation_head: epoch, block: epoch`\n2. standardize import/export of entire slashable DB (which is very likely to be very different across clients)",
        "created_at": "2020-08-17T22:47:40.443000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I vote (1)",
        "created_at": "2020-08-17T22:47:53.965000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "2 isnâ€™t necessarily different, you could make an interchange format",
        "created_at": "2020-08-17T22:48:26.830000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I mean different in the sense that teku doesn't even track all attestation, just latest",
        "created_at": "2020-08-17T22:48:55.094000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ben made me write our signing records in a human readable form so we store a yml file for each validator we run containing:\n```\n---\nlastSignedBlockSlot: 25\nlastSignedAttestationSourceEpoch: 2\nlastSignedAttestationTargetEpoch: 3\n```",
        "created_at": "2020-08-17T22:49:16.047000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Iâ€™ll have to run it past Michael, a little hesitant to introduce new paths here and downgrade what we have currently",
        "created_at": "2020-08-17T22:49:46.056000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But that might be misplaced",
        "created_at": "2020-08-17T22:49:52.060000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "it wouldn't necessarily downgrade your current DB. It would just provide the starting point when someone enters into lighthouse",
        "created_at": "2020-08-17T22:50:21.587000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "but yeah, chat with michael",
        "created_at": "2020-08-17T22:50:29.496000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "and given that a client _can_ operate with that minimal info, you'll need to be able to start with that minimal info as a seed if you want to be able to accept users  migrating from clients operating with minimal info",
        "created_at": "2020-08-17T22:52:37.981000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think our DB is just a list of those minimal format, might be possible to make a format that supports both",
        "created_at": "2020-08-17T22:54:17.518000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Might be able to just add a rule that says never act on things earlier than the earliest entry",
        "created_at": "2020-08-17T22:54:48.416000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "that is safe",
        "created_at": "2020-08-17T22:55:08.211000+00:00",
        "attachments": null
    }
]
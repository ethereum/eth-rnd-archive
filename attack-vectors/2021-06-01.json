[
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If miners keep mining and releasing a new block disregarding from what was received from the wire this behaviour could orphan blocks with execution bombs. So, it depends on the miners' strategy; though, optimal strategy might be the one which would orphan blocks with an oddly high execution time. In the beacon chain if validator is honest and follows the spec these blocks would be orphaned due to the fork choice. Actually, it depends on how much time it takes to execute a block; if propagation time including execution is less than a slot then the next proposer will likely build its block on top of the previous one.",
        "created_at": "2021-06-01T07:08:48.913000+00:00",
        "attachments": []
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I don't think that it would be correct to make block proposals with execution bombs a slashable offence. Existence of such blocks would mean that gas cost of particular operation is irrelevant to resources consumed by this operation. And we should rather fix this discrepancy.",
        "created_at": "2021-06-01T07:23:18.089000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If 51% of validators attest to block `n`, and the next block proposer proposes a block built on top of `n-1` rather than `n`, what happens?",
        "created_at": "2021-06-01T08:23:11.024000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Same question if 49% of validators attest to block `n` and if 65%/67% of validators attest to block `n` (or any other magic thresholds).",
        "created_at": "2021-06-01T08:23:37.729000+00:00",
        "attachments": []
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Then `51%` block wins and the other one will be orphaned. If `49%` is voted for `A` and there is no `51%` votes for `A'` then `A` wins. There is a majority rule in the spec:\n```\n        # Sort by latest attesting balance with ties broken lexicographically\n        head = max(children, key=lambda root: (get_latest_attesting_balance(store, root), root))\n```",
        "created_at": "2021-06-01T08:28:52.887000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is it a slashing condition to vote for a block that excludes another block you voted for?",
        "created_at": "2021-06-01T09:14:51.230000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or is it just the fork choice rule that all current clients implement?",
        "created_at": "2021-06-01T09:15:11.087000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also, will a client refuse to accept/follow any block that doesn't build on top of a 51% attested block?",
        "created_at": "2021-06-01T09:15:54.728000+00:00",
        "attachments": []
    },
    {
        "author": "ajsutton",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Being wrong is never slashable - you can only get slashed for attesting differently twice in the same epoch, a surround attestation or creating two different blocks for the same slot.\nIt's fine if in one epoch you attest to one fork and then in the next one you attest to a different fork, that just means your view of the network changed (maybe you first received the other fork or maybe you just got more attestations that made you switch forks).",
        "created_at": "2021-06-01T09:27:04.735000+00:00",
        "attachments": []
    },
    {
        "author": "ajsutton",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There's nothing that makes a block which is not currently canonical invalid until finalization is reached for that epoch. So all forks are imported and tracked just like with eth1 and the canonical fork is the one with the greatest attesting balances.",
        "created_at": "2021-06-01T09:31:13.037000+00:00",
        "attachments": []
    },
    {
        "author": "ajsutton",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we have block X with two descendants A and A', and block A has 51% then it would be canonical.  However, in the next epoch all validators attest again and could, theoretically, change which fork they voted for and now attest to the chain descending from A'.  That would cause a reorg and A' would become canonical.\n\nIt would be quite unusual for a block that has 51% of the active validator balances attesting to it to wind up not being canonical but it's theoretically possible - I'm not sure if it could happen in normal operation, but potentially if all validators crashed and had to resync their view of the chain might change and then in later epochs they'd attest to a different fork.",
        "created_at": "2021-06-01T09:34:39.431000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or a 51% of active stake is maliciously trying to cause reorgs at finality boundaries?",
        "created_at": "2021-06-01T10:23:34.148000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "IIUC, the voting within an epoch is basically weak consenus building, and under the assumption of honest majority that will affirm the highest voted chain when it comes time for finality?",
        "created_at": "2021-06-01T10:24:36.652000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It isn't until finality though that the votes actually have meaning for the sake of permanence or consenus based fork choice rules?",
        "created_at": "2021-06-01T10:25:16.718000+00:00",
        "attachments": []
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Finality requires `\u003e=2/3` of active stake voting for the same root. It means that potentially justified and then finalized checkpoint requires at least `2/3` of active stake to get their fork choice converged around this checkpoint.",
        "created_at": "2021-06-01T10:35:46.437000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Finality can only happen on epoch boundaries, right?",
        "created_at": "2021-06-01T10:39:25.929000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You can't get finality by just having 2/3 attest to a particular slot?",
        "created_at": "2021-06-01T10:39:43.270000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Purely theoretical, you could have 100% attest to a particular block/slot, and then attest to a different chain that doesn't include that block in that slot come the end of the epoch?",
        "created_at": "2021-06-01T10:40:55.231000+00:00",
        "attachments": []
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If these pair of blocks are from the same epoch then you can't do that without being slashed. Cause you're voting twice for the same epoch",
        "created_at": "2021-06-01T10:42:37.475000+00:00",
        "attachments": []
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But if these blocks are from different epochs, e.g. subsequent ones, then this is theoretically possible",
        "created_at": "2021-06-01T10:43:37.125000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh, I thought you attested to a block each slot?",
        "created_at": "2021-06-01T10:52:08.777000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Maybe I should set aside the time to actually read the spec.  ðŸ˜–",
        "created_at": "2021-06-01T10:52:24.309000+00:00",
        "attachments": []
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Each validator attests once per epoch",
        "created_at": "2021-06-01T11:03:46.057000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What is the thing that happens 4 seconds into each slot?",
        "created_at": "2021-06-01T11:40:12.591000+00:00",
        "attachments": []
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Validators from committees that are assigned to a slot are producing and firing their attestations to the network",
        "created_at": "2021-06-01T11:44:06.502000+00:00",
        "attachments": []
    }
]
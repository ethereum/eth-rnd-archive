[
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003crecklessengineer\u003e anyone in berlin this week?",
        "created_at": "2022-09-11T08:30:16.160000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cvbuterin\u003e I am!",
        "created_at": "2022-09-11T08:30:30.730000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  Yep (re @recklessengineer: anyone in berlin this week?)",
        "created_at": "2022-09-11T08:31:40.893000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003crecklessengineer\u003e we booked a coworking space on thursday in case anyone wants to co-work! http://www.eventbrite.com/e/413088798717/?discount=OPFREN",
        "created_at": "2022-09-11T08:36:28.495000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cGrzegorz\u003e Hey all, I've started documenting Kev's work \u0026 differences compared to the spec and have a few questions/observations:\n 1. Do we expect to have some sort of CDN/proxy with rate limiting on top of this Rust server? Looks like /info endpoints are public (can be queried without signing in), return quite a lot of data and hold a read lock on AppState. We can starve the /contribute endpoint easily\n 2. When we do persistence, we should be more careful with locking. Right now there is a single global RWLock (GH issue: https://github.com/ethereum/kzg-ceremony-sequencer/issues/1)\n 3. @kevaundray Is there any reason why /queue/checkin was renamed to /slot/join? Do we have any naming preferences here?\n 4. What about queue vs lobby naming preference? Have we agreed if participants should be able to sign in when the lobby is full?",
        "created_at": "2022-09-11T10:22:44.289000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  For 1. Yeah there will be a rate limiter, we could use a reverse proxy or we could use the rate limit layer. I think here we probably want to apply different rates to different routes.\n\n2. Yeah I agree, we can have a finer read write lock on top of the app state, so that each endpoint can quickly release l locks when they no longer need them. This is done for the AppState and Transcript currently but can be made even finer.\n\n3. This was to differentiate between a queue and a lobby. So there is no longer a queue, there is only a lobby(no ordering) where each member is trying to get the slot to contribute.\n\n4. Re agreeing what to do when lobby is full.  I’d need to read the conversation above later, currently on mobile.\n\nBut overall, I was aiming to remove all queue terminology since a queue implies an ordering (re @Grzegorz: Hey all, I've started documenting Kev's work \u0026 differences compared to the spec and have a few questions/observations:\n 1. Do we expect to have some sort of CDN/proxy with rate limiting on top of this Rust server? Looks like /info endpoints are public (can be queried without signing in), return quite a lot of data and hold a read lock on AppState. We can starve the /contribute endpoint easily\n 2. When we do persistence, we should be more careful with locking. Right now there is a single global RWLock (GH issue: https://github.com/ethereum/kzg-ceremony-sequencer/issues/1)\n 3. @kevaundray Is there any reason why /queue/checkin was renamed to /slot/join? Do we have any naming preferences here?\n 4. What about queue vs lobby naming preference? Have we agreed if participants should be able to sign in when the lobby is full?)",
        "created_at": "2022-09-11T10:32:41.851000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  Re lock starvation, I think this might not be as big an issue once persistent storage is implemented, as the /contribute endpoint can read from disk. We’d mainly need fine grained access on the participant slot field (re @Grzegorz: Hey all, I've started documenting Kev's work \u0026 differences compared to the spec and have a few questions/observations:\n 1. Do we expect to have some sort of CDN/proxy with rate limiting on top of this Rust server? Looks like /info endpoints are public (can be queried without signing in), return quite a lot of data and hold a read lock on AppState. We can starve the /contribute endpoint easily\n 2. When we do persistence, we should be more careful with locking. Right now there is a single global RWLock (GH issue: https://github.com/ethereum/kzg-ceremony-sequencer/issues/1)\n 3. @kevaundray Is there any reason why /queue/checkin was renamed to /slot/join? Do we have any naming preferences here?\n 4. What about queue vs lobby naming preference? Have we agreed if participants should be able to sign in when the lobby is full?)",
        "created_at": "2022-09-11T10:56:40.833000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e Though I think we should then change the /slot/enter endpoint to return the transcript.\n\nBecause currently as implemented and spec’d , the participant gets it from a separate endpoint",
        "created_at": "2022-09-11T11:01:05.181000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cGrzegorz\u003e yeah, entering a slot should give you the most recent transcript. otherwise we risk working on a stale state",
        "created_at": "2022-09-11T11:02:30.251000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cGrzegorz\u003e 1-3. Ack. I think avoiding the word \"queue\" makes sense.\n\n4. One thing I'm still slightly worried about is choosing contributors based on who calls `/slot/join` first. It leaves some potential to deny access to others. By having an upper bound on the lobby size we can remember when was everyone's last ping without blowing up the memory. When `/slot/join` comes, we can ensure that that person didn't poll the endpoint too often.",
        "created_at": "2022-09-11T11:02:37.445000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e We _could_ also get rid of the endpoint to get the transcript in that case, though it’s probably best to confirm with the ui team that they don’t need it",
        "created_at": "2022-09-11T11:02:40.304000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  For 4, can you elaborate on the part about denying others? (re @Grzegorz: 1-3. Ack. I think avoiding the word \"queue\" makes sense.\n\n4. One thing I'm still slightly worried about is choosing contributors based on who calls /slot/join first. It leaves some potential to deny access to others. By having an upper bound on the lobby size we can remember when was everyone's last ping without blowing up the memory. When /slot/join comes, we can ensure that that person didn't poll the endpoint too often.)",
        "created_at": "2022-09-11T11:04:19.502000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e I think I shared some of the same concerns when the lobby approach was brought up, but would like to confirm we are on the same page",
        "created_at": "2022-09-11T11:04:58.612000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cGrzegorz\u003e i understand that we don't need the full transcript for contributors? just a trimmed contribution file?",
        "created_at": "2022-09-11T11:05:13.619000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cGrzegorz\u003e imagine a client that calls /slot/join in a tight loop. he has a much higher probability of being chosen to contribute. once his contribution is completed (or timed out), they might be kicked out from the lobby but that gives them time to sign in under a different account. if we don't remember who was rejected already, two valid accounts are enough to block progress",
        "created_at": "2022-09-11T11:06:35.751000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  Yeah because the full transcript has the witnesses too.\n\nI like the terminology “contribution file” and “transcript”\n\nThough the specs for sequencer are more general and use “state” and witness (re @Grzegorz: i understand that we don't need the full transcript for contributors? just a trimmed contribution file?)",
        "created_at": "2022-09-11T11:06:40.179000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  Once I call /slot/join in the lobby, I would not need to call it again and I guess I would call ping to tell the sequencer that I’m still alive? (re @Grzegorz: imagine a client that calls /slot/join in a tight loop. he has a much higher probability of being chosen to contribute. once his contribution is completed (or timed out), they might be kicked out from the lobby but that gives them time to sign in under a different account. if we don't remember who was rejected already, two valid accounts are enough to block progress)",
        "created_at": "2022-09-11T11:09:15.698000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cGrzegorz\u003e currently there is no /slot/ping. i thought /slot/join either registers you for the first time or acts as a ping.",
        "created_at": "2022-09-11T11:10:23.528000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e Yep you’re right, I was suggesting that we may need to add it if we start logging when participants called /slot/join because we’d want to know that they are still alive",
        "created_at": "2022-09-11T11:11:30.437000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cGrzegorz\u003e (created GH issue for returning contribution files when elected to contribute: https://github.com/ethereum/kzg-ceremony-sequencer/issues/2)",
        "created_at": "2022-09-11T11:11:30.686000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  Thanks, I’ll push the hackmd to the specs so that we can upstream all changes to the specs and then modify implementation in the future (re @Grzegorz: (created GH issue for returning contribution files when elected to contribute: https://github.com/ethereum/kzg-ceremony-sequencer/issues/2))",
        "created_at": "2022-09-11T11:12:24.798000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  Oh so calling /slot/join a second time would act as a ping. Hmm I think we would be going back to the queuing mechanism in this case? (re @kevaundray: Yep you’re right, I was suggesting that we may need to add it if we start logging when participants called /slot/join because we’d want to know that they are still alive)",
        "created_at": "2022-09-11T11:13:38.201000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e I guess a queue with a max size",
        "created_at": "2022-09-11T11:14:00.143000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cGrzegorz\u003e \u003e \u003cGrzegorz\u003e  awesome. i'll start creating PRs against specs today to match what we've discussed here (and then others can comment on them in a more structured way) (re @kevaundray: Thanks, I’ll push the hackmd to the specs so that we can upstream all changes to the specs and then modify implementation in the future)",
        "created_at": "2022-09-11T11:14:01.972000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  Feel free to change the structuring if you found it was hard to parse certain content :D (re @Grzegorz: awesome. i'll start creating PRs against specs today to match what we've discussed here (and then others can comment on them in a more structured way))",
        "created_at": "2022-09-11T11:17:51.551000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cGrzegorz\u003e \u003e \u003cGrzegorz\u003e  No, not queuing as there would be no ordering. We simply have a lobby of size X. Those X clients call /slot/join periodically, let's say every 10 seconds. Once the sequencer finishes with a single contribution, it \"opens up a slot\". Now, the first person to call /slot/join will receive info that they've been elected. Doesn't matter if they called /slot/join for the 1st or 100th time.\n\nThe only safety feature that I'd like to see here is that for each participant in the lobby, we keep their last /slot/join timestamp. If the new one comes too fast (e.g. faster than in 9 seconds), we ignore that contribution request (but might still choose to bump the timestamp to punish for not behaving up to the spec). (re @kevaundray: Oh so calling /slot/join a second time would act as a ping. Hmm I think we would be going back to the queuing mechanism in this case?)",
        "created_at": "2022-09-11T11:18:37.607000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  Oh I see, so the problem here is when a person just keeps calling /slot/join every second? (re @Grzegorz: No, not queuing as there would be no ordering. We simply have a lobby of size X. Those X clients call /slot/join periodically, let's say every 10 seconds. Once the sequencer finishes with a single contribution, it \"opens up a slot\". Now, the first person to call /slot/join will receive info that they've been elected. Doesn't matter if they called /slot/join for the 1st or 100th time.\n\nThe only safety feature that I'd like to see here is that for each participant in the lobby, we keep their last /slot/join timestamp. If the new one comes too fast (e.g. faster than in 9 seconds), we ignore that contribution request (but might still choose to bump the timestamp to punish for not behaving up to the spec).)",
        "created_at": "2022-09-11T11:21:11.278000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e I guess with ip rate limiting running /slot/join in a tight loop is not possible? \n\nHmm I guess they can wait for the sequencer to finish and then only ping then, so they would not be obligated to ping while the sequencer has the slot filled",
        "created_at": "2022-09-11T11:23:08.729000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cGrzegorz\u003e right. my solution doesn't help mitigate your last point and pretty much reduces to a regular rate limiting",
        "created_at": "2022-09-11T11:25:34.986000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e Would these two clauses mitigate it? \n\n- You cannot ping more than five times a minute \n\n- Every Y seconds the sequencer checks to see if you’ve pinged in the last X seconds",
        "created_at": "2022-09-11T11:26:16.915000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e So if you ping in a tight loop, you get rate limited, then sequencer kicks you out for not pinging in the last X seconds\n\nSo the rationale thing to do would be to evenly distribute your pings in this case, so that you don’t get kicked and or rate limited and also so that you get a spot",
        "created_at": "2022-09-11T11:27:55.167000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cGrzegorz\u003e it makes the attack much harder. you still need some tolerance for ping times (e.g. between 8-12 seconds to account for network issues, locking etc). with enough accounts in the lobby you could still target times when sequencer finishes processing previous contributions. not sure how much we worry about extreme scenarios like that",
        "created_at": "2022-09-11T11:34:46.425000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  Opened up a PR for this: https://github.com/ethereum/kzg-ceremony-sequencer/pull/3\n\nShould also be an issue open about not indenting the group elements in a PowrsOfTau struct (re @Grzegorz: (created GH issue for returning contribution files when elected to contribute: https://github.com/ethereum/kzg-ceremony-sequencer/issues/2))",
        "created_at": "2022-09-11T11:57:20.550000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cMarcin\u003e Account verification is now ready for review: https://github.com/ethereum/kzg-ceremony-sequencer/pull/10/files",
        "created_at": "2022-09-11T19:09:10.961000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  Left some initial comments, will test locally before revisiting (re @Marcin: Account verification is now ready for review: https://github.com/ethereum/kzg-ceremony-sequencer/pull/10/files)",
        "created_at": "2022-09-11T19:43:27.689000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cMarcin\u003e \u003e \u003cMarcin\u003e  addressed the first batch of comments :) (re @kevaundray: Left some initial comments, will test locally before revisiting)",
        "created_at": "2022-09-11T20:00:25.689000+00:00",
        "attachments": []
    }
]
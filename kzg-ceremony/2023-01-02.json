[
    {
        "author": "trent_vanepps",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "https://twitter.com/odin_free/status/1609885316961247233?s=20\u0026t=6FMD7gNSHwY8qSLD79Kccg",
        "created_at": "2023-01-02T15:41:46.063000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "hey everyone. while doing the \"core\" of the spot client, i noticed it would be useful to have a quick signal that i can include in a unit test that things are looking good compared to a the reference implementation.\nSo, I created this separate repo: https://github.com/jsign/kzg-ceremony-test-vectors ... I included a readme that might be helpful for other clients.",
        "created_at": "2023-01-02T16:46:58.596000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "with this i was able to realize that in my implementation, i had a field value in montgomery form instead of normal.. and i haven't yet tested with the sequencer so that was good early feedback/fixing",
        "created_at": "2023-01-02T16:47:45.773000+00:00",
        "attachments": []
    },
    {
        "author": "trent_vanepps",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "awesome, sounds like a useful tool then! we'll figure out how to get this to other people working on their implementations",
        "created_at": "2023-01-02T16:48:27.620000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yes. whenever i open up the repo of the client i'm working on, I'll include a link in the README there to the Go test that using this... prob will help to show as an example.",
        "created_at": "2023-01-02T16:49:14.682000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think there's a small bug in the reference implementation.\nIf you see the test vector (https://raw.githubusercontent.com/jsign/kzg-ceremony-test-vectors/9b2f500df32fb68e40e4586e0c1c3a9d91bb8aeb/updatedContribution.json), all `potPubKey` for each ceremony have the same value `0x93e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8`.\n\nThat shouldn't happen since `potPubKey` for each sub-ceremony depends on different secrets.\n\nLooking at the code, I think the problem is here: https://github.com/crate-crypto/small-powers-of-tau/blob/a958dbf0dd73f47e03aad6da50e033dddb83230c/src/serialisation.rs#L170\nSo that explains why `potPubKey` is always the same value, since `g2[0]` is always constant for all sub-ceremonies (the g2 generator).\nI think what was intended in that line was doing `pot_pubkey: SRS::g2s_to_json_array(g2s).get(1).unwrap().to_string(),` \n\nSo `get(1)` instead of `get(0)`. That would give `[x]G2` which works since the `initialContribution` is \"pristine\". (Maybe fine for the reference implementation?.. but the solution sounds more like an independent calculation)\n\nMaybe some repo owner can double check if this fix is correct? If that's the case, I'm happy making a PR :) (and I'd later update the test vector in my repo).",
        "created_at": "2023-01-02T17:03:48.445000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cMarcin\u003e I'd be careful calling that repo a reference implementation, I think it's some early and abandoned effort. Here's the one the sequencer actually uses.",
        "created_at": "2023-01-02T18:15:00.971000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cMarcin\u003e https://github.com/ethereum/kzg-ceremony-sequencer/tree/master/crypto",
        "created_at": "2023-01-02T18:15:11.688000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  I‚Äôm currently travelling will double check once I land or tomorrow.\n\nAs Marcin noted, the sequencer uses a different implementation now and that one is used in clients (re @kzg_ceremony_bot: \u003cignacio (jsign)\u003e I think there's a small bug in the reference implementation.\nIf you see the test vector (https://raw.githubusercontent.com/jsign/kzg-ceremony-test-vectors/main/updatedContribution.json), all `potPubKey` for each ceremony have the same value `0x93e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8`.\n\nThat shouldn't happen since `potPubKey` for each sub-ceremony depends on different secrets.\n\nLooking at the code, I think the problem is here: https://github.com/crate-crypto/small-powers-of-tau/blob/a958dbf0dd73f47e03aad6da50e033dddb83230c/src/serialisation.rs#L170\nSo that explains why `potPubKey` is always the same value, since `g2[0]` is always constant for all sub-ceremonies (the g2 generator).\nI think what was intended in that line was doing `pot_pubkey: SRS::g2s_to_json_array(g2s).get(1).unwrap().to_string(),` \n\nSo `get(1)` instead of `get(0)`. That would give `[x]G2` which works since the `initialContribution` is \"pristine\". (Maybe fine for the reference implementation?.. but the solution sounds more like an independent calculation)\n\nMaybe some repo owner can double check if this fix is correct? If that's the case, I'm happy making a PR :) (and I'd later update the test vector in my repo).)",
        "created_at": "2023-01-02T18:45:34.564000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@334704997122179072\u003e , \u003c@427491045308235776\u003e , sounds good. it might worth to remove it from here https://github.com/ethereum/kzg-ceremony#client-implementations since it's how I got there. probably it can help avoiding confusions.\ni'll check later if can generate the test vectors with the sequencer repo.",
        "created_at": "2023-01-02T18:48:13.125000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  That header is for client implantations; the repo should still be compatible with the sequencer, at least last time I checked (re @kzg_ceremony_bot: \u003cignacio (jsign)\u003e @Marcin , \u003c@427491045308235776\u003e , sounds good. it might worth to remove it from here https://github.com/ethereum/kzg-ceremony#client-implementations since it's how I got there. probably it can help avoiding confusions.\ni'll check later if can generate the test vectors with the sequencer repo.)",
        "created_at": "2023-01-02T18:50:04.856000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@427491045308235776\u003e, cool, just suggested removing it if that might be \"abandoned\" as mentioned. but if the intention is to still generate correct output, i'll be interested in your opinion about that `potPubKey` value generation whenever you check it tomorrow since sounds like that shouldn't be working with the sequencer. (no rush)",
        "created_at": "2023-01-02T18:53:52.003000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ckevaundray\u003e \u003e \u003ckevaundray\u003e  Yep no problem, there was a nasty bug in the sequencer‚Äôs cryptography back when I did run the tests against it, so it could be that that was why it was passing.\n\nWill let you know (re @kzg_ceremony_bot: \u003cignacio (jsign)\u003e @Kev, cool, just suggested removing it if that might be \"abandoned\" as mentioned. but if the intention is to still generate correct output, i'll be interested in your opinion about that `potPubKey` value generation whenever you check it tomorrow since sounds like that shouldn't be working with the sequencer. (no rush))",
        "created_at": "2023-01-02T18:55:58.158000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I've changed the test-vector generating code to use `ethereum/kzg-ceremony-sequencer`, https://github.com/jsign/kzg-ceremony-test-vectors/commit/7e8df17f4b12ce8e9b04c8d1240287f5b45bb0ea\nGot the same taus as calculated by `crate-crypto/small-powers-of-tau` . Now `potPubKeys` are looking good. üëç",
        "created_at": "2023-01-02T22:07:45.893000+00:00",
        "attachments": []
    }
]
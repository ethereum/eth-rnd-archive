[
    {
        "author": "lagake.",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!476250636548308992\u003e as per your suggestion running it with the \"--clear-db\" flag got me syncing, so thank you!",
        "created_at": "2020-07-26T09:16:32.647000+00:00",
        "attachments": null
    },
    {
        "author": "lagake.",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I delayed epoch 1462 on the Pyrsm chain for 12 minutes, if it helps anyone I find using \"--verbosity info\" to be the best for relative output for attacking the network with different ideas.",
        "created_at": "2020-07-26T12:15:47.075000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ah k, could you clarify this ? \n\u003e I delayed epoch 1462 on the Pyrsm chain for 12 minutes\n\nI checked the validator participation rate and it was still 100% from epoch 1462 onwards for the chain",
        "created_at": "2020-07-26T12:51:45.524000+00:00",
        "attachments": null
    },
    {
        "author": "lagake.",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I probably interpreted disconnecting nodes as disconnecting from the network rather than only disconnecting to my IP. Would the best way to verify this be checking the beaconChain.db file? Or perhaps setting up another node separate from the one used for attacking for better live test data...?",
        "created_at": "2020-07-26T13:35:27.135000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I suggest looking at prysms http api. You can monitor things like vote participation and peer count",
        "created_at": "2020-07-26T13:52:36.744000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e I probably interpreted disconnecting nodes as disconnecting from the network rather than only disconnecting to my IP.\nah , that would only be from your node/ip.",
        "created_at": "2020-07-26T13:56:49.378000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "you can look at our http api to monitor the node \nhttps://api.prylabs.net/",
        "created_at": "2020-07-26T13:57:05.518000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "if you want to find the participation at that epoch \n```\ncurl -X GET \"http://localhost:3500/eth/v1alpha1/validators/participation?epoch=1462\" -H \"accept: application/json\" \n```",
        "created_at": "2020-07-26T13:58:17.158000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "or \n```\n curl -X GET \"http://localhost:3500/eth/v1alpha1/node/peers\" -H \"accept: application/json\" \n```\nto find all the connected peers in the network",
        "created_at": "2020-07-26T13:59:18.824000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Whodunit? \n`lighthouse-attack-0` last finalized epoch 1447, current epoch 1498",
        "created_at": "2020-07-26T18:06:06.311000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "No blocks being produced",
        "created_at": "2020-07-26T18:06:26.148000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Either that, or something broke the way I'm checking chain health :P\nI'm seeing last finalized root as `930b11..e906`",
        "created_at": "2020-07-26T18:08:31.060000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'll check the logs",
        "created_at": "2020-07-26T18:19:06.789000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e slot: 48037, root: 0xa312â€¦2b6a, finalized_epoch: 1499, finalized_root: 0xaa8fâ€¦a819, justified_epoch: 1500, justified_root: 0x0623â€¦d984\nSeems fine",
        "created_at": "2020-07-26T18:20:41.653000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'll try and check what it was at your epoch range",
        "created_at": "2020-07-26T18:21:14.608000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!544848504078598144\u003e what is your method of checking chain health? I can try it on one of the attacknet nodes. Or was that just from logs?",
        "created_at": "2020-07-26T18:25:26.692000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Checking terminal output \u0026 REST API of a Teku instance running on this net",
        "created_at": "2020-07-26T18:28:31.764000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ðŸ˜›",
        "created_at": "2020-07-26T18:28:38.993000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Oh cool. Maybe you misconfigured the teku node? Does it have peers?\nI'll get some data from one of the lighthouse nodes now, and make a stake graph like with teku earlier",
        "created_at": "2020-07-26T18:29:40.928000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It has just 1 peer: the bootnode\nIt synced correctly till epoch 1447, then something mustâ€™ve broken\nIâ€™ll check the config stuff again",
        "created_at": "2020-07-26T18:31:24.158000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It's indexing 47000-48000 slot range now, let's see if there's anything odd",
        "created_at": "2020-07-26T18:34:38.410000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "```\nJul 26 12:59:17.198 DEBG Head beacon block                       slot: 46433, root: 0x8281â€¦c28c, finalized_epoch: 1449, finalized_root: 0xc9bcâ€¦5e07, justified_epoch: 1450, justified_root: 0x96b3â€¦73a1, service: beacon\n```\nSearched the logs and it finalized just fine there",
        "created_at": "2020-07-26T18:41:46.363000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Most boring chart ever lol. Lighthouse attacknet is healthy",
        "created_at": "2020-07-26T18:44:00.415000+00:00",
        "attachments": [
            {
                "type": "",
                "origin_name": "stake_lit.png",
                "content": "33b8496b7924bfb216f412e9274628a98c251f843dbf485c3e0992301fe19af6"
            }
        ]
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!544848504078598144\u003e You may be on a different chain or forkversion? That would also explain why you don't have more peers than your bootnode",
        "created_at": "2020-07-26T18:44:58.119000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Thanks \u003c@!203220829473996800\u003e",
        "created_at": "2020-07-26T18:48:07.206000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "https://enr-viewer.com/ says `0x80e1769b00000000ffffffffffffffff` for eth2 data. (digest, fork version, fork epoch)",
        "created_at": "2020-07-26T18:48:25.534000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Can you check your own ENR? See if that matches?",
        "created_at": "2020-07-26T18:49:22.798000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Some info for debug:\n\nCommand: `./teku --network=teku_config.yaml --rest-api-enabled --eth1-endpoint=https://goerli.infura.io/v3/\u003cendpoint\u003e --eth1-deposit-contract-address=0xdbb44f3e33640A820eECc0b893ED5aEC17150dbf --p2p-discovery-bootnodes=-LK4QHAlBrRpcx9d6JTRA5kVnTNSPwVs-v_QIwBE8wfZxIqPWqqMDGGKpZDXI2lhbbnO66cmGK3eEzot3D_P_MGbcUAhh2F0dG5ldHOIgRebSXZucWmEZXRoMpCA4XabAAAAAP__________gmlkgnY0gmlwhBLDX_-Jc2VjcDI1NmsxoQOnyC60XGPSxv86ncxxezh0khFdgu7E3Cqr4imui_h_6oN0Y3CCIyiDdWRwgiMo`\n\nI think after the initial sync, the Teku instance stopped getting new blocks. This may be an interop issue(?). `1446` was the last finalized epoch from the end of the initial sync.\n```\n2020-07-26 12:46:29.154+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 46369, Head slot: 45728, Connected peers: 1\n2020-07-26 12:46:41.155+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 46370, Head slot: 45970, Connected peers: 1\n2020-07-26 12:46:53.180+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 46371, Head slot: 46214, Connected peers: 1\n2020-07-26 12:47:09.141+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Slot Event  *** Slot: 46372, Block:    ... empty, Epoch: 1449, Finalized checkpoint: 1446, Finalized root: 930b11..e906, Peers: 1\n2020-07-26 12:47:21.139+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Slot Event  *** Slot: 46373, Block:    ... empty, Epoch: 1449, Finalized checkpoint: 1446, Finalized root: 930b11..e906, Peers: 1\n2020-07-26 12:47:33.139+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Slot Event  *** Slot: 46374, Block:    ... empty, Epoch: 1449, Finalized checkpoint: 1446, Finalized root: 930b11..e906, Peers: 1\n```",
        "created_at": "2020-07-26T18:50:23.032000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think you need to specify a config file if you join with teku",
        "created_at": "2020-07-26T18:50:49.480000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, the `--network=teku_config.yaml` is using https://github.com/ethereum/public-attacknets/blob/master/attacknets/lighthouse-attack-0/teku_config.yaml",
        "created_at": "2020-07-26T18:51:35.012000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah yes, I read too quick. Hmm",
        "created_at": "2020-07-26T18:51:56.747000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Connected to the node you're connected to, and it looks fine:\n```\n curl http://localhost:4000/consensus/global_votes?epoch=1451\n{\"current_epoch_active_gwei\":4096000000000,\"previous_epoch_active_gwei\":4096000000000,\"current_epoch_attesting_gwei\":3968000000000,\"current_epoch_target_attesting_gwei\":3968000000000,\"previous_epoch_attesting_gwei\":4096000000000,\"previous_epoch_target_attesting_gwei\":4096000000000,\"previous_epoch_head_attesting_gwei\":4096000000000}\n```",
        "created_at": "2020-07-26T18:54:36.641000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e Can you check your own ENR? See if that matches?\nYes, matches with `0x80e1769b00000000ffffffffffffffff`",
        "created_at": "2020-07-26T18:55:45.629000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e I think after the initial sync, the Teku instance stopped getting new blocks.\nAre there any known issues for Teku syncing with Lighthouse?",
        "created_at": "2020-07-26T18:58:02.854000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Nothing recent that I know of. A few weeks ago there was an issue with metadata RPC exchange, maybe you're hitting that",
        "created_at": "2020-07-26T18:58:40.906000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Just checked the peerstore of the node you're using. It says your peer has 0 reputation",
        "created_at": "2020-07-26T18:59:13.578000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And your ENR is filled with a non-public IP",
        "created_at": "2020-07-26T18:59:38.137000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "```\n  {\n    \"peer_id\": \"16Uiu2HAkxFHgTjQW1Kn5jJfsdDfk2AipvN94jR8nqqYarvQsVHEn\",\n    \"peer_info\": {\n      \"_status\": \"Healthy\",\n      \"score\": {\n        \"score\": 0\n      },\n      \"client\": {\n        \"kind\": \"Teku\",\n        \"version\": \"v0.12.2-dev-e64557e5\",\n        \"os_version\": \"linux-x86_64\",\n        \"protocol_version\": \"ipfs/0.1.0\",\n        \"agent_string\": \"teku/teku/v0.12.2-dev-e64557e5/linux-x86_64/-debian-openjdk64bitservervm-java-11\"\n      },\n      \"connection_status\": {\n        \"Connected\": {\n          \"in\": 0,\n          \"out\": 1\n        }\n      },\n      \"listening_addresses\": [\n        \"/ip4/10.128.0.4/tcp/9000/p2p/16Uiu2HAkxFHgTjQW1Kn5jJfsdDfk2AipvN94jR8nqqYarvQsVHEn\"\n      ],\n      \"sync_status\": \"Unknown\",\n      \"meta_data\": {\n        \"seq_number\": 0,\n        \"attnets\": \"0x0000000000000000\"\n      }\n    }\n  },\n```",
        "created_at": "2020-07-26T19:00:17.982000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I assume that's your teku node?",
        "created_at": "2020-07-26T19:00:52.422000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Update: Confirmed that only initial sync happens fine. Gossip is failing. Restarting the client downloads all the blocks up till current head, then it doesn't see any new blocks",
        "created_at": "2020-07-26T19:01:34.220000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "One problem with restarting teku is that it doesn't persit the p2p priv key or ENR data",
        "created_at": "2020-07-26T19:02:14.137000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e I assume that's your teku node?\nYes, that's me",
        "created_at": "2020-07-26T19:02:31.831000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "`16Uiu2HAkvyJa1Evpm22iAt3MuMw53NJmh3ABkTwZLXPHBzLqcheR` and peer ID just changed to this one?",
        "created_at": "2020-07-26T19:02:47.909000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yep!",
        "created_at": "2020-07-26T19:05:02.653000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'll move to DM for more logs, hope I don't spam here too much",
        "created_at": "2020-07-26T19:05:05.624000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!544848504078598144\u003e My guess is Lighthouse is using snappy compression for gossip but your command line hasn't enabled it for Teku.  Try adding `--p2p-snappy-enabled`",
        "created_at": "2020-07-26T21:04:40.923000+00:00",
        "attachments": null
    },
    {
        "author": "adiasg",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!340345049063882753\u003e Nice catch! That fixed it! ðŸ™‚",
        "created_at": "2020-07-26T21:24:05.915000+00:00",
        "attachments": null
    }
]
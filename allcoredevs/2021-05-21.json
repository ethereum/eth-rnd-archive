[
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "\u003c@!552133098075193354\u003e - I think the main question is about Tx pool implementation. I suppose we will try, but not very confident. I mean it will work on Ropsten I think, but testing tx pool logic properly does require a different approach to testing - I don't suppose the tests that we (or anyone?) currently have will give us high confidence that tx pool prioritisation is working as expected",
        "created_at": "2021-05-21T06:18:12.161000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "I would say putting such aggressive schedules up all way up until the end of the year (yes, I mean \"The merge in October\") is a good recipe to cause dev burnout, just saying",
        "created_at": "2021-05-21T07:24:06.609000+00:00",
        "attachments": null
    },
    {
        "author": "madeof_tin7509",
        "category": "general",
        "parent": "",
        "content": "I did some more analysis on the bomb for fun. I looked at what if the difficulty doubles or halves by December.",
        "created_at": "2021-05-21T08:53:33.761000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "unknown.png",
                "content": "6c21c640f8588f8eba4d301811fa6c5566d7d3987803b960d094934121361443"
            }
        ]
    },
    {
        "author": "madeof_tin7509",
        "category": "general",
        "parent": "",
        "content": "It basically will show up two weeks before or after Dec 7th.",
        "created_at": "2021-05-21T08:53:57.361000+00:00",
        "attachments": null
    },
    {
        "author": "madeof_tin7509",
        "category": "general",
        "parent": "",
        "content": "The red line is when the bomb typically shows. when the ratio is greater than 0.1",
        "created_at": "2021-05-21T08:54:44.346000+00:00",
        "attachments": null
    },
    {
        "author": "madeof_tin7509",
        "category": "general",
        "parent": "",
        "content": "",
        "created_at": "2021-05-21T09:05:45.198000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "unknown.png",
                "content": "bb194809b876abb2f559e24330657c4ee65b0990175177969fd58d9757c7c83c"
            }
        ]
    },
    {
        "author": "madeof_tin7509",
        "category": "general",
        "parent": "",
        "content": "It works better as a step graph.",
        "created_at": "2021-05-21T09:05:55.675000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "general",
        "parent": "",
        "content": "Is anyone considering merge in october? I think in order to manage public expectations we should communicate that the merge is earliest Q1 2022. \nMerging earlier is always possible, but moving the merge back half a year would be a bad look. \nImo the merge needs more testing than the last two hardforks combined, so we shouldn't rush it just to appease the public.",
        "created_at": "2021-05-21T09:09:04.288000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The most common thing I see people saying is November unlikely, but possible in theory with Q1 2022 being likely and Q2 2022 being probable.  I have also seen that expressed in terms of percentages.  ü§∑",
        "created_at": "2021-05-21T09:27:11.248000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Those people who made projections, did they look at the testing challenges? For EIP-1559, as I understand, one of the challenges that current tool used for producing consensus tests, only work on single-block scenarios. And for EIP-1559 it is quite valuable to have multi-block scenarios (because of changing baseFee) - these are called \"Blockchain Tests\". So it is my understanding that either current tool needs to be extended, or older tool (retesteth) will need to be used. Is that correct understanding, \u003c@!393119312350543872\u003e ?",
        "created_at": "2021-05-21T12:10:59.022000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "For the merge I know much less in terms of testing scope",
        "created_at": "2021-05-21T12:11:19.096000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Regarding Tx pool changes for EIP-1559, after some thinking, I concluded for now, that prioritisation has to be made by whatever effective payment miner/block proposer is going to receive, and derive efficient implementation from there. Rather than looking at the current implementation and come up with the \"least disruptive\" change that approximates correct ordering (for example, ordering by `feeCap`). Yes, transactions will need to be re-ordered at every block (and perhaps do some insertions when a new transaction comes in), but it should not too bad if one builds up an array of pairs `\u003ceffective_tip; pointer_to_tx\u003e`, and sorts it by `effective_tip`. This should be efficient enough even for tens of thousands txs in the pool. Newly arriving transactions may need to insert into the middle of this array, which is mem-copy. This initial implementation (I believe it has been referred as \"vector\" in some documents), which optimal in economic sense but perhaps sub-optimal (but efficient enough) in the implementation efficient should get us far enough before more sophisticated data structures are tested and deployed.",
        "created_at": "2021-05-21T12:26:45.934000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "general",
        "parent": "",
        "content": "We can make blockchain tests with retesteth. Both if I implrment the chain rules and we have besu supporting the test protocol to challenge chain logic directly on a client implementation",
        "created_at": "2021-05-21T12:29:31.102000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "general",
        "parent": "",
        "content": "There are PRs already",
        "created_at": "2021-05-21T12:30:06.728000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "Also, \u003c@!524738020033691659\u003e worked on such tests. We had some chats about that in particular on the fuzzing calls",
        "created_at": "2021-05-21T13:12:09.660000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "great, thank you for the info",
        "created_at": "2021-05-21T13:20:55.245000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "How would we go about testing this?",
        "created_at": "2021-05-21T13:54:21.943000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "I think currently this is implementation dependent",
        "created_at": "2021-05-21T13:55:00.145000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "unless there is something like this in hive, I am not sure",
        "created_at": "2021-05-21T13:55:15.629000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "We are planning to write tests with the \"mock sentry\" to inject transactions into the pool, then trigger mining and check the ordering in the block that comes out",
        "created_at": "2021-05-21T13:55:54.422000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "For this, \u003c@415548822983278593\u003e had a write up looking at how to do it: https://hackmd.io/@adietrichs/1559-transaction-sorting-part-2",
        "created_at": "2021-05-21T13:56:02.663000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "Also, I agree re: burnout, hence why I‚Äôm trying to gauge progress here, which is a bit hard to do by just looking at merged PRs, which are sort of the ‚Äútip of the iceberg‚Äù",
        "created_at": "2021-05-21T13:58:03.805000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "general",
        "parent": "",
        "content": "This link is 404 (before the message was edited, that is)",
        "created_at": "2021-05-21T14:05:13.761000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "https://hackmd.io/@adietrichs/1559-transaction-sorting-part2",
        "created_at": "2021-05-21T14:05:40.916000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "Missed a character at the end, my bad!",
        "created_at": "2021-05-21T14:05:54.183000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "also, there is actually a \"good trade\" for the merge. \"In exchange\" for less aggressive roll-out plan, It might be possible to amend the definition of the merge under which the withdrawal of funds from beacon chain into Eth1 state is possible right after the merge, and not after yet another hard-fork. I think this would be quite good for giving small validators a fairer playing ground. Because as it stands now, beacon validators aren't actually getting paid, and even after the current merge spec, they will only be paid tx fees, while having their deposits still living in the separate state.",
        "created_at": "2021-05-21T14:06:31.740000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "And I believe this amendment is not very hard to do",
        "created_at": "2021-05-21T14:06:52.474000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "The fact that validators aren't getting paid is bad because only people with sufficient capital can afford such game",
        "created_at": "2021-05-21T14:07:45.345000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "We should move that to \u003c#692062809701482577\u003e üòÑ",
        "created_at": "2021-05-21T14:33:12.014000+00:00",
        "attachments": null
    },
    {
        "author": "holgerd77",
        "category": "general",
        "parent": "",
        "content": "Totally no memopool expert, but shouldn't the size of the memopool shrink significantly with 1559 by txs being included in blocks a lot faster/more efficiently? ü§î Are there any estimates on this actually?",
        "created_at": "2021-05-21T15:55:37.316000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "\u003c@!425269142615097345\u003e I think that may be true for the average node, but perhaps not for miners, who want to keep a lot of \"possible to include in future blocks\" txns",
        "created_at": "2021-05-21T15:56:21.983000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "So if miners are the main users you are optimizing the txn pool for, you probably want to be able to handle at least as many txns as now",
        "created_at": "2021-05-21T15:56:41.176000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "It will be much easier post-1559 to tell if a txn is unincludable in the current block (`maxFee` \u003c `baseFee`), but if the `baseFee` goes down in the next block, that txn can be included.",
        "created_at": "2021-05-21T15:57:21.187000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "EIP-1559 does not fundamentally change the capacity of the chain, so I do not see how it would reduce the size of the tx pool",
        "created_at": "2021-05-21T15:57:59.610000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "So the question becomes \"how many blocks of potentially includable txns\" do you want to keep? Given how quickly the `baseFee` can go down, if you keep just 5 blocks of potentially includeable txns, you need to allow for a 2x range in too high/low `maxFee`",
        "created_at": "2021-05-21T15:58:23.678000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "It makes it clear which txns can be included in the next block, so if you wanted to be super strict about it, you could refuse to hold/propagate txns where the `feeCap` \u003c `baseFee`, and maybe add 1-2 blocks of slack",
        "created_at": "2021-05-21T15:58:55.314000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "It does _kind of_ change the capacity of the chain because you can frequently include the marginal transaction, with the caveat that it requires a `feeCap` \u003e `baseFee`. This is true because the `baseFee` will rise in the next block, so a lot of your \"pending\" transactions become invalid, but, again, it is a very \"strict\" view of the txn pool.",
        "created_at": "2021-05-21T16:00:11.907000+00:00",
        "attachments": null
    },
    {
        "author": "holgerd77",
        "category": "general",
        "parent": "",
        "content": "Tx pool size is also depending on the time the average tx needs to wait until included, which should be significantly reduced I guess with 1559? So together with the optimized usage of chain capacity \u003c@!552133098075193354\u003e mentioned I would very much expect a reduction of tx pool size by a factor 2-10?\n\n\u003e but perhaps not for miners, who want to keep a lot of \"possible to include in future blocks\" txns\n\nAlso not sure where all these possible-future txs come from Tim mentioned above, are these all strategic txs to be included on certain conditions? Otherwise the 1559 mechanism should channel the vast majority of the txs directly through I guess (if wallets get their UI/UX right at least)?",
        "created_at": "2021-05-21T16:48:00.320000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Well \"kind of change the capacity\" is not the same as \"fundamentally change the capacity\". We shall see after the deployment how economics will play with that, but for now I do not think I can assume (and rely on) that tx pool will suddenly shrinks after EIP-1559 deployment",
        "created_at": "2021-05-21T16:50:10.153000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "Miners may want to keep a backlog of low fee cap txns even though they are invalid in case the base fee goes down",
        "created_at": "2021-05-21T16:53:07.289000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "How big that backlog will be is TBD and I would be cautious of assuming the txn pool is much smaller until we see emperical evidence that it is",
        "created_at": "2021-05-21T16:53:52.480000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "Blocks on average seem to have 2-300 txns recently. Assume 250 for round numbers, so 1559 blocks can have up to 2x that, i.e. 500. That means with a default txn pool setting of 4000 txns, you have 8 blocks' worth of transactions, where the base fee could go +/- 2.5x (1.125 ^8). \n\nThat seems reasonable, and at best maybe 2x \"too big\", so I think if we are optimistic we can assume _maybe_ a 2x improvement, but not, say, 10x. I assume most complicated approaches (e.g. sort by effective fee to miner) don't go from impossible to possible with a 2x reduction in txn count?",
        "created_at": "2021-05-21T17:03:21.611000+00:00",
        "attachments": null
    },
    {
        "author": "holgerd77",
        "category": "general",
        "parent": "",
        "content": "Still a bit sceptical here, as far as my understanding of 1559 goes I would assume that the 1559 price and capacity adoptions should constantly work towards working down over-demand and somewhat empty the pool, so I would stick to my 2-10x estimation for now. üòã But we'll see.",
        "created_at": "2021-05-21T17:34:18.834000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "I think you may very well be proven right, but I just want to make sure we can still deal with the current size if we're wrong üòÖ",
        "created_at": "2021-05-21T17:37:21.089000+00:00",
        "attachments": null
    },
    {
        "author": "0xraino",
        "category": "general",
        "parent": "",
        "content": "We're planning on releasing our testnet compatible version on June 1st.",
        "created_at": "2021-05-21T20:31:19.948000+00:00",
        "attachments": null
    }
]
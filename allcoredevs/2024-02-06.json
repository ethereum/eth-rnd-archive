[
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "\u003c@206016661470314496\u003e \u003c@360491619402776577\u003e \u003c@\u0026652918665943056397\u003e we're seeing lots of invalid blocks on mainnet",
        "created_at": "2024-02-06T13:22:11.365000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "seems like a client bug",
        "created_at": "2024-02-06T13:22:14.182000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Did we finalize a bad branch already?",
        "created_at": "2024-02-06T13:23:49.037000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "general",
        "parent": "",
        "content": "Can you share some logs?",
        "created_at": "2024-02-06T13:23:56.831000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "",
        "created_at": "2024-02-06T13:24:22.635000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "message.txt",
                "content": "720de9355adefdf22b6950f70f3e3161db01d66f45de04a68796238ae53b1c50"
            }
        ]
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "It's a blockhash mismatch",
        "created_at": "2024-02-06T13:25:00.270000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "probably a broken builder?",
        "created_at": "2024-02-06T13:25:04.158000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "we're finalizing still though",
        "created_at": "2024-02-06T13:26:09.544000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "general",
        "parent": "",
        "content": "We saw a similar issue (mismatched blockhash) with reth on the devnets",
        "created_at": "2024-02-06T13:26:21.883000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "general",
        "parent": "",
        "content": "do you've a block number for me? i can try fetching the data",
        "created_at": "2024-02-06T13:26:45.451000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "There's too many blocks to be reth",
        "created_at": "2024-02-06T13:26:45.467000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "What EL is involved there?",
        "created_at": "2024-02-06T13:26:47.431000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "general",
        "parent": "",
        "content": "Hard to know",
        "created_at": "2024-02-06T13:26:52.970000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "don't know yet Martin",
        "created_at": "2024-02-06T13:26:55.076000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "\u003c@199561711278227457\u003e look at my log",
        "created_at": "2024-02-06T13:27:01.893000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "I mean on `chiral`",
        "created_at": "2024-02-06T13:27:03.210000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "but there's plenty of blocks",
        "created_at": "2024-02-06T13:27:06.045000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "chiral is prysm + geth",
        "created_at": "2024-02-06T13:27:10.632000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "that's the thing that worries me",
        "created_at": "2024-02-06T13:27:15.639000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "if it's geth reporting incorrectly we're doomed ðŸ™‚",
        "created_at": "2024-02-06T13:27:27.288000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "general",
        "parent": "",
        "content": "19168986 is the next good one afaict",
        "created_at": "2024-02-06T13:27:54.222000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "So, when `geth` convert the executable data to block (within `newPayload`), and hash the block, we don't wind up with the same hash as expected.",
        "created_at": "2024-02-06T13:28:19.400000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "right",
        "created_at": "2024-02-06T13:28:45.730000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "general",
        "parent": "",
        "content": "i do see `WARN [02-06|13:14:48.747] Invalid NewPayload params                params=\"{ParentHash:0x05f8d8dc22c9c0073d9226ef778f11f7453eed0a073a81313cfc89bb96edf411 FeeRecipient:0x77777A6C097a1cE65C61A96a49bd1100F660eC94 StateRoot:0x3abbda0df2aacb7081e69ba944a7215b00e27245a50455ab66861031809851a5 ReceiptsRoot:0x86af7ae966f0b0d39c88027ce0dda44008fe06f8fa097af70b94972859e93356 LogsBl` on our geth logs. Checking for the exact slot you mentioned.",
        "created_at": "2024-02-06T13:29:23.355000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I updated prysm a couple of days ago, not sure if we changed that engine call",
        "created_at": "2024-02-06T13:29:25.845000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "general",
        "parent": "",
        "content": "Would be interesting to see the inputs: the exact params for such a newPayload call. Not sure if it's possible/easy to extract somehow",
        "created_at": "2024-02-06T13:29:37.042000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "general",
        "parent": "",
        "content": "https://etherscan.io/block/19168984 this one is good, the next slot is empty, probably https://beaconscan.com/slot/8366319",
        "created_at": "2024-02-06T13:29:47.931000+00:00",
        "attachments": null
    },
    {
        "author": "pawandhananjay",
        "category": "general",
        "parent": "",
        "content": "our lighthouse-besu node also rejected it\n```\nFeb 06 11:44:14.086 DEBG Beacon block rejected                   reason: ExecutionPayloadError(RejectedByExecutionEngine { status: Invalid { latest_valid_hash: None, validation_error: Some(\"Computed block hash 0x4749a113d4436a03dc1bf78bb64378b48fa38523b34a7dfac53c00c26f07dbaa does not match block hash parameter 0xd543680bc98b32be616c8b24f97bfd4e3da3f3721f80d5f252a0832a8960b09e\") } }), service: beacon\n```",
        "created_at": "2024-02-06T13:29:53.676000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "ahhh that's great to know \u003c@491624610215886849\u003e",
        "created_at": "2024-02-06T13:30:08.666000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "that's a relief",
        "created_at": "2024-02-06T13:30:12.823000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "general",
        "parent": "",
        "content": "phew",
        "created_at": "2024-02-06T13:30:13.631000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "may be a builder",
        "created_at": "2024-02-06T13:30:17.632000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "general",
        "parent": "",
        "content": "",
        "created_at": "2024-02-06T13:30:24.208000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "mainnet-geth-nimbus.log",
                "content": "595d9d76fc30655d8e362c5497bd1bd3ffa1ae2c9732d7266b59f620cde558a4"
            },
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "mainnet-geth-prysm.log",
                "content": "037febb147ee0b452574ffe698586b7634d11a3f25fa5ddc69eb8300573a68db"
            }
        ]
    },
    {
        "author": "smartprogrammer",
        "category": "general",
        "parent": "",
        "content": "ðŸ˜“",
        "created_at": "2024-02-06T13:30:31.108000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "general",
        "parent": "",
        "content": "Possibly a bad builder",
        "created_at": "2024-02-06T13:30:40.597000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I don't keep the bad blocks, \u003c@199561711278227457\u003e do you keep them? because we can check the paying transaction to see if it's the same builder",
        "created_at": "2024-02-06T13:31:53.504000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "\u003c@226589605816696832\u003e can you confirm nethermind also doesn't take those blocks?",
        "created_at": "2024-02-06T13:32:12.042000+00:00",
        "attachments": null
    },
    {
        "author": "smartprogrammer",
        "category": "general",
        "parent": "",
        "content": "i see the network participation looking good",
        "created_at": "2024-02-06T13:33:47.615000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Same fee recipient for all of them as far as I can see: `0x77777a6c097a1ce65c61a96a49bd1100f660ec94`",
        "created_at": "2024-02-06T13:33:51.093000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "general",
        "parent": "",
        "content": "Can someone from \u003c@\u0026688101493978562687\u003e also confirm? We only have one node on the forkmon and that seems a bit behind https://forkmon.mainnet.ethpandaops.io/",
        "created_at": "2024-02-06T13:33:52.010000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "general",
        "parent": "",
        "content": "Do we know who it belongs to ?",
        "created_at": "2024-02-06T13:34:18.470000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "general",
        "parent": "",
        "content": "extra data for 19169473 is rsync builder",
        "created_at": "2024-02-06T13:34:21.420000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "general",
        "parent": "",
        "content": "If the extra data for all the other blocks match up , then that is our answer",
        "created_at": "2024-02-06T13:35:02.001000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "general",
        "parent": "",
        "content": "all up to head right?",
        "created_at": "2024-02-06T13:35:36.372000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "that's lido,",
        "created_at": "2024-02-06T13:35:39.780000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "For the builder?  From the extra data it looks like rsync-builder.xyz to me",
        "created_at": "2024-02-06T13:36:14.591000+00:00",
        "attachments": null
    },
    {
        "author": "smartprogrammer",
        "category": "general",
        "parent": "",
        "content": "nethermind got this for the block as well \n```\n2024-02-06 13:14:48.704    \n06 Feb 13:14:48 | InvalidBlockHash. Result of new block:  19169429 (0xfa2d5f...f1681d). \n```",
        "created_at": "2024-02-06T13:36:29.405000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "ahhh thank you lord ðŸ™‚",
        "created_at": "2024-02-06T13:36:40.666000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "general",
        "parent": "",
        "content": "i have checked and yeah all the extra data i see for invalid new payload on my local is rsync builder",
        "created_at": "2024-02-06T13:36:58.729000+00:00",
        "attachments": null
    },
    {
        "author": "izz.y",
        "category": "general",
        "parent": "",
        "content": "not a lido contract",
        "created_at": "2024-02-06T13:37:38.565000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Ohh my bad, that's the mev builder https://etherscan.io/address/0x77777a6c097a1ce65c61a96a49bd1100f660ec94",
        "created_at": "2024-02-06T13:38:44.400000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "saw all Lido in the recipient address",
        "created_at": "2024-02-06T13:38:55.545000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "general",
        "parent": "",
        "content": "Reth is also rejecting these blocks `2024-02-06T13:24:24.418724Z ERROR consensus::engine: Invalid payload error=BlockHash { execution: 0x86f374fd803515f37f0b4b0e24ae648c0e1c931f9932bd88ce5bbb56d0e0d267, consensus: 0x6868f8e474a163bb17f39d05847aa8e3f1b38db3cca0dfc9bd139db1da8dcde2 }`",
        "created_at": "2024-02-06T13:39:15.938000+00:00",
        "attachments": null
    },
    {
        "author": "smartprogrammer",
        "category": "general",
        "parent": "",
        "content": "quite a lot of blocks \n```\n06 Feb 11:44:13 | InvalidBlockHash. Result of new block:  19168985 (0xd54368...60b09e).\n06 Feb 11:57:01 | InvalidBlockHash. Result of new block:  19169048 (0xe54a21...cdc9d5).\n06 Feb 12:22:00 | InvalidBlockHash. Result of new block:  19169169 (0x5e84fe...e144c6).\n06 Feb 12:23:01 | InvalidBlockHash. Result of new block:  19169173 (0x1ed001...e01614).\n06 Feb 12:52:38 | InvalidBlockHash. Result of new block:  19169319 (0x8c83c2...6667c1).\n06 Feb 13:14:48 | InvalidBlockHash. Result of new block:  19169429 (0xfa2d5f...f1681d).\n06 Feb 13:16:50 | InvalidBlockHash. Result of new block:  19169438 (0xa40dad...f78e42).\n06 Feb 13:19:37 | InvalidBlockHash. Result of new block:  19169451 (0x19d8a7...9b9363).\n06 Feb 13:24:24 | InvalidBlockHash. Result of new block:  19169473 (0x6868f8...8dcde2).\n```",
        "created_at": "2024-02-06T13:39:46.229000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "general",
        "parent": "",
        "content": "all invalid blocks logged in Nethermind in the last few days:",
        "created_at": "2024-02-06T13:40:04.838000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "general",
        "parent": "",
        "content": "",
        "created_at": "2024-02-06T13:40:14.200000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "Screenshot_from_2024-02-06_14-39-11.png",
                "content": "4f5478dbed54b85ad425fe7badd31fb9c510f97ebd91faef1f19bfeb1c2b0e2f"
            }
        ]
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "according to etherscan above this builder is producing a lot of blocks",
        "created_at": "2024-02-06T13:40:22.904000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "general",
        "parent": "",
        "content": "all of them have this extradata:\nblock extra data : 6265617665726275696c642e6f7267, UTF8: beaverbuild.org",
        "created_at": "2024-02-06T13:40:27.925000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I see them all from rsync-builder",
        "created_at": "2024-02-06T13:41:43.100000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "general",
        "parent": "",
        "content": "small correction:\n3 bad blocks in the last days\n2 of them have extradata  beaverbuild.org (state root mismatch)\n1 of them has empty extradata (gas used/receipts/state root mismatch)",
        "created_at": "2024-02-06T13:43:00.629000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "Screenshot_from_2024-02-06_14-41-17.png",
                "content": "80e3e912fe57e71c844e90f511fed3fc93c509f1407925c6b66d49b0a6f8c1f4"
            }
        ]
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Really?  Latest example that I can see is slot 8366820 block 19169473, which shows extra data of rsync-build.xyz",
        "created_at": "2024-02-06T13:45:16.315000+00:00",
        "attachments": null
    },
    {
        "author": "smartprogrammer",
        "category": "general",
        "parent": "",
        "content": "the ones marek is showing are not from today",
        "created_at": "2024-02-06T13:45:42.573000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I got 9 bad blocks in the last 4 hours",
        "created_at": "2024-02-06T13:45:45.637000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "```\nFeb 06 08:44:14 chiral beacon-chain[378]: time=\"2024-02-06 08:44:14\" level=debug msg=\"Inserting in invalid block cache\" prefix=sync root=0xfa261c9b76895d76bac60d090c6f4e7bb68284c032e72acdb6a7bb165a00bc55\nFeb 06 08:57:01 chiral beacon-chain[378]: time=\"2024-02-06 08:57:01\" level=debug msg=\"Inserting in invalid block cache\" prefix=sync root=0xaba7e7f67effa4d1b93b91e6ff122535e1a2770f70477cb83f367474c5713997\nFeb 06 09:22:00 chiral beacon-chain[378]: time=\"2024-02-06 09:22:00\" level=debug msg=\"Inserting in invalid block cache\" prefix=sync root=0x1a20795f1f2b2808e8b87a25b07fa7156774915796c8d215e0113d8632261165\nFeb 06 09:23:01 chiral beacon-chain[378]: time=\"2024-02-06 09:23:01\" level=debug msg=\"Inserting in invalid block cache\" prefix=sync root=0x6bca47490faad469cfa925e2acdae86f975b9d52a27bdb0d2846bb364c6d4496\nFeb 06 09:52:38 chiral beacon-chain[378]: time=\"2024-02-06 09:52:38\" level=debug msg=\"Inserting in invalid block cache\" prefix=sync root=0x3f6ef20ba532e7b0c79823bf08365a476453d5ad79d17dbaf7960ca63e743881\nFeb 06 10:14:48 chiral beacon-chain[378]: time=\"2024-02-06 10:14:48\" level=debug msg=\"Inserting in invalid block cache\" prefix=sync root=0x95acf3fadaf2a972ab3a34cf8349b536da9e3a5a0b59f422a810d347317fa9e8\nFeb 06 10:16:50 chiral beacon-chain[378]: time=\"2024-02-06 10:16:50\" level=debug msg=\"Inserting in invalid block cache\" prefix=sync root=0x0bc8a438b1ad5c44b720c65adc37de1d32f9301b6241e040f49a1756233c30fe\nFeb 06 10:19:37 chiral beacon-chain[378]: time=\"2024-02-06 10:19:37\" level=debug msg=\"Inserting in invalid block cache\" prefix=sync root=0x1a77b4c752c4b2de69abd29f967b53891f119074bcf545250ddf83112c68662a\nFeb 06 10:24:24 chiral beacon-chain[378]: time=\"2024-02-06 10:24:24\" level=debug msg=\"Inserting in invalid block cache\" prefix=sync root=0x0f9773c3dd28d2d5d79bf83de8c926b5bab106217d38b5a420e375797f4640ba\n```",
        "created_at": "2024-02-06T13:45:57.027000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "general",
        "parent": "",
        "content": "19169473\n19169451\n19169438\n19169429\nthese i see from rsync builder in last couple hours",
        "created_at": "2024-02-06T13:46:17.472000+00:00",
        "attachments": null
    },
    {
        "author": "pawandhananjay",
        "category": "general",
        "parent": "",
        "content": "same",
        "created_at": "2024-02-06T13:46:25.936000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "same as mine, they are all rsync",
        "created_at": "2024-02-06T13:46:47.469000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "seems it's rsync-builder that's broken",
        "created_at": "2024-02-06T13:46:53.579000+00:00",
        "attachments": null
    },
    {
        "author": "pawandhananjay",
        "category": "general",
        "parent": "",
        "content": "if it's helpful\n```\nSlot.       graffiti\n8366319: \"\"\n8366383: Staking via Paralinker \n8366508: huobipool\n8366513: SenseiNode\n8366661: :bricks::fire: Kiln.fi :fire::bricks: \n8366772: bloxstaking.com \n8366782: :four_leaf_clover::four_leaf_clover:æºŸæ·±è¾°è¿œ:four_leaf_clover::four_leaf_clover: \n8366796: \"\"\n8366820: :mage: Magic Internet Money\n```",
        "created_at": "2024-02-06T13:46:54.180000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "yeah that shows it's across all clients, so the relay is broadcasting those blocks without ever validating",
        "created_at": "2024-02-06T13:47:40.203000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "general",
        "parent": "",
        "content": "I see 9 invalids in logs from besu/nethermind and 6 from geth",
        "created_at": "2024-02-06T13:47:50.353000+00:00",
        "attachments": null
    },
    {
        "author": "butta",
        "category": "general",
        "parent": "",
        "content": "we have a light mainnet instance that support grafiti search: \nhttps://light-mainnet.beaconcha.in/slots/filtered",
        "created_at": "2024-02-06T13:47:59.113000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "the point is that the relay should never broadcast these blocks",
        "created_at": "2024-02-06T13:48:01.389000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Nimbus logs showing bad blocks from today (UTC).",
        "created_at": "2024-02-06T13:48:05.248000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "nimbus.log",
                "content": "e7a124fcf45936cf75ef2da9b8bdb4a737016a1d7e5536e396842365a4b8bc55"
            }
        ]
    },
    {
        "author": "nishant0",
        "category": "general",
        "parent": "",
        "content": "So the builder continues producing invalid blocks without any sort of penalty ?",
        "created_at": "2024-02-06T13:48:39.128000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "oes it support extra data search?  That's what we need here.",
        "created_at": "2024-02-06T13:48:45.841000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "general",
        "parent": "",
        "content": "no, dora just indexes grafitti",
        "created_at": "2024-02-06T13:49:05.003000+00:00",
        "attachments": null
    },
    {
        "author": "pk910",
        "category": "general",
        "parent": "",
        "content": "no ðŸ˜¦   but maybe soon ðŸ˜‰",
        "created_at": "2024-02-06T13:49:10.847000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "do we know which relay is giving these bad blocks?",
        "created_at": "2024-02-06T13:49:13.698000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "\"Trusted\".",
        "created_at": "2024-02-06T13:49:22.783000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "general",
        "parent": "",
        "content": "ah, right sorry, they had invalid block hash and we have a bit different logging in this case:\n InvalidBlockHash. Result of new block: 19168985 (0xd54368...60b09e).",
        "created_at": "2024-02-06T13:50:16.180000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "general",
        "parent": "",
        "content": "Also shows relays arent actually doing anything",
        "created_at": "2024-02-06T13:50:42.056000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Last 5 have all been https://bloxroute.max-profit.blxrbdn.com/",
        "created_at": "2024-02-06T13:50:47.249000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "yes, there have been flashbots/builder calls where they deliberately plan these (not blaming FB, they just hosted the calls)",
        "created_at": "2024-02-06T13:50:55.309000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "saves latency",
        "created_at": "2024-02-06T13:51:03+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "and it's not really their problem on a practical level if/when it goes bad",
        "created_at": "2024-02-06T13:51:16.243000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "when \u003c#874767108809031740\u003e ðŸ™‚",
        "created_at": "2024-02-06T13:51:22.951000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "misaligned incentives because builder API",
        "created_at": "2024-02-06T13:51:24.170000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "can I push for it in Electra?",
        "created_at": "2024-02-06T13:51:32.924000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "yes please",
        "created_at": "2024-02-06T13:51:37.524000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I'm already working in the Prysm impl",
        "created_at": "2024-02-06T13:51:48.418000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "it's one of my highest priorities personally",
        "created_at": "2024-02-06T13:51:49.864000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "builder API is conceptually awful",
        "created_at": "2024-02-06T13:51:57.330000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "best that could be done within the time/schedule constraints, but awful nonetheless",
        "created_at": "2024-02-06T13:52:13.714000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "general",
        "parent": "",
        "content": "from nimbus logs, also: `extra_data_len: 17`",
        "created_at": "2024-02-06T13:52:42.451000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "general",
        "parent": "",
        "content": "for all of them",
        "created_at": "2024-02-06T13:52:46.120000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "general",
        "parent": "",
        "content": "don't have the full extra_data though",
        "created_at": "2024-02-06T13:52:51.431000+00:00",
        "attachments": null
    },
    {
        "author": "etan_status",
        "category": "general",
        "parent": "",
        "content": "would align, for example, with `rsync-builder.xyz` from the past blocks having same fee recipient",
        "created_at": "2024-02-06T13:53:40.532000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "(I know it's off topic right now, but *please* can we consider making builders (and relays) protocol actors?  For such a critical function it's killing us that they are extra-protocol and the whole idea of them being dropped if they behave badly has been repeatedly disproven.)",
        "created_at": "2024-02-06T13:54:03.012000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "Yeah, some ELs log the extra data (geth, for one) and it's rsync.",
        "created_at": "2024-02-06T13:54:17.499000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "https://x.com/potuz1/status/1754867671261151277?s=20 please thumb up the ACD request?",
        "created_at": "2024-02-06T14:01:51.885000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "Does someone have a slot + block hash. I want to check if it was a optimistic submission at the relay",
        "created_at": "2024-02-06T14:02:12.942000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "blockSlot=8366319 root=0xfa261c9b76895d76bac60d090c6f4e7bb68284c032e72acdb6a7bb165a00bc55",
        "created_at": "2024-02-06T14:02:56.626000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "\u003c@792404665068158998\u003e",
        "created_at": "2024-02-06T14:03:00.843000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "that's consensus data",
        "created_at": "2024-02-06T14:03:10.761000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "I'd need the EL block hash to confirm",
        "created_at": "2024-02-06T14:03:37.549000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "Feb 06 08:44:14 chiral beacon-chain[378]: time=\"2024-02-06 08:44:14\" level=error msg=\"Got a validation error in newPayload\" error=\"blockhash mismatch, want d543680bc98b32be616c8b24f97bfd4e3da3f3721f80d5f252a0832a8960b09e, got 4749a113d4436a03dc1bf78bb64378b48fa38523b34a7dfac53c00c26f07dbaa\" prefix=execution",
        "created_at": "2024-02-06T14:04:08.844000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "general",
        "parent": "",
        "content": "`0x6868f8e474a163bb17f39d05847aa8e3f1b38db3cca0dfc9bd139db1da8dcde2` I think",
        "created_at": "2024-02-06T14:04:10.100000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "that's the good and the bad one in the above log",
        "created_at": "2024-02-06T14:04:25.992000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "they correspond to the slot I posted above",
        "created_at": "2024-02-06T14:04:44.424000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "general",
        "parent": "",
        "content": "Slot: 8366820, EL Hash: `0x6868f8e474a163bb17f39d05847aa8e3f1b38db3cca0dfc9bd139db1da8dcde2` is another",
        "created_at": "2024-02-06T14:06:20.129000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "is someone catching/saving these blocks? Nimbus can do it but it needs to be configured (haven't checked lately how Nimbus mainnet test fleet is configured in this regard)",
        "created_at": "2024-02-06T14:08:57.429000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "Hey all, bloXroute dev here.  We just disabled optimism on that troublesome builder and are investigating the issues now.",
        "created_at": "2024-02-06T14:10:10.921000+00:00",
        "attachments": null
    },
    {
        "author": "pawandhananjay",
        "category": "general",
        "parent": "",
        "content": "we have the block ssz's saved, \u003c@199561711278227457\u003e might have it too",
        "created_at": "2024-02-06T14:10:14.982000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "general",
        "parent": "",
        "content": "We don't unfortunately, gonna enable it for mainnet today",
        "created_at": "2024-02-06T14:10:30.637000+00:00",
        "attachments": null
    },
    {
        "author": "izz.y",
        "category": "general",
        "parent": "",
        "content": "Thanks for responding quickly!",
        "created_at": "2024-02-06T14:11:48.837000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "I found this one here:\n\nhttps://bloxroute.max-profit.blxrbdn.com/relay/v1/data/bidtraces/builder_blocks_received?slot=8366820",
        "created_at": "2024-02-06T14:13:17.459000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "general",
        "parent": "",
        "content": "Whats the purpose of the optimistic mode? And why is there no automatic shutoff if you see bad blocks originate from your relay?",
        "created_at": "2024-02-06T14:14:08.370000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "Last 9 blocks from this builder seem to be the issue:\nhttp://bloxroute.max-profit.blxrbdn.com/relay/v1/data/bidtraces/proposer_payload_delivered?builder_pubkey=0x8e6df6e0a9ca3fd89db2aa2f3daf77722dc4fbcd15e285ed7d9560fdf07b7d69ba504add4cc12ac999b8094ff30ed06c",
        "created_at": "2024-02-06T14:14:37.057000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "If the relay doesn't need to validate the block it can improve latency",
        "created_at": "2024-02-06T14:14:47.717000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "general",
        "parent": "",
        "content": "so it's confirmed these invalid blocks are produced by bloXroute?",
        "created_at": "2024-02-06T14:14:58.634000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "general",
        "parent": "",
        "content": "i was going to ask the same thing. There should be some verification after the block is relayed and flip the switch if the builder produces even 1 invalid block",
        "created_at": "2024-02-06T14:15:27.231000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "We're investigating why our post simulation did not catch these and disable optimistic simulation automaticaly",
        "created_at": "2024-02-06T14:15:27.333000+00:00",
        "attachments": null
    },
    {
        "author": "pawandhananjay",
        "category": "general",
        "parent": "",
        "content": "isn't one of the main purpose of a relay validating the block",
        "created_at": "2024-02-06T14:16:11.358000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "Blocks were created by a builder called rSync, relayed through bloXroute's max-profit relay.",
        "created_at": "2024-02-06T14:16:45.620000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "general",
        "parent": "",
        "content": "What latency are you concerned about? I thought at this point the bid was already accepted by the validator?",
        "created_at": "2024-02-06T14:18:37.704000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "It's called optimistic relaying, it's a pretty known thing in the PBS space.  https://frontier.tech/optimistic-relays-and-where-to-find-them",
        "created_at": "2024-02-06T14:19:18.390000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "with optimistic mode the builder posts some collateral that is distributed to the victims (validators) in the event the builder produces invalid blocks. In return the builder gets smaller latency",
        "created_at": "2024-02-06T14:19:26.994000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "how can ordinary eth users access this collateral?",
        "created_at": "2024-02-06T14:20:18.114000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "The slower the relay is, the older the bid that arrives at the validator. So if you call the relay and it receives a bid that is hight at the exact same moment, you would't get it because it's not yet validated. In optimistic mode you get it.",
        "created_at": "2024-02-06T14:20:49.545000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "they can't, the relays have access to it and distribute it in case of a failure",
        "created_at": "2024-02-06T14:21:13.699000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "and this is supposed to be automatic by the relays?",
        "created_at": "2024-02-06T14:21:38.316000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "no. It's now the first time we saw that happening at that scale so I'm curious too how this is handled",
        "created_at": "2024-02-06T14:22:28.514000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "Is it possible to manually disable it now?",
        "created_at": "2024-02-06T14:23:34.792000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "Already done",
        "created_at": "2024-02-06T14:23:43.575000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "We'll release a post mortem about the whole thing.  Right now focusing on why post simulation has not caught this issue.",
        "created_at": "2024-02-06T14:24:19.568000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "latency is evil here: they want to optimize for it so that they can send the block **later** this should be stopped immediately",
        "created_at": "2024-02-06T14:25:10.586000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "If you got the slot number \u003c@217441939463602177\u003e  for me, I'm happy to look into it too. Wanto to check how much ETH that validators lost on avg",
        "created_at": "2024-02-06T14:25:13.744000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "and it has to be done at the protocol level cause obviously won't happen by market conditions",
        "created_at": "2024-02-06T14:25:27.117000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "https://discord.com/channels/595666850260713488/745077610685661265/1204429948954083348",
        "created_at": "2024-02-06T14:25:57.041000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "so \"only\" 9 blocks?",
        "created_at": "2024-02-06T14:26:32.300000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "that's wrong and broken",
        "created_at": "2024-02-06T14:27:09.235000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "nine blocks and almost a heart attack of seeing consecutive bad blocks from a geth log, I saw the chain finalize and panicked",
        "created_at": "2024-02-06T14:27:09.996000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "general",
        "parent": "",
        "content": "I guess block builders need to set aside some collateral for core dev ER services too from now on ðŸ˜…",
        "created_at": "2024-02-06T14:29:05.596000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdannyryan\u003e ha",
        "created_at": "2024-02-06T14:33:27.423000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cdannyryan\u003e (tweeted this)\n\nOptimistic submission was a bad design/idea in the relay-trust model, imo\n\nAt a minimum an \"optimistic\" relay *should* do the verification after broadcast and black-list if issues even if a bad block made it to the p2p. Which it apparently is not",
        "created_at": "2024-02-06T14:33:59.162000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "yeah some circuit breaker seems like the minimum safety measure.",
        "created_at": "2024-02-06T14:35:07.211000+00:00",
        "attachments": null
    },
    {
        "author": "pawandhananjay",
        "category": "general",
        "parent": "",
        "content": "is the collateral acmount for running in optimistic mode public information?",
        "created_at": "2024-02-06T14:36:04.126000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "general",
        "parent": "",
        "content": "i don't have the addresses now but yeah it is",
        "created_at": "2024-02-06T14:36:24.620000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "indeed when we use the word \"optimistic\" we eventually perform an actual validation and react to invalid input. In this case \"optimistic\" was taken to be \"wishfulthinking\"",
        "created_at": "2024-02-06T14:37:05.831000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "But the whole concept is evil in anyway, regardless of checks, the **only** purpose of gaining latency at broadcast time is to send the block later, this is bad for the network",
        "created_at": "2024-02-06T14:38:05.733000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "We thought about rebalancing the slot time to allow for longer attestation time in Deneb, I'd be strongly against it and actually think we should lower it",
        "created_at": "2024-02-06T14:38:39.896000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "because people will just wait until the last millisecond regardless?",
        "created_at": "2024-02-06T14:39:15.798000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "exactly",
        "created_at": "2024-02-06T14:39:21.493000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "we have pools publicly saying they are sending getheader a second later",
        "created_at": "2024-02-06T14:39:33.168000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "yeah, people gave presentations at Devconnect charting out how much additional profit that netted them, people have written about this aspect of the economics of MEV extensively",
        "created_at": "2024-02-06T14:40:22.431000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "but the bigger issue is the misaligned incentives IMO. obviously asking nicely hasn't helped. the protocol must enforce this.",
        "created_at": "2024-02-06T14:41:05.057000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "(e.g., ePBS)",
        "created_at": "2024-02-06T14:41:29.857000+00:00",
        "attachments": null
    },
    {
        "author": "pawandhananjay",
        "category": "general",
        "parent": "",
        "content": "\u003c@755590043632140352\u003e do you have a link for the latest epbs proposal?",
        "created_at": "2024-02-06T14:42:48.359000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "general",
        "parent": "",
        "content": "yep. I think we can't blame them. They are simply doing whatever protocol allows them to do, and they are profit maximalist by definition.",
        "created_at": "2024-02-06T14:43:39.834000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "The latest I'm working on is this one https://github.com/potuz/consensus-specs/pull/1, it includes the current proposal for ILs, 7002 and Max EB, but they are not necessary. I'm already implementing this in Prysm nonetheless",
        "created_at": "2024-02-06T14:43:48.751000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "general",
        "parent": "",
        "content": "FYI the slot numbers and relay-stated value of each of the bad blocks:\n\n```\n f_slot  |      f_value\n---------+--------------------\n 8366319 | 336627698167516219\n 8366383 |  40151294531800951\n 8366508 |  92101569672087368\n 8366513 | 117021094633455503\n 8366661 | 118768445676649612\n 8366772 |  59797900937841359\n 8366782 | 156182547611636384\n 8366796 |  20614487402014643\n 8366820 |  25974747686278448\n```",
        "created_at": "2024-02-06T15:04:22.690000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "worth noting that optimistic relaying is not about delaying block propagation in the sense of timing games\n\noptimistic relaying is an _internal_ feature to relays so that the time from \"receive block from builder\" to \"i can serve to proposer\" is shorter (this is the target latency it aims to minimize)\n\nplaying timing games is a separate concern and i agree should be minimized at every possible layer",
        "created_at": "2024-02-06T15:16:47.548000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "also, we should wait for the post-mortem but it sounds like the issue here was a bug in the optimistic relaying implementation -- the relay should have 'demoted' this builder as soon as they relay the first invalid block",
        "created_at": "2024-02-06T15:17:28.790000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "in the 'honest' behavior, this one proposer would be compensated from collateral the relay holds and things move along...",
        "created_at": "2024-02-06T15:18:06.155000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "do think we can push for higher legibility of the optimistic infra as it is quite opaque at the moment",
        "created_at": "2024-02-06T15:18:32.728000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "well I asked about this above, and apparently this hasn't been considered/implemented in detail?",
        "created_at": "2024-02-06T15:18:35.363000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "disagree, but link to context?",
        "created_at": "2024-02-06T15:18:49.326000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "here",
        "created_at": "2024-02-06T15:19:05.035000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "demotion should be automatic",
        "created_at": "2024-02-06T15:19:34.498000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "reimbursement is handled manually, if only to reduce complexity around smart contracts etc",
        "created_at": "2024-02-06T15:19:48.950000+00:00",
        "attachments": null
    },
    {
        "author": "alextes",
        "category": "general",
        "parent": "",
        "content": "In case anyone is interested, I'm not aware of any optimistic relay which doesn't verify the blocks they optimistically relay and then switch off optimistic in the case of an issue. In fact, a relay generally only allows optimistic blocks at a max value equal to the collateral the builder has. Meaning things can only go maximally wrong once. Of course, this is what *should* happen. I'd say wait for the bloxroute post-mortem to find out what actually *did* ðŸ˜¬ .",
        "created_at": "2024-02-06T15:19:53.711000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "\"things _should_ only go maximally wrong once\", edit; didn't read all of alex's msg,",
        "created_at": "2024-02-06T15:20:36.958000+00:00",
        "attachments": null
    },
    {
        "author": "izz.y",
        "category": "general",
        "parent": "",
        "content": "I would hazard that this is a bug/failure in the mechanism on the relay side vs it being an oversight or bad design (i.e. lack of builder demotion after bad bids), but need to wait for post-mortem to be sure. So there's something implemented, just that there's a bug or something went wrong.",
        "created_at": "2024-02-06T15:20:48.832000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "I dissagree here, while technically this is correct, namely that you want to send to the proposer as fast as possible. That communication is not critical since the relay is the one that broadcast.  There is no real need for the relay to optimize to this point unless they want to give more time for the builder to submit later bids and more time for the proposer to request its block later",
        "created_at": "2024-02-06T15:34:16.055000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "The relay even delays giving the block to the proposer after the unbundling attacks.",
        "created_at": "2024-02-06T15:34:41.212000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "general",
        "parent": "",
        "content": "so this is purely about broadcasting and allowing bids to come later",
        "created_at": "2024-02-06T15:34:56.712000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "general",
        "parent": "",
        "content": "I agree with Potuz here. This is the timing game to the maximum extent. Putting some collateral to repay the proposers doesn't count the damage to the network that is caused by a missing beacon block.",
        "created_at": "2024-02-06T15:47:48.158000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "i do think the \"social\" cost of a missed slot is not reflected in the optimistic relaying model, however its also hard to price that\n\nthe intent is that missed slots in this regime would be ~0% and if this suddenly opened up a huge QoS degradation for the chain relays would stop doing it",
        "created_at": "2024-02-06T15:49:55.406000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "well, this gets at the misaligned incentive aspect. why would they care?",
        "created_at": "2024-02-06T15:53:09.425000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "general",
        "parent": "",
        "content": "it's presumably a +EV move for them",
        "created_at": "2024-02-06T15:53:20.499000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "continuing to operate in optimistic mode would be far more profitable in expectation compared to throwing a bad block once and then losing optimistic mode for the rest of time",
        "created_at": "2024-02-06T15:55:29.427000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cfradamt\u003e \u003e \u003cfradamt\u003e  Why does it matter whether the relay is optimistic in terms of missed slot? (re @allcoredevs_bot: \u003cralexstokes\u003e i do think the \"social\" cost of a missed slot is not reflected in the optimistic relaying model, however its also hard to price that\n\nthe intent is that missed slots in this regime would be ~0% and if this suddenly opened up a huge QoS degradation for the chain relays would stop doing it)",
        "created_at": "2024-02-06T15:56:12.983000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "if a non-optimistic relay has a missed slot they have failed to follow through on their commitments -- in the honest execution there would never be a missed slot\n\noptimistic relaying, in the honest execution, does open the possibility of a missed slot but the intent is to minimize it at all costs",
        "created_at": "2024-02-06T15:59:02.702000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cfradamt\u003e if they're not buggy or malicious then the amount of missed slots is bounded by the number of whitelisted builders, which is just a handful",
        "created_at": "2024-02-06T15:59:58.899000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cfradamt\u003e percentage wise even if every single builder makes an invalid block it won't move the needle at all",
        "created_at": "2024-02-06T16:00:35.916000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "needle on our \"social welfare\" metric? you could imagine some large liquidation taking place for some unlucky defi user",
        "created_at": "2024-02-06T16:01:42.607000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "general",
        "parent": "",
        "content": "\u003cfradamt\u003e I don't think apps can be designed to not tolerate a handful of missed slots. Missed slots happen, regardless of optimistic relaying",
        "created_at": "2024-02-06T16:04:05.502000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "We posted a post mortem on our discord server here:\nhttps://discord.com/channels/638409433860407300/638411057051729920/1204478200780951572",
        "created_at": "2024-02-06T17:32:52.131000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "I'll create a gist as well",
        "created_at": "2024-02-06T17:32:57.598000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "https://gist.github.com/benhenryhunter/5f63ad6b5d68452192e9965925b9878e",
        "created_at": "2024-02-06T17:34:55.272000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "general",
        "parent": "",
        "content": "thanks. do you have a pr for the fix we can see?",
        "created_at": "2024-02-06T17:37:19.028000+00:00",
        "attachments": null
    },
    {
        "author": "closer__",
        "category": "general",
        "parent": "",
        "content": "all these bad blocks were submitted by a single builder (same pubkey), correct?",
        "created_at": "2024-02-06T18:51:29.112000+00:00",
        "attachments": null
    },
    {
        "author": "closer__",
        "category": "general",
        "parent": "",
        "content": "would be great to have block hashes included in the gist \u003c@217441939463602177\u003e  \u003c:pepelove:829458395873411084\u003e",
        "created_at": "2024-02-06T18:52:06.526000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "Demotion logic and monitoring is not open source currently",
        "created_at": "2024-02-06T18:52:46.218000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "ðŸ«¡",
        "created_at": "2024-02-06T18:52:55.013000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "Added the bids to the gist.  All from the same builder pubkey",
        "created_at": "2024-02-06T18:54:02.756000+00:00",
        "attachments": null
    },
    {
        "author": "closer__",
        "category": "general",
        "parent": "",
        "content": "thanks! could u also elaborate on what u mean by \"improper formatting\"?\n\u003e From these blocks 9 won the auction but failed to be broadcasted due to the improper formatting of the blocks.",
        "created_at": "2024-02-06T20:08:34.503000+00:00",
        "attachments": null
    },
    {
        "author": "smartprogrammer",
        "category": "general",
        "parent": "",
        "content": "i think the issue was that the hash calculated for the block header was incorrect. \u003c@217441939463602177\u003e can confirm",
        "created_at": "2024-02-06T20:11:35.449000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "Yeah the underlying fatal error was block hash was not correct. It's likely that the block was built properly just the encoding of the gRPC payload was incorrect.  We're still confirming that is the case and working with the builder to resolve that.",
        "created_at": "2024-02-06T20:13:31.432000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "general",
        "parent": "",
        "content": "I know this is very specific to this incident, but I'd be curious to understand what level of validation would have found that the block was incorrectly encoded, and the relative cost of that vs. full block validation.\n\nIn this case, did the hash \"look correct\" (e.g. a 0x-prefixed 32 byte string), meaning you had to validate the entire block contents to know it was wrong, or could you have known from simple formatting checks that something was off?",
        "created_at": "2024-02-06T20:28:50.732000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "i'd assume a syntactically incorrect block hash would not even be gossiped, and given that we saw propagation (which triggered all of this in the first place), that suggests the syntax was fine (although someone closer to the client impl can correct me)",
        "created_at": "2024-02-06T20:31:51.740000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "general",
        "parent": "",
        "content": "from what i've gathered it sounds like there may have been an issue decoding the block hash correctly from some grpc transport, although \u003c@217441939463602177\u003e can chime in once they know more",
        "created_at": "2024-02-06T20:32:30.476000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "I should probably add a lot more emphasis on the word \"assumption\" here ðŸ˜… \n\nIt's just an assumption is that the blocks were built correctly and we're still working to confirm it.   You can see the bids in the provided gist so there was in fact _a_ hex decodable string provided.\n\nIt's unfortunately pretty difficult to work backwards on issues like this so it will take some time to know for sure if the blocks were valid and it was an encoding issue or if the blocks were invalid and it was a builder issue.",
        "created_at": "2024-02-06T20:34:57.113000+00:00",
        "attachments": null
    },
    {
        "author": "philosowrapter",
        "category": "general",
        "parent": "",
        "content": "Ultimately though what I think is pretty clear is that the demotion logic is what is at fault most severely.",
        "created_at": "2024-02-06T20:35:20.311000+00:00",
        "attachments": null
    }
]
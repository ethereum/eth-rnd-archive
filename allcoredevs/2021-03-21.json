[
    {
        "author": "ajsutton",
        "category": "general",
        "parent": "",
        "content": "I think itâ€™s essentially the same amount of work as setting up signing for the header. You need to generate a private key and set the public key for that as trusted by the other side. You can add a lot of complexity with certificate chains etc but you donâ€™t have to (and that complexity brings a lot of simplicity when youâ€™re managing a fleet of nodes so the flexibility is very valuable). \nPlus if you just use existing solutions you get to also use existing tools which are plentiful for certificate management.",
        "created_at": "2021-03-21T00:16:14.446000+00:00",
        "attachments": null
    },
    {
        "author": "carpediem_7",
        "category": "general",
        "parent": "",
        "content": "Is this a long lived session?",
        "created_at": "2021-03-21T05:31:31.403000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "It is a long lived arrangement, but doesn't have to be a long lived session.",
        "created_at": "2021-03-21T06:03:04.728000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Thinking more on TLS, and I don't think it will work because it is the wrong direction.",
        "created_at": "2021-03-21T06:03:36.309000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The \"server\" is the application client and the \"client\" is the consensus client.  The consensus client is pushing data to the application client and the application client implicitly trusts the data it receives.",
        "created_at": "2021-03-21T06:04:05.721000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "With TLS, the client is generally anonymous while the server is generally well known, which is backwards from the security guarantees we need.",
        "created_at": "2021-03-21T06:04:32.396000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "general",
        "parent": "",
        "content": "TLS authentication can work both ways.\nBut I still think mostly it will be in authenticated and if auth is required it will just be ssl + basic auth as a baseline. Clients will offer a range of other options for authentication based on their client needs.",
        "created_at": "2021-03-21T06:15:05.094000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "We specifically don't want every client to implement different strategies because we have an many to many relationship.  This is the canonical situation where you *want* a standard.",
        "created_at": "2021-03-21T06:18:56.819000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "We want Nethermind, Geth, OpenEthereum, and Besu to all be able to connect to any of Teku, Prism, Lighthouse, or Nimbus.",
        "created_at": "2021-03-21T06:19:34.153000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "If everyone implements their own authentication system then every one of the 8 clients will have (in theory, not practically) up to 16 possible mappings between application and consensus clients.  We definitely don't want 16 different auth mechanisms.  ðŸ™‚",
        "created_at": "2021-03-21T06:20:59.345000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "We also don't want 4 (where either application layer or consensus layer drives the decision making and the other side implements all 4).",
        "created_at": "2021-03-21T06:21:16.800000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Then we have TLS *just* so we can secure basic auth credentials.  ðŸ™‚  This seems quite unnecessary when we could instead just sign the payloads so we don't need TLS at all.",
        "created_at": "2021-03-21T06:22:38.478000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "general",
        "parent": "",
        "content": "But being able to sign the payload has all the complexity of a tls setup - more complexity if itâ€™s a custom scheme. \nMost of the time unauthenticated will be fine and when itâ€™s not the setup of tls is unlikely to be the most complicated factor.",
        "created_at": "2021-03-21T06:38:03.997000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "TLS involves a handshake (back and forth) I believe?  A signature with a pre-shared key doesn't require any handshake.  This is nice because implementation is a bit simpler, and latency is generally a tad higher (though, latency probably doesn't matter too much in this context).",
        "created_at": "2021-03-21T06:40:41.306000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Maybe it is possible to do a pre-exchange with TLS, but now we are deviating from TLS into something custom.",
        "created_at": "2021-03-21T06:41:05.721000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "In my experience, TLS setup *is* the most complicated bit.  ðŸ˜¢",
        "created_at": "2021-03-21T06:41:34.692000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Which is why basically *everyone* just delegates the problem to CloudFlare these days.  ðŸ˜¬",
        "created_at": "2021-03-21T06:41:48.341000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "general",
        "parent": "",
        "content": "Http keep alive would avoid the need for this and tls has proven to not be a performance issue.",
        "created_at": "2021-03-21T06:45:44.848000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Yeah, I won't defend on the performance front since I think it is epsilon on the scales we are discussing.  ðŸ™‚",
        "created_at": "2021-03-21T06:46:31.579000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I will continue to defend the complexity though.",
        "created_at": "2021-03-21T06:46:38.772000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The *only* reason I defend the complexity is because we work in a space where public key cryptography is very well understood.",
        "created_at": "2021-03-21T06:47:07.321000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "If we were in any other industry I would join you in \"just use TLS\".",
        "created_at": "2021-03-21T06:47:17.816000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "However, in this case everyone involved on both sides of the connection understands public key cryptography and already has to utilize it (securely!) to build their clients.",
        "created_at": "2021-03-21T06:47:49.318000+00:00",
        "attachments": null
    },
    {
        "author": "carpediem_7",
        "category": "general",
        "parent": "",
        "content": "if there is stream over an extended period of time - TLS would be beneficial in terms of performance.  Auth is performed using pki whereas data transfer using AES GCM.  Pay the pub key cost once and enjoy the performance of symm key over a long term.   Repeated sign verification of JWTs would be costly w.r.t performance. Now going onto the complexity argument:    The problem with TLS is the fact that clients typically use available libraries such as OpenSSL which are prone to mistakes and not in control of Eth devs.   Google/ Netflix etc. build their own custom e2e intra-service communication protocol for their cloud just for this reason.    If signature schemes are already implemented within the eth clients - there is at least some degree of control \u0026 simplicity.",
        "created_at": "2021-03-21T07:08:35.125000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I have never had a good experience working with OpenSSL.  ðŸ˜¢",
        "created_at": "2021-03-21T07:14:31.334000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Or any web server that had built-in TLS support.",
        "created_at": "2021-03-21T07:14:59.408000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Web client TLS support was good, but very bad if you had to supply your own cert to the client (which we would need in this case).",
        "created_at": "2021-03-21T07:15:31.812000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "general",
        "parent": "",
        "content": "Teku and web3signer already use tls authentication and besu supports it for connecting to Orion for private transactions. Dirk and vouch use it for authentication as well. So itâ€™s not like itâ€™s this is some exotic new technology, itâ€™s already implemented and in use.",
        "created_at": "2021-03-21T09:06:57.027000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "TLS servers or clients?",
        "created_at": "2021-03-21T11:02:22.225000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "general",
        "parent": "",
        "content": "SSZ already has a perfectly good de facto signature standard if we want to roll our own ðŸ˜†",
        "created_at": "2021-03-21T14:18:29.069000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "general",
        "parent": "",
        "content": "Both. The connection is verified on both sides using the tls certs.",
        "created_at": "2021-03-21T20:14:58.690000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "We use gRPC for connection between components. And it is possible to have gRPC connections secured by TLS. I've tested it, but we did not roll it out yet, because we need to update the certificate generation doc to specify Cnames too: https://github.com/ledgerwatch/turbo-geth/tree/master/cmd/rpcdaemon#securing-the-communication-between-rpc-daemon-and-tg-instance-via-tls-and-authentication",
        "created_at": "2021-03-21T20:27:07.355000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Also, we are working on splitting out the \"Consensus\" component, as some of you may know, it will also talk to the \"core\" using gRPC (potentially with TLS). It is fair to assume that this component may be what will talk to Beacon node in our case",
        "created_at": "2021-03-21T20:28:12.929000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "Since we have already moved JSON RPC out of the \"core\", there is no assumption that TG node can server any JSON RPC, and I definitely would like to see the `submitBlock` to be defined a bit looser, and not necessarily as JSON RPC method",
        "created_at": "2021-03-21T20:29:49.697000+00:00",
        "attachments": null
    },
    {
        "author": "carpediem_7",
        "category": "general",
        "parent": "",
        "content": "looks like classic gRPC over mTLS",
        "created_at": "2021-03-21T21:33:13.243000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "general",
        "parent": "",
        "content": "yes",
        "created_at": "2021-03-21T22:05:43.756000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "holiman",
        "category": "Execution Layer",
        "parent": "",
        "content": "See https://github.com/ethereum/go-ethereum/blob/master/eth/protocols/snap/handler.go#L281. The `    for it.Next() {` will be false, so if the range is \"too late\" no accounts will be returned. Later on, we will add the proof for the request origin: \n```\n    // Generate the Merkle proofs for the first and last account\n    proof := light.NewNodeSet()\n    if err := tr.Prove(req.Origin[:], 0, proof); err != nil {\n```\nAs for the last: \n```\n    if last != (common.Hash{}) {\n        if err := tr.Prove(last[:], 0, proof); err != nil {\n```\nSince we never entered the for-loop. the `last` will be unset, and we will not add the proof for that one. \n\nTLDR: only one (exclusion-) proof  in the resposne, for the request.origin account",
        "created_at": "2022-09-26T06:44:10.846000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution Layer",
        "parent": "",
        "content": "LMK if something is still unanswered",
        "created_at": "2022-09-26T06:45:09.576000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution Layer",
        "parent": "",
        "content": "thanks for the explanation \u003c@211091239112671234\u003e , but is still a sufficient proof to accept that there are no more accounts? I think the locally created merkle tree should be able to tell me that it has the rightmost branch (just for discussions sake we sync the merkle tree account leaves from left (0x0000...) to right (0xffff...)",
        "created_at": "2022-09-26T19:54:30.307000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution Layer",
        "parent": "",
        "content": "i just need to establish that this is my stopping condition for lets say account range fetcher",
        "created_at": "2022-09-26T19:55:12.738000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution Layer",
        "parent": "",
        "content": "Well, if there's nothing to the right side of the range... Then the proof you've been given covers the entire remaining trie, doesn't it?",
        "created_at": "2022-09-26T20:03:24.999000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution Layer",
        "parent": "",
        "content": "Trie is complete, no more hashes on the right side",
        "created_at": "2022-09-26T20:03:48.640000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution Layer",
        "parent": "",
        "content": "right, thats what i wanted to confirm in my understanding",
        "created_at": "2022-09-26T20:04:14.223000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Execution Layer",
        "parent": "",
        "content": "So stuff the proofs on the left into a trie. Then shove in leafs, building up the internal nodes. And then calc the root.",
        "created_at": "2022-09-26T20:04:54.887000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution Layer",
        "parent": "",
        "content": "yes i should be able to acertain that i can build root from all accounts i have synced",
        "created_at": "2022-09-26T20:06:25.042000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution Layer",
        "parent": "",
        "content": "+ left proof",
        "created_at": "2022-09-26T20:07:35.411000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution Layer",
        "parent": "",
        "content": "in other words if i can build root from the left proof + accounts (lets say the last range request that returned the accounts)  without right proof, then the sync is done",
        "created_at": "2022-09-26T20:09:35.945000+00:00",
        "attachments": null
    }
]
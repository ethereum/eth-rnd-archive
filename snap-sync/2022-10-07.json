[
    {
        "author": "jochembrouwer",
        "category": "Execution Layer",
        "parent": "",
        "content": "Hi all, I am wondering in what scenario one would need to use `GetTrieNodes` in snap sync. If you request bytecode, accounts or storage slots then you will get all the nodes which you should insert (which you can retrieve from the responesss since the proof has the rightmost value nodes). So I do not see how there could at any point be missing trie nodes (but there are, right, in the \"state heal\" process..?)",
        "created_at": "2022-10-07T13:29:54.099000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "The snapshot moves out from under you in 15 mins. If sync takes longer, you need to piece multiple ones together. Thatâ€˜s the healing part",
        "created_at": "2022-10-07T13:32:53.058000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Execution Layer",
        "parent": "",
        "content": "I think I slightly get this point. But let's say we are (somewhat naively) only connecting to one peer to receive accounts linearly. Then indeed at some point we will have to change `rootHash`. However this is the point which I do not yet get: this would invalidate many trie nodes which I have currently. It would not be possible to just keep going linearly and if you reach the end of the trie keys (0xFFFF..FF), you start at the start (0x0000..00) again until you finally get all the trie nodes. I think I'm missing a key point of the snap sync here. I do dump the trie nodes which I generate when verifying range proofs into a trie, right..?",
        "created_at": "2022-10-07T14:06:45.903000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "But that would require your peer to send you everything again. And in this Time the pivot could move again",
        "created_at": "2022-10-07T16:56:04.580000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "Yes",
        "created_at": "2022-10-07T16:56:22.855000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Execution Layer",
        "parent": "",
        "content": "Only smallish parts of the true are invalidated by moving the pivot so you start healing the true by only fetching these trie nodes with gettrienodes",
        "created_at": "2022-10-07T16:57:48.149000+00:00",
        "attachments": null
    }
]
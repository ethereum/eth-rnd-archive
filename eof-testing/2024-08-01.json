[
    {
        "author": "pdobacz",
        "category": "Testing",
        "parent": "",
        "content": "I'm trying to use the new flag Mario added ‚òùÔ∏è with the 7702 test `test_eoa_code_txs.py`, and see how far I can get.",
        "created_at": "2024-08-01T08:36:45.535000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Hey \u003c@403707149043105803\u003e I'm using the PR above to test EOF+EIP-2537 and, for some reason, `EXTSTATICCALL` is working for the BLS precompiles (only tested G1ADD so far), but failing for `EXTCALL`, with apparently the same inputs, is there anything obvious I might be missing here?",
        "created_at": "2024-08-01T19:00:58.068000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "Stack order?  EXTCALL has a value argument and at one point stack was value, offset, len but moved to offset, len, value so that offset and len weree at the same stack depth for all call operations.",
        "created_at": "2024-08-01T19:01:56.800000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Seems ok, this is `EXTSTATICCALL`:\n```\n{\"pc\":11,\"section\":0,\"op\":251,\"gas\":\"0x984229\",\"gasCost\":\"0x12bb86a\",\"memSize\":256,\"stack\":[\"0x100\",\"0x0\",\"0xb\"],\"depth\":1,\"refund\":0,\"opName\":\"EXTSTATICCALL\"}\n```\nAnd this is `EXTCALL`:\n```\n{\"pc\":13,\"section\":0,\"op\":248,\"gas\":\"0x984226\",\"gasCost\":\"0x12bb866\",\"memSize\":256,\"stack\":[\"0x0\",\"0x100\",\"0x0\",\"0xb\"],\"depth\":1,\"refund\":0,\"opName\":\"EXTCALL\"}\n```\nWhere 0xb is the addres of G1ADD, and 0x100 is the size of the call data",
        "created_at": "2024-08-01T19:04:19.059000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "Looks fine in the python code too...",
        "created_at": "2024-08-01T19:04:28.084000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "tests/prague/eip2537_bls_12_381_precompiles/test_bls12_g1add.py ?",
        "created_at": "2024-08-01T19:05:17.736000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Yes but give me a second and I can upload the branch so you can run the test too",
        "created_at": "2024-08-01T19:05:49.157000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "This is the branch: https://github.com/ethereum/execution-spec-tests/tree/eof-test-updates",
        "created_at": "2024-08-01T19:07:55.815000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Tests are:\n- \"tests/prague/eip2537_bls_12_381_precompiles/test_bls12_g1add.py::test_call_types[fork_PragueEIP7692-call_opcode_EXTCALL-evm_code_type_EOF_V1-state_test-valid-]\"\n- \"tests/prague/eip2537_bls_12_381_precompiles/test_bls12_g1add.py::test_call_types[fork_PragueEIP7692-call_opcode_EXTSTATICCALL-evm_code_type_EOF_V1-state_test-valid-]\"",
        "created_at": "2024-08-01T19:09:23.588000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "with `--fork=PragueEIP7692` with besu evm tool, not using the latest version btw, might also be that",
        "created_at": "2024-08-01T19:10:01.099000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "For me EXTCALL worked but EXTDELEGATECALL failed.",
        "created_at": "2024-08-01T19:12:35.714000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "That may be expected, as delegate call to precompiles is not a delegate call to an EOF contract",
        "created_at": "2024-08-01T19:13:00.103000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Ah yes that one is expected, but that means that my installed version of besu was failing ?",
        "created_at": "2024-08-01T19:13:27.666000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "I‚Äôm updating right now to retest",
        "created_at": "2024-08-01T19:13:38.314000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "It's passing now üòÑ but that means there was something there a couple of commits ago üëÄ",
        "created_at": "2024-08-01T19:14:40.125000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "what was the older version's hash?  I'd be interested to know what broke.  Was it before July 12 / commit 85d286aa?  Because Besu's EXTCALL was broken before then.",
        "created_at": "2024-08-01T19:15:21.210000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "It was this commit: https://github.com/hyperledger/besu/commit/c0efeef89a1befb23d53323f38f9c3f8b62ea785",
        "created_at": "2024-08-01T19:19:16.431000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "TIL you can use `git reflog` to see from which commit you moved from even after `git reset`",
        "created_at": "2024-08-01T19:19:51.419000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Interesting that this returns `1` and not `2`",
        "created_at": "2024-08-01T19:24:19.115000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "That's what the spec says. https://eips.ethereum.org/EIPS/eip-3540#changes-to-execution-semantics - EXTDELEGATECALL to non-EOF fails as though it's a stack depth failure, https://eips.ethereum.org/EIPS/eip-7069#specification step 10 calls for exit code 1 for a stack depth failire.",
        "created_at": "2024-08-01T19:28:21.578000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "VM is refusing the call, the code at the call didn't fail.",
        "created_at": "2024-08-01T19:28:45.438000+00:00",
        "attachments": []
    }
]
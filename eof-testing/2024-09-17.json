[
    {
        "author": "racytech",
        "category": "Testing",
        "parent": "",
        "content": "Probably this was mentioned before, I am not sure, but it seems that some of `JUMPF` state tests fail during validation steps. As an example `jumpf_to_nonexistent_section` fails when validating instructions, and other tests fail during stack validation. I am guessing this was intended, since test bytecode is invalid and is never executed, and tests end up failing because of state root mismatch. Is this expected behavior? Anyone else experiencing this?",
        "created_at": "2024-09-17T11:37:28.319000+00:00",
        "attachments": null
    },
    {
        "author": "racytech",
        "category": "Testing",
        "parent": "",
        "content": "```\n0xef000101000402000100030400000000800000e50005 - bytecode from jumpf_to_nonexistent_section.json\n\n0x\nef00 - magic\n01   - version\n01   - kind type\n0004 - type sizes (4/4=1 type sections)\n02   - kind code\n0001 - num code sections\n0003 - 1st code section size\n04   - kind data\n0000 - data size\n00   - terminator\n00   - inputs 1st code section\n80   - outputs 1st (non returning)\n0000 - max stack height 1st section\ne5   - JUMPF\n0005 - function id -\u003e does not exists, fails during validation\n```",
        "created_at": "2024-09-17T11:41:56.171000+00:00",
        "attachments": null
    },
    {
        "author": "pdobacz",
        "category": "Testing",
        "parent": "",
        "content": "This is an `EOFStateTest`, which, if configured with an expected error like this one, will generate two tests: an `eof_test` which runs the validation routine and ensure it reports the error, and also a `state_test` (and `blockchain_test` too I guess) to attempt to make an EIP-7698 creation transaction, expecting it to fail too.\n\nI wonder what could be the reason for you for the test to fail.",
        "created_at": "2024-09-17T12:02:21.547000+00:00",
        "attachments": null
    },
    {
        "author": "pdobacz",
        "category": "Testing",
        "parent": "",
        "content": "Refer to [eest](https://github.com/ethereum/execution-spec-tests/blob/main/src/ethereum_test_specs/eof.py#L291) to see how it is filled",
        "created_at": "2024-09-17T12:05:17.518000+00:00",
        "attachments": null
    },
    {
        "author": "racytech",
        "category": "Testing",
        "parent": "",
        "content": "I am trying to pass all the test from `state_tests` v1.0.8 I think, and some of the `jumpf` tests fail because of the post state root mismatch. My guess was that this is happening because of the error being returned during validation step and not proceeding to execution",
        "created_at": "2024-09-17T12:18:11.524000+00:00",
        "attachments": null
    },
    {
        "author": "pdobacz",
        "category": "Testing",
        "parent": "",
        "content": "\u003e not proceeding to execution\nThis is expected behavior. From EIP-7698 \"If EOF header parsing or full container validation fails, transaction is considered valid and failing. Gas for initcode execution is not consumed, only intrinsic creation transaction costs are charged.\"",
        "created_at": "2024-09-17T12:21:08.249000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "We had a similar issue where we consumed all the gas instead of just consuming the initcode creation costs",
        "created_at": "2024-09-17T12:22:11.799000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I'm getting a bad state root on all tests, even those where no new contract is deployed or anything is sstored. I think it may have something to do with Prague. e.g.\n```\n{\"pc\":0,\"op\":227,\"gas\":\"0x984468\",\"gasCost\":\"0x5\",\"memSize\":0,\"stack\":[],\"depth\":1,\"refund\":0,\"opName\":\"CALLF\"}\n{\"pc\":0,\"op\":229,\"gas\":\"0x984463\",\"gasCost\":\"0x5\",\"memSize\":0,\"stack\":[],\"depth\":1,\"refund\":0,\"opName\":\"JUMPF\"}\n{\"pc\":1,\"op\":0,\"gas\":\"0x98445e\",\"gasCost\":\"0x0\",\"memSize\":0,\"stack\":[],\"depth\":1,\"refund\":0,\"opName\":\"STOP\"}\n{\"output\":\"\",\"gasUsed\":\"0xa\"}\n{\"stateRoot\": \"0x124b6e6d3e1975f17437a976a784640e9ad325ec0ff048942966946745713c3e\"}\n[\n  {\n    \"name\": \"tests/prague/eip7692_eof_v1/eip6206_jumpf/test_jumpf_execution.py::test_jumpf_backward[fork_CancunEIP7692-state_test]\",\n    \"pass\": false,\n    \"stateRoot\": \"0x124b6e6d3e1975f17437a976a784640e9ad325ec0ff048942966946745713c3e\",\n    \"fork\": \"Prague\",\n    \"error\": \"post state root mismatch: got 124b6e6d3e1975f17437a976a784640e9ad325ec0ff048942966946745713c3e, want 609970c0fcc7f76a0f97d4e07c6c904896c12e15352c3c46e50bed4ca3a2a3bc\"\n  }\n]\n```\nI believe we're never calling ProcessParentBlockHash in statetests and I wonder if other clients do it differently? And if so, which value they use",
        "created_at": "2024-06-24T07:42:33.544000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Are you guys deploying the history storage code in state tests?",
        "created_at": "2024-06-24T08:33:50.947000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@425274498732916736\u003e",
        "created_at": "2024-06-24T08:35:45.483000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "This is my state dump",
        "created_at": "2024-06-24T09:29:32.694000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=ISO-8859-1",
                "origin_name": "message.txt",
                "content": "VGhpcyBpcyBteSBzdGF0ZSBkdW1wIApgYGAKeyJwYyI6MCwib3AiOjIyNywiZ2FzIjoiMHg5ODQ0NjgiLCJnYXNDb3N0IjoiMHg1IiwibWVtU2l6ZSI6MCwic3RhY2siOltdLCJkZXB0aCI6MSwicmVmdW5kIjowLCJvcE5hbWUiOiJDQUxMRiJ9CnsicGMiOjAsIm9wIjoyMjksImdhcyI6IjB4OTg0NDYzIiwiZ2FzQ29zdCI6IjB4NSIsIm1lbVNpemUiOjAsInN0YWNrIjpbXSwiZGVwdGgiOjEsInJlZnVuZCI6MCwib3BOYW1lIjoiSlVNUEYifQp7InBjIjoxLCJvcCI6MCwiZ2FzIjoiMHg5ODQ0NWUiLCJnYXNDb3N0IjoiMHgwIiwibWVtU2l6ZSI6MCwic3RhY2siOltdLCJkZXB0aCI6MSwicmVmdW5kIjowLCJvcE5hbWUiOiJTVE9QIn0KeyJvdXRwdXQiOiIiLCJnYXNVc2VkIjoiMHhhIn0KeyJzdGF0ZVJvb3QiOiAiMHg3MDUyNTI0ZjdkMGEzNWM1YjdlN2RlNzMwYzYxMTg5YmY1MTc3Y2ZlMzE3ZjEzNjYzN2FkOGM2NDZhYmU4Mzk3In0KSU5GTyBbMDYtMjR8MTE6Mjg6MzkuMDM4XSBUcmllIGR1bXBpbmcgc3RhcnRlZCAgICAgICAgICAgICAgICAgICAgIHJvb3Q9NzA1MjUyLi5iZTgzOTcKSU5GTyBbMDYtMjR8MTE6Mjg6MzkuMDM4XSBUcmllIGR1bXBpbmcgY29tcGxldGUgICAgICAgICAgICAgICAgICAgIGFjY291bnRzPTQgZWxhcHNlZD0iNTguNzHCtXMiClsKICB7CiAgICAibmFtZSI6ICJ0ZXN0cy9wcmFndWUvZWlwNzY5Ml9lb2ZfdjEvZWlwNjIwNl9qdW1wZi90ZXN0X2p1bXBmX2V4ZWN1dGlvbi5weTo6dGVzdF9qdW1wZl9iYWNrd2FyZFtmb3JrX0NhbmN1bkVJUDc2OTItc3RhdGVfdGVzdF0iLAogICAgInBhc3MiOiBmYWxzZSwKICAgICJzdGF0ZVJvb3QiOiAiMHg3MDUyNTI0ZjdkMGEzNWM1YjdlN2RlNzMwYzYxMTg5YmY1MTc3Y2ZlMzE3ZjEzNjYzN2FkOGM2NDZhYmU4Mzk3IiwKICAgICJmb3JrIjogIlByYWd1ZSIsCiAgICAiZXJyb3IiOiAicG9zdCBzdGF0ZSByb290IG1pc21hdGNoOiBnb3QgNzA1MjUyNGY3ZDBhMzVjNWI3ZTdkZTczMGM2MTE4OWJmNTE3N2NmZTMxN2YxMzY2MzdhZDhjNjQ2YWJlODM5Nywgd2FudCA2MDk5NzBjMGZjYzdmNzZhMGY5N2Q0ZTA3YzZjOTA0ODk2YzEyZTE1MzUyYzNjNDZlNTBiZWQ0Y2EzYTJhM2JjIiwKICAgICJzdGF0ZSI6IHsKICAgICAgInJvb3QiOiAiNzA1MjUyNGY3ZDBhMzVjNWI3ZTdkZTczMGM2MTE4OWJmNTE3N2NmZTMxN2YxMzY2MzdhZDhjNjQ2YWJlODM5NyIsCiAgICAgICJhY2NvdW50cyI6IHsKICAgICAgICAiMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMDAwIjogewogICAgICAgICAgImJhbGFuY2UiOiAiMCIsCiAgICAgICAgICAibm9uY2UiOiAxLAogICAgICAgICAgInJvb3QiOiAiMHg1NmU4MWYxNzFiY2M1NWE2ZmY4MzQ1ZTY5MmMwZjg2ZTViNDhlMDFiOTk2Y2FkYzAwMTYyMmZiNWUzNjNiNDIxIiwKICAgICAgICAgICJjb2RlSGFzaCI6ICIweGMxMjMxM2IyMGJiMTY1MzQ0MDkxY2Q0NzI1ZmMwYzhmZDE5NjUwZjhjNDUyYjkyMzk1MjEzNzhjYmE1ZmIwMzEiLAogICAgICAgICAgImNvZGUiOiAiMHhlZjAwMDEwMTAwMGMwMjAwMDMwMDBhMDAwMTAwMDMwNDAwMDAwMDAwODAwMDAyMDAwMDAwMDAwMDAwMDAwMGUzMDAwMjYxMjAxNTYwMDE1NTAwZTRlNTAwMDEiLAogICAgICAgICAgImFkZHJlc3MiOiAiMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMDAwIiwKICAgICAgICAgICJrZXkiOiAiMHgxZDdkY2I2YTBjZTUyMjdjNTM3OWZjNWIwZTAwNDU2MWQ3ODMzYjA2MzM1NWY2OWJmZWEzMTc4ZjA4ZmJhYWI0IgogICAgICAgIH0sCiAgICAgICAgIjB4MEFBRTQwOTY1RTY4MDBjRDliMWY0YjA1ZmYyMTU4MTA0N0UzRjkxZSI6IHsKICAgICAgICAgICJiYWxhbmNlIjogIjAiLAogICAgICAgICAgIm5vbmNlIjogMSwKICAgICAgICAgICJyb290IjogIjB4YzI5ODVmYTkyNmYzYmFiMDlhYmI4MDQwYWU4ODJkYTgwMGY4ZjYwMDY2ZDQ5NmY5YzE1NzA1MzJmMDUyZTA2ZSIsCiAgICAgICAgICAiY29kZUhhc2giOiAiMHhmODhjYTIwZGIyNTExNGU0YmQ3NzEyOGI5ODA3MjhmMDM0ZGExMjI3NzZlMWIzNDJkNjEwOGQ0NzQ1YTk2MWZkIiwKICAgICAgICAgICJjb2RlIjogIjB4MzM3M2ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmUxNDYwNTc1NzY3ZmZmZmZmZmZmZmZmZmZmZjVmMzUxMTYwNTM1NzYwMDE0MzAzNWYzNTExNjA0YjU3NWYzNTYxMjAwMDAxNDMxMTYwNGI1NzYxMWZmZjVmMzUxNjU0NWY1MjYwMjA1ZmYzNWI1ZjVmNTI2MDIwNWZmMzViNWY1ZmZkNWI1ZjM1NjExZmZmNjAwMTQzMDMxNjU1MDAiLAogICAgICAgICAgInN0b3JhZ2UiOiB7CiAgICAgICAgICAgICIweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAiOiAiMDQ0ODUyYjJhNjcwYWRlNTQwN2U3OGZiMjg2M2M1MWRlOWZjYjk2NTQyYTA3MTg2ZmUzYWVkYTZiYjhhMTE2ZCIKICAgICAgICAgIH0sCiAgICAgICAgICAiYWRkcmVzcyI6ICIweDBhYWU0MDk2NWU2ODAwY2Q5YjFmNGIwNWZmMjE1ODEwNDdlM2Y5MWUiLAogICAgICAgICAgImtleSI6ICIweGU0ODZkYWYyYjNjZjk3MDc5ZGViNWMxMTBjOTExZjlhNzBkYzZiYmQyZGFjNWViYTNjMWJmYzc4YjA3NzQ1NDMiCiAgICAgICAgfSwKICAgICAgICAiMHgyQURDMjU2NjUwMThBYTFGRTBFNkJDNjY2RGFDOEZjMjY5N2ZGOWJBIjogewogICAgICAgICAgImJhbGFuY2UiOiAiNjMwNzgiLAogICAgICAgICAgIm5vbmNlIjogMCwKICAgICAgICAgICJyb290IjogIjB4NTZlODFmMTcxYmNjNTVhNmZmODM0NWU2OTJjMGY4NmU1YjQ4ZTAxYjk5NmNhZGMwMDE2MjJmYjVlMzYzYjQyMSIsCiAgICAgICAgICAiY29kZUhhc2giOiAiMHhjNWQyNDYwMTg2ZjcyMzNjOTI3ZTdkYjJkY2M3MDNjMGU1MDBiNjUzY2E4MjI3M2I3YmZhZDgwNDVkODVhNDcwIiwKICAgICAgICAgICJhZGRyZXNzIjogIjB4MmFkYzI1NjY1MDE4YWExZmUwZTZiYzY2NmRhYzhmYzI2OTdmZjliYSIsCiAgICAgICAgICAia2V5IjogIjB4OWQ4NjBlN2JiN2U2YjA5Yjg3YWI3NDA2OTMzZWYyOTgwYzE5ZDdkMDE5MmQ4OTM5Y2Y2ZGM2OTA4YTAzMzA1ZiIKICAgICAgICB9LAogICAgICAgICIweGE5NGY1Mzc0RmNlNWVkQkM4RTJhODY5N0MxNTMzMTY3N2U2RWJGMEIiOiB7CiAgICAgICAgICAiYmFsYW5jZSI6ICI5OTk5OTk5OTk5OTk5OTk3ODk3NDAiLAogICAgICAgICAgIm5vbmNlIjogMSwKICAgICAgICAgICJyb290IjogIjB4NTZlODFmMTcxYmNjNTVhNmZmODM0NWU2OTJjMGY4NmU1YjQ4ZTAxYjk5NmNhZGMwMDE2MjJmYjVlMzYzYjQyMSIsCiAgICAgICAgICAiY29kZUhhc2giOiAiMHhjNWQyNDYwMTg2ZjcyMzNjOTI3ZTdkYjJkY2M3MDNjMGU1MDBiNjUzY2E4MjI3M2I3YmZhZDgwNDVkODVhNDcwIiwKICAgICAgICAgICJhZGRyZXNzIjogIjB4YTk0ZjUzNzRmY2U1ZWRiYzhlMmE4Njk3YzE1MzMxNjc3ZTZlYmYwYiIsCiAgICAgICAgICAia2V5IjogIjB4MDM2MDE0NjIwOTNiNTk0NWQxNjc2ZGYwOTM0NDY3OTBmZDMxYjIwZTdiMTJhMmU4ZTVlMDlkMDY4MTA5NjE2YiIKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cl0KYGBg"
            }
        ]
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "cc \u003c@403707149043105803\u003e",
        "created_at": "2024-06-24T09:29:58.317000+00:00",
        "attachments": []
    },
    {
        "author": "chfast",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@360491619402776577\u003e \n\n1. I don't know what `ProcessParentBlockHash` is so probably I'm not doing it.\n2. Can it be just the gas difference?\n3. The same tests should be in Blockchain form where you have the expected post state.",
        "created_at": "2024-06-24T13:56:39.748000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "It writes the parent block hash to the database",
        "created_at": "2024-06-24T13:57:27.149000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Its https://eips.ethereum.org/EIPS/eip-7709",
        "created_at": "2024-06-24T13:57:57.674000+00:00",
        "attachments": []
    },
    {
        "author": "chfast",
        "category": "Testing",
        "parent": "",
        "content": "Ok, so this may be it. These tests use config \"Shanghai+EOF\" so no other Prague EIPs.",
        "created_at": "2024-06-24T13:59:16.604000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Ah the beaconRootsAddress is set in the blockchain tests, but not in my output",
        "created_at": "2024-06-24T14:00:20.218000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Thanks for the tip with the blockchain tests!",
        "created_at": "2024-06-24T14:00:29.825000+00:00",
        "attachments": []
    },
    {
        "author": "chfast",
        "category": "Testing",
        "parent": "",
        "content": "As I said, we should have single test format ðŸ˜‰",
        "created_at": "2024-06-24T14:03:13.093000+00:00",
        "attachments": []
    },
    {
        "author": "chfast",
        "category": "Testing",
        "parent": "",
        "content": "BTW, the 7709 still (?) don't have the system part... will it get it?",
        "created_at": "2024-06-24T14:05:02.278000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I really don't understand whats happening. In the blockchain test the following is set: \n```\n\"0x000f3df6d732807ef1319fb7b8bb8522d0beac02\": {\n                \"nonce\": \"0x01\",\n                \"balance\": \"0x00\",\n                \"code\": \"0x3373fffffffffffffffffffffffffffffffffffffffe14604d57602036146024575f5ffd5b5f35801560495762001fff810690815414603c575f5ffd5b62001fff01545f5260205ff35b5f5ffd5b62001fff42064281555f359062001fff015500\",\n                \"storage\": {\n                    \"0x03e8\": \"0x03e8\"\n                }\n            },\n\n```",
        "created_at": "2024-06-24T14:18:19.394000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Which is the 4788 beacon root contract with the correct code, but the storage is set to 1000... why?",
        "created_at": "2024-06-24T14:18:56.076000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "ParentBeaconBlock is 0x0 both for this and the genesis block",
        "created_at": "2024-06-24T14:19:46.651000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@892053833121923094\u003e",
        "created_at": "2024-06-24T14:19:51.909000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "When I try to run the blocktest, I error even earlier: \n```\ncution/jumpf_backward.json \nINFO [06-24|16:21:25.403] Persisted trie from memory database      nodes=4 size=573.00B time=\"5.8Âµs\" gcnodes=0 gcsize=0.00B gctime=0s livenodes=0 livesize=0.00B\ntest tests/prague/eip7692_eof_v1/eip6206_jumpf/test_jumpf_execution.py::test_jumpf_backward[fork_CancunEIP7692-blockchain_test]: genesis block hash doesn't match test: computed=8c2428746f69, test=b58a08819f02\n```",
        "created_at": "2024-06-24T14:22:43.027000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Ahh I think the genesis error is because evmone doesn't have the empty Requests Hash",
        "created_at": "2024-06-24T14:27:43.503000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "EOF tests are still on top of Cancun",
        "created_at": "2024-06-24T14:32:26.647000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "But that still doesn't explain the weird thing stored in beaconroot contract",
        "created_at": "2024-06-24T14:34:29.951000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Although, it would be relatively simple to enable on top of Prague by just adding the empty requests hash on top of  Cancun's output I think",
        "created_at": "2024-06-24T14:34:50.224000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Timestamp of the previous block I think, if we don't specify anything to the `parentBeaconBlockRoot` field, it stores zero, but the timestamp is non-zero regardless",
        "created_at": "2024-06-24T14:35:55.413000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "Ahh now I get it",
        "created_at": "2024-06-24T14:36:53.613000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "Besu's T8n does in prague, evmone doesn't.  We get different state roots for the state tests, That opens the question, should state-tests's update block hash?  Won't they need a parentHash field in the env section now?  And should we rely on a \"standard\" parent and beacon root unless we are explicitly testing those features?",
        "created_at": "2024-06-24T15:22:51.950000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "The old testing code used the hashes of the block numbers for BLOCKHASH.",
        "created_at": "2024-06-24T15:23:20.782000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "I'm still getting a state root mismatch even though it _looks_ the same too me",
        "created_at": "2024-06-24T15:29:41.621000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "message.txt",
                "content": "Q2FuIHNvbWVvbmUgZmluZCB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZXNlIHR3bzoKYGBgCiJzdGF0ZSI6IHsKICAgICAgInJvb3QiOiAiMDZhM2FjYTc0ODUwNWQyZDY4YmY5NDRhZTFkZDgzYTA3NTE5NGFjYWNhZDI2NmM2ZjMzMWIyOGIwY2EyOWI5NyIsCiAgICAgICJhY2NvdW50cyI6IHsKICAgICAgICAiMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMDAwIjogewogICAgICAgICAgImJhbGFuY2UiOiAiMCIsCiAgICAgICAgICAibm9uY2UiOiAxLAogICAgICAgICAgInJvb3QiOiAiMHg0Nzg4YWJmZWYwN2NmZDQ3NWVlMmQ4ZTBmNzdmNTQ0NTRmNGU1NWIyMzVmZjdiNjJlNDQyOGY1YTRlY2Y3MWM5IiwKICAgICAgICAgICJjb2RlSGFzaCI6ICIweGMxMjMxM2IyMGJiMTY1MzQ0MDkxY2Q0NzI1ZmMwYzhmZDE5NjUwZjhjNDUyYjkyMzk1MjEzNzhjYmE1ZmIwMzEiLAogICAgICAgICAgImNvZGUiOiAiMHhlZjAwMDEwMTAwMGMwMjAwMDMwMDBhMDAwMTAwMDMwNDAwMDAwMDAwODAwMDAyMDAwMDAwMDAwMDAwMDAwMGUzMDAwMjYxMjAxNTYwMDE1NTAwZTRlNTAwMDEiLAogICAgICAgICAgInN0b3JhZ2UiOiB7CiAgICAgICAgICAgICIweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDEiOiAiMjAxNSIKICAgICAgICAgIH0sCiAgICAgICAgICAiYWRkcmVzcyI6ICIweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDEwMDAiLAogICAgICAgICAgImtleSI6ICIweDFkN2RjYjZhMGNlNTIyN2M1Mzc5ZmM1YjBlMDA0NTYxZDc4MzNiMDYzMzU1ZjY5YmZlYTMxNzhmMDhmYmFhYjQiCiAgICAgICAgfSwKICAgICAgICAiMHgwMDBGM2RmNkQ3MzI4MDdFZjEzMTlmQjdCOGJCODUyMmQwQmVhYzAyIjogewogICAgICAgICAgImJhbGFuY2UiOiAiMCIsCiAgICAgICAgICAibm9uY2UiOiAxLAogICAgICAgICAgInJvb3QiOiAiMHhmOTM5Nzk0MTg4NzA3ZjFjMGY1YmU4N2I5Mzg5ZGUwMjExM2I2ZmEzYmZjNzMzZDQ5MjBkYzJhNTIwYmIxYzY2IiwKICAgICAgICAgICJjb2RlSGFzaCI6ICIweGY1N2FjZDQwMjU5ODcyNjA2ZDc2MTk3ZWYwNTJmM2QzNTU4OGRhZGY5MTllZTFmMGUzY2I5YjYyZDNmNGIwMmMiLAogICAgICAgICAgImNvZGUiOiAiMHgzMzczZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZTE0NjA0ZDU3NjAyMDM2MTQ2MDI0NTc1ZjVmZmQ1YjVmMzU4MDE1NjA0OTU3NjIwMDFmZmY4MTA2OTA4MTU0MTQ2MDNjNTc1ZjVmZmQ1YjYyMDAxZmZmMDE1NDVmNTI2MDIwNWZmMzViNWY1ZmZkNWI2MjAwMWZmZjQyMDY0MjgxNTU1ZjM1OTA2MjAwMWZmZjAxNTUwMCIsCiAgICAgICAgICAic3RvcmFnZSI6IHsKICAgICAgICAgICAgIjB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDNlOCI6ICIwM2U4IgogICAgICAgICAgfSwKICAgICAgICAgICJhZGRyZXNzIjogIjB4MDAwZjNkZjZkNzMyODA3ZWYxMzE5ZmI3YjhiYjg1MjJkMGJlYWMwMiIsCiAgICAgICAgICAia2V5IjogIjB4MzdkNjVlYWE5MmM2YmM0YzEzYTVlYzQ1NTI3ZjBjMThlYTg5MzI1ODg3Mjg3NjllYzdhZWNmZTZkOWYzMmU0MiIKICAgICAgICB9LAogICAgICAgICIweDJBREMyNTY2NTAxOEFhMUZFMEU2QkM2NjZEYUM4RmMyNjk3ZkY5YkEiOiB7CiAgICAgICAgICAiYmFsYW5jZSI6ICIxMjk0MDUiLAogICAgICAgICAgIm5vbmNlIjogMCwKICAgICAgICAgICJyb290IjogIjB4NTZlODFmMTcxYmNjNTVhNmZmODM0NWU2OTJjMGY4NmU1YjQ4ZTAxYjk5NmNhZGMwMDE2MjJmYjVlMzYzYjQyMSIsCiAgICAgICAgICAiY29kZUhhc2giOiAiMHhjNWQyNDYwMTg2ZjcyMzNjOTI3ZTdkYjJkY2M3MDNjMGU1MDBiNjUzY2E4MjI3M2I3YmZhZDgwNDVkODVhNDcwIiwKICAgICAgICAgICJhZGRyZXNzIjogIjB4MmFkYzI1NjY1MDE4YWExZmUwZTZiYzY2NmRhYzhmYzI2OTdmZjliYSIsCiAgICAgICAgICAia2V5IjogIjB4OWQ4NjBlN2JiN2U2YjA5Yjg3YWI3NDA2OTMzZWYyOTgwYzE5ZDdkMDE5MmQ4OTM5Y2Y2ZGM2OTA4YTAzMzA1ZiIKICAgICAgICB9LAogICAgICAgICIweGE5NGY1Mzc0RmNlNWVkQkM4RTJhODY5N0MxNTMzMTY3N2U2RWJGMEIiOiB7CiAgICAgICAgICAiYmFsYW5jZSI6ICI5OTk5OTk5OTk5OTk5OTk1Njg2NTAiLAogICAgICAgICAgIm5vbmNlIjogMSwKICAgICAgICAgICJyb290IjogIjB4NTZlODFmMTcxYmNjNTVhNmZmODM0NWU2OTJjMGY4NmU1YjQ4ZTAxYjk5NmNhZGMwMDE2MjJmYjVlMzYzYjQyMSIsCiAgICAgICAgICAiY29kZUhhc2giOiAiMHhjNWQyNDYwMTg2ZjcyMzNjOTI3ZTdkYjJkY2M3MDNjMGU1MDBiNjUzY2E4MjI3M2I3YmZhZDgwNDVkODVhNDcwIiwKICAgICAgICAgICJhZGRyZXNzIjogIjB4YTk0ZjUzNzRmY2U1ZWRiYzhlMmE4Njk3YzE1MzMxNjc3ZTZlYmYwYiIsCiAgICAgICAgICAia2V5IjogIjB4MDM2MDE0NjIwOTNiNTk0NWQxNjc2ZGYwOTM0NDY3OTBmZDMxYjIwZTdiMTJhMmU4ZTVlMDlkMDY4MTA5NjE2YiIKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CmBgYApgYGAKInBvc3RTdGF0ZSI6IHsKICAgICAgICAgICAgIjB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTAwMCI6IHsKICAgICAgICAgICAgICAgICJub25jZSI6ICIweDAxIiwKICAgICAgICAgICAgICAgICJiYWxhbmNlIjogIjB4MDAiLAogICAgICAgICAgICAgICAgImNvZGUiOiAiMHhlZjAwMDEwMTAwMGMwMjAwMDMwMDBhMDAwMTAwMDMwNDAwMDAwMDAwODAwMDAyMDAwMDAwMDAwMDAwMDAwMGUzMDAwMjYxMjAxNTYwMDE1NTAwZTRlNTAwMDEiLAogICAgICAgICAgICAgICAgInN0b3JhZ2UiOiB7CiAgICAgICAgICAgICAgICAgICAgIjB4MDEiOiAiMHgyMDE1IgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICAiMHgwMDBmM2RmNmQ3MzI4MDdlZjEzMTlmYjdiOGJiODUyMmQwYmVhYzAyIjogewogICAgICAgICAgICAgICAgIm5vbmNlIjogIjB4MDEiLAogICAgICAgICAgICAgICAgImJhbGFuY2UiOiAiMHgwMCIsCiAgICAgICAgICAgICAgICAiY29kZSI6ICIweDMzNzNmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlMTQ2MDRkNTc2MDIwMzYxNDYwMjQ1NzVmNWZmZDViNWYzNTgwMTU2MDQ5NTc2MjAwMWZmZjgxMDY5MDgxNTQxNDYwM2M1NzVmNWZmZDViNjIwMDFmZmYwMTU0NWY1MjYwMjA1ZmYzNWI1ZjVmZmQ1YjYyMDAxZmZmNDIwNjQyODE1NTVmMzU5MDYyMDAxZmZmMDE1NTAwIiwKICAgICAgICAgICAgICAgICJzdG9yYWdlIjogewogICAgICAgICAgICAgICAgICAgICIweDAzZTgiOiAiMHgwM2U4IgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICAiMHgyYWRjMjU2NjUwMThhYTFmZTBlNmJjNjY2ZGFjOGZjMjY5N2ZmOWJhIjogewogICAgICAgICAgICAgICAgIm5vbmNlIjogIjB4MDAiLAogICAgICAgICAgICAgICAgImJhbGFuY2UiOiAiMHgwMWY5N2QiLAogICAgICAgICAgICAgICAgImNvZGUiOiAiMHgiLAogICAgICAgICAgICAgICAgInN0b3JhZ2UiOiB7fQogICAgICAgICAgICB9LAogICAgICAgICAgICAiMHhhOTRmNTM3NGZjZTVlZGJjOGUyYTg2OTdjMTUzMzE2NzdlNmViZjBiIjogewogICAgICAgICAgICAgICAgIm5vbmNlIjogIjB4MDEiLAogICAgICAgICAgICAgICAgImJhbGFuY2UiOiAiMHgzNjM1YzlhZGM1ZGU5OTZiMGEiLAogICAgICAgICAgICAgICAgImNvZGUiOiAiMHgiLAogICAgICAgICAgICAgICAgInN0b3JhZ2UiOiB7fQogICAgICAgICAgICB9CiAgICAgICAgfSwKYGBg"
            }
        ]
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "It does work with the blockchain tests now",
        "created_at": "2024-06-24T15:30:16.808000+00:00",
        "attachments": []
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "The state test doesn't work yet for me though",
        "created_at": "2024-06-24T15:30:30.574000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "The sate-test is missing the beacon root in it's hash state: 0x609970c0fcc7f76a0f97d4e07c6c904896c12e15352c3c46e50bed4ca3a2a3bc\n```\n{\n \"0x0000000000000000000000000000000000001000\": {\n  \"code\": \"0xef000101000c020003000a0001000304000000008000020000000000000000e3000261201560015500e4e50001\",\n  \"storage\": {\n   \"0x1\": \"0x2015\"\n  },\n  \"balance\": \"0x0\",\n  \"nonce\": \"0x1\"\n },\n \"0x2adc25665018aa1fe0e6bc666dac8fc2697ff9ba\": {\n  \"balance\": \"0x1f97d\"\n },\n \"0xa94f5374fce5edbc8e2a8697c15331677e6ebf0b\": {\n  \"balance\": \"0x3635c9adc5de996b0a\",\n  \"nonce\": \"0x1\"\n },\n}\n```",
        "created_at": "2024-06-24T15:39:03.628000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "So for cancun state-tests\n* Should we add beacon root? (this is after the TX)\nand for Prague state-tests\n* Should we add block-hash? (this is before the TX, and may impact BLOCKHASH operation)",
        "created_at": "2024-06-24T15:40:21.104000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "Or for both, do we do neither operation as state-tests are testing a single sub-block transition.  Blockhash needs to be set up in prestate or the parents are zero, and only changes from the TX are considered.",
        "created_at": "2024-06-24T15:41:51.893000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "That cancun tests are not adding beacon root leads me to the \"no system tx\" path.",
        "created_at": "2024-06-24T15:42:16.278000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@892053833121923094\u003e ^^^ - What should a T8n and state tests tool that properly handles Prague do?",
        "created_at": "2024-06-24T15:58:26.785000+00:00",
        "attachments": []
    },
    {
        "author": "chfast",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@425343240212971521\u003e has added an option to export evmone's EOF validation tests: https://github.com/ethereum/execution-spec-tests/pull/646\n\nIs this something EEST want's to receive?",
        "created_at": "2024-06-24T16:11:33.803000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "We need this to generate the blockchain tests, sadly, if we were only generating state tests with t8n then it would be ok, but I think the blockchain tests are just as important.\n\nIdeally we should have two different tools for each operation.",
        "created_at": "2024-06-24T16:30:04.440000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "If t8n doesn't do both of these operations for us, then all blockchain tests will be incorrect",
        "created_at": "2024-06-24T16:30:34.952000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "We have no way of appending something into the state before or after execution of the transactions by the t8n",
        "created_at": "2024-06-24T16:31:07.421000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "To clarify, state-tests \n* Should or should not process the parent block hash prior to the tx\n* Should or should not process the beacon root update after the tx?",
        "created_at": "2024-06-24T16:38:59.740000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Ideally they should not, **but** we have no way of doing this now, so for the time being both t8n and the state tests will need to have both operations",
        "created_at": "2024-06-24T16:40:52.372000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "Ok, I'll bring Besu's tools in line today.  We may need to re-state state tests for cancun as I don't think they were doing beacon root update (which adds the timestamp even if root hash is zeros)",
        "created_at": "2024-06-24T16:41:52.802000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "We should aim to have `t8n-blockchain` + `t8n-state` in the long term:\n- `t8n-blockchain`: applies multiple transactions and extra block logic including system-txs\n- `t8n-state`: applies a single tx and nothing else (might redirect priority fees to a default coinbase)",
        "created_at": "2024-06-24T16:44:33.313000+00:00",
        "attachments": []
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "long term as in when we start flipping prague testnets?  What about devnet-1 and devnet-2?",
        "created_at": "2024-06-24T16:46:33.565000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "The thing is I don't think there is that much added benefit to have this ready for devnet-1",
        "created_at": "2024-06-24T16:47:32.786000+00:00",
        "attachments": []
    },
    {
        "author": "gumb00",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@892053833121923094\u003e how is `max_stack_height` calculated by `Bytecode` exactly?",
        "created_at": "2024-06-24T18:01:20.040000+00:00",
        "attachments": []
    },
    {
        "author": "gumb00",
        "category": "Testing",
        "parent": "",
        "content": "I think it cannot handle any code with jumps correctly at all?",
        "created_at": "2024-06-24T18:01:34.501000+00:00",
        "attachments": []
    },
    {
        "author": "gumb00",
        "category": "Testing",
        "parent": "",
        "content": "it seems it just assumes that code is linear",
        "created_at": "2024-06-24T18:01:49.084000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Yes that is correct, it's calculated when two opcodes are added together with this code:\nhttps://github.com/ethereum/execution-spec-tests/blob/ffdfc6315d7d6fbede06e287ae52877688b0a29d/src/ethereum_test_tools/vm/opcode.py#L155",
        "created_at": "2024-06-24T18:04:11.234000+00:00",
        "attachments": []
    },
    {
        "author": "gumb00",
        "category": "Testing",
        "parent": "",
        "content": "okay",
        "created_at": "2024-06-24T18:04:49.605000+00:00",
        "attachments": []
    },
    {
        "author": "gumb00",
        "category": "Testing",
        "parent": "",
        "content": "I think test fixtures should have an \"initcode\" flag and eofparse should have an input flag. \n(I don't know much about `eof_test.py` yet)",
        "created_at": "2024-06-24T18:28:26.494000+00:00",
        "attachments": []
    }
]
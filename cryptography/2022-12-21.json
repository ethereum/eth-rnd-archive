[
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hi Micah. Looking at the ``ethereum-crypto/library/source/secp256k1.ts`` code, I noticed that you choose to sometimes reverse ``s`` and consequently ``R.y``  in the ``sign`` function. The comment is: \n``// if there are multiple valid values of s, prefer the smaller one``\n``const s = maybeS \u003c basePointOrder / 2n ? maybeS : basePointOrder - maybeS`` [...]\nCould you please explain that choice to me? Is this formally specified somewhere?",
        "created_at": "2022-12-21T18:32:12.651000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or is it just to speedup the double\u0026add algo?",
        "created_at": "2022-12-21T18:39:59.753000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "IIRC (it was a while ago) this is an Ethereum thing to avoid needing 4 values for `v`?",
        "created_at": "2022-12-21T19:16:06.682000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Though, I may be thinking about something else.",
        "created_at": "2022-12-21T19:16:13.685000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hmm, actually maybe that is the `if (point.x \u003e= basePointOrder)` thing that I am thinking of.",
        "created_at": "2022-12-21T19:17:51.113000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@273808422753796097\u003e probably remembers why `s` is changed if it ends up being greater than half of the base point order.",
        "created_at": "2022-12-21T19:19:12.372000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It's to make signatures not malleable",
        "created_at": "2022-12-21T19:19:40.723000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So to prevent third parties from changing the signature while the tx is inflight",
        "created_at": "2022-12-21T19:19:59.178000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Meaning, two valid signatures for a single transaction?",
        "created_at": "2022-12-21T19:20:11.678000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yep",
        "created_at": "2022-12-21T19:20:17.169000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Where third parties can flip which one it is",
        "created_at": "2022-12-21T19:20:26.742000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Which could cause the included txhash to be different from the sent txhash",
        "created_at": "2022-12-21T19:20:35.992000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Which would screw up ux",
        "created_at": "2022-12-21T19:20:40.638000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh, you don't need the private key to flip between the two?",
        "created_at": "2022-12-21T19:20:41.585000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "No you don't",
        "created_at": "2022-12-21T19:20:47.926000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, I see it now.  Thanks!",
        "created_at": "2022-12-21T19:21:05.123000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "With the private key, you can make almost 2**256 different valid signatures for each (tx, key) pair",
        "created_at": "2022-12-21T19:21:25.688000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "BLS is the only scheme we have (well technically lamport/winternitz too) which tries to have a \"one valid signature per (message, key) combo\" property",
        "created_at": "2022-12-21T19:22:03.611000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is a neat property.  Are there any big wins from it, or just \"simplifies some things\"?",
        "created_at": "2022-12-21T19:23:33.654000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So should a node/wallet assume that signatures with ``s \u003e PointOrder/2`` are invalid?  Since a specific bloc?",
        "created_at": "2022-12-21T19:45:03.918000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Nevermind, I think I found the specification. It appeared in the EIP-2 for the Homestead hardfork (a while ago!) Thank you both for your kind help! ðŸ™‚",
        "created_at": "2022-12-21T20:59:03.866000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hi Micah. In the following test of your recover function (r=1, s=1), I seem to find both a R and PubKey candidates that are on the curve and of the right order:\nhttps://github.com/Zoltu/ethereum-crypto/blob/master/tests/source/index.ts#L487-L491\nMy solutions are:\n``R = (1, 0x4218f20ae6c646b363db68605822fb14264ca8d2587fdd6fbc750d587e76a7ee)``\n``PubKey  = (0xc37c38e15e2d375cb8b4dfc6b4202fb28c39acac38c268fdaf13e560f3b793c0, 0xdd50c04fe95fdb6ed527d8906b37aa63fc72eb07f5b9aa7abf41e1eb9a174f3a)``\nCould you help me find out what is my mistake?",
        "created_at": "2022-12-23T14:34:48.450000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "~~IIRC, something is special about r=1,s=1.~~",
        "created_at": "2022-12-23T14:37:16.584000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "```ts\n1^3 + 0 + 7 = 8\nmodularHasPerfectSquareRoot(8, 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f) == false\n```",
        "created_at": "2022-12-23T14:43:06.999000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I believe the magic is in https://mathworld.wolfram.com/LegendreSymbol.html which I never actually understood, just implemented.",
        "created_at": "2022-12-23T14:45:06.483000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Weird....I find that sqrt(8) = 0x4218f20ae6c646b363db68605822fb14264ca8d2587fdd6fbc750d587e76a7ee modulo 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f...let me see...",
        "created_at": "2022-12-23T14:48:18.532000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Does my library agree with that?",
        "created_at": "2022-12-23T14:49:01.951000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Particluarly, does this function return true or false when passed those parameters?\n```ts\nexport function modularHasPerfectSquareRoot(value: bigint, modulus: bigint) {\n    if (value === 0n) throw new Error(`value cannot be 0`)\n    // technically this can work for values greater than or equal to modulus, but we would need to deal with value % modulus == 0 then\n    if (value \u003e= modulus) throw new Error(`value (${value}) \u003e= modulus (${modulus})`)\n    const legendreSymbol = modularPower(value, (modulus - 1n) / 2n, modulus)\n    // legendareSymbol will always be -1 or 1 here (0 is not possible because we don't allow value \u003e= modulus)\n    return legendreSymbol === 1n ? true : false\n}\n```",
        "created_at": "2022-12-23T14:49:35.981000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also, you should validate the test against another library.  Don't blindly trust my library!",
        "created_at": "2022-12-23T14:50:59.641000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Especially on erroring when it shouldn't have, as I tended to make decisions that preferred incorrect failure over incorrect success.",
        "created_at": "2022-12-23T14:52:00.853000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If FieldOrder%4 = 3, shouldn't it be x^(modulus+1)/4?",
        "created_at": "2022-12-23T14:52:14.302000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Like the fact that that function just hard fails if `value` is greater than `modulus`.",
        "created_at": "2022-12-23T14:52:16.916000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Shouldn't what be?",
        "created_at": "2022-12-23T14:53:24.176000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh, the code isn't making it that far.",
        "created_at": "2022-12-23T14:54:05.688000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Sorry, the square root of x: sqrt(x) = x^(modulus+1)/4",
        "created_at": "2022-12-23T14:54:07.661000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That function is returning early with `undefined` because value == 0, modulus == 2, or `modularHasPerfectSquareRoot` returns false.",
        "created_at": "2022-12-23T14:54:47.466000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So we don't even get to the point where we run the modular square root.",
        "created_at": "2022-12-23T14:54:56.029000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If you aren't doing that check I think that is the problem.",
        "created_at": "2022-12-23T14:56:17.781000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm going to go out on a limb here and suggest that that function will *always* return a value if you omit the `has perfect square` check.",
        "created_at": "2022-12-23T14:56:42.109000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ok. Maybe I missunderstand what a \"perfect\" square root is. I happen to simply have found a working square root % field order.",
        "created_at": "2022-12-23T14:58:35.091000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You do appear to be correct that `0x4218f20ae6c646b363db68605822fb14264ca8d2587fdd6fbc750d587e76a7ee^2 mod 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f = 8`.  My guess is that the term \"perfect square\" means something different than one expects it to mean, which I have found to be common in cryptography.  ðŸ˜–",
        "created_at": "2022-12-23T14:58:38.274000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://math.stackexchange.com/a/2515595",
        "created_at": "2022-12-23T14:59:43.374000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ouch! I definitely need to read more on that requirement.",
        "created_at": "2022-12-23T14:59:47.893000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "My instinct is to assume that \"perfect square\" means \"whole integer square\", but perhaps within a finite field one can *always* find a whole integer square?",
        "created_at": "2022-12-23T15:01:20.415000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I bet \u003c@427491045308235776\u003e knows what a \"perfect square\" in a finite field is.  ðŸ˜¬",
        "created_at": "2022-12-23T15:01:42.177000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Though, you can probably just look it up online.",
        "created_at": "2022-12-23T15:01:47.606000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or, again, maybe my code is wrong.  ðŸ˜¬",
        "created_at": "2022-12-23T15:02:46.581000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That SO answer suggests that maybe my code is wrong and I should not be erroring.",
        "created_at": "2022-12-23T15:03:43.589000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hello ðŸ‘‹  I think it just means that it is a quadratic residue. Unlike the rational numbers, when you take a square root, you don't get a decimal number if it is not a \"perfect square\". So the square root either exists in the field or it does not",
        "created_at": "2022-12-23T15:03:45.855000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is `0x4218f20ae6c646b363db68605822fb14264ca8d2587fdd6fbc750d587e76a7ee` a perfect square of `8` in the finite field `0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f`?",
        "created_at": "2022-12-23T15:04:47.838000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think this works depending on what the modulus is",
        "created_at": "2022-12-23T15:04:53.825000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If you naively square the number mod field, you get `8`.  But I have some code I wrote a long time ago that checks to see if a value is a perfect square that is returning false.",
        "created_at": "2022-12-23T15:05:35.818000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah I did this in a online python interpreter:\n\n```python\na = 0x4218f20ae6c646b363db68605822fb14264ca8d2587fdd6fbc750d587e76a7ee\nmodulus = 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f\n\nprint((a * a) % modulus) // 8\n```",
        "created_at": "2022-12-23T15:06:15.251000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And that is sufficient to mean 8 is the perfect square of a?",
        "created_at": "2022-12-23T15:07:48.008000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There aren't any other requirements that a must fulfil?",
        "created_at": "2022-12-23T15:07:57.648000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What does \"unlike the rational numbers\" mean here? ðŸ˜¬",
        "created_at": "2022-12-23T15:09:41.754000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We can say a number `x` is a perfect square, if you can find another number in the field `a` such that `a * a = x` modulo the prime",
        "created_at": "2022-12-23T15:12:22.978000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "*real ðŸ˜„",
        "created_at": "2022-12-23T15:12:28.554000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In that case I have no idea why I have some code that claims to check if something is a perfect square that is returning `false` for those inputs.  ðŸ˜¬",
        "created_at": "2022-12-23T15:12:55.821000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Welcome to the land of cargo culting.",
        "created_at": "2022-12-23T15:13:05.972000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Surely there is a good reason for it...",
        "created_at": "2022-12-23T15:13:17.785000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is the modulus you are using `0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f`?",
        "created_at": "2022-12-23T15:13:32.007000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It is a secp256k1 test case that claims the signature `r=1, s=1, recovery=0` is \"invalid\".",
        "created_at": "2022-12-23T15:14:04.206000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think here you may want `modularPower(value, (modulus + 1n) / 4n, modulus)` I'll look for a reference",
        "created_at": "2022-12-23T15:15:52.074000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is what I do, but not until *after* checking `modularHasPerfectSquareRoot` (which may be a misnamed function!).",
        "created_at": "2022-12-23T15:16:56.315000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Got no clue what is your application but the very first check here is wrong, 0 is a square on any field",
        "created_at": "2022-12-23T15:21:48.047000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It is for secp256k1 (ECDSA).",
        "created_at": "2022-12-23T15:22:12.579000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And I believe `0` is not allowed in this context, and my guess (based on my knowledge of past me) is that it adds complexity if you try to make that function work for `0`.",
        "created_at": "2022-12-23T15:22:58.034000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "My current suspicion is that the function is named wrong.",
        "created_at": "2022-12-23T15:24:24.945000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@457453632254640140\u003e My recommendation is to find another library and run that test case against it to see if it also says that the signature is invalid.  If it does, then it likely means my code is right in this case, but perhaps the function is named poorly.",
        "created_at": "2022-12-23T15:27:07.968000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If 2+ libraries say that the signature `r:1,s:1,recovery:0` is valid, then it probably means my code is wrong (but in a safe way as it just means it'll fail when it should succeed, rather than succeeding when it should fail).",
        "created_at": "2022-12-23T15:27:57.534000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ok, will do. I might try to run that testcase in remix and keep you in touch. Thank you very much for your time!",
        "created_at": "2022-12-23T15:30:04.965000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm sorry \u003c@301186049323958275\u003e but I don't understand what your confusion is here, the code you posted there, modulo the little thing with zero, checks whether the Legendre symbol (v/m) == 1 (for v = value and m = modulus).  If m is prime then this is if and only if v is a square in the field F_m, which is precisely what the name indicates.",
        "created_at": "2022-12-23T15:38:18.377000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is a result that goes back to Euler.",
        "created_at": "2022-12-23T15:38:41.271000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So you think that function should not be returning `false` for `8, 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f`?",
        "created_at": "2022-12-23T15:39:28.858000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "what is 8 and what is 0xffff.... ?",
        "created_at": "2022-12-23T15:39:47.065000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`value=8, modulus = 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f`\nFor context: `0x4218f20ae6c646b363db68605822fb14264ca8d2587fdd6fbc750d587e76a7ee^2 mod 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f = 8`",
        "created_at": "2022-12-23T15:40:12.125000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "if that equation is correct then yes, the function should return `true` for that pair",
        "created_at": "2022-12-23T15:40:53.070000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this is also asuming that the modulus is prime",
        "created_at": "2022-12-23T15:41:31.375000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Presumably it is (modulus for secp256k1).",
        "created_at": "2022-12-23T15:41:45.876000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I do not know anything about cryptography, so got no clue what that curve is, but typically elliptic curves over finite fields are defined over F_q where q = p^k is a power of a prime,",
        "created_at": "2022-12-23T15:42:34.717000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and if it's referring not to the base field but to the field of invertible points the same applies, if it's a cyclic group then yes that m should be prime",
        "created_at": "2022-12-23T15:44:12.530000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Internet seems to suggest that ECDSA field modulus has to be prime.",
        "created_at": "2022-12-23T15:44:29.029000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ok, so then your code above is correct",
        "created_at": "2022-12-23T15:44:41.288000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it checks that there exists a such that a*a = v in the field F_m",
        "created_at": "2022-12-23T15:44:56.738000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@457453632254640140\u003e I just tested my code against `8, modulus` and I get back true.  ðŸ¤”",
        "created_at": "2022-12-23T15:45:02.206000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so it should return true",
        "created_at": "2022-12-23T15:45:12.688000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@457453632254640140\u003e The answer is the most terrifying answer possible.  ðŸ˜¬",
        "created_at": "2022-12-23T15:50:41.866000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That test is actually failing, but for some reason Jasmine is reporting it as a success.  ðŸ˜¬",
        "created_at": "2022-12-23T15:50:54.591000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh thank god.  Only two tests had the particular bug that caused Jasmine to not actually report on them.",
        "created_at": "2022-12-23T15:52:05.868000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "throws on invalid signature\nthrows on wrong message",
        "created_at": "2022-12-23T15:52:34.583000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hmm, that second one is still terrifying.",
        "created_at": "2022-12-23T15:52:50.097000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hopefully no one uses this code in production.  ðŸ˜¬",
        "created_at": "2022-12-23T15:52:55.129000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "List your repo subscribers and reach out to them to inform them of an update?",
        "created_at": "2022-12-23T15:54:31.105000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Need to figure out if it is a bug in the test or in the code first.",
        "created_at": "2022-12-23T15:55:35.242000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah, I think the test was just testing something that it shouldn't have been.",
        "created_at": "2022-12-23T15:59:43.977000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If you have a signature and a message hash, you can always* recover it to an address, it just won't recover to the address that signed the message.",
        "created_at": "2022-12-23T16:00:28.873000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yep. And unless one find a collision in the keccak256, the address check should always be enough.",
        "created_at": "2022-12-23T16:03:45.231000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Would be nice to have a test case for invalid signature.  Apparently they are fairly rare though I guess?",
        "created_at": "2022-12-23T16:04:21.146000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is, it is non-trivial to find an `r,s` pair that is invalid.",
        "created_at": "2022-12-23T16:04:44.610000+00:00",
        "attachments": null
    },
    {
        "author": "arxis75",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It might be impossible for a specific hash, without predefining the pubkey.",
        "created_at": "2022-12-23T16:06:25.652000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@457453632254640140\u003e \u003chttps://github.com/Zoltu/ethereum-crypto/commit/da9516c5826cecb41258ea077ebdc59894e4b995\u003e I did find one bug researching this.  Not super critical, but worth fixing none the less and it resulted in being able to write a test that actually fails.",
        "created_at": "2022-12-23T16:55:33.549000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@301186049323958275\u003e think I found the bug",
        "created_at": "2022-12-23T17:09:19.877000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Too late, already found.  ðŸ˜†",
        "created_at": "2022-12-23T17:09:30.460000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "My test was incorrectly passing when it should have been failing.  ðŸ˜¬",
        "created_at": "2022-12-23T17:09:41.667000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "damn ðŸ˜„",
        "created_at": "2022-12-23T17:09:57.347000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@301186049323958275\u003e Oh wait, so to be clear, this `modularHasPerfectSquareRoot(8, 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f) == false` should return true in theory, but it returns false",
        "created_at": "2022-12-23T17:10:50.171000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Correct.  That should return true.",
        "created_at": "2022-12-23T17:16:13.011000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think you habitually postfixed n to the constant, whereas without it you would get back 0 which is probably what \u003c@457453632254640140\u003e did",
        "created_at": "2022-12-23T17:16:16.546000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And it does return true.",
        "created_at": "2022-12-23T17:16:19.838000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I thought it returned false because my test harness was setup incorrectly.  ðŸ˜¬",
        "created_at": "2022-12-23T17:16:42.921000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I get back false when I don't postfix the `n` constant, but once its postfixed, I get back true",
        "created_at": "2022-12-23T17:17:30.482000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Was reading a bigint crypto util package and they also commented:\n\n```\n/* Stage 3 BigInts with value 666 can be declared as BigInt('666')\nor the shorter syntax 666n.\nNotice that you can also pass a number, e.g. BigInt(666), but it is not\nrecommended since values over 2**53 - 1 won't be safe but no warning will\nbe raised.\n*/\n```\n\n\u003chttps://github.com/juanelas/bigint-mod-arith#api-reference-documentation\u003e",
        "created_at": "2022-12-23T17:19:23.069000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The `n` tells JS that it needs to be a `bigint`.  Otherwise it is stored in memory as a double precision floating point number which results in rounding.",
        "created_at": "2022-12-23T17:20:06.609000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In other words, every single one of your integer constants should have an `n` if you are doing anything in cryptography or finance.",
        "created_at": "2022-12-23T17:20:50.449000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What got me was that I thought typescript was sane enough to deduce that `BigInt(number)` means that I want to create a BigInteger whose value is number",
        "created_at": "2022-12-23T17:24:00.816000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "JavaScript is *not* sane.",
        "created_at": "2022-12-23T17:24:27.930000+00:00",
        "attachments": null
    }
]
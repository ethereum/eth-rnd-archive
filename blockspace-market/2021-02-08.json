[
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Can you link me to the basefee adjustment formula in the EIP as it currently stands?",
        "created_at": "2021-02-08T00:57:17.443000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In the spec (https://eips.ethereum.org/EIPS/eip-1559), right under the \"# check if the base fee is correct\" comment",
        "created_at": "2021-02-08T01:02:33.081000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e's online: he may have the simplified one at the top of his head ðŸ™‚",
        "created_at": "2021-02-08T01:02:48.190000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It should only change the formula.  It is just added code complexity is all.  I'm ambivalent to it as I think the code complexity difference is low, but I also think the effect size of the change in low.",
        "created_at": "2021-02-08T01:25:47.203000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So it is competing between doing epsilon work for epsilon gain.  The conversation and coorddnation probably is the dominant cost and the way it affects public perception is the dominant gain.",
        "created_at": "2021-02-08T01:26:59.227000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So barely a technical change really, more a political one IMO.",
        "created_at": "2021-02-08T01:27:10.489000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I believe we would need to change these two lines:\n```\nbase_fee_per_gas_delta = max(parent_base_fee_per_gas * gas_used_delta // parent_gas_target // BASE_FEE_MAX_CHANGE_DENOMINATOR, 1)\n\nbase_fee_per_gas_delta = parent_base_fee_per_gas * gas_used_delta // parent_gas_target // BASE_FEE_MAX_CHANGE_DENOMINATOR\n```",
        "created_at": "2021-02-08T01:28:55.506000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The formula in code is a bit trickier than the one \u003c@273808422753796097\u003e posted above I think if you are working with integers (no floating point or fixed point), but certainly doable.  Just means you can't simplify quite as much.",
        "created_at": "2021-02-08T01:33:15.721000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ðŸ¤” like with that squaring, you need to expand it out and distribute to get all of the multiplications before the divides.",
        "created_at": "2021-02-08T01:34:47.080000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It is really just annoying, but easy to write tests for and validate in consensus.",
        "created_at": "2021-02-08T01:35:20.340000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "```\nlinear_delta = parent_base_fee_per_gas * gas_used_delta // parent_gas_target // BASE_FEE_MAX_CHANGE_DENOMINATOR\nquadratic_delta = (parent_base_fee_per_gas * gas_used_delta // parent_gas_target) * gas_used_delta // parent_gas_target // (BASE_FEE_MAX_CHANGE_DENOMINATOR ** 2 * 2)\n```\n\nSomething like that",
        "created_at": "2021-02-08T01:38:29.434000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Honestly I would oppose changing it now, just do it in a follow up EIP",
        "created_at": "2021-02-08T01:39:00.579000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think you still have one divide before a multiply in there.",
        "created_at": "2021-02-08T01:49:36.510000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "On mobile, but the squaring needs to be distributed more I think?",
        "created_at": "2021-02-08T01:49:58.968000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`(x * y / z) * y =\u003e x * y * y / z`?",
        "created_at": "2021-02-08T01:51:52.312000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, I suspect we may be able to use on-chain data once 1559 is live to tweak the formula and maybe adapt it post-merge too",
        "created_at": "2021-02-08T14:46:00.832000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is the initial base fee in the spec really just 1 wei?",
        "created_at": "2021-02-08T19:04:04.130000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If so, I think we should obviously raise it",
        "created_at": "2021-02-08T19:06:11.925000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For 2 reasons",
        "created_at": "2021-02-08T19:06:14.442000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "1. fees are way higher on Ethereum in practice, so making it 100 gwei is probably closer to \"market price\"",
        "created_at": "2021-02-08T19:06:34.968000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "2. _if_ miners wanted to attack the chain post-1559 and drive the base fee to 0, having it be higher will make that slightly harder because they will have to mine more empty blocks (and leave more money on the table) to drive the base fee down to 0",
        "created_at": "2021-02-08T19:07:10.730000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "hmm yeah, making it even 1 gwei is definitely much more sensible than 1 wei",
        "created_at": "2021-02-08T20:43:14.370000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Otherwise the chain would just have an hour of 2x capacity for no reason",
        "created_at": "2021-02-08T20:43:28.066000+00:00",
        "attachments": []
    }
]
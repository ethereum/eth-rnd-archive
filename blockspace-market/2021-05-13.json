[
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!393119312350543872\u003e responding here instead of in \u003c#745077610685661265\u003e \n\n\u003e the case when   transaction.tipGasPrice   is   \u003e  than    (transaction.gasPrice - block.baseGasPrice)        kind of makes   the  transaction.gasPrice - block.baseGasPrice   a new   tipGasPrice  which is not intuitive\n\nI'm not entirely sure what you mean, and where you get the term `tipGasPrice` from. The new EIP-1559 transactions don't have a `tipGasPrice` field, they only have (using your naming) a `maxTipGasPrice` field. The effective `tipGasPrice` (an internal variable that could also be inlined) is then possibly lower than this max in the case you described. There is no \"overwriting\" of `tipGasPrice`, as there is no such field.",
        "created_at": "2021-05-13T09:31:39.590000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I mean it looks like in the eip1559 the transaction gasPrice basically became of 2 parts.   the baseGasPrice  required by block  and the tipGasPrice  that is actual reward to miner",
        "created_at": "2021-05-13T12:41:23.488000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so in that formula there is min(  tipGasPrice from user defined in transaction,   transaction.gasPrice - block.baseGasPrice)    i renamed the fields because I can't read as they are in EIP its too confusing.    and in case we set transaction.gasPrice higher then block.baseGasPrice happend to be. but lower then tipGasPrice (transaction field)  the tipGasPrice wont be used. confusing the user",
        "created_at": "2021-05-13T12:43:29.915000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "instead the diff becomes actuall tip going to the miner",
        "created_at": "2021-05-13T12:44:24.029000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I find it very confusing if you use different names than the ones in the EIP, it becomes hard to check what variables you are referring to",
        "created_at": "2021-05-13T12:44:32.320000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yes. I need to translate it back to EIP terms.",
        "created_at": "2021-05-13T12:44:58.191000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "the question in the end is - why there is min formula. what does it solves",
        "created_at": "2021-05-13T12:45:53.842000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "that the total fee paid by the user never exceeds the fee cap (`maxFeePerGas` / `max_fee_per_gas`)",
        "created_at": "2021-05-13T12:46:32.627000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "why it is not better to make feeCap  a  fee ?  and use it all the time (const)?",
        "created_at": "2021-05-13T12:48:19.999000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm not sure what you mean by that. When is it not used?",
        "created_at": "2021-05-13T12:48:52.238000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it is not used in the case where \n\n```\n\n(transaction.max_fee_per_gas - block.base_fee_per_gas)   \u003c  transaction.max_priority_fee_per_gas\n\n```",
        "created_at": "2021-05-13T12:50:34.591000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "One of the ideas of EIP-1559 is that I can give a transactions as follows:\n- fee cap: 500 Gwei\n- max priority fee: 1 Gwei\n\nAnd at the same time you give a transaction that says:\n- fee cap 200 Gwei\n- max priority fee: 1 Gwei\n\nIf the base fee ends up being 100 Gwei, we _both_ end up paying 101 Gwei total (100 for the base fee which is burned, and 1 for the tip/priority fee going to the miner)",
        "created_at": "2021-05-13T12:51:16.714000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "what if  maxPriority fee is  300 ?",
        "created_at": "2021-05-13T12:52:57.455000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Assuming we keep our fee caps the same, I would pay 400 Gwei (100 is burned, 300 is given to the miner). You would pay 200 Gwei (100 of which is burned, 100 given to the miner)",
        "created_at": "2021-05-13T12:54:45.281000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Note that this system really helps in supporting legacy transactions as well",
        "created_at": "2021-05-13T12:54:57.731000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "then first transaction pays  100 + 300 \nbut the second one pays 100 + 100 ?",
        "created_at": "2021-05-13T12:55:25.117000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If you currently set the gas price to e.g. 300 Gwei, you can get same behavior/cost by setting _both_ the fee cap and the priority fee cap to 300 Gwei",
        "created_at": "2021-05-13T12:55:27.139000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Correct!",
        "created_at": "2021-05-13T12:55:35.662000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You should not be able to set a maxPriorityFee \u003e FeeCap, no?",
        "created_at": "2021-05-13T12:55:52.160000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm not sure if there is a check like that, but it does not really matter anyway I think.",
        "created_at": "2021-05-13T12:56:37.979000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Legacy transactions set both fields equal to the gasPrice",
        "created_at": "2021-05-13T12:56:49.018000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so if I set 300 but end up paying 200 it is counterintuitive that what I think",
        "created_at": "2021-05-13T12:57:07.999000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "why? You set the _max_ fee you were willing to pay",
        "created_at": "2021-05-13T12:57:27.645000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That's one of the good properties of 1559 actually ðŸ™‚ You can set your maximum willingness to pay and only end up paying the market rate",
        "created_at": "2021-05-13T12:57:36.665000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If you want to _always_ pay 300 Gwei, then you should set the fee cap _and_ the max priority fee equal to 300 Gwei",
        "created_at": "2021-05-13T12:58:02.833000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "which is exactly how old-style (i.e. the current ones) transactions will be interpreted/converted",
        "created_at": "2021-05-13T12:58:51.364000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "hm. I see perhaps this is required to make it backwards compatible",
        "created_at": "2021-05-13T13:00:40.269000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "other wise I see no reason for the min()   as I would like to set 2 values in a transaction \nthe meaning of those are \n1) says how long I wish to wait in order the transaction to be accepted in the block. (as the block baseFee must match)\n2) says how much I wish to reward the miner",
        "created_at": "2021-05-13T13:01:48.017000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "From a UX perspective, we want users to be able to assert how much they are *willing* to pay for the transaction, and we give strong guarantees that they *never* pay more than that.",
        "created_at": "2021-05-13T13:01:58.640000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The base fee does not have to match the fee cap, it has to be smaller or equal to it.",
        "created_at": "2021-05-13T13:02:38.698000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Pragmatically, we expect that the vast majority of users won't manually set the miner reward.  It will likely be automatically set by tooling.  Those that use the priority fee (the piece that goes to miners) are very advanced users engaging in gas price auctions most likely.",
        "created_at": "2021-05-13T13:02:47.404000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yes. people had years to think it through. I just joined at the end. trying to grasp this",
        "created_at": "2021-05-13T13:02:56.974000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "No worries ðŸ™‚ There's a lot of unintuitive stuff in 1559 ðŸ˜…",
        "created_at": "2021-05-13T13:03:18.648000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think once we have UIs things will (hopefully) become a lot more clear.",
        "created_at": "2021-05-13T13:04:01.985000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Talking about UIs.. I was asked a few time what's the default tip transactions should include for average users. Is there a number we can give them?",
        "created_at": "2021-05-13T13:04:43.744000+00:00",
        "attachments": null
    },
    {
        "author": "pietjepuk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is one way of looking at it. And indeed support for legacy transactions becomes easier if you do it the way it's currently done instead of what you suggest there.\nOther counterarguments are that many users are not familiar at all with tips and stuff. They just want to get a maximum estimated fee, and that's it. From a DeFi/arbitrage point of view having a total cap (and dynamic tip/priority fee) also makes sense; if a smaller priority fee than your cap still got your tx included that's great. You only care about the max cost to you, not what part goes to the miner. In the setup you describe this would not be possible.",
        "created_at": "2021-05-13T13:06:08.597000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this seems to make the situation even worse with the fee market. because not only users would have to pay for transaction baseFee \nthey would also need to compete with other transaction minerTip  setting it higher and higher",
        "created_at": "2021-05-13T13:06:13.406000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Look at priority fees accepted in historic non-full blocks and set to some percentile.",
        "created_at": "2021-05-13T13:06:49.248000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "They only need to compete on tips when blocks are completely full (30m gas) vs. at the target (15m gas). Because most of the time blocks have an \"extra\" 15m gas, users don't actually need to compete \u003c@!393119312350543872\u003e",
        "created_at": "2021-05-13T13:06:54.859000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "How do you set it on day 1, though?",
        "created_at": "2021-05-13T13:07:05.101000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "1 nanoeth.",
        "created_at": "2021-05-13T13:07:11.058000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Which *also* should probably be the default configuration for mining clients (configurable by miners of course).",
        "created_at": "2021-05-13T13:07:37.470000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Weren't there some numbers about the opportunity cost of running txns?",
        "created_at": "2021-05-13T13:08:06.105000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, it is around 1 nanoeth (a bit less).",
        "created_at": "2021-05-13T13:08:13.685000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://bitcoinexchangeguide.com/ethereum-blocks-consistently-at-least-95-full-eths-use-as-a-non-speculative-asset-on-the-rise/#:~:text=There's%20actually%20a%20lot%20of,%25%20full%2C%20per%20Coin%20Metrics.",
        "created_at": "2021-05-13T13:08:30.559000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "1559 makes it so blocks won't be full anymore.  By definition, they are half full on average (+/- some deviation because of math).",
        "created_at": "2021-05-13T13:08:51.136000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so its like asking people to orgnize in a line instead of trying to burst into the shop?",
        "created_at": "2021-05-13T13:09:35.336000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "YEs, basically ðŸ™‚",
        "created_at": "2021-05-13T13:09:44.965000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It is setting the price high enough that people don't even want to line up anymore.  ðŸ™‚",
        "created_at": "2021-05-13T13:09:58.115000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and once people are in a line, we have half the shop empty and can accomodate more people",
        "created_at": "2021-05-13T13:09:59.281000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In other words, 1559 finds the price (`base fee`) which matches ~15m gas of demand.",
        "created_at": "2021-05-13T13:11:28.696000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "would not they just bid a higher miner fee in order to get served first making it impossible for low price transaction ?",
        "created_at": "2021-05-13T13:11:33.924000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "They will do that to be first _in the block_ (MEV). But you do not need to outbid people if you just want to be included in the block because there is still \"extra capacity\".",
        "created_at": "2021-05-13T13:12:49.868000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If you are willing to pay the base fee, then you already are in the top 15M gas (in the average case), which means you don't need to bid for space..",
        "created_at": "2021-05-13T13:12:55.602000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ha and then miners try to fill up the block but the more they fill it the less of this tip they get",
        "created_at": "2021-05-13T13:13:01.258000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "They also need to pay the base fee on their txns",
        "created_at": "2021-05-13T13:13:27.275000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "More importantly, miners \"filling\" a block will be burning base_fee.",
        "created_at": "2021-05-13T13:13:27.594000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "lol",
        "created_at": "2021-05-13T13:13:34.832000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "not for space (for being first served)",
        "created_at": "2021-05-13T13:13:41.817000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah, for being first served (due to gas auctions/MEV) you will still bid with the priority fee (miner fee).",
        "created_at": "2021-05-13T13:14:07.332000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In fact, bots likely won't even bother switching to EIP-1559 transactions.",
        "created_at": "2021-05-13T13:14:19.571000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "EIP-1559 is for *everyone* else who isn't actively engaging in gas auctions.",
        "created_at": "2021-05-13T13:14:36.012000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "see. there is seems to be a problem. auction transactions will just occupy the first part of the line all the time. and if I am not participating in miners tip I will have to wait untill there is no line. because people just bypassing me in the queue by bribing the miner",
        "created_at": "2021-05-13T13:19:37.915000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so at some point I also start to bid miner reward in order to buy the ico token first, and end up paying few eths for gasPrice anyway",
        "created_at": "2021-05-13T13:20:54.148000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "can all this burned eth go to ethereum scalability fund? seems like a waste",
        "created_at": "2021-05-13T13:22:01.794000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The burned ETH is basically a redistribution to all ETH holders via deflation. There would be way too much arguing about where to send the funds that are burnt, and this is a way where you can make let every ETH holder make a decision about how to spend their funds, indirectly.",
        "created_at": "2021-05-13T13:23:58.662000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "also. I was having this idea. since this upgrade will require all wallet UIs to update. I was thinking that it would've been good to have a donation button when you send a transaction. so then you can choose a fund to donate to every time you make a transaction (optionally)",
        "created_at": "2021-05-13T13:32:53.938000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e also. I was having this idea. since this upgrade will require all wallet UIs to update\nIt only requires a UI update for wallets that want to add support for 1559.  Wallets that do nothing will continue to work.",
        "created_at": "2021-05-13T13:58:37.758000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "trent_vanepps",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Forwarding questions from \u003c@!322222239850168331\u003e, jumping off point is in the cheatsheet.\n\n\u003c@!552133098075193354\u003e you may be better suited to answer this, and brad's question above\n\n\n\u003e under example values, won't we always be in the option 3 section\n\u003e \n\u003e In this case, estimating the maxPriorityFee becomes the same as estimating the current gasPrice. A “smart” implementation could look at how full the last N blocks are to determine whether we are in a high congestion regime.\n\u003e \n\u003e my rational is that most people will just try to do advanced high gas and then the whole network defaults to number 3\n\u003e \n\u003e Also wrt to supporting legacy transactions is there a plan to phase them out? I can see huge censorship opportunity by miners since they profit more on pre-1559 transactions",
        "created_at": "2021-05-25T17:35:20.725000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!464858726344425472\u003e   Geth's implementation is very likely to require a +10% bump across both the `maxFeePerGas` and `maxPriorityFeePerGas`. \n\nIt hasn't been merged in yet, so still somewhat subject to change, but you basically need both values to be bumped to avoid DoS risks.",
        "created_at": "2021-05-25T17:41:56.599000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e my rational is that most people will just try to do advanced high gas and then the whole network defaults to number 3\nWhy? I think what is missed here is that, on average, blocks have an extra 50% capacity, so are frequently \"half empty\" and can include more transactions. If you don't mind waiting a handful of blocks, then it's rational to put a lower fee and pay less because the miners' choice is either \"include this txn or don't\" vs. \"include this txn or this other one\", given that if the previous block was not full, it implies that all txns with fee cap \u003e base fee are already included.",
        "created_at": "2021-05-25T17:43:43.677000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e Also wrt to supporting legacy transactions is there a plan to phase them out? I can see huge censorship opportunity by miners since they profit more on pre-1559 transactions\nNo plan yet, but definitely something we could consider if we saw such censorship. Obviously, the tradeoff there is breaking legacy tooling.",
        "created_at": "2021-05-25T17:44:14.365000+00:00",
        "attachments": null
    },
    {
        "author": "brad.decker",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Thanks!",
        "created_at": "2021-05-25T17:52:13.899000+00:00",
        "attachments": null
    },
    {
        "author": "gregthegreek",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e Why? I think what is missed here is that, on average, blocks have an extra 50% capacity, so are frequently \"half empty\" and can include more transactions.\nRight im following you on that, but if i look at a chart like this (https://etherscan.io/chart/pendingtx) I'm sorta thinking that theres going to be heavy competition for the remaining 50% block space no?\n\nObviously this chart has \"replaced transactions\" included, so its a bit of a duplicate scenario. But yeah idk, just thinking off the top of my head. Very late to the discussion by all means",
        "created_at": "2021-05-25T18:00:28.304000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e Right im following you on that, but if i look at a chart like this (https://etherscan.io/chart/pendingtx) I'm sorta thinking that theres going to be heavy competition for the remaining 50% block space no?\n\nNot necessarily, because it has to be competiton **at a certain base fee**",
        "created_at": "2021-05-25T18:10:48.928000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So assume, with right now's gas price of 44 gwei, the base fee was 40 gwei",
        "created_at": "2021-05-25T18:11:18.851000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "you may have 160k pending txns, but of those, only a handful are eligible (i.e. have a `maxFee` \u003e 40 gwei)",
        "created_at": "2021-05-25T18:11:41.989000+00:00",
        "attachments": null
    },
    {
        "author": "gregthegreek",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ahhhh - right on",
        "created_at": "2021-05-25T18:12:02.750000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And then, if you fill the block with those, next block's base fee is ~45",
        "created_at": "2021-05-25T18:12:04.097000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So again, you limit the set of includable txns to those who whose `maxFee` \u003e= 45. So, the only time where you actually have more demand than blockspace is when the demand grows at more than 12.5%/block.",
        "created_at": "2021-05-25T18:12:15.654000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "To be fair, I think that's the least obvious part of 1559 for people who have a lot of ethereum experience",
        "created_at": "2021-05-25T18:12:44.293000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "because \"dealing with a full mempool and overflowing blocks\" is such a core part of the experience lol",
        "created_at": "2021-05-25T18:12:55.797000+00:00",
        "attachments": null
    },
    {
        "author": "brad.decker",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so with maxPriorityFeePerGas what determines how much you actually pay on this... or is it more about allowing miners to make the call about whether they will include your transaction based on what the transaction's \"maxPriorityFeePerGas\" is",
        "created_at": "2021-05-25T21:42:53.200000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!464858726344425472\u003e you pay the entirety of `maxPriorityFeePerGas` as long as the `maxFeePerGas` minus the `baseFeePerGas` \u003e= `maxPriorityFeePerGas`. In other words, it's only when the `baseFee` starts \"eating into\" the `maxFee` that you would pay less.",
        "created_at": "2021-05-25T22:02:40.814000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So this allows you to say \"I want to pay at most 100 gwei, with a max of 10 going to the miner\". If the `baseFee` is, say, 80, you will pay 90 gwei (80 burnt + 10 to miner), but if the `baseFee` went up to 95, then you would only pay 100 (95 burnt + 5 to miner)",
        "created_at": "2021-05-25T22:03:56.384000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The main reason why this flexibility in the priority fee is needed is that it makes supporting legacy transactions much simpler: we can set both `maxFee` and `priorityFee` to `gasPrice` and that just means the miner gets the entirety of the difference between `baseFee` and `maxFee`.",
        "created_at": "2021-05-25T22:05:55.111000+00:00",
        "attachments": null
    },
    {
        "author": "brad.decker",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Got it. Thanks for the explanation \u003c@!552133098075193354\u003e",
        "created_at": "2021-05-25T22:08:08.533000+00:00",
        "attachments": null
    }
]
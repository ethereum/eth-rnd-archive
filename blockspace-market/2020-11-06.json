[
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Draft document to share the various approaches to transaction pool mgmt: https://hackmd.io/@timbeiko/1559-tx-pool-mgmt\n\ncc: \u003c@!489256758989029405\u003e \u003c@!574864862338088960\u003e \u003c@!332923501079953409\u003e \u003c@!636906092374261761\u003e \u003c@!486501030046203915\u003e \u003c@!301186049323958275\u003e",
        "created_at": "2020-11-06T02:22:30.487000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "One of the reasons for an aggressive eviction strategy is also UX.  When a user submits a transaction and for whatever reason doesn't get included, there is a good chance that they don't actually want their transaction to be included 24 hours later when they aren't around.  By having most of the clients in the network follow an eviction strategy of \"if fee cap is 10% lower than base fee then evict\" we can help those users out by clearing out their transactions so they don't wake up to surprise inclusions 24 hours later after the days seasonality has passed.",
        "created_at": "2020-11-06T04:04:02.346000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!489256758989029405\u003e You seemed to be a bit opposed to evicting old transactions, do you find this argument compelling at all?",
        "created_at": "2020-11-06T04:04:22.564000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "**TL;DR**: Most normal users don't actually want their transaction to mine far in the future.  If it fails to mine now, they would rather re-submit or walk away than have the transaction mine at an arbitrary point in time in the future.",
        "created_at": "2020-11-06T04:04:56.689000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "New blog post in draft that attempts to illustrate why the UX for 1559 is such a big improvement: https://medium.com/@MicahZoltu/a-user-story-dc9c8717906\nFeedback is most welcome.  Will probably publish tonight or tomorrow.",
        "created_at": "2020-11-06T04:05:45.361000+00:00",
        "attachments": null
    },
    {
        "author": "philcares",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Nice article, I really like the first part where you adressing the problems of the average user. The kind of reader you adress is switching though. Like when you talk about the legacy style tx, you adress the average user directly. At the end you are talking about the \"end user\". You really had me and then lost me when you discribed the eip-1559 styled tx pricing.",
        "created_at": "2020-11-06T07:54:48.123000+00:00",
        "attachments": null
    },
    {
        "author": "philcares",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I dont get why I suddenly need to know two other things: base fee and miner bribe (what a horrible word) if I struggle with gas already so much",
        "created_at": "2020-11-06T07:56:10.959000+00:00",
        "attachments": null
    },
    {
        "author": "philcares",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also calling the new style 'eip-1559' is a bit unlucky. Not totally bad, but there could be better word/description, somthing catchy, like 'ETH 2.0' is.",
        "created_at": "2020-11-06T07:58:17.655000+00:00",
        "attachments": null
    },
    {
        "author": "philcares",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What we want (as I understood) is that the average user you adress in the article just does not have to care about the price of a TX anymore. So we need some phrase that embodies the freeing of this burden.",
        "created_at": "2020-11-06T08:01:28.999000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e I dont get why I suddenly need to know two other things: base fee and miner bribe (what a horrible word) if I struggle with gas already so much\n\u003c@!707707212184944702\u003e You are right, that the first part of the document has a target audience of \"new user\" but the second part of the document starts throwing a bunch of jargon around.  I'm not sure how to resolve this though because I do think there is value in explaining *why* 1559 fixes the problem.  I feel like the article would be significantly worse if I followed the user story up with something like:\n\u003e With 1559, none of this would happen!  You wouldn't have to set a gas price, you wouldn't get stuck/pending transactions, and your transaction would almost always be included immediately.  Viva la 1559!",
        "created_at": "2020-11-06T08:36:55.874000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Maybe I can try to make it into a 2-parter, (perhaps in one document) where the first part *does* end with something like that and then the second part goes into details of the \"why\".",
        "created_at": "2020-11-06T08:37:55.205000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e \u003c@!489256758989029405\u003e You seemed to be a bit opposed to evicting old transactions, do you find this argument compelling at all?\n\u003c@!301186049323958275\u003e I was not opposed to evicting transactions -\u003e I just thought it would not be necessary (I wanted to maintain the status quo on how the transactions behave in tx pool)",
        "created_at": "2020-11-06T10:17:48.549000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "can we stop calling it miner bribe?",
        "created_at": "2020-11-06T10:18:33.298000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "can we just use gas premium?",
        "created_at": "2020-11-06T10:18:39.368000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "as it is in the EIP",
        "created_at": "2020-11-06T10:18:44.486000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "EIP renamed it to miner bribe I believe.",
        "created_at": "2020-11-06T10:28:20.980000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Which was intentional, to call it what it is rather than trying to mince words to hide reality from users.",
        "created_at": "2020-11-06T10:28:35.683000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "`max_miner_bribe_per_gas` is the name the EIP uses.",
        "created_at": "2020-11-06T10:29:03.154000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e I was not opposed to evicting transactions -\u003e I just thought it would not be necessary (I wanted to maintain the status quo on how the transactions behave in tx pool)\n\u003c@!489256758989029405\u003e Given that a change in behavior here would allow us to keep the pending pool nearly empty the vast majority of the time, does your position change or do you still prefer the status quo over a change in this case?",
        "created_at": "2020-11-06T10:30:16.643000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e \u003c@!489256758989029405\u003e Given that a change in behavior here would allow us to keep the pending pool nearly empty the vast majority of the time, does your position change or do you still prefer the status quo over a change in this case?\n\u003c@!301186049323958275\u003e I am explaining my previous view, not the current one",
        "created_at": "2020-11-06T12:33:59.446000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah, what is your current view?",
        "created_at": "2020-11-06T12:34:15.517000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I did not think of the benefit of empty pool so it is interesting. Still I would leave the pool behaviour outside of consensus / EIP.",
        "created_at": "2020-11-06T12:37:44.167000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also I see the point of ensuring that the transactions that cannot be executed should not execute 20 hours later.",
        "created_at": "2020-11-06T12:42:23.275000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is usually unpleasant.",
        "created_at": "2020-11-06T12:42:28.758000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "They either REVERT or trade at an adverse market.",
        "created_at": "2020-11-06T12:42:40.214000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I fully agree this shouldn't be part of consensus or EIP-1559.  It *may* be worthy of a footnote in 1559 if all of the current clients agree on a particular eviction/rejection strategy, but I think for now just talking about it and recording it in that HackMD that Tim created is all we really should do.",
        "created_at": "2020-11-06T13:56:29.724000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Re: \"forking mainnet\", it seems like it may be more complicated than we thought. \n\nFirst, \u003c@!403707149043105803\u003e explained to me that \"one does not simply ‚Äúadd a bunch of whales‚Äù\" üòÖ  There are some cryptographic checks which would reject that. \n\nSecond, it seems like this would cause issues with the chain ID, as we don't support changing on a running chain. \n\nThird, Hardhat doesn't seem to give us the flexibility we'd like in doing this. \n\n\u003c@!489256758989029405\u003e \u003c@!301186049323958275\u003e \u003c@!332923501079953409\u003e do you have any thoughts about (1) + (2)? It seems to me at this point i's maybe easier to just start a new PoW network, fill it up with a large state and  a bunch of whales and send ETH to anyone who wants to deploy contracts on it (or even maybe pay out a bounty to someone to deploy a ton of contracts).",
        "created_at": "2020-11-06T17:01:12.983000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For the whales, you would just do an irregular state transition as part of the hard fork that gives a bunch of money to some accounts of your choice.",
        "created_at": "2020-11-06T17:38:45.516000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For the chain ID, that one is trickier I suspect.  Other client devs may have thoughts on it.  I suspect it depends pretty heavily on how the specific client is designed though.  One can imagine a hard fork where the chain ID needed for signatures to be valid changes, but any given client may not have that exposed in a way that makes such a hard fork easy.",
        "created_at": "2020-11-06T17:39:02.899000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I still think that this is generally a very valuable tool that we will need time and again in the future and would benefit many people in the ecosystem, so I personally think it is worth at least some effort to get the HF setup.",
        "created_at": "2020-11-06T17:40:41.857000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e Re: \"forking mainnet\", it seems like it may be more complicated than we thought. \n\u003e \n\u003e First, \u003c@!403707149043105803\u003e explained to me that \"one does not simply ‚Äúadd a bunch of whales‚Äù\" üòÖ  There are some cryptographic checks which would reject that. \n\u003e \n\u003e Second, it seems like this would cause issues with the chain ID, as we don't support changing on a running chain. \n\u003e \n\u003e Third, Hardhat doesn't seem to give us the flexibility we'd like in doing this. \n\u003e \n\u003e \u003c@!489256758989029405\u003e \u003c@!301186049323958275\u003e \u003c@!332923501079953409\u003e do you have any thoughts about (1) + (2)? It seems to me at this point i's maybe easier to just start a new PoW network, fill it up with a large state and  a bunch of whales and send ETH to anyone who wants to deploy contracts on it (or even maybe pay out a bounty to someone to deploy a ton of contracts).\n\u003c@!552133098075193354\u003e one does simply add a bunch of whales -\u003e see DAO hardfork",
        "created_at": "2020-11-06T18:33:54.394000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ChainId changing mid run -\u003e yeah, this may be a bit worse but we can simply hardcode the branch (most of the clients already support hardcoding the branch blockhashes) -\u003e I am most worried about people signing something wrong and this being pushed to mainnet",
        "created_at": "2020-11-06T18:36:42.941000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but this is only if you want to keep it public",
        "created_at": "2020-11-06T18:37:02.081000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "HardHat probably will not be enough",
        "created_at": "2020-11-06T18:37:29.976000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "wait, hmmm",
        "created_at": "2020-11-06T18:38:20.706000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "for ChainId it is very simple:",
        "created_at": "2020-11-06T18:38:27.619000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "1) sync a mainnet node",
        "created_at": "2020-11-06T18:38:45.060000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "2) switch it off",
        "created_at": "2020-11-06T18:38:52.621000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "3) launch it with the same setup but with three things changed",
        "created_at": "2020-11-06T18:39:22.800000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "a) chain ID",
        "created_at": "2020-11-06T18:39:27.117000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "b) list of whales",
        "created_at": "2020-11-06T18:39:31.490000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "c) change that says that anything before the fork block reutnrs chainID 1 in the EVM (it was so bad to add CHAINID opcode)",
        "created_at": "2020-11-06T18:40:01.441000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "tell me if there is any problem with it by I believe this is absolutely fine",
        "created_at": "2020-11-06T18:40:43.818000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "later any new nodes will sync from this initial modified node",
        "created_at": "2020-11-06T18:40:53.426000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and they will all be on a separate network / chain id",
        "created_at": "2020-11-06T18:41:03.737000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and will not conflict with mainnet at all",
        "created_at": "2020-11-06T18:41:12.439000+00:00",
        "attachments": null
    },
    {
        "author": "tkstanczak",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(just make sure people do not send old style transactions there without Chainid)",
        "created_at": "2020-11-06T18:41:27.621000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The validation code is hard wired to prevent such \"welded\" chains.  I don't want to hard wire in special cases into production clients for test nets when we don't have to, it's a possible vector for scammers... \"Ohh... you need this special version of the ethereum client to see our transactions.\"  I know we're smart enough to see through it, but not some of the people who get hit up.",
        "created_at": "2020-11-06T20:59:41.666000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e do you think there's any downside to telling wallets to not make 1559 txns the default for like 1h after the fork?",
        "created_at": "2021-05-21T15:33:45.250000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Main reason is that anyways with a base fee starting at 1 gwei, txns will be a first price auction on the tip until we reach the right market price.",
        "created_at": "2021-05-21T15:34:06.126000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Nope, they are strictly better IMO.  Of course, wallets may want to do a slow rollout in case of bugs.",
        "created_at": "2021-05-21T15:34:13.991000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ok great, that's my thinking too. Wanted to make sure I wasn't missing something. Thanks!",
        "created_at": "2021-05-21T15:34:31.693000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "1h is fine i think as well",
        "created_at": "2021-05-21T15:37:45.854000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "‚ÄúThey are strictly better‚Äù as in wallets are better off not using 1559 transactions?",
        "created_at": "2021-05-21T15:38:12.127000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "As in wallets are better off using EIP-1559 transactions.",
        "created_at": "2021-05-21T15:38:54.725000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Wait what",
        "created_at": "2021-05-21T15:40:33.909000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is the opposite of what I think lol",
        "created_at": "2021-05-21T15:40:45.550000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I just wrote this in another doc: \n\n\u003e When EIP-1559 will go live (in the London upgrade, tentatively scheduled for mid-July), the `baseFeePerGas` will be set to 1 gwei. This means that, at first, transactions will be competing via a first-price auction on the tip, as the `baseFeePerGas` reaches the rate where there is ~15m gas of demand at that price. \n\u003e \n\u003e If you assume the market price is 250 gwei on the fork date, this means that `baseFeePerGas` needs to go through ~50 blocks to get there, or slightly less than 15 minutes. \n\u003e \n\u003e Because of this, it is probably simplest to _not_ make 1559-style transactions the default for at least 15-30 minutes post fork, in order for the `baseFeePerGas` to stabilize.",
        "created_at": "2021-05-21T15:41:00.707000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Why would wallets be better off using legacy transactions?",
        "created_at": "2021-05-21T15:41:02.711000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because it's a first price auction on the tip anyways",
        "created_at": "2021-05-21T15:41:09.883000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so just leave the old UI for users",
        "created_at": "2021-05-21T15:41:16.865000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It will take minutes for that to clear up.",
        "created_at": "2021-05-21T15:41:19.516000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah, 15ish minutes",
        "created_at": "2021-05-21T15:41:24.497000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so you probably want to make the UI change 15-30 minutes after the fork, not right at the fork block",
        "created_at": "2021-05-21T15:41:37.014000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh, I see.  I suppose, sure.",
        "created_at": "2021-05-21T15:42:00.563000+00:00",
        "attachments": []
    },
    {
        "author": "brad.decker",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is there a number for base fee that would indicate safety to enable new UI?",
        "created_at": "2021-05-21T15:42:19.657000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!464858726344425472\u003e I would not look at the `baseFee` but at the `gasUsed` in a block: when blocks start being ~15m gas",
        "created_at": "2021-05-21T15:46:38.067000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If you want to look at the base fee, then I would compare to the previous block, i.e. when the `baseFee` between two blocks moved less than 5%?",
        "created_at": "2021-05-21T15:47:00.416000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But that's why I'm trying to ballpark it. I feel like it's likely to be OK to enable 50-100 blocks after the fork (depending on how high gas prices are), so if you wanted to be _really_ safe, you could just do something like 250 blocks",
        "created_at": "2021-05-21T15:48:16.272000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It's just that if you wait too long, your users will overpay a bit relative to using native 1559-style txns",
        "created_at": "2021-05-21T15:48:29.876000+00:00",
        "attachments": []
    },
    {
        "author": "brad.decker",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We can examine any block header field to use for indication. We would ideally have this rolled out before the fork, detect the fork and when to safely enable new UX. We already have to keep the old UX for networks that do not support EIP-1559 or whose support of it is behind a rollup mechanism.",
        "created_at": "2021-05-21T15:50:44.648000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!464858726344425472\u003e here are my current thoughts (aiming to share this doc publicly today):\n\n\u003e ### Heuristics to decide when to default to 1559 txns\n\u003e \n\u003e 1. `gasUsed` is closer to `gasTarget` (currently 15m) than `gasLimit` (30m post fork): this means that we've found a price for the `baseFeePerGas` that's close to the market price;\n\u003e 2. `baseFeePerGas` of parent +/- 5% from last block's `baseFeePerGas`: this means the `baseFeePerGas` has stopped increasing and is somewhat stable;\n\u003e 3. Ballpark: look at average `gasPrice` right before fork, calculate how many blocks need to be full for the `baseFeePerGas` to reach that amount (+12.5% each full block), add a little buffer\n\u003e \n\u003e Can perhaps use a combination of the 3, i.e.: 12.5m \u003c`gasUsed` \u003c 17.5m AND `parentBaseFee` +/- 5% from `baseFeePerGas` AND `blocksSinceFork` \u003e 100",
        "created_at": "2021-05-21T15:53:10.042000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm not sure which one is easiest for MetaMask to do, and how long in advance do you need to hardcode the parameters",
        "created_at": "2021-05-21T15:53:41.230000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think (3) is what will produce the best results, but it's very hard to implement if you need to ship a release, say, 1 week before the fork",
        "created_at": "2021-05-21T15:54:01.464000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Otherwise, I would probably use 1 + 2, and of course have it be a one time flag, e.g. activate 1559 when that is met vs. flip-flopping between interfaces if the condition becomes false again.",
        "created_at": "2021-05-21T15:54:39.210000+00:00",
        "attachments": []
    },
    {
        "author": "brad.decker",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That sounds reasonable. I'll share with our team",
        "created_at": "2021-05-21T15:56:40.778000+00:00",
        "attachments": []
    },
    {
        "author": "trent_vanepps",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "is this the first network upgrade that will take additional time beyond the selected block to reach steady state?",
        "created_at": "2021-05-21T19:30:35.820000+00:00",
        "attachments": []
    },
    {
        "author": "trent_vanepps",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "steady state meaning \"target\"",
        "created_at": "2021-05-21T19:30:56.778000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hmm I don‚Äôt know",
        "created_at": "2021-05-21T19:31:14.662000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "At least we won‚Äôt have to wait 3 days for someone to use the feature üòÖ",
        "created_at": "2021-05-21T19:31:27.786000+00:00",
        "attachments": []
    },
    {
        "author": "trent_vanepps",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm thinking of it purely in terms of the watch parties haha - we get an extra 15 min of fun watching the system adust",
        "created_at": "2021-05-21T19:33:01.333000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh yeah",
        "created_at": "2021-05-21T19:33:07.600000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The watch parties will be the most fun in a while for sure",
        "created_at": "2021-05-21T19:33:16.318000+00:00",
        "attachments": []
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because you‚Äôll see 30m gas blocks right after the fork (if everything goes right!)",
        "created_at": "2021-05-21T19:33:34.706000+00:00",
        "attachments": []
    },
    {
        "author": "trent_vanepps",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "New weekend reading from \u003c@!552133098075193354\u003e and myself üòÉ  Send any suggestions / corrections my way!\n\n**Cheatsheet: 1559 for Wallets \u0026 Users**\n\nhttps://hackmd.io/@q8X_WM2nTfu6nuvAzqXiTQ/1559-wallets",
        "created_at": "2021-05-21T21:53:38.563000+00:00",
        "attachments": []
    }
]
[
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Does this break certain use cases, like sending a transaction you are OK to wait a while to be mined? Or should 1559 explicitly disallow that use case?",
        "created_at": "2020-11-23T15:53:28.190000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The argument I have seen made, and I agree with, is that people shouldn't be using 10s of thousands of other people's memory as their own personal queue.",
        "created_at": "2020-11-23T15:54:03.407000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If you want to queue a transaction, queue it on your local node, not in the global pending queue.",
        "created_at": "2020-11-23T15:54:15.866000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Transactions that are in the global pending queue should all be transactions that are very likely to be included soon, where \"soon\" is within a few blocks.",
        "created_at": "2020-11-23T15:55:24.655000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The risk, of course, is that if we tune this wrong we may end up just trading wasted bandwidth for wasted memory.",
        "created_at": "2020-11-23T15:55:49.675000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, and also that some things break",
        "created_at": "2020-11-23T15:56:07.415000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Which, to be fair, could be fixed",
        "created_at": "2020-11-23T15:56:16.516000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What sort of things are you worried about breaking?",
        "created_at": "2020-11-23T15:56:20.848000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Automated, not-ETH-specific things, like crypto exchange withdrawals, for example",
        "created_at": "2020-11-23T15:56:38.655000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Why would they break?",
        "created_at": "2020-11-23T15:56:47.597000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If they currently use a low-ish fee (to advertise free withdrawals to users) and are OK with the tx being stuck in the mempool a while",
        "created_at": "2020-11-23T15:57:10.091000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In theory, local nodes would continue to follow the existing strategy of \"keep forever\" with perhaps a new RPC endpoint for `eth_dropLocalTransaction`.",
        "created_at": "2020-11-23T15:57:17.036000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Got it, but then their node is constantly re-broadcasting this txn?",
        "created_at": "2020-11-23T15:57:36.815000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah, you are worried about business processes built around 0-conf stuff it sounds like.",
        "created_at": "2020-11-23T15:57:42.146000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "IMO, we should first aim at replicating the memory usage that we currently see then slowly ramp down the defaults",
        "created_at": "2020-11-23T15:57:58.240000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, exactly.  It would just hang onto it until the environment is primed for the transaction being included in a block, then it would broadcast.  If the transaction doesn't land, it would repeat this process (wait then broadcast).",
        "created_at": "2020-11-23T15:58:02.616000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "no need to solve every problem related to tx propagation with a single upgrade ðŸ™‚",
        "created_at": "2020-11-23T15:58:35.707000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm not against this approach, while this particular problem was *harder* before 1559, that doesn't mean we must solve it with the launch of 1559.  My main argument for solving it in tandem with 1559 is just that we already are doing a bunch of mucking with pending pool rules, so it seems like a good time to touch this code since we have to touch it anyway.",
        "created_at": "2020-11-23T15:59:29.950000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That argument is relatively weak though.",
        "created_at": "2020-11-23T15:59:35.631000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Agreed re: not solving everything. I do think we should aim to not make things much worse (e.g. tx pool re-sort every block), though!",
        "created_at": "2020-11-23T16:00:33.743000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I suppose that is the other selling point.  It basically makes the \"pending pool sorting problem\" go away largely since the pending pool is so small that you can use pretty terrible strategies for sorting and still be fine.  ðŸ™‚",
        "created_at": "2020-11-23T16:01:29.529000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Until you have a spike in usage!",
        "created_at": "2020-11-23T16:01:46.003000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "IMO that's the main problem",
        "created_at": "2020-11-23T16:01:49.884000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Even with a spike in usage, due to base fee changes the problem would be transient.",
        "created_at": "2020-11-23T16:02:17.615000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We can't get away with \"naive sort\" because when you get a spike, then you get a backlog of txns that were reasonable to include pre-spike, and that you'd like to have around for when the base fee starts to fall again",
        "created_at": "2020-11-23T16:02:23.253000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ðŸ¤”  I suppose if you can slow down miner pending transaction times enough, you may actually end up with a stable (not increasing) base fee.",
        "created_at": "2020-11-23T16:03:25.144000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is, if you can make it so miners take more than 15 seconds (on average) to re-sort the pending pool then the base fee won't actually increase.",
        "created_at": "2020-11-23T16:03:49.107000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i just don't think it's reasonable for the mempool's performance to degrade by an order of magnitude (e.g. sorting on every block)",
        "created_at": "2020-11-23T16:05:58.155000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "are there any additional concerns with bit packing legacy tx's gas price to support the constant fee strategy?",
        "created_at": "2020-11-23T16:14:22.393000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I would expect that a large majority of wallets will update to support the 1559 transaction type at the moment of the hard fork. Legacy transactions should default to tip some reasonable constant amount (do we know what that value is?) and allow for bit packing the upper byte with a tip in gwei. My main concerns are:\ni) I'm over estimating the amount of wallets that will be compatible at the moment of the fork\nii) we may choose a constant value for the tip on legacy transactions, but it becomes too low for txs to be included\niii) a reorg to before the fork block could cause once valid bit packed transactions to be included (at `72057594` gwei, this would be ~1500 eth for a transfer)",
        "created_at": "2020-11-23T16:22:05.698000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "since only ~5000 accounts have \u003e`1500` eth, the likelihood of one of those account sending a transfer very close to the fork boundary using the bit packing mechanism (note, tipping at least 4 gwei would mean that a transfer would cost 6000 eth and there are only ~1500 account with that balance) is incredibly low",
        "created_at": "2020-11-23T16:27:38.034000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I don't share this belief.  I suspect that while one or two wallets may update, most will not update until substantially after the fork block.  Hardware wallets in particular are likely to be last to update, and they never auto-update so there will be a very long tail of users.",
        "created_at": "2020-11-23T16:27:57.998000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also, wallets updating != user updating wallet.  For example, I have auto-updates of MM and Coinbase wallet disabled on my devices for security reasons.  I recognize this is an uncommon practice, but it also isn't unheard of.",
        "created_at": "2020-11-23T16:29:40.729000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Airgapped signing devices also may be difficult to update for users.",
        "created_at": "2020-11-23T16:30:11.069000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah, i am probably over estimating the amount of wallets that will be updated at the time of the fork to support 1559",
        "created_at": "2020-11-23T17:07:01.898000+00:00",
        "attachments": null
    },
    {
        "author": "todcool",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Eth mining for at least one year still?",
        "created_at": "2020-11-23T19:43:05.183000+00:00",
        "attachments": null
    }
]
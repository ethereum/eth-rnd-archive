[
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Are there any L2 designs currently that do not rely on L1 storing receipts/bodies forever for data availability?",
        "created_at": "2021-11-04T06:41:05.621000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Are there any solutions to the L2 data availability problem that don't require trust?",
        "created_at": "2021-11-04T06:42:23.650000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "With L1 we have the benefit of making L1 data availability being part of the fork choice rule.  With L2s, we cannot do that (unless someone has a solution to that problem).",
        "created_at": "2021-11-04T06:49:46.195000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "Why would L1 need to store any data forever? L2s that rely on L1 for data availability send tx data as calldata, which is part of history and can be pruned.",
        "created_at": "2021-11-04T08:46:20.270000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "A user wanting to use an L2 must be able to acquire current state in some way.  I believe the way all current L2s handle this is by rebuilding the L2 state from L1 calldata or event history.",
        "created_at": "2021-11-04T08:50:04.121000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Currently, L1 does *not* (largely) prune body/receipt history (it is a big part of why Geth is \u003e500GB).  If we *do* start pruning bodies/receipts on L1, I worry that this will break L2s who rely on that data being available for constructing L2 state.",
        "created_at": "2021-11-04T08:51:15.746000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "I believe most L2s store the current state root in the contract storage, so you could get the current state from anyone trustlessly.",
        "created_at": "2021-11-04T08:52:17.808000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Yes, but there are no guarantees that the network actually has the state (or is willing to give it to you) to go along with that state root.",
        "created_at": "2021-11-04T08:53:09.725000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "This is the essence of the data availability problem, just because you know the state root doesn't mean the state is actually available.  It just means that you can validate the state if you can acquire it from somewhere.",
        "created_at": "2021-11-04T08:53:49.143000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "If the state is held by some single actor (e.g., sequencer), and they disappear then no one is able to use the network, which I believe includes being able to exit the network since you need the state to exit.",
        "created_at": "2021-11-04T08:54:27.850000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "Which is why the sequencer is required to post state changes as calldata.",
        "created_at": "2021-11-04T08:56:28.318000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Right, which gets us back to the fact that if L1 ever prunes body/receipt history, L2s will no longer have data availability guarantees.",
        "created_at": "2021-11-04T08:57:01.430000+00:00",
        "attachments": []
    },
    {
        "author": "yahgwai",
        "category": "general",
        "parent": "",
        "content": "zk rollups that post state changes could implement state expiry",
        "created_at": "2021-11-04T08:57:11.314000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "L2 data availability currently has a strong dependency on indefinite L1 body/history retention.",
        "created_at": "2021-11-04T08:57:23.858000+00:00",
        "attachments": []
    },
    {
        "author": "yahgwai",
        "category": "general",
        "parent": "",
        "content": "optimistic rollups dont have that option",
        "created_at": "2021-11-04T08:57:47.716000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I think you still have a data availability problem in that case?  Though maybe I'm not fully understanding what you are proposing?",
        "created_at": "2021-11-04T08:57:48.453000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "You only need L1 data availability for just the time needed for anyone following the L2 chain to update their states.",
        "created_at": "2021-11-04T08:58:10.808000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "That implies that no new participants can sync the chain.",
        "created_at": "2021-11-04T08:58:54.191000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "And if you leave and come back there is no guarantee that you will be able to withdraw in the future.",
        "created_at": "2021-11-04T08:59:03.719000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "You just need to get a recent state from one honest node.",
        "created_at": "2021-11-04T09:01:09.372000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "It doesn't have to be the newest state, as long as there is L1 calldata history for the period between the state you get and the newest state.",
        "created_at": "2021-11-04T09:03:11.586000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Correct.  However, this isn't the security assumption that L2s are built on/advertising.",
        "created_at": "2021-11-04T09:03:57.725000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The security assumption right now is that you can rebuild current state entirely from L1 body/receipt history, and with that you can then publish a transaction on L1 to force inclusion.  This ensures that no matter what happens, you can participate in the network and/or exit, even under extreme censorship.  This is the \"inherits security properties from L1\".",
        "created_at": "2021-11-04T09:05:02.414000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "If, however, L1 does not include body/receipt history then those guarantees go away and you now need a *different* guarantee, which is that there will be at least one honest node that is willing to give you the current (or at least recent)  state.",
        "created_at": "2021-11-04T09:05:52.482000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "I agree that there is such an assumption, but I also believe that this assumption is not too bad. I believe it is *easier* to maintain an L2 node than an L1 node since 1) you only need to store the most recent state you have and 2) there is no verification since that is already handled by the zk-proof.",
        "created_at": "2021-11-04T09:09:46.949000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "Isn't this assumption the same as you have with snap sync etc. on L1?",
        "created_at": "2021-11-04T09:12:33.850000+00:00",
        "attachments": []
    },
    {
        "author": "yahgwai",
        "category": "general",
        "parent": "",
        "content": "Yeah, thinking this through more, I agree. You still have to come online once every \"data availability window\" to sync some state to store yourself.",
        "created_at": "2021-11-04T09:20:08.823000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I think that security assumption is fine for some subset of people.  I think there are other people who are not OK with those security assumptions.  What is bugging me right now is that the stated/advertised security assumptions assume that L1 bodies/receipts will be available forever, and we have spoken a lot in this server about removing that.",
        "created_at": "2021-11-04T09:23:51.950000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "Yeah, if L1 data gets pruned you would need this extra assumption on L2s, but doesn't the same assumption also hold on L1 then? I.e. you would no longer be able to verify the ethereum chain from genesis, but would need to rely on honest nodes giving you a recent state.",
        "created_at": "2021-11-04T09:29:03.714000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Sort of.  With L1 you have to make a single assumption about \"I need to be able to access root state plus diff history\".  At the moment, root state is genesis block but that could change to be the state of block 10,000,000.  The only difference is that the state of block 10M is bigger than the state of genesis.",
        "created_at": "2021-11-04T09:31:13.569000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "If L1 makes such a change, now all of a sudden all of those L2 networks have a sudden shift in their security model because they now are changing their assumption set.",
        "created_at": "2021-11-04T09:31:51.869000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "Yeah, in that case you would require a single honest L2 node willing to provide a state newer than from block 10,000,000.",
        "created_at": "2021-11-04T09:40:32.296000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "L2 should use have their own state provider networks like portal network for their own state, and I think this is an easier problem than for L1, because you don't need to do any validation (except checking the root hash).",
        "created_at": "2021-11-04T09:43:25.563000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "general",
        "parent": "",
        "content": "You could likely just use torrents/IPFS (along with an Eth light client to get the latest state hash).",
        "created_at": "2021-11-04T09:44:52.235000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "This is what I'm interested in.  How can one build out a state network like that and what (if anything) can be done to ensure the data is available?",
        "created_at": "2021-11-04T09:53:19.531000+00:00",
        "attachments": []
    },
    {
        "author": "treyzania",
        "category": "general",
        "parent": "",
        "content": "payment/state channels",
        "created_at": "2021-11-04T13:21:31.893000+00:00",
        "attachments": []
    },
    {
        "author": "treyzania",
        "category": "general",
        "parent": "",
        "content": "parties in a channel store all the state for that channel only locally and then with multihop/etc you can interact with people you don't have channels with directly",
        "created_at": "2021-11-04T13:23:45.752000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "Those are 1:1 usually.  In theory with a large payment network you can do better, but those have some distinct downsides and I wouldn't call them L2 solutions (even though they are useful in some contexts).",
        "created_at": "2021-11-04T13:23:57.833000+00:00",
        "attachments": []
    },
    {
        "author": "treyzania",
        "category": "general",
        "parent": "",
        "content": "lightning definitely falls into the category of L2",
        "created_at": "2021-11-04T13:24:28.560000+00:00",
        "attachments": []
    },
    {
        "author": "treyzania",
        "category": "general",
        "parent": "",
        "content": "it's the *original* L2",
        "created_at": "2021-11-04T13:24:35.931000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "I don't think I would classify it as L2, but I can see myself being convinced otherwise.",
        "created_at": "2021-11-04T13:24:48.669000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "general",
        "parent": "",
        "content": "The biggest issue with something like lightning is the capital lockup required.",
        "created_at": "2021-11-04T13:25:16.755000+00:00",
        "attachments": []
    },
    {
        "author": "treyzania",
        "category": "general",
        "parent": "",
        "content": "I mean I suppose that's understandable",
        "created_at": "2021-11-04T13:25:20.638000+00:00",
        "attachments": []
    }
]
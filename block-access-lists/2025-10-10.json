[
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e Addresses accessed without state changes, including:\n\u003e \n\u003e ...\n\u003e \n\u003e * Coinbase address when receiving transaction fees\n\nCan someone remind me what the rationale for this is?  if no fees are paid to the coinbase, it shouldn't be accessed at all.",
        "created_at": "2025-10-10T03:18:58.372000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "I guess that it's done this way to avoid creating an additional special case behavior for the situation I described above",
        "created_at": "2025-10-10T03:26:58.621000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "we should have a test case with an empty block (no txs) that includes coinbase",
        "created_at": "2025-10-10T04:28:20.846000+00:00",
        "attachments": null
    },
    {
        "author": "icree23",
        "category": "Cross-layer",
        "parent": "",
        "content": "I am using kurtosis cli version 2.1.0 and running this [setup](https://github.com/jihoonsong/local-devnet-bals/blob/main/Makefile)\n\ni tend to have this error  \nmake run-registry\n```\nkurtosis run github.com/ethpandaops/ethereum-package --enclave bals --args-file ./kurtosis.config.registry.yaml --image-download always\nThere was an error interpreting Starlark code\nEvaluation error: module has no .get_cluster_type field or method\n        at [github.com/ethpandaops/ethereum-package/main.star:105:28]: run\n\nError encountered running Starlark code.\n```\nCan someone help with this?",
        "created_at": "2025-10-10T05:20:50.685000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Cross-layer",
        "parent": "",
        "content": "2.1.0 is a borked release. Please reinstall kurtosis. should be version 1.x.y",
        "created_at": "2025-10-10T05:38:02.049000+00:00",
        "attachments": null
    },
    {
        "author": "raxhvl",
        "category": "Cross-layer",
        "parent": "",
        "content": "I think in this case coinbase should not be included.\n\n\u003e Coinbase address when receiving transaction fees\n\nFrom the spec, the _when_ clause is not met\n\ncc: \u003c@792404665068158998\u003e \u003c@796570016966770688\u003e",
        "created_at": "2025-10-10T05:58:56.923000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "There is a `0` transfer to the coinbase though, no? Shouldn't the address be in the BAL with empty account changes?",
        "created_at": "2025-10-10T06:05:58.562000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "The EIP contradicts itself here",
        "created_at": "2025-10-10T06:06:11.422000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e Addresses accessed without state changes, including:\nand\n\u003e Coinbase address when receiving transaction fees",
        "created_at": "2025-10-10T06:06:47.510000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "actually, it doesn't",
        "created_at": "2025-10-10T06:07:59.916000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "but it's a bit confusing",
        "created_at": "2025-10-10T06:08:23.449000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah I guess this should also count `0` transfers because it does receive the fee but I think the wording should be more clear.",
        "created_at": "2025-10-10T06:08:45.533000+00:00",
        "attachments": null
    },
    {
        "author": "raxhvl",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah. If we go by zero value transfer of balance for account it should be included.\n\nhttps://pokebal.raxhvl.com/?test=test_bal_zero_value_transfer",
        "created_at": "2025-10-10T06:09:28.892000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "For example, there's a weird edge case with coinbase and EIP-161 where if it's touched and received `0` but was empty to begin with, it's marked for account clearing.",
        "created_at": "2025-10-10T06:09:33.659000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "So imo it should definitely be included with zero account changes",
        "created_at": "2025-10-10T06:09:53.221000+00:00",
        "attachments": null
    },
    {
        "author": "raxhvl",
        "category": "Cross-layer",
        "parent": "",
        "content": "Right, so coinbase is always unconditionally included?",
        "created_at": "2025-10-10T06:11:42.050000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "including state accesses is turning the complexity of this EIP into a nightmare üòÖ",
        "created_at": "2025-10-10T06:12:26.982000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yes but the EIP should be more clear. I think the \"when receiving transaction fees\" is vague.",
        "created_at": "2025-10-10T06:12:32.421000+00:00",
        "attachments": null
    },
    {
        "author": "raxhvl",
        "category": "Cross-layer",
        "parent": "",
        "content": "If so then isnt that redundant info we can get from block anyway?",
        "created_at": "2025-10-10T06:13:51.055000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "I would be fine with not including the coinbase in this case, as it's not actually accessed if it doesn't receive fees",
        "created_at": "2025-10-10T06:14:50.695000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "It is. We can certainly _choose_ to exclude it. But if the account receives `0` (this isn't clear implementation-wise) then the address should be included according to the current EIP state. I think we can define it one way or the other because it feels like meaningless data but in either case the EIP should be very explicit.",
        "created_at": "2025-10-10T06:17:54.363000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "We record an address that receives `0` so this would be a deviation from that behavior specific to coinbase.",
        "created_at": "2025-10-10T06:20:10.645000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e this is how it's marked for deletion according to EIP-161\n\nCould it actually be touched though?  if it was not accessed elsewhere in the block, and a zero-fee-transfer touch would mark it for deletion, then it must have been non-existent at the start of the block.",
        "created_at": "2025-10-10T06:24:31.447000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "actually, it could have had a balance at the start of the block, have been the target of a create2  (which transfered all the value to another account either via SENDALL or CALL).  However, the execution of the initcode would have touched the address",
        "created_at": "2025-10-10T06:26:51.518000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah I can't remember the exact test case, but ~~there was a case with a state root mismatch issue in `py-evm` and the fix is that we _only_ called `delta_balance` if the fee was non-zero but changing this to touching the account always, even for `0`, is what fixed this~~ [more context below, these tests were thankfully changed later]. If we have this line `Addresses with no state changes MUST still be present with empty change lists` in the EIP then it seems to me that it should be included.",
        "created_at": "2025-10-10T06:31:16.358000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "The fee was always non-zero pre-merge so this was a weird case which is why I remember it. Anyway, I'm not in one camp or another.",
        "created_at": "2025-10-10T06:33:06.518000+00:00",
        "attachments": null
    },
    {
        "author": "raxhvl",
        "category": "Cross-layer",
        "parent": "",
        "content": "So the options are\n\n1. Coinbase is included unconditionally, for consistency but this adds 20 byte redundancy\n\n2. Coinbase excluded unconditionally but this adds a new exception to the rule",
        "created_at": "2025-10-10T06:34:02.312000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "I prefer option 2 for this case",
        "created_at": "2025-10-10T06:34:26.818000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah whichever way it goes, I think we just need a very clear clarification.",
        "created_at": "2025-10-10T06:38:42.896000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "I actually somehow found the context and those tests were actually fixed [here](https://github.com/ethereum/tests/pull/1335) to remove empty accounts from the pre-state, thankfully üòÖ. I don't believe we have any empty accounts left in the state trie on mainnet and this would essentially be a non-existent acct. I think I also lean option 2.",
        "created_at": "2025-10-10T07:26:55.262000+00:00",
        "attachments": null
    },
    {
        "author": "raxhvl",
        "category": "Cross-layer",
        "parent": "",
        "content": "Besu is here! h/t \u003c@680337202521440470\u003e \u003c@465903001156976682\u003e üî•",
        "created_at": "2025-10-10T11:13:51.121000+00:00",
        "attachments": [
            {
                "type": "image/webp",
                "origin_name": "image.png",
                "content": "7cfd0e73ba54808368d484fb63baf536eb1c38989659f4947c7778005ed5d22b"
            }
        ]
    },
    {
        "author": "mariusvanderwijden",
        "category": "Cross-layer",
        "parent": "",
        "content": "lets goooo üöÄ",
        "created_at": "2025-10-10T11:26:38.360000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "test case(s) idea:  coverage around transactions that hit an execution error and consume all gas, making sure that the state reads get included properly.",
        "created_at": "2025-10-10T13:30:53.722000+00:00",
        "attachments": null
    },
    {
        "author": "raxhvl",
        "category": "Cross-layer",
        "parent": "",
        "content": "Something like this: https://pokebal.raxhvl.com/?test=test_bal_aborted_storage_access",
        "created_at": "2025-10-10T16:14:18.958000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "üß™ ‚öΩ New bal tests minor release [bal@v1.2.0](https://github.com/ethereum/execution-spec-tests/releases/tag/bal%40v1.2.0) out. Includes no-op, 7702, 2930, net-zero balance cases as well as a fix for `test_bal_block_rewards`. This is up-to-date with our `main` branch so includes all the currently implemented tests.",
        "created_at": "2025-10-10T16:23:58.440000+00:00",
        "attachments": null
    },
    {
        "author": "raxhvl",
        "category": "Cross-layer",
        "parent": "",
        "content": "Latest test results for release v1.2.0:\n1. üèÜ **Besu**: 80/90 (89%) \n2. **Reth**: 67/90 (74%)\n3. **Geth**: 64/90 (71%) \n4. **Nethermind**: 63/90 (70%)",
        "created_at": "2025-10-10T21:10:45.678000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "Just a note on the invalid **engine** tests, these will have to have the correct expected exception mapped in each exception mapper for each client. The majority of these fails, if not all, are actually correctly not accepting the block but there's a mismatch in the expected exception.",
        "created_at": "2025-10-10T22:16:41.184000+00:00",
        "attachments": null
    }
]
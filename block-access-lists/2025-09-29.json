[
    {
        "author": "raxhvl",
        "category": "Cross-layer",
        "parent": "",
        "content": "‚ùì If a contract reads / write to storage before `SELFDESTRUCT`  would `storage_changes` and `storage_reads` be still be empty? \n\nExample:\n\n```py\n[00]    PUSH1    01\n[02]    SLOAD    \n[03]    PUSH1    42\n[05]    PUSH1    02\n[07]    SSTORE    \n[08]    PUSH20    8a0a19589531694250d570040a0c4b74576919b8\n[1d]    SELFDESTRUCT    \n```",
        "created_at": "2025-09-29T09:32:30.455000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "Cross-layer",
        "parent": "",
        "content": "From the EIP:\n```\nSELFDESTRUCT (in-transaction): Accounts destroyed within a transaction MUST be included in AccountChanges without balance, nonce or code changes. Storage keys within the self-destructed contracts that were modified or read **MUST** be included as a `storage_read`.\n```",
        "created_at": "2025-09-29T09:47:02.714000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "Cross-layer",
        "parent": "",
        "content": "If a contract is self-destructed, then the storage/state changes (expect balance) within THIS contract are deleted from the BAL.\nIf the state of a different accoutn was modified then it's included as usual",
        "created_at": "2025-09-29T09:49:14.520000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "Cross-layer",
        "parent": "",
        "content": "I will further clarify the case on balance changes though. Thans for bringing this up!",
        "created_at": "2025-09-29T09:50:35.077000+00:00",
        "attachments": null
    },
    {
        "author": "raxhvl",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e SELFDESTRUCT (in-transaction): Accounts destroyed within a transaction MUST be included in AccountChanges without balance, nonce or code changes.\n\nWhat if the target of in-tx `SELFDESTRUCT`  before the self-destruct tx?  happens to have balance. Say the target of `CREATE2` , then it should have `balance_changes pre -\u003e 0` right?",
        "created_at": "2025-09-29T09:56:27.955000+00:00",
        "attachments": null
    },
    {
        "author": "nero_eth",
        "category": "Cross-layer",
        "parent": "",
        "content": "yeah this was addressed in this PR",
        "created_at": "2025-09-29T09:58:20.660000+00:00",
        "attachments": null
    },
    {
        "author": "qu0b",
        "category": "Cross-layer",
        "parent": "",
        "content": "The shared config above is not working for me. I'm getting:\n\n```\n[cl-2-prysm-geth] [2025-09-29 10:50:55.05] ERROR rpc/validator: Finished building block error=rpc error: code = Internal desc = Could not get local payload: could not get cached payload from execution client: Unsupported fork sinceSlotStartTime=59.733983ms slot=34 validator=57\n```\n\nNone of the nodes are successfully propsing blocks",
        "created_at": "2025-09-29T10:59:44.932000+00:00",
        "attachments": null
    },
    {
        "author": "jih2nn",
        "category": "Cross-layer",
        "parent": "",
        "content": "We need this PR in to reproduce what I described above: https://github.com/jwasinger/go-ethereum/pull/17\n\nIn the meantime, you can build a Geth image based on that PR, if you will",
        "created_at": "2025-09-29T11:05:11.425000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "I merged the PR",
        "created_at": "2025-09-29T11:12:16.498000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "I'm not a fan of the json representation for BAL being a hex string by default (I like to print my BALs as json objs for debugging), so I had previously reverted that change.  But if it's a blocker on the devnet, it can be fixed later on.",
        "created_at": "2025-09-29T11:13:50.112000+00:00",
        "attachments": null
    },
    {
        "author": "qu0b",
        "category": "Cross-layer",
        "parent": "",
        "content": "The image is now updated and i'm also getting the bad block errors. Should we hold off on merging the ethereum-package PR until this is resolved or is that a blocker for you?",
        "created_at": "2025-09-29T12:36:47.564000+00:00",
        "attachments": null
    },
    {
        "author": "jih2nn",
        "category": "Cross-layer",
        "parent": "",
        "content": "Getting the bad block error is where we're at: https://discord.com/channels/595666850260713488/1364000387195076608/1421227088756867326 The ethereum-package PR is not a blocker here.",
        "created_at": "2025-09-29T12:52:14.258000+00:00",
        "attachments": null
    },
    {
        "author": "jih2nn",
        "category": "Cross-layer",
        "parent": "",
        "content": "FYI, I opened the ethereum-package PR because Geth image reference will stay the same even after we fix it.",
        "created_at": "2025-09-29T12:53:12.914000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Cross-layer",
        "parent": "",
        "content": "Yeah, I have seen the message about the issue with the bad block error.  I am going to look into it after I make more progress on getting some of the BAL changes merged in Geth.",
        "created_at": "2025-09-29T12:58:59.015000+00:00",
        "attachments": null
    },
    {
        "author": "matkt0",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@199561711278227457\u003e I think we will be able to share a besu image for Besu for devnet0 this week. \u003c@465903001156976682\u003e had a branch that we tested in a local testnet with Geth for the moment it's ok. Will do more tests and share it soon",
        "created_at": "2025-09-29T14:50:57.259000+00:00",
        "attachments": null
    },
    {
        "author": "raxhvl",
        "category": "Cross-layer",
        "parent": "",
        "content": "üß™  Testing BAL",
        "created_at": "2025-09-29T17:54:22.100000+00:00",
        "attachments": null
    },
    {
        "author": "m0_ox",
        "category": "Cross-layer",
        "parent": "",
        "content": "üß™ ‚öΩ  We have a new EEST release for the latest EIP-7928 test vectors: [bal@v1.1.0](https://github.com/ethereum/execution-spec-tests/releases/tag/bal%40v1.1.0). This includes a few edge cases with self-destruct, some call / delegated call tests, account access tests, and beneficiary fee tracking.\n\nPlease give these a run and post any friction points or related questions in here.",
        "created_at": "2025-09-29T21:57:23.960000+00:00",
        "attachments": null
    }
]
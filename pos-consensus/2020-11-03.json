[
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Question on indexed attestations: some spec tests have an empty list for `attesting_indices` (_e.g._ `tests/mainnet/phase0/ssz_static/IndexedAttestation/ssz_random/case_2`) but the spec states that such attestations are invalid.  Is one or the other incorrect, or am I missing something?",
        "created_at": "2020-11-03T17:00:47.622000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Encoding still exists",
        "created_at": "2020-11-03T17:01:40.476000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Okay, but what's the point of having an encoding for an invalid item in the spec tests?",
        "created_at": "2020-11-03T17:02:37.184000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Well, the encoding is generic. There can be other lists and bitfields that are empty",
        "created_at": "2020-11-03T17:03:19.111000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "My problem is that I'm running against the spec tests doing decoding of the YAML and then comparing SSZ encoding and hash tree root, but my code also checks the data against spec, so it's throwing an error early saying that the indexed attestation isn't valid.  This is a bit of a pain.\n\nWould it be possible to add some metadata somewhere in the spec test directory that states that the object is invalid under spec, so that I can pick this up and pass over the relevant tests?",
        "created_at": "2020-11-03T17:06:49.018000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "The indexed attestation empty-contents check should exist at consensus layer.",
        "created_at": "2020-11-03T17:10:12.335000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "The object may be encoded like that in other contexts outside of the spec. E.g. as initial step when aggregating in some custom eth2 validator. It's really only the transition which actively rejects empty lists there",
        "created_at": "2020-11-03T17:12:00.642000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "\u003e The object may be encoded like that in other contexts outside of the spec. E.g. as initial step when aggregating in some custom eth2 validator.\n\u003c@!203220829473996800\u003e wouldn't that just use `Attestation`?\n\nAnyway, would it be possible to add a flag for non-spec items?  If not I'll add it to my side, but that would be a lot more ragile.",
        "created_at": "2020-11-03T18:43:21.580000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I really don't think it belongs in the encoding layer. Every encoding should work the same, based on typing. The transition function (and related gossipsub verification functions) then take care of the other non-standard conditions",
        "created_at": "2020-11-03T18:56:24.825000+00:00",
        "attachments": null
    }
]
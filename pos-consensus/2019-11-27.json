[
    {
        "author": "paulhauner",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I'm seeing that a fast-synced geth node is not sufficient to handle the requirements of eth1 voting because we end up with missing trie nodes. I've had to run with `--gcmode=archive --syncmode=full`.",
        "created_at": "2019-11-27T02:44:08.790000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Prysm how did you deal with this? Do you just require an archive node?",
        "created_at": "2019-11-27T02:44:17.749000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "What rpc calls do you perform that requires an archive node ?",
        "created_at": "2019-11-27T02:47:33.370000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Trying to get deposit root at prior blocks, I understand that is past contract state which gets pruned out/dropped",
        "created_at": "2019-11-27T02:48:12.539000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I think we replay the logs",
        "created_at": "2019-11-27T02:50:00.039000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "and recompute the deposit merkle tree?",
        "created_at": "2019-11-27T02:50:25.470000+00:00",
        "attachments": null
    },
    {
        "author": "prestonvanloon",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "right, so we would do that on start up, then we maintain it",
        "created_at": "2019-11-27T02:50:54.897000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Yes me maintain our own deposit trie",
        "created_at": "2019-11-27T02:51:23.055000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "ok cool",
        "created_at": "2019-11-27T02:52:58.799000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "i'm not super familiar with eth1 state management, can we assume that we have all logs with a fast-synced, non-archive node?",
        "created_at": "2019-11-27T02:53:28.313000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Are you saying you keep a central server that has the deposit tree that nodes pull from?",
        "created_at": "2019-11-27T02:55:16.466000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I think that is a reasonable assumption , event logs arent pruned for fast synced nodes to my knowledge.Although I am not 100% sure.",
        "created_at": "2019-11-27T02:56:17.103000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "\u003c@498009160982724610\u003e no the deposit tree is stored in each beacon node",
        "created_at": "2019-11-27T02:57:52.736000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "yep cool. thanks",
        "created_at": "2019-11-27T02:58:08.709000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Because you are only appending to the tree, you can use the iterative merkle tree algorithm to prune the already processed portion",
        "created_at": "2019-11-27T02:58:40.864000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "(if concerned about keeping all that extra stuff around forever)",
        "created_at": "2019-11-27T02:58:54.953000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Great, thanks for that, it would be useful to prune that after finalization",
        "created_at": "2019-11-27T03:02:32.860000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Event logs are stored in blocks so I dont think we have to worry about them being pruned for a fast synced node. It should be existing forever",
        "created_at": "2019-11-27T03:05:06.427000+00:00",
        "attachments": null
    },
    {
        "author": "kiwi.eth",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Event logs are not pruned at all üëç",
        "created_at": "2019-11-27T03:37:40.994000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "yep, just checked with a freshly synced node and it worked. thanks!",
        "created_at": "2019-11-27T03:38:59.747000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "5 cents, historical transaction receipts are downloaded along with state and blocks by fast sync. It requires some time to get this done and a portion of logs (esp. for the newer blocks) could be unavailable while downloading is in progress. As I remember geth downloads historical data starting from the beginning of the chain; it would be better to start doing that from the end for use cases like deposit tracking.",
        "created_at": "2019-11-27T06:35:59.342000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "sky.cactus",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "The consensus layer needs to know how many tokens to mint, and if an invalid block has deposits in it but the consensus layer doesn't know which blocks to account for.",
        "created_at": "2022-06-14T05:32:48.104000+00:00",
        "attachments": []
    },
    {
        "author": "albusdompeldorius",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "That's for deposits (EL -\u003e CL), right? I agree that is the issue. For withdrawals (CL -\u003e EL) this is not a problem though. I think there is no way around requiring the CL to know the valid state of the deposit contract.",
        "created_at": "2022-06-14T05:57:21.792000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Yeah, I think your described workaround for withdraws is probably fine.",
        "created_at": "2022-06-14T05:58:15.365000+00:00",
        "attachments": []
    },
    {
        "author": "ryanleeschneider",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "\u003e While re-writing the history because of a bug in EL is what will always remain as a big issue.\n\nMaybe each \"rewrite\" is a EVM precompile that is only allowed to execute once and only once as part of a special tx type that the miner must include in the particular fork block?  So for example the DAO fork would've been implemented like \"the first transaction in FORK_BLOCK must come from the miners coinbase and call precompile REWRITE_DAO_BALANCES\", where that precompile is what actually rewrites state.  Then it's up to the block producing side to handle rewrite correctly via code changes.  I haven't fully thought through this idea but personally I prefer that rewrites are very explicitly seen in the state history vs things that happen \"magically\" between certain blocks.",
        "created_at": "2022-06-14T22:29:02.559000+00:00",
        "attachments": []
    }
]
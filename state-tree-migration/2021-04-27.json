[
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I've been trying to write up a spec for the exact gas cost changes that would come for code merklization",
        "created_at": "2021-04-27T00:23:48.084000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And one thing I discovered is that I think the current spec is a little bit suboptimal",
        "created_at": "2021-04-27T00:23:53.583000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In that when an account is accessed, you get up to 5 random accesses into the tree as a fixed cost:\n\n* Header\n* Code chunk 1 (bytes 0...31*256)\n* Code chunk 2 (bytes 31*256...31*512)\n* Code chunk 3 (bytes 31*512...31*768)\n* Code chunk 4 (bytes 31*768...31*1024)",
        "created_at": "2021-04-27T00:23:59.364000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And so a call followed by a worst-case execution going into an account can trigger 1000 bytes of witness (5 random accesses) but cost only ~4000 gas (assuming 2600 for the account access + 350 per chunk)",
        "created_at": "2021-04-27T00:24:02.670000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "4 gas per byte is a little suboptimal; it would be ideal to either have 10 gas per byte, or if we are okay with less gas per byte, distribute the benefits more evenly toward average applications and not worst-case dos attacks",
        "created_at": "2021-04-27T00:24:05.395000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Basically, ideally the header and the code would live \"together\"",
        "created_at": "2021-04-27T00:24:48.117000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "One idea of course is increasing the verkle width *only at the bottom* from 256 to 1024",
        "created_at": "2021-04-27T00:25:28.886000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And fitting everything in",
        "created_at": "2021-04-27T00:25:34.617000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "though maybe we can still do some work and afford to make it 1024 everywhere... not sure",
        "created_at": "2021-04-27T00:26:04.685000+00:00",
        "attachments": []
    }
]
[
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "that's super cool, let me know if you need help integrating this into go-verkle, I definitely want to try running this on my block-replay benchmark",
        "created_at": "2022-11-08T17:36:40.656000+00:00",
        "attachments": []
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I've also ran the benchmarks on my arm machine and created a PR to update the README. I'm going to do the same thing with that second branch.",
        "created_at": "2022-11-08T17:37:48.878000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For sure. I'll create a `go-verkle` PR to update `go-ipa`. It should be quite easy since the API didn't change. I'll also run the benchmarks that are there to see how this improvement improved stuff.",
        "created_at": "2022-11-08T21:54:09.873000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "BTW, I merged this PR.",
        "created_at": "2022-11-08T21:55:04.916000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@353136597522448385\u003e, updating `go-verkle` to this new `go-ipa` and running `go-verkle` benchmarks: https://github.com/gballet/go-verkle/pull/290\n\nTo facilitate the results to others (copy-paste from PR description):\nReg the Go benchmarks:\n```\nname                                        old time/op    new time/op    delta\nProofCalculation-16                            4.65s Â± 1%     4.14s Â± 1%  -10.88%  (p=0.008 n=5+5)\nProofVerification-16                          26.6ms Â± 2%    26.4ms Â± 3%     ~     (p=0.548 n=5+5)\nCommitLeaves/insert/leaves/1000-16             215ms Â± 1%     203ms Â± 1%   -5.89%  (p=0.008 n=5+5)\nCommitLeaves/insertOrdered/leaves/1000-16      238ms Â± 1%     224ms Â± 3%   -5.63%  (p=0.008 n=5+5)\nCommitLeaves/insert/leaves/10000-16            2.46s Â± 1%     2.29s Â± 2%   -6.79%  (p=0.008 n=5+5)\nCommitLeaves/insertOrdered/leaves/10000-16     2.50s Â± 2%     2.37s Â± 1%   -5.18%  (p=0.008 n=5+5)\nCommitFullNode-16                             32.0ms Â± 1%    30.1ms Â± 1%   -5.95%  (p=0.008 n=5+5)\nModifyLeaves-16                                9.34s Â± 1%     8.23s Â± 1%  -11.93%  (p=0.008 n=5+5)\n```\nSo this makes sense if we try extrapolating from my benchmarks.\n\nRunning `benchs/main.go` separate benchmaks seem to have also 1.10x speedup (in some scaled down setup). If I test the original setup (1 million pre-inserted leaves, and insert 10k leaves; I got a 5x speedup which... is quite crazy, but my bet is my machine swapping RAM (too good to be true))\n\nWill be interesting to see what you find out running that `block-replay` benchmark. :)",
        "created_at": "2022-11-08T22:43:39.405000+00:00",
        "attachments": []
    },
    {
        "author": "kevaundray",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I merged both branches into go-ipa master, if you meant the MultiMapToField branch",
        "created_at": "2022-11-08T23:03:33.493000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Created this https://github.com/gballet/go-verkle/pull/291\nI'm trying to figure out at which N that new `MultiMapToBaseFieldBytes` is cheaper _per value_ than a single usual `MapToBaseFieldBytes`\n\nPasting here the result:\n```\nBenchmarkGroupToField/single-16                   793231              1506 ns/op\nBenchmarkGroupToField/multiple/1-16               539619              1862 ns/op              1862 ns/value          144 B/op          6 allocs/op\nBenchmarkGroupToField/multiple/2-16               520746              2251 ns/op              1125 ns/value          336 B/op          8 allocs/op\nBenchmarkGroupToField/multiple/4-16               343665              3501 ns/op               875.2 ns/value        736 B/op         12 allocs/op\nBenchmarkGroupToField/multiple/8-16               178898              6015 ns/op               751.8 ns/value       1530 B/op         17 allocs/op\nBenchmarkGroupToField/multiple/16-16              116660             10384 ns/op               649.0 ns/value       3124 B/op         25 allocs/op\nBenchmarkGroupToField/multiple/32-16               67484             17460 ns/op               545.6 ns/value       6312 B/op         39 allocs/op\nBenchmarkGroupToField/multiple/64-16               35632             35094 ns/op               548.4 ns/value      12713 B/op         68 allocs/op\nBenchmarkGroupToField/multiple/128-16              18733             65418 ns/op               511.1 ns/value      25435 B/op        114 allocs/op\nBenchmarkGroupToField/multiple/256-16               8793            137116 ns/op               535.6 ns/value      50922 B/op        210 allocs/op\n```",
        "created_at": "2022-11-08T23:54:03.204000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@427491045308235776\u003e, does this make sense from what you were expecting? Looks like starting from 2 values, it starts to get faster per value.",
        "created_at": "2022-11-08T23:54:51.367000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@353136597522448385\u003e, I could try using this new feature at least in all places in `go-verkle` that does `toFr(..)` for \u003e=2 values, and in `for` loops (I see some cases) if you want. LMK if that sounds good and I can give it a shot.",
        "created_at": "2022-11-08T23:56:51.728000+00:00",
        "attachments": []
    },
    {
        "author": "jsign",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(Sorry that I write so late. I dedicate time to the Fellowship program after my fulltime job ðŸ˜… )",
        "created_at": "2022-11-08T23:57:38.704000+00:00",
        "attachments": []
    }
]
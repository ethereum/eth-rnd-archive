[
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "hey guys, i was trying to sync kaustinen network with lodestar, but hitting up issues while decoding blocks synced from lighthouse",
        "created_at": "2023-08-04T09:48:26.167000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so i decided to get beacon jsons and trying to decode and figure out the issue locally",
        "created_at": "2023-08-04T09:48:50.054000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but suddently the casing of keys change from expected `snake` case to `camel` case for verkle fields",
        "created_at": "2023-08-04T09:49:29.960000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "this for e.g. is the key casing for execution payload inside beacon block json fetched from getblockv2 endpoint from lighthouse",
        "created_at": "2023-08-04T09:50:08.453000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "c89b66ec2677451abbf37dd73b832b1443eab057cf8c2f02c7492f5997691f17"
            }
        ]
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so far so good",
        "created_at": "2023-08-04T09:50:16.449000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but the fields inside execution witness for e.g. have `camel` casing which is messing up with lodestar ssz json reading routines",
        "created_at": "2023-08-04T09:51:47.720000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "6a68c7fc999de35ea280206c235fd871db00e686893d9aedb103362bbdaa3340"
            }
        ]
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "by suddenly you mean \"at a given block height\" or \"at some level of nesting\" ?",
        "created_at": "2023-08-04T09:52:55.798000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i think this is happening for any/all blocks",
        "created_at": "2023-08-04T09:53:20.122000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so i took a json from getBlockV2 api endpoint for lets say head block",
        "created_at": "2023-08-04T09:53:33.204000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so in my case slot: `957221`",
        "created_at": "2023-08-04T09:53:52.845000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it should, I think it's due to the way that go encodes blocks",
        "created_at": "2023-08-04T09:54:18.020000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "in this json, the keys casing for verkle structures is wrong imo",
        "created_at": "2023-08-04T09:54:31.640000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so what you see if the border between lighthouse and geth",
        "created_at": "2023-08-04T09:54:34.836000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it's not wrong, it's completely normal",
        "created_at": "2023-08-04T09:54:59.140000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it has nothing to do with geth but the json building by lighthouse",
        "created_at": "2023-08-04T09:55:01.270000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but yeah I get the point",
        "created_at": "2023-08-04T09:55:03.760000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "well lighthouse gets this json from geth",
        "created_at": "2023-08-04T09:55:19.182000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yes like the other fields in the execution payload",
        "created_at": "2023-08-04T09:55:38.568000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "their casing is correct",
        "created_at": "2023-08-04T09:55:42.605000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "not the casing of these verkle fields",
        "created_at": "2023-08-04T09:55:52.527000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "for e.g. `execution_witness` is correct casing for execution witness field in the execution payload json of beacon block json",
        "created_at": "2023-08-04T09:56:40.218000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but the fields inside `execution_witness` don't follow this casing structure",
        "created_at": "2023-08-04T09:57:02.202000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "that doesn't make it incorrect, that makes it different",
        "created_at": "2023-08-04T09:57:21.724000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but yeah, I get the point",
        "created_at": "2023-08-04T09:57:29.851000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "it makes it non standard... so incorrect imo ðŸ˜†",
        "created_at": "2023-08-04T09:58:03.703000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "w.r.t. beacon apis expectations of how data should be formateed",
        "created_at": "2023-08-04T09:58:26.759000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "anyhow, what you see is the language interface, I assume that lighthouse gets what geth gives it verbatim and places it. So we need to fix it at geth level",
        "created_at": "2023-08-04T09:59:03.076000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "no no, fix has to be at lighthouse level",
        "created_at": "2023-08-04T09:59:19.871000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i am not sure",
        "created_at": "2023-08-04T09:59:25.174000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "how lighthouse structures data reads",
        "created_at": "2023-08-04T09:59:38.434000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm pretty sure it's geth-level, I know exactly why this happens",
        "created_at": "2023-08-04T09:59:38.791000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ok i trust you ðŸ™‚",
        "created_at": "2023-08-04T09:59:51.556000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and the reason I think lighthouse doesn't \"fix\" it is because it doesn't want the receiving geths to be confused",
        "created_at": "2023-08-04T10:00:23.371000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "anyway, thanks for pointing this out. We will fix this before the relaunch.",
        "created_at": "2023-08-04T10:00:51.708000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Right now it's too late to change that in the live testnet",
        "created_at": "2023-08-04T10:01:03.304000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yea pls, anyway i can manually fix in my json to continue my debugging",
        "created_at": "2023-08-04T10:01:26.104000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but i will have problems trying to sync lodestar nodes which i wanted to sync at least few slots before new network launch",
        "created_at": "2023-08-04T10:01:52.785000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "mostly on engine api communication with geth",
        "created_at": "2023-08-04T10:03:06.466000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "will see how i can find a wayout...",
        "created_at": "2023-08-04T10:03:59.390000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but it would be good to have a beacon json dump of a dummy block to inspect before network relaunch",
        "created_at": "2023-08-04T10:04:40.836000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I don't understand what you mean by this? You already have one since you showed us screenshots of it, so what kind of JSON dump do you need? Do you mean that before the relaunch, we would produce some test blocks for you to test?",
        "created_at": "2023-08-04T10:07:06.514000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yes before launch",
        "created_at": "2023-08-04T10:08:08.739000+00:00",
        "attachments": null
    },
    {
        "author": "gballet",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah, sure we'll definitely do that",
        "created_at": "2023-08-04T10:08:18.753000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "on the \"fixed\" geth",
        "created_at": "2023-08-04T10:08:29.577000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ok on further drill down on the beacon block json to figure out why lodestar can't read it `depthExtensionPresent` is defined as a list while in json its just hex, did i miss anything in specs which changed from the consensus spec PR linked in verkle docs?",
        "created_at": "2023-08-04T13:04:02.045000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "35372db1cdcde1f7a222dd07d788e6afec35827a4c2d65132fa2673cebd1989a"
            }
        ]
    },
    {
        "author": "g11tech",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "also for the new testnet relaunch i suggest the spec is implemented as its own fork and not patched in bellatrix fork (or capella for that matter but obviously can still be scheduled at genesis) , i had to figure that out by myself as my fork version was not matching, and config.yaml seemed lacking to me without any VERGE/VERKLE fork epoch/version",
        "created_at": "2023-08-04T13:08:07.692000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "a7a7b4acf79b1fcc212c5ac23761b74a19946a539accb496912592e5cc025b76"
            }
        ]
    }
]
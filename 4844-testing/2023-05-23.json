[
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003casn_d6\u003e \u003e \u003casn_d6\u003e  replying to: \n ```@testing4844_bot wrote: \n \u003cz3nchada\u003e [reply]: Gotcha, the way geth accesses the API then should be safe then as long as I compile minimal support with c-kzg and use a minimal trusted_set...```\n geth initializes the trusted_setup by calling the c-kzg function `load_trusted_setup()` somewhere around here https://github.com/karalabe/go-ethereum/blob/6de8078d809d553d61863c8702faaa0336419d7f/crypto/kzg4844/kzg4844_ckzg_cgo.go#L38",
        "created_at": "2023-05-23T08:59:29.276000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003casn_d6\u003e \u003e \u003casn_d6\u003e  replying to: \n ```@testing4844_bot wrote: \n \u003cz3nchada\u003e [reply]: Gotcha, the way geth accesses the API then should be safe then as long as I compile minimal support with c-kzg and use a minimal trusted_set...```\n i don't know if anyone is doing this on any other EL :/ you might want to pop into the c-kzg channel and ask.",
        "created_at": "2023-05-23T08:59:54.243000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cflcl42\u003e \u003e \u003cflcl42\u003e  replying to: \n ```\u003c@486477492434239488\u003e wrote: \n This is a very interesting point. Are you worried about DoS on lower end machines due to the math?```\n - runs at all and properly detected\n- produces the same results\n- performant enough indeed",
        "created_at": "2023-05-23T09:48:38.293000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Plop ðŸ˜›",
        "created_at": "2023-05-23T13:20:01.512000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So, been integrating 4844 some more into Geth",
        "created_at": "2023-05-23T13:20:13.469000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I may be misunderstanding something, but does validating the excessDataGas header field require the paren't tx list?",
        "created_at": "2023-05-23T13:20:37.974000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Since the header only contains a tx root, I don't know how many blobs there are in the block without the body",
        "created_at": "2023-05-23T13:20:57.932000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "so to validate a header, I need the previous body?",
        "created_at": "2023-05-23T13:21:05.130000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "No, you need just parent's excess data gas only",
        "created_at": "2023-05-23T13:23:22.108000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And the number of blobs?",
        "created_at": "2023-05-23T13:23:35.035000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It's taken from the current block",
        "created_at": "2023-05-23T13:23:45.935000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "the current excess data gas depends on the parent data gas and parent blobs afaik",
        "created_at": "2023-05-23T13:24:27.066000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "wither way, you can't have header field validation depend on the block bodies",
        "created_at": "2023-05-23T13:24:42.819000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "soooo ðŸ˜„ we have a big problem",
        "created_at": "2023-05-23T13:24:48.169000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "https://eips.ethereum.org/EIPS/eip-4844#header-extension new_blobs mean current block's blobs I suppose",
        "created_at": "2023-05-23T13:25:18.647000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "that wouldn't be possible because the current blob price would depebd on the currently being included blobs",
        "created_at": "2023-05-23T13:25:46.047000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "hmmm, or I'm getting confused",
        "created_at": "2023-05-23T13:26:27.402000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Nope, it depends on previous block only",
        "created_at": "2023-05-23T13:26:40.508000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You are probably confused by `def get_data_gasprice(header: Header) -\u003e int:`\nwhere header is actually parent header",
        "created_at": "2023-05-23T13:27:12.118000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(`def calc_data_fee(tx: SignedBlobTransaction, parent: Header) -\u003e int:`)",
        "created_at": "2023-05-23T13:27:30.379000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": ":/",
        "created_at": "2023-05-23T13:27:38.571000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "so the basefee used is the one from teh current header and the blobfee used is the one from the parent",
        "created_at": "2023-05-23T13:27:53.657000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "that seems like a very wild idea",
        "created_at": "2023-05-23T13:27:59.138000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "EIP-1559 says this which seems the same as for blobs\n\u003e There is a base fee per gas in protocol, which can move up or down each block according to a formula which is a function of gas used in parent block",
        "created_at": "2023-05-23T13:29:20.317000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, and the tx price in the current block is defined by teh basefee in the current block",
        "created_at": "2023-05-23T13:30:17.427000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "obviously the basefee in the current block changes based on what was in the parent block, but the current fee is the one from the current block",
        "created_at": "2023-05-23T13:30:41.788000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "it seems that the basefee field is pre-execution and the exessdatagas field it post-execution, which feels a bit wonky given that they both define the gas price",
        "created_at": "2023-05-23T13:31:57.094000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "What I can say for sure is that we know parent's and current block's ExcessDataGas before execution",
        "created_at": "2023-05-23T13:34:13.833000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "you don't know the current block's exessdatagas before mining though",
        "created_at": "2023-05-23T13:34:53.356000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "if the excessdatagas depends on the *current* blob count",
        "created_at": "2023-05-23T13:35:07.920000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "since you don't know what will fit inside in the end",
        "created_at": "2023-05-23T13:35:44.297000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, we need to know txs",
        "created_at": "2023-05-23T13:36:18.865000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But at least current block's ExcessDataGas does not effect current block's execution at all",
        "created_at": "2023-05-23T13:37:16.562000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "well yes because it does not exist yet during execution",
        "created_at": "2023-05-23T13:39:39.629000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "but it's a bad design, the price field should be advertised in the current block, not in the parent",
        "created_at": "2023-05-23T13:39:55.373000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "just like all the other gas fields",
        "created_at": "2023-05-23T13:40:01.390000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It just feels wonky",
        "created_at": "2023-05-23T13:41:41.895000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "tehcnically doesn't matter, just the design feels off",
        "created_at": "2023-05-23T13:41:50.264000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The current interpretation is \"how much data gas was consumed in excess of the allowance at the end of the block, after all blob txs were processed\" and I'd like it to mean \"how much data gas was consumed in excess of the allowance at the beginning of the block, before starting transaction execution\"",
        "created_at": "2023-05-23T13:42:50.553000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I guess we could also make the analogy that excessDataGas follows the design of gasUsed? Feels a bit convoluted that price and capacity is mixed in a single field vs the old gas accounting",
        "created_at": "2023-05-23T14:00:06.852000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I see, do you mean it'd be better to have a different field in the current block that could be used to calculate data gas price instead of parent block's ExcessDataGas? Like shift it to one block to the future?",
        "created_at": "2023-05-23T14:20:17.337000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I find at least one useful application for that: you do not need to pass parentExcessDataGas everywhere",
        "created_at": "2023-05-23T14:24:01.343000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "just opened this to update besu version on devnet 5 - https://github.com/ethpandaops/4844-testnet/pull/111",
        "created_at": "2023-05-23T16:00:06.260000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "has anyone started collecting the list of reqs for devnet 6 yet?",
        "created_at": "2023-05-23T16:10:32.123000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ahhhh https://discord.com/channels/595666850260713488/892088344438255616/1110531435489661008",
        "created_at": "2023-05-23T16:14:51.893000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e @Peter I don't see your objection, excess_data_gas is just an accounting field, similar to gas_used. It does not advertise the current gas limit, that has to be computed from it. I don't understand why we would want an additional field if we can do everything using one field?",
        "created_at": "2023-05-23T19:14:11.400000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e The exponential form of eip1559 is considered superior because it strictly only depends on the total excess gas (which is only approximately true in the traditional form). See here for an explainer: https://dankradfeist.de/ethereum/2022/03/16/exponential-eip1559.html",
        "created_at": "2023-05-23T19:15:35.543000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@555483069038198827\u003e I guess the question boils down to interpretation. is excessDataGas akin to gasUsed or to baseFee?",
        "created_at": "2023-05-23T19:35:28.079000+00:00",
        "attachments": null
    },
    {
        "author": "karalabe",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I can see both versions give or take so I can live with both, but both ways it's a bit of a new mechanism that does not fit well into the existing ones",
        "created_at": "2023-05-23T19:35:59.869000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cdankrad\u003e The aim is to also change current mechanism to this long term",
        "created_at": "2023-05-23T19:36:53.119000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "in the geth fork \u003c@159152274659082240\u003e implemented the verification by passing in a chain reader for fetching the parent block in order to count # of blobs https://github.com/mdehoog/go-ethereum/commit/b6f59c206ab1aea7ac91669c9bb71d690c1ac205\n\nthe need to refer to parent header/block throughout the implementation did prove more than a bit inconvenient.",
        "created_at": "2023-05-23T20:06:58.948000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "FWIW the name \"excessDataGas\" always makes me think it's a surplus of gas rather than an overage. Maybe \"excessDataGasUsed\" would be more descriptive.",
        "created_at": "2023-05-23T20:14:27.964000+00:00",
        "attachments": null
    }
]
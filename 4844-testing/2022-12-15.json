[
    {
        "author": "gezero",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "sorry for bothering, I am from besu, trying to get the ssz encoding for transaction network payload up and running. I am using these test vectors https://github.com/Inphi/blob-utils/blob/master/resources/eip4844_test_vectors_sample_1.json, but it seams to me that the `max_fee_per_data_gas` field is missing from the vectors. Can someone confirm if these transactions network payloads are valid? if not, can someone share their test vectors please?",
        "created_at": "2022-12-15T12:52:05.156000+00:00",
        "attachments": null
    },
    {
        "author": "inphi",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "hi gezero. The test vectors are out of date. I'll update them in a moment.",
        "created_at": "2022-12-15T16:08:27.867000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "speaking of test vectors... I am working on the KZGPointEval pre-compile for Besu. I saw these https://github.com/holiman/go-ethereum/blob/50fed98730f6ddbb376936adc5149a1af1644c0d/core/vm/testdata/precompiles/fail-pointEvaluation.json and was going to use them in Besu, but i can't seem to find the corresponding trusted setup that goes with them.  I tried both the 4bit and 4096bit ones to no avail, though it is very possible i'm doing something else wrong.",
        "created_at": "2022-12-15T20:08:52.247000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "i'm pretty sure it is the 4bit setup. i have about 25 of 'em failing exceptionally, the others fail as expected.",
        "created_at": "2022-12-15T20:25:56.254000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Can you give an example of failing exceptionally? maybe there is an error message or something?",
        "created_at": "2022-12-15T21:01:20.774000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If you have the wrong setup, then they should all fail as expected. The way to figure out if you have the wrong setup would be to try it on input that should pass.\n\nIf failing exceptionally means that an exception is raised, then I think thats possibly a bug in the cryptography code, since it should be able to handle malformed points",
        "created_at": "2022-12-15T21:03:08.337000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yes, i mean the later. all of the exceptional failures seem to have a problem with the bytes_to_g1 function:  https://github.com/ethereum/c-kzg-4844/blob/1768321fc386973a4dd0b299d307327ce3db03b6/src/c_kzg_4844.c#L761",
        "created_at": "2022-12-15T21:11:51.492000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "error messages are all `There was an error while converting commitment bytes to g1: C_KZG_BADARGS`",
        "created_at": "2022-12-15T21:12:41.183000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "sometimes proof instead of commitment though",
        "created_at": "2022-12-15T21:12:50.739000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "and when it complains of proof, is is aligning with an expected error that contains \"kzg proof\" in it per the geth vectors.",
        "created_at": "2022-12-15T21:16:32.236000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah it seems that the exception is being thrown in the wrapper code, so `bytes_to_g1` is return `C_KZG_BADARGS` to the java wrapper, then the java wrapper is returning an exception",
        "created_at": "2022-12-15T21:40:28.759000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "i think it is doing the right thing, it is just inconsistent and confusing with the messaging",
        "created_at": "2022-12-15T21:40:34.709000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think it makes sense to return a false here instead of throwing, though I haven't coded in java for a while, so maybe throwing here is the correct option",
        "created_at": "2022-12-15T21:40:38.769000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Would it be consistent if that method never threw and simply returned a false value if anything was wrong with the input?",
        "created_at": "2022-12-15T21:41:39.120000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yes, it would",
        "created_at": "2022-12-15T21:41:49.849000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "however, we then become blind as to why.  might be ok though? i'm curious how geth is doing it.",
        "created_at": "2022-12-15T21:42:22.316000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "seems like their vectors include expected error messages. we'd need to get those through exceptions.",
        "created_at": "2022-12-15T21:42:47.892000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "In geth, there is an error object. If you check those test vectors, the error object has a string which tells you what the error is",
        "created_at": "2022-12-15T21:43:02.724000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Since in golang, an error is just another type that gets returned. \n\nThough I don't think it would be good to have the code try to use the exact same error messages as in geth/the test vectors since those strings are not stable afaik. \n\nThe essence of those error messages are helpful though (maybe this is what you originally meant)",
        "created_at": "2022-12-15T21:47:51.057000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "right now the wrapper returns a bool and maybe throws an exception. we could change to a struct return type and include the error optionally there",
        "created_at": "2022-12-15T21:52:55.339000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah I think thats a good idea.\n\nFor visibility, here is the passing test from that repo:  \u003chttps://github.com/holiman/go-ethereum/blob/50fed98730f6ddbb376936adc5149a1af1644c0d/core/vm/testdata/precompiles/pointEvaluation.json\u003e\n\nIt seems to be a bit out of date, since it does not specify a return value in \"Expected\", if it passes. \n\nIf that fails, I can increase the scope of the cryptography test vectors to also include the precompile with version hashing etc",
        "created_at": "2022-12-15T21:54:45.883000+00:00",
        "attachments": null
    },
    {
        "author": "robocopsgonemad",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I can talk to Stefan about this, it seems he's contributing to the java binding.",
        "created_at": "2022-12-15T21:55:33.145000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@641548687813902336\u003e linking  for visibility... ahh nevermind Justin can talk to you",
        "created_at": "2022-12-15T21:55:41.659000+00:00",
        "attachments": null
    }
]
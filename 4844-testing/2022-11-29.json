[
    {
        "author": "hsiaowei",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, I will share the new test vectors in the next few hours  üôè (running testgen now)",
        "created_at": "2022-11-29T02:50:00.690000+00:00",
        "attachments": null
    },
    {
        "author": "hsiaowei",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Hi all CLs, spec tests for `v1.3.0-alpha.1-hotfix.2` released: https://github.com/ethereum/consensus-spec-tests/releases/tag/v1.3.0-alpha.1-hotfix.2\n\nIt fixed the EIP4844 `previous_version` issue (#3127, thanks to \u003c@363800010518822915\u003e).",
        "created_at": "2022-11-29T05:34:47.651000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Which one is worst may vary a bit, yes. However, looking at the mem stats, it seems some fail cases do more allocation than the happy-path case. Which indicates that they are actually worse, for some reason.",
        "created_at": "2022-11-29T06:19:06.833000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Case in point:\n```\n[user@work vm]$ go test . -run - -bench BenchmarkPrecompiledPointEvaluation/point --count 5\ngoos: linux\ngoarch: amd64\npkg: github.com/ethereum/go-ethereum/core/vm\ncpu: Intel(R) Core(TM) i9-10885H CPU @ 2.40GHz\nBenchmarkPrecompiledPointEvaluation/pointEvaluation1-Gas=50000-8                  909       1288215 ns/op         50000 gas/op            38.81 mgas/s       54802 B/op         351 allocs/op\nBenchmarkPrecompiledPointEvaluation/pointEvaluation1-Gas=50000-8                  883       1278805 ns/op         50000 gas/op            39.09 mgas/s       54800 B/op         351 allocs/op\nBenchmarkPrecompiledPointEvaluation/pointEvaluation1-Gas=50000-8                  927       1287673 ns/op         50000 gas/op            38.82 mgas/s       54800 B/op         351 allocs/op\nBenchmarkPrecompiledPointEvaluation/pointEvaluation1-Gas=50000-8                  926       1327074 ns/op         50000 gas/op            37.67 mgas/s       54800 B/op         351 allocs/op\nBenchmarkPrecompiledPointEvaluation/pointEvaluation1-Gas=50000-8                  909       1290959 ns/op         50000 gas/op            38.72 mgas/s       54800 B/op         351 allocs/op\n```",
        "created_at": "2022-11-29T07:56:17.984000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "vs\n```\n[user@work vm]$ go test . -run - -bench BenchmarkPrecompiledPointEvaluationFail/fuzzcorp-4 --count 5\ngoos: linux\ngoarch: amd64\npkg: github.com/ethereum/go-ethereum/core/vm\ncpu: Intel(R) Core(TM) i9-10885H CPU @ 2.40GHz\nBenchmarkPrecompiledPointEvaluationFail/fuzzcorp-4-Gas=50000-8                  808       1464602 ns/op         50000 gas/op            34.11 mgas/s       58819 B/op         363 allocs/op\nBenchmarkPrecompiledPointEvaluationFail/fuzzcorp-4-Gas=50000-8                  804       1446054 ns/op         50000 gas/op            34.57 mgas/s       58816 B/op         363 allocs/op\nBenchmarkPrecompiledPointEvaluationFail/fuzzcorp-4-Gas=50000-8                  798       1445463 ns/op         50000 gas/op            34.58 mgas/s       58816 B/op         363 allocs/op\nBenchmarkPrecompiledPointEvaluationFail/fuzzcorp-4-Gas=50000-8                  812       1449572 ns/op         50000 gas/op            34.49 mgas/s       58816 B/op         363 allocs/op\nBenchmarkPrecompiledPointEvaluationFail/fuzzcorp-4-Gas=50000-8                  794       1492131 ns/op         50000 gas/op            33.50 mgas/s       58816 B/op         363 allocs/op\n```",
        "created_at": "2022-11-29T07:56:30.697000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "`351` vs `363` allocs/op.",
        "created_at": "2022-11-29T07:56:50.555000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And it seems it may vary exaclty _which_ case is the worst, but it seems pretty clear to me that e.g `fuzzcorp-4` is worse than the happy-path-case `pointEvaluation1`.",
        "created_at": "2022-11-29T07:58:03.204000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I _guess_ that this is due to the implementation rather than some inherent trait",
        "created_at": "2022-11-29T07:58:39.024000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "On another note, btw: I think it would be good if someone opened a PR against geth, with the 4844 changes. We should get started on reviewing that as soon as possible if you seriously pursue it for shanghai",
        "created_at": "2022-11-29T09:17:20.399000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "can I run those exact benchmarks based off of your branch? Would like to see if its an implementation trait as you mentioned or whether I've made a wrong assumption somewhere\n\nOkay found it",
        "created_at": "2022-11-29T09:33:51.661000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, but -- I just updated the corpus, so if you want run the exact same ones, you need to ignore the latest commit",
        "created_at": "2022-11-29T09:42:43.980000+00:00",
        "attachments": null
    },
    {
        "author": "inphi",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "cc \u003c@898563924440543283\u003e",
        "created_at": "2022-11-29T14:57:24.922000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Sorry for the late link, but 4844 call starting in ~8 mins!\n\nAgenda: https://github.com/ethereum/pm/issues/679\nZoom: https://ethereumfoundation.zoom.us/j/88332629239?pwd=YmNpVVpaVy93RXhOTS9DYmNtWGtLdz09",
        "created_at": "2022-11-29T15:22:50.706000+00:00",
        "attachments": null
    },
    {
        "author": "roberto.bayardo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "on it",
        "created_at": "2022-11-29T15:24:20.403000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003cflcl42\u003e Hey guys, how can Nethermind benchmark the precompile? Could you direct me, please?",
        "created_at": "2022-11-29T16:50:18.983000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Question, would it be easier for CL clients not to upgrade to an intermediate Capella state before EIP444?\n\nCurrently \n`Bellatrix -\u003e Capella[1] -\u003e EIP4844[2]`\n\nWhat I believe will be easier\n`Bellatrix -\u003e EIP4844(rebased)`\n\nThe only difference between `[1]` and `[2]` is just `payloadHeader.ExcessiveDataGas`. It's more work maintain two Capella states where one has `ExcessiveDataGas` and one doesn't have it\n\n\u003c@607055410104500244\u003e \u003c@504202741933932544\u003e \u003c@688748669268132001\u003e",
        "created_at": "2022-11-29T17:59:04.869000+00:00",
        "attachments": null
    },
    {
        "author": "dapplion",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'm testing bellatrix -\u003e eip4844 (rebased) locally now because life is short",
        "created_at": "2022-11-29T18:00:02.226000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Us too but it looks like spec test wants `Bellatrix` -\u003e `Capella` -\u003e `EIP4844`. Just wanted to make sure everyone is on the same page",
        "created_at": "2022-11-29T18:01:15.260000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We've been testing with `Bellatrix -\u003e Capella -\u003e EIP4844` but Capella + Eip4844 have the same fork epoch*",
        "created_at": "2022-11-29T18:01:55.493000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "the quirk that exist is in the previous fork version",
        "created_at": "2022-11-29T18:02:07.465000+00:00",
        "attachments": null
    },
    {
        "author": "realbigsean",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "we can change it though, not a big deal",
        "created_at": "2022-11-29T18:02:23.273000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ok I'll try to open a PR on this, if everyone likes it, we can merge it",
        "created_at": "2022-11-29T18:03:23.198000+00:00",
        "attachments": null
    },
    {
        "author": "dapplion",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Noted that clients must persist blocks beyond MIN_EPOCHS_FOR_BLOBS_SIDECARS_REQUESTS if the network is not finalizing. Also for all forks, so in choppy network conditions disk can grow significantly. Spec text is correct in that regard, where\n- BlobsSidecarsByRange: Clients MUST keep a record of signed blobs sidecars seen on the epoch range\n`[max(GENESIS_EPOCH, current_epoch - MIN_EPOCHS_FOR_BLOBS_SIDECARS_REQUESTS), current_epoch]`\n- BeaconBlockAndBlobsSidecarByRoot: Clients MUST support requesting blocks and sidecars since the latest finalized epoch\n\nNot sure if a note would be necessary to clarify",
        "created_at": "2022-11-29T18:15:43.686000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "we can't do the double upgrade on the same epoch. We need to do them one epoch after the other",
        "created_at": "2022-11-29T18:35:28.244000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Can we just skip Capella and go straight to EIP4844?",
        "created_at": "2022-11-29T18:38:12.817000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "What I propose: https://github.com/ethereum/consensus-specs/pull/3140",
        "created_at": "2022-11-29T18:38:15.862000+00:00",
        "attachments": null
    },
    {
        "author": "bridge-bot",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003ctimbeiko\u003e \u003e \u003ctimbeiko\u003e  replying to: \n ```@flcl42 wrote: \n Hey guys, how can Nethermind benchmark the precompile? Could you direct me, please?```\n @flcl42 this is what Martin used: https://github.com/ethereum/benchmarking/tree/master/shanghai\n\nNot sure if it works \"out of the box\" for Nethermind or if there are significant modifications needed. If it's easy for you to run, then it'd be great to just get that done. OTOH, if you think it's a lot of work to get nethermind set up, I can see if there are testing people who have bandwidth üòä",
        "created_at": "2022-11-29T18:53:16.935000+00:00",
        "attachments": null
    },
    {
        "author": "dapplion",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If unfinalized blocks older than MIN_EPOCHS_FOR_BLOBS_SIDECARS_REQUESTS must be checked for data availability a form of optimistic sync appears necessary https://github.com/ethereum/consensus-specs/pull/3141",
        "created_at": "2022-11-29T19:00:00.817000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This is a bit weird to me. We already implemented that state upgrade. Resetting the withdrawal fields is weird too.. I might be missing the complexity you have in mind that is being simplified by doing that.",
        "created_at": "2022-11-29T19:19:42.002000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Does Teku also maintain a capella state without `excessive_data_gas` ?",
        "created_at": "2022-11-29T19:21:00.876000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I want to simplify having to maintain two different states which are capella and eip4844. I thought the whole point to rebase 4844 on top of Capella is so we can avoid that",
        "created_at": "2022-11-29T19:22:22.779000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes we have a Capella state with payload header without excessive_data_gas",
        "created_at": "2022-11-29T19:23:03.351000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I see. Wonder if I'm missing a good reason to stick to a no-op Capella intermediate state before 4844 state. Feels a bit redundant and somewhat wasted work",
        "created_at": "2022-11-29T19:27:38.935000+00:00",
        "attachments": null
    },
    {
        "author": "dapplion",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The rebase should allow both EIP4844_EPOCH \u003e CAPELLA_EPOCH in case eip4844 is delayed, which isn't unreasonable. In that case the intermediary state is necessary right?",
        "created_at": "2022-11-29T19:29:15.272000+00:00",
        "attachments": null
    },
    {
        "author": "dapplion",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I agree that + disabled withdrawals are mutually exclusive work, shouldn't be too much",
        "created_at": "2022-11-29T19:29:43.835000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah. That's a good reason",
        "created_at": "2022-11-29T19:30:16.204000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I agree. Will be happy to work on the intermediary state. Sounds like we are in alignment ü´°",
        "created_at": "2022-11-29T19:31:25.720000+00:00",
        "attachments": null
    },
    {
        "author": "tbenr",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "well, the point of rebasing 4844 on top of capella is also to be able to roll them out in sequence üôÇ",
        "created_at": "2022-11-29T19:38:10.804000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I haven‚Äôt been following the testnets so closely, but Im told we‚Äôre using 3 slots per epoch for the 4844 devnets. Can we please abandon that and use 8 like the minimal spec? I think we should focus on testing 4844 rather than exotic new spec configurations.\n\nIf we all follow the spec exactly then 3 shouldn‚Äôt be a problem, but as we all know there‚Äôs lots of optimisations going on in clients and I don‚Äôt see the value in seeing what happens with arbitrary slots per epochs values.",
        "created_at": "2022-11-29T20:06:05.385000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "From the 4844 implementer's call, we all decided not to use 3 (odd values). We'll be using normal values from minimal or mainnet from now on. ü´°",
        "created_at": "2022-11-29T20:07:32.369000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "On that note, here are the notes from the call today, and video linked inside üôÇ https://docs.google.com/document/d/15EatedrJanNxBZGPVASvwq9xgbTs5UxjsDfjpM6ppSY/edit#",
        "created_at": "2022-11-29T20:07:49.510000+00:00",
        "attachments": null
    },
    {
        "author": "paulhauner",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Thank you, sorry for being outdated!",
        "created_at": "2022-11-29T20:08:00.844000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "3h behind, still pretty good üòõ !",
        "created_at": "2022-11-29T20:08:11.692000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I thought Australians lived in the future üòù",
        "created_at": "2022-11-29T21:12:49.659000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I knew you were going to say that...",
        "created_at": "2022-11-29T21:14:10.739000+00:00",
        "attachments": null
    },
    {
        "author": "inphi",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Writing some 4844 hive tests. Anyone know how to run a sim for a specific test case? The `--sim.limit` flag doesn't do anything.",
        "created_at": "2022-11-29T21:19:00.116000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, there's a regex flag that can be used to pinpoint a specific simulator. But perhaps you are using the consensus simulator and want to pinpoint a testcase name?",
        "created_at": "2022-11-29T21:31:18.090000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Not sure that is supported. Can check tomorrow, or \u003c@194432762315407360\u003e might know",
        "created_at": "2022-11-29T21:31:51.517000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "What string are you passing to that flag ?",
        "created_at": "2022-11-29T21:32:16.867000+00:00",
        "attachments": null
    },
    {
        "author": "inphi",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "nvmind figured it out. I was passing `\u003ctestname\u003e` where i should have been using `\u003csimulator\u003e/\u003ctestname\u003e`",
        "created_at": "2022-11-29T21:35:18.188000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah it can be confusing because it expects the suite as well",
        "created_at": "2022-11-29T21:40:13.666000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We only have one multi-suite simulator so far",
        "created_at": "2022-11-29T21:40:28.612000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If you have time tomorrow, can you re-run your benchmarks on this fork of your branch to extrapolate new numbers please: \u003chttps://github.com/kevaundray/go-ethereum/tree/kw/martinsFork4844-50f\u003e\n\nWill also create interop test vectors for correctness/soundness of the precompile.\n\nPreliminary results from my laptop show the allocations being a lot more uniform and a healthy speedup but need to do more investigation before confirming",
        "created_at": "2022-11-29T22:14:44.666000+00:00",
        "attachments": null
    }
]
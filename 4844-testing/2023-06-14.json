[
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "For this tx:\n```json\n                    {\n                        \"type\": \"0x03\",\n                        \"chainId\": \"0x01\",\n                        \"nonce\": \"0x00\",\n                        \"maxPriorityFeePerGas\": \"0x00\",\n                        \"maxFeePerGas\": \"0x64\",\n                        \"value\": \"0x01\",\n                        \"to\": \"0x0000000000000000000000000000000000000100\",\n                        \"accessList\": [],\n                        \"protected\": true,\n                        \"secretKey\": \"0x45a915e4d060149eb4365960e6a7a45f334393093061116b197e3240065ff2d8\",\n                        \"maxFeePerDataGas\": \"0x03\",\n                        \"blobVersionedHashes\": [\n                            \"0x0100000000000000000000000000000000000000000000000000000000000000\"\n                        ],\n                        \"data\": \"0x\",\n                        \"gasLimit\": \"0x07a120\"\n                    }\n```\n\nThe upfront cost (sender has to have at least this amount of eth to send the tx) should be:\n\n`0x64 * 0x07a120 + 1 + 3 * 2^17` - right?\n\n(`maxFeePerGas * gasLimit + value + maxFeePerDataGas * common.param('dataGasPerBlob')`)\n\nThe test in question here is `blob_txs/blob_tx_attribute_gasprice_opcode.json test: 002-fork=Cancun-tx_gas=500000-opcode=GASPRICE-tx_max_fee_per_gas=100-tx_max_fee_per_data_gas=3-tx_max_priority_fee_per_gas=0`. On EthereumJS we fail this tx because the sender does not have enough eth. However, if you calculate the data gas price (this is 1), then the tx should be able to cover this.",
        "created_at": "2023-06-14T08:50:35.619000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Per EIP spec:\n\n```\n        # modify the check for sufficient balance\n        max_total_fee = tx.gas * tx.max_fee_per_gas\n        if type(tx) is SignedBlobTransaction:\n            max_total_fee += get_total_data_gas(tx) * tx.max_fee_per_data_gas\n        assert signer(tx).balance \u003e= max_total_fee\n```\n\nIt seems that this test filler instead checks:\n\n```\n        # modify the check for sufficient balance\n        max_total_fee = tx.gas * tx.max_fee_per_gas\n        if type(tx) is SignedBlobTransaction:\n            max_total_fee += calc_data_fee(header, tx) * tx.max_fee_per_data_gas\n        assert signer(tx).balance \u003e= max_total_fee\n```\n\nMight be wrong here though ðŸ¤” But I think according to the spec this tx should be invalid",
        "created_at": "2023-06-14T08:52:50.939000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The same goes for all the `excess_data_gas` tests",
        "created_at": "2023-06-14T09:03:42.831000+00:00",
        "attachments": null
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This is a good example: \"000-fork=Cancun-new_blobs=1-parent_blobs=2-parent_excess_blobs=18-expected_excess_data_gas:0x220000\"\n\nHere we have: maxFeePerGas: 7, maxFeePerDataGas: 131072, value: 1, this tx has 1 blob, gasLimit: 21000\n\nUpfront cost should be `1 + 7 * 21000  + 131072 * 1 * 131072`. However, account only has 278073,\nThis is the same as: `1 + 7 * 21000 + 131072 * 1 * 1` (here the final 1 is not the maxFeePerDataGas, but is instead the gas price of that block). I am rather certain now that this does not match the spec. CC \u003c@892053833121923094\u003e \u003c@755913785620824175\u003e",
        "created_at": "2023-06-14T09:08:47.189000+00:00",
        "attachments": null
    },
    {
        "author": "satyajitsato",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I am new to 4844 and exploring. I want to be able to send a simple blob transaction to my local network. Could someone point me to any codebase that can do it? Thanks!",
        "created_at": "2023-06-14T11:42:13.912000+00:00",
        "attachments": null
    },
    {
        "author": "__flcl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Having this tool in drafts, do you want to send something specific in blobs?",
        "created_at": "2023-06-14T11:54:13.712000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This is a good example 000 fork Cancun",
        "created_at": "2023-06-14T14:55:03.129000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You're right, the implementation doesn't match the spec",
        "created_at": "2023-06-14T18:39:45.234000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Implementing the right thing makes it a bit complicated, because we use one value for the check and the other immediately after for the actual computation\nI think the argument would be that you can not send transactions with a max fee per data gas that you can't cover, but this should be checked in the txpools already",
        "created_at": "2023-06-14T18:41:22.813000+00:00",
        "attachments": null
    }
]
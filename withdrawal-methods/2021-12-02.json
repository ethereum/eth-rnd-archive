[
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "\u003c@291925846556540928\u003e since you're already opening issues and PRs for withrawals. I wonder what are your thoughts about transfers, or even automatic transfers on epoch processing of validator excess? I worry that forking with withrawals without something like this will make a poor UX because of pool validator rotation. We should have at the very least 100 000 exits right away",
        "created_at": "2021-12-02T00:33:32.057000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "See the related tracking issue \n\nI think we need three features and one is partial withdrawals (i think this is best placed as an option for proposers but can be debated)",
        "created_at": "2021-12-02T00:36:45.680000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "No what I mean is different",
        "created_at": "2021-12-02T00:37:04.066000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I mean completely cl-cl",
        "created_at": "2021-12-02T00:37:23.152000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "What do transfers beyond 32 eth buy us? Beyond partial withdrawals\n\nA transfer market and related fee market brings in a lot of complexity that my intuition is we can side step with appropriate partial withdrawals",
        "created_at": "2021-12-02T00:39:34.530000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "If we have partial withdrawals I don't see the need for inter-CL transfers any more.",
        "created_at": "2021-12-02T00:39:45.269000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I don't see any complexity nor engineering problem in simply assigning your earnings to another validator. This is automatic compounding for pools without clogging the network with withrawals",
        "created_at": "2021-12-02T00:41:10.096000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "(When these were first mooted there was no exit to EL outside of a full withdrawal, which would be a painful process.  But transferring to another CL validator is also a painful process from the user perspective, and worth avoiding if possible.)",
        "created_at": "2021-12-02T00:41:21.513000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "And also allowing small stakers to sell their earnings without waiting months for a proposal",
        "created_at": "2021-12-02T00:41:38.779000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "If inter-CL transfers were possible it would still be a pain.  A new validator would need to be pre-created, so would need at least 1 Ether to start with.  Then there would need to be monitoring of the flow of funds from existing validators to the new validator to hit but not exceed 32 Ether, so some sort of co-ordination effort.  Seems like a lot of effort if we can fix the problem by just having some withdrawal receipts passed back to the EL.",
        "created_at": "2021-12-02T00:43:19.524000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Having some sort of explicit \"transfer\" operation would potentially clog up the CL.  We want to keep the beacon chain as light as we can, without additional operations if possible.",
        "created_at": "2021-12-02T00:44:30.883000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Why these checks? You do not need nor care if the new validator has more than 32",
        "created_at": "2021-12-02T00:44:35.753000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "And I'm not talking about complicated transfer mechanisms. A single message only once you can change your target",
        "created_at": "2021-12-02T00:45:15.502000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "If the purpose of transfers is to allow compounding, then you do care as when you have one validator at 32 Ether you'd want to move on to the next.",
        "created_at": "2021-12-02T00:45:35.227000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "The new validator will also use this system and transfer it's excess",
        "created_at": "2021-12-02T00:45:59.124000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "From the beacon chain this is a very light operation and doesn't require extra processing at epoch transition",
        "created_at": "2021-12-02T00:46:30.387000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "You also have the issue of how to authorize where the funds go.  An `0x01` address is simple and clear, other systems may not.",
        "created_at": "2021-12-02T00:46:33.434000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "This is a message signed by the withdrawal key with the pubkey of the new target",
        "created_at": "2021-12-02T00:47:24.772000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Following a chain of these delegations is a potential DoS vector, or at least expensive.",
        "created_at": "2021-12-02T00:47:32.903000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "How?",
        "created_at": "2021-12-02T00:47:47.741000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "(You could make it a loop)",
        "created_at": "2021-12-02T00:48:08.099000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Setting up a loop would be a fun way to start.  But even if we explicitly check for that you can make quite a long chain we have to follow on every balance change.",
        "created_at": "2021-12-02T00:48:28.291000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "And it costs you nothing because you're just delegating between your own validators.",
        "created_at": "2021-12-02T00:48:39.988000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "This can be trivially dealt with",
        "created_at": "2021-12-02T00:48:44.293000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "But this simple change is now starting to \"trivially\" deal with quite a lot of stuff.",
        "created_at": "2021-12-02T00:49:03.194000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "And you leave the validators with recess",
        "created_at": "2021-12-02T00:49:06.547000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Ok, I think the easy thing will be to open an actual PR and see pros and cons",
        "created_at": "2021-12-02T00:49:46.429000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I claim this is not hard and the benefits are non trivial",
        "created_at": "2021-12-02T00:50:07.648000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I don't think that there is anything that we could build on the CL that we couldn't do just as easily with existing mechanisms on the EL.  And I don't see a benefit to trying to do so on the CL as it involves new operations and additional complexity.",
        "created_at": "2021-12-02T00:50:08.509000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Well, if there's zero churn on partial withrawals and you can trigger them by a message I'd agree. But currently a single staker that wants to take out it's earnings would have to wait months or the churn. I suppose everyone here is working under the assumption that that churn won't be large if there are partial withrawals",
        "created_at": "2021-12-02T00:53:38.279000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I think it's more a case that churn is irrelevant for partial withdrawals.  If you want to skim off rewards then it has 0 impact on the validator's state.",
        "created_at": "2021-12-02T00:54:30.328000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I understand this, but the mechanism proposed is to wait months for a proposal",
        "created_at": "2021-12-02T00:55:02.052000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "So if you're holding one key you would probably be better off exiting",
        "created_at": "2021-12-02T00:55:28.116000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Probably not, when you include gas fees and the like to move funds around on the EL and submit a new validator.",
        "created_at": "2021-12-02T00:56:14.698000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "But then again, so will pools that have now thousands of validators that can be converted 10-1 into another immediately",
        "created_at": "2021-12-02T00:56:16.505000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "If everyone does it, it won't be immediate and it will also involve losing rewards whilst waiting in the return queue.  I suspect that most would go for an understanding that partial withdrawals, even if it's once every few months, is a better way of doing things than working through the exit and activation queues.",
        "created_at": "2021-12-02T00:57:41.484000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "This will be an economical decision and your point is that the churn will be so bad that it may be better to wait months to take away the excess. This is the very definition of a poor UX",
        "created_at": "2021-12-02T00:58:54.788000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "(An alternative option would be some sort of accounting super-epoch, where withdrawal receipts for all validators with \u003e32ETH and a suitable 0x01 address were created.  Perhaps every month or so.)",
        "created_at": "2021-12-02T00:59:17.637000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I don't think that the beacon chain has responsiveness as one of its major goals.  I'd prefer the proposed system over additional on-chain operations, purely from the technical standpoint of having to create, manage and store them.  Less complexity on the beacon chain should be an overriding factor, given the trust that will be placed in it.",
        "created_at": "2021-12-02T01:01:31.347000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Ok so it will be a fun exercise but I'll open a PR to see technical arguments against it. The loops and chains are just as simple as allowing delegates only for higher validator index. The issue of the deposits are irrelevant as validators become active when they reach 32ETH. And the accounting is performed anyway per epoch. It adds just a uint64 on each validator structure, a space on blocks for the messages and one extra function with signature verification on block processing. It should take me just a few weeks.",
        "created_at": "2021-12-02T01:06:53.613000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "i don't see any technical arguments *for* it, though, outside of validators being able to move their funds around more often.  The beacon chain stopped being a chain with transfers and the like a while back, and I don't see the benefit of attempting to bring that back in when we have the EL that was built for it.\n\n(what happens if one of the validators you delegate to exits?  Can a validator ever change its delegation, and if so what happens to the upstream delegations to it?  It's these types of maintenance operations that will add complexity and pain.)",
        "created_at": "2021-12-02T01:11:39.624000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "But yeah, throw the PR up and we can discuss it there.",
        "created_at": "2021-12-02T01:11:59.857000+00:00",
        "attachments": null
    }
]
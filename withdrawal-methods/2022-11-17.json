[
    {
        "author": ".paulharris",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "i dont suppose anyone has notes on running geth with CL to play with withdrawals?",
        "created_at": "2022-11-17T01:40:20.071000+00:00",
        "attachments": []
    },
    {
        "author": "siladu",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "There's this https://hackmd.io/-7X3aN3KRvOcY2TsDbFcvQ",
        "created_at": "2022-11-17T02:16:49.643000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "that looks pretty awesome! thanks",
        "created_at": "2022-11-17T02:21:56.943000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Feel free to ping me if you feel like you have something ready to be tested. I'm running lodestar now with geth/nethermind/besu successfully past shanghai.",
        "created_at": "2022-11-17T09:45:55.416000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "im stuck trying to connect to geth, so it may be nearing that point",
        "created_at": "2022-11-17T09:46:24.649000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "the main problem i have is teku has a 'minimal' but not an 'interop' like the above describes",
        "created_at": "2022-11-17T09:47:27.034000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Are you trying to get started from a merged genesis ?",
        "created_at": "2022-11-17T09:47:46.192000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "no i basically did the same as the hackmd, with 4 slots per epoch and go through each transition",
        "created_at": "2022-11-17T09:48:14.222000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "but never get the EL doing anything, which im fairly sure is me failing to use geth more than anything",
        "created_at": "2022-11-17T09:48:41.473000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Prysm goes through all the steps as they can't (yet) start from a merged genesis file, however teku can.",
        "created_at": "2022-11-17T09:48:43.273000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "oh! hrm i wonder how i make that work",
        "created_at": "2022-11-17T09:48:57.621000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Got some time now to test things out? I can give you a hand.",
        "created_at": "2022-11-17T09:49:10.006000+00:00",
        "attachments": []
    },
    {
        "author": ".paulharris",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "yep tha'ts my current obsession..",
        "created_at": "2022-11-17T09:49:19.706000+00:00",
        "attachments": []
    },
    {
        "author": "barnabasbusa",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Lets hop into a call.",
        "created_at": "2022-11-17T09:49:28.717000+00:00",
        "attachments": []
    },
    {
        "author": "m.kalinin",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "We can remove `V1` after the fork next to Capella, i.e. after `V3` takes over `V2`. `Vn` supporting all previous versions sounds like unnecessary spec and engineering overhead to me",
        "created_at": "2022-11-17T13:29:31.249000+00:00",
        "attachments": []
    },
    {
        "author": "m.kalinin",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I thought that it is just easier for CL to use `V1` and then completely switch to `V2` once it is available and do not care about block is after or before the fork when CL needs to call `newPayload`.",
        "created_at": "2022-11-17T13:32:15.100000+00:00",
        "attachments": []
    },
    {
        "author": "m.kalinin",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "From the spec perspective, `V2` not backwards compatible to `V1` would be cleaner. And if there is no engineering gain in backwards compatibility then we should not aiming to do so. I don't think supporting two separate versions at the same time is somewhat complicated",
        "created_at": "2022-11-17T13:38:47.318000+00:00",
        "attachments": []
    },
    {
        "author": "ethdreamer",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I also agree this may be the right approach. Something has to delineate which fork the `ExecutionPayload` is deserialized into.\n\nIt's bad design to do it by whether or not some of the fields are null. In the future we might have fields that can reasonably be null without changing the fork.\n\nThe way this is handled in the beacon API is to add a header with the fork info.\nOr if we don't deprecate the different endpoint versions, we know that each endpoint only deserializes into two possible forks.",
        "created_at": "2022-11-17T17:57:24.514000+00:00",
        "attachments": []
    },
    {
        "author": "ethdreamer",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I'm not strictly against making the future endpoints handle all forks so we can deprecate old versions, but I think if we make that decision, we should make the API more explicit about which fork to deserialize into.",
        "created_at": "2022-11-17T17:59:10.064000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "\u003c@539495253418180618\u003e \u003c@291925846556540928\u003e I'm just reading the notes from Ben on the call. I see there's discussion about whether or not we can be stuck if we don't advance the pointer. As I noted in the PR we definitely will get stuck if all validators in the sweep are actually withrawn. If the bound is added then we need to update the pointer, that's a must",
        "created_at": "2022-11-17T18:31:44.306000+00:00",
        "attachments": []
    },
    {
        "author": "ajsutton",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "But if we always use V1 to import Bellatrix blocks we'd have to keep it around forever to support nodes stepwise syncing through Bellatrix. So we can only remove older versions if the new versions can be used in their place.",
        "created_at": "2022-11-17T20:53:54.967000+00:00",
        "attachments": []
    },
    {
        "author": "ethdreamer",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Yes. I agree that's not ideal. I'm saying we could allow the new endpoints to be compatible with all forks, but we should add a field to be explicit about what fork the block belongs to.",
        "created_at": "2022-11-17T20:55:04.796000+00:00",
        "attachments": []
    },
    {
        "author": "ajsutton",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Yeah I'm happy to have a field defining the milestone if that's helpful.  The CL should always know what milestone it expects based on the slot involved (and it always initiates calls so I think that works pretty neatly).  The EL though would have to parse out the timestamp from newPaylad requests and forkchoiceUpdated probably can't know reliably. So yeah, a field would very likely be useful.",
        "created_at": "2022-11-17T20:56:39.866000+00:00",
        "attachments": []
    },
    {
        "author": "ethdreamer",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "the beacon API already deos this:\n`/eth/v2/beacon/blocks/{block_id}`\n```\n{\n  \"version\": \"phase0\",\n  \"execution_optimistic\": false,\n  \"data\": {\n        ...\n    }\n}\n```",
        "created_at": "2022-11-17T20:56:51.183000+00:00",
        "attachments": []
    },
    {
        "author": "ethdreamer",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Yeah that's one way around this, or including the fork in the `PayloadAttributes` as there is a natural flow:\n`PayloadAttributes`-\u003e`PayloadId`-\u003e`ExecutionPayload`\n\nEither of these would work but they're like hacking around deficiencies in the API instead of just making it explicit which I think is a better option",
        "created_at": "2022-11-17T21:00:54.558000+00:00",
        "attachments": []
    },
    {
        "author": "ajsutton",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "Yep, I'm totally on board with adding a field listing the milestone if it's at all useful and I believe it will be - was just thinking out loud about where it may become needed given we didn't hit any issues with knowing the milestone involved while using V2 for everything on Teku. \n\nMy only real argument is that we have to be able to use the latest version of methods for all blocks - otherwise we can't ever remove old versions and tech debt will just pile up.  Anything that makes that easier I'm good with. ðŸ™‚",
        "created_at": "2022-11-17T21:04:59.118000+00:00",
        "attachments": []
    },
    {
        "author": "ethdreamer",
        "category": "Consensus R\u0026D",
        "parent": "",
        "content": "I'll draft a PR then",
        "created_at": "2022-11-17T21:08:18.251000+00:00",
        "attachments": []
    }
]
[
    {
        "author": "mlettry",
        "category": "Execution Layer",
        "parent": "",
        "content": "Hi all, I had a quick question regarding discv4 and discv5\n\nI am writing my own ~custom node\n\nI have implemented discv4 and it works fine\n\nI have not implemented (and  most probably will not) implement discv5\n\nMy issue is that a lot of nodes are trying to connect to my node using discv5, which ultimately fails\n\nIs there not a way to advertise (say some enr flag) that my node does not accept discv4?\n\nThanks!",
        "created_at": "2025-10-13T11:04:20.476000+00:00",
        "attachments": null
    },
    {
        "author": "cskiraly",
        "category": "Execution Layer",
        "parent": "",
        "content": "Good question. AFAIK there is nothing in the ENR that distinguishes nodes that support discv5 and those that don't.",
        "created_at": "2025-10-13T13:52:24.700000+00:00",
        "attachments": null
    },
    {
        "author": "cskiraly",
        "category": "Execution Layer",
        "parent": "",
        "content": "CL clients are on discv5, and some EL clients also support v5. It would be good if we could move EL clients to v5 and eventually drop v4 support.",
        "created_at": "2025-10-13T13:55:23.122000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Execution Layer",
        "parent": "",
        "content": "is there a way to track which? as far as I know, Geth support is enabled by default, Nethermind support exists but isn't enabled by default, and of the other non-Nimbus EL ones (it supports both) I don't know",
        "created_at": "2025-10-13T14:02:13.599000+00:00",
        "attachments": null
    },
    {
        "author": "cskiraly",
        "category": "Execution Layer",
        "parent": "",
        "content": "We could start with a quick poll here. Then agree on where to go, and track status\n- Geth default: discv4: on ; discv5: on (use `--discovery.v4` , `--discovery.v5` flags to change)",
        "created_at": "2025-10-13T14:12:29.276000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Execution Layer",
        "parent": "",
        "content": "- Nimbus EL: both v4 and v5 supported and enabled by default. Flags are `--discovery=v4`, `--discovery=v5`, and `--discovery=v4,v5` depending on goal",
        "created_at": "2025-10-13T14:20:43.404000+00:00",
        "attachments": null
    },
    {
        "author": "mlettry",
        "category": "Execution Layer",
        "parent": "",
        "content": "Nice thanks both for the clarification!",
        "created_at": "2025-10-13T16:01:30.984000+00:00",
        "attachments": null
    },
    {
        "author": "cskiraly",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@741651225576996935\u003e , what about Besu?\n- Is there discv5 support?\n- Is it on by default?\n- Do you share the same discovery codebase with CL?",
        "created_at": "2025-10-13T16:15:24.998000+00:00",
        "attachments": null
    },
    {
        "author": "fab_10",
        "category": "Execution Layer",
        "parent": "",
        "content": "support for discv5 is a WIP https://github.com/hyperledger/besu/issues/4089, and yes the codebase is shared with Teku",
        "created_at": "2025-10-13T16:40:04.448000+00:00",
        "attachments": null
    },
    {
        "author": "cskiraly",
        "category": "Execution Layer",
        "parent": "",
        "content": "\u003c@654267572107083777\u003e Is there a \"usual place\" where we do such trackers?",
        "created_at": "2025-10-13T17:01:32.231000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution Layer",
        "parent": "",
        "content": "I really want to turn off discv4 by default",
        "created_at": "2025-10-13T17:47:10.099000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution Layer",
        "parent": "",
        "content": "the only reason we still have it at all in Geth is to support clients which are not running v5",
        "created_at": "2025-10-13T17:47:23.703000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution Layer",
        "parent": "",
        "content": "we are now at the point where all major clients have v5 implemented",
        "created_at": "2025-10-13T17:47:49.240000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Execution Layer",
        "parent": "",
        "content": "so it would be good to decide the timeline of shutting down v4",
        "created_at": "2025-10-13T17:48:07.796000+00:00",
        "attachments": null
    }
]
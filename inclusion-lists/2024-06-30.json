[
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "The following combo I've already had with \u003c@725415098331430932\u003e and \u003c@486501030046203915\u003e now on Twitter lol, so putting here some rehashed thoughts about the only way that I think FOCIL works on ePBS:\n1. During slot N, the builder reveals a payload for N at 6 seconds (to be corrected in point 4 and 6 below)\n2. During slot N+1, at 0 seconds, two things are happening:\n    2.a) The proposer of N+1 is gathering bids for N+1 and preparing its consensus block. \n    2.b) The IL committee is preparing an inclusion list. **This IL consists of transactions that need to be included by N+2**.\n    In both cases the proposer and the IL committee have had 6 seconds to validate the payload and submit the IL.  I'm only analyzing the happy case, already have in mind a bunch of edge cases when payload is reorged. \n3. At 3 seconds into N+1, attesters of N+1 attest to the correctness of the N+1 CL block, this includes the correctness of the N payload.  (to be corrected in point 5 below)\n4. At 6 seconds during N+1 the builder of N+1 reveals its payload and also an IL aggregate. Some of the transactions from this aggregate may have been invalidated by the block he is revealing right now. \n5. At 3 seconds  into N+2 the attesters of N+2 attest to the correctness of the N+2 CL block, this includes the correctness of the N+1 paylaod **and the correctness of the IL aggregate sent by the N+1 builder**. \n4. At 6 seconds during N+2, the builder of N+2 **needs to satisfy the aggregate that was broadcast by the N+1 builder**\n\nI do not think variants where the proposer submits the IL aggregate work without adding an extra 6 seconds delay.",
        "created_at": "2024-06-30T20:56:37.353000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cpotuz0\u003e Ohhh this is really weird, the Telegram bot has a bug and it actively changes messages. Point #6 renders as 4 in TG.",
        "created_at": "2024-06-30T21:00:20.779000+00:00",
        "attachments": []
    },
    {
        "author": "bridge-bot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003cpotuz0\u003e Now I'm paranoid and I wonder how many messages this thing changes lol. anyway, leaving this channel to avoid getting repeated pings.",
        "created_at": "2024-06-30T21:01:16.364000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Cross-layer",
        "parent": "",
        "content": "The IL committee can prepare and disseminate their local lists much earlier than `(N+1, t = 0)`. They can do so as soon as the builder of `N` has revealed their payload.",
        "created_at": "2024-06-30T21:07:04.069000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003e Some of the transactions from this aggregate may have been invalidated by the block he is revealing right now.\nnot sure I understand this part",
        "created_at": "2024-06-30T21:07:26.578000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "No, they need to know their tx are executable, i fyou do this then you are now putting the requirement that the EL has to be executed fast for validators, which is something that ePBS has removed completely. 6 seconds is the minimum requirement on ePBS for the next proposer. Losing this because of ILs is a big loss",
        "created_at": "2024-06-30T21:08:14.720000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "The aggregate is prepared after seeing N, but before seeing N+1, some of the transactions in this aggregate were executable after N, but may not be after N+1",
        "created_at": "2024-06-30T21:09:05.428000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Cross-layer",
        "parent": "",
        "content": "Ok hence the alternative of making them disseminate the local ILs at `(N+1, t=0)`, and get the builder to include `IL_agg`",
        "created_at": "2024-06-30T21:12:23.832000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Cross-layer",
        "parent": "",
        "content": "But that only works with slot auctions then",
        "created_at": "2024-06-30T21:12:47.357000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "that works with block auctions just as well",
        "created_at": "2024-06-30T21:12:58.592000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "the IL is to be satisfied at N+2",
        "created_at": "2024-06-30T21:13:07.553000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Cross-layer",
        "parent": "",
        "content": "No it should apply for block `N+1`, if it is built \"on the head\" of `N`, otherwise there is this issue of tx invalidation",
        "created_at": "2024-06-30T21:13:45.149000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "no, that doesn't work neither with block auctions for obvious reasons, but also for slot auctions: the IL committee reveals at t=0 for N+1 and the block with the committment as well, so the slot buyer may be buying a slot **for which he can't produce a block** if the IL forces him to include transactions they don't want to include",
        "created_at": "2024-06-30T21:14:48.598000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "you can't really design an IL mechanism that does not allow the builder to say I won't even bid in this slot",
        "created_at": "2024-06-30T21:15:12.197000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "And yes, what I have been saying for days is that FOCIL as is, on ePBS has always the same problem of tx invalidation of 7547",
        "created_at": "2024-06-30T21:15:52.479000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Cross-layer",
        "parent": "",
        "content": "Hmm ok I see that. It would be better for the builder to know what the constraints are before they bid, but it's perhaps not a fatal issue. I'll think about that one more",
        "created_at": "2024-06-30T21:18:56.712000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Cross-layer",
        "parent": "",
        "content": "It's not the same problem per se, in that 7547 is such that the IL is built without the knowledge of `N`, while in FOCIL you do know `N`",
        "created_at": "2024-06-30T21:19:26.807000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Cross-layer",
        "parent": "",
        "content": "https://ethresear.ch/t/fork-choice-enforced-inclusion-lists-focil-a-simple-committee-based-inclusion-list-proposal/19870#account-abstraction-accounting-18",
        "created_at": "2024-06-30T21:19:37.792000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "in  both cases the IL is built with the same knowledge: in the description above I gave, the IL for N+2 knows the block N before being constructed. In 7547, the proposer of N+1 would reveal the IL (it's exactly as FOCIL with m=1 and the committe == proposer)",
        "created_at": "2024-06-30T21:20:46.116000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "I still think that FOCIL is better than 7547 in the sense that the construction is decentralized. But it loses one of the nice feature which is the compatibility with AA",
        "created_at": "2024-06-30T21:21:21.879000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Cross-layer",
        "parent": "",
        "content": "I am just trying to use consistent naming, FOCIL is not built \"forward\" (without knowledge of `N`), it is built \"spot\" (with knowledge of `N`). You can talk about forward FOCIL if you want, it's just not the construction I am trying to achieve (maybe what I want is not possible given the trade-offs we're willing to make, but that's separate).",
        "created_at": "2024-06-30T21:22:46.554000+00:00",
        "attachments": []
    },
    {
        "author": "barnabemonnot",
        "category": "Cross-layer",
        "parent": "",
        "content": "(tuning off for now but will catch up tomorrow ðŸ™‚ )",
        "created_at": "2024-06-30T21:24:42.601000+00:00",
        "attachments": []
    },
    {
        "author": "potuz",
        "category": "Cross-layer",
        "parent": "",
        "content": "Ok whatever naming you want to put to the algorithm I described above in points 1-6 I think that is the only thing that is similar to FOCIL then and that it works with ePBS. that algorithm above, if you set the committee to be 1 member and set it to be the proposer, is equal to 7547. If you want to do that on top of that the IL should be satisfied in the same slot, then I think that's a fatal problem for the builder. If you can solve that then we decide on mechanisms. But I find it hard to believe there will be a solution for a committee and not 7547",
        "created_at": "2024-06-30T21:25:28.941000+00:00",
        "attachments": []
    }
]
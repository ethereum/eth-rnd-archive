[
    {
        "author": "nc1234",
        "category": "Cross-layer",
        "parent": "",
        "content": "\u003c@363800010518822915\u003e I think Prysm is not updating `state.fork.epoch` correctly on `eip7805` fork activation. I am running \n```\nelectra_fork_epoch: 1\nfulu_fork_epoch: 2\neip7805_fork_epoch: 3\n```\nSo by slot 96, the beacon state should have `state.fork.epoch = 3` to indicate the first epoch of the latest hard fork. But I checked the state and it is still showing `2`:\n\n```\ngenesis_time: '1739866001'\ngenesis_validators_root: '0x92d4b4030504d606f5151abcef1deca16d90d5a4d9249e2f3e70f5020e6cb526'\nslot: '96'\nfork:\n  previous_version: '0x60000038'\n  current_version: '0x70000038'\n  epoch: '2'\n...\n```",
        "created_at": "2025-02-18T08:46:45.430000+00:00",
        "attachments": null
    },
    {
        "author": "nc1234",
        "category": "Cross-layer",
        "parent": "",
        "content": "Also I believe the previous and current version is wrong. According to kurtosis constants https://github.com/ethpandaops/ethereum-package/blob/03bb449cfd327e55188fb1ff4407c4b75606b911/src/package_io/constants.star#L122 , previous_version should show `0x70000038` and current_version should show `0x90000038`",
        "created_at": "2025-02-18T08:57:54.192000+00:00",
        "attachments": null
    },
    {
        "author": "nflaig",
        "category": "Cross-layer",
        "parent": "",
        "content": "does it make sense to test focil on top of fulu right now? we might not wanna do that yet until peerdas is more stable",
        "created_at": "2025-02-18T10:04:48.291000+00:00",
        "attachments": null
    },
    {
        "author": "marchhill",
        "category": "Cross-layer",
        "parent": "",
        "content": "Hey I have a minor spec question about FOCIL, for this endpoint `engine_getInclusionList` maybe we should change the name to `engine_getInclusionListV1`? This is generally what we do for other enginerpc endpoints",
        "created_at": "2025-02-18T11:17:24.077000+00:00",
        "attachments": null
    },
    {
        "author": "nc1234",
        "category": "Cross-layer",
        "parent": "",
        "content": "Where did you see without v1? The spec here has v1 https://github.com/ethereum/execution-apis/pull/609",
        "created_at": "2025-02-18T12:53:08.591000+00:00",
        "attachments": null
    },
    {
        "author": "marchhill",
        "category": "Cross-layer",
        "parent": "",
        "content": "In the EIP itself it doesn't have the V1. I wasn't actually aware of this PR, maybe this could also be linked to in the EIP. Does this spec supersede the original one, so` engine_forkchoiceUpdated` change is replaced with `engine_updatePayloadWithInclusionListV1`? If so why this change? CC \u003c@845691100072509460\u003e",
        "created_at": "2025-02-18T13:02:45.054000+00:00",
        "attachments": null
    },
    {
        "author": "terencechain",
        "category": "Cross-layer",
        "parent": "",
        "content": "Thanks for the report, I'll debug this today",
        "created_at": "2025-02-18T14:21:40.319000+00:00",
        "attachments": null
    },
    {
        "author": "jih2nn",
        "category": "Cross-layer",
        "parent": "",
        "content": "By the time we have inclusion lists, a payload is already in the building process. So we need to update a payload in the building process. But in Geth, a subsequent `engine_forkchoiceUpdated` call just early returns. I haven't checked all other EL clients but this might be the same. Furthermore, changing forkchoice_updated API seems more invasive than adding a new engine API. I wasn't sure about consensus on overloading FCU attribute either.\n\nAdding new engine API was simpler and it works. It's an open decision so we can change to use `engine_forkchoiceUpdated` later, if it turns out to be better.",
        "created_at": "2025-02-18T15:26:02.136000+00:00",
        "attachments": null
    },
    {
        "author": "marchhill",
        "category": "Cross-layer",
        "parent": "",
        "content": "Ok I will look into this, seems like it will require significant changes. Would be good to merge this into the EIP so others don't miss this change, and to generally iron out this part of the spec",
        "created_at": "2025-02-18T16:33:42.700000+00:00",
        "attachments": null
    }
]
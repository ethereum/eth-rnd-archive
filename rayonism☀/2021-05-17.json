[
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Hey guys, I want to test the les/catalyst integration and want to sync up a new beacon node. But looks like the beacon node(`lighthouse`) always read some state from somewhere(I have already deleted the `--datadir` directory) and push the `10087` block to my eth1 node, it should be block `1`.",
        "created_at": "2021-05-17T09:33:12.706000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Any tips where I can delete the historical database?",
        "created_at": "2021-05-17T09:33:39.319000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "are you running lighthouse with tips from http://github.com/protolambda/mergenet-tutorial?",
        "created_at": "2021-05-17T10:07:09.635000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "what is the exact command you use?",
        "created_at": "2021-05-17T10:07:49.068000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "```\nlighthouse --datadir ./rayonism_light_beacon --testnet-deposit-contract-deploy-block 0 --testnet-genesis-state ./genesis.ssz --testnet-yaml-config ./eth2_config.yaml --debug-level=info beacon_node --enr-tcp-port=10000 --enr-udp-port=10000 --port=10000 --discovery-port=10000 --eth1 --eth1-endpoints \"http://localhost:7777\" --http --http-address 0.0.0.0 --http-port 14000 --metrics --metrics-address 0.0.0.0 --metrics-port \"18000\" --listen-address 0.0.0.0 --boot-nodes enr:-KG4QAot7X6xLDriqiOpDx9SsoGyDa_IOEaMyibfGxSnSwGNSRU49YJDkluFuw-bqO3EpYiLCBJkfp5JTEcoh6XA6UQDhGV0aDKQ6PqIZwAABwL__________4JpZIJ2NIJpcIQS3eH5iXNlY3AyNTZrMaEDzOz7QvfIbJC2iYzO1E0H_EkoA7Rr3cXK88CHRFl2bTODdGNwgiMog3VkcIIjKA\n```",
        "created_at": "2021-05-17T10:13:43.659000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I have one beacon node, it's running well.",
        "created_at": "2021-05-17T10:13:57.881000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And actually I successfully setup another beacon node a few days ago. And it synced around 10k blocks. And I closed it.",
        "created_at": "2021-05-17T10:14:32.080000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But looks like the lighthouse will still read some data from somewhere. And feed my eth1 node the `10087` block.",
        "created_at": "2021-05-17T10:14:58.384000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The Lighthouse prototype doesn't do backfills for the eth1 node I believe. If the Lighthouse node is synced to 10087 already, then it may be doing that",
        "created_at": "2021-05-17T10:18:14.837000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yes, but I already deleted the `--datadir` directory.",
        "created_at": "2021-05-17T10:18:45.131000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So my question is what else I should delete for a fresh new node",
        "created_at": "2021-05-17T10:19:04.053000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Hmm, it should sync then. Maybe it's using a different data dir, maybe the default? ~~I don't see the option in your command~~ Edit: I'm blind",
        "created_at": "2021-05-17T10:19:48.958000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "```\nMay 17 18:21:38.929 INFO Lighthouse started                      version: Lighthouse/v1.3.0-82344f9\nMay 17 18:21:38.929 INFO Configured for network                  name: custom loaded from ./eth2_config.yaml\nMay 17 18:21:38.929 INFO Data directory initialised              datadir: ./rayonism_light_beacon\nMay 17 18:21:38.933 INFO Deposit contract                        address: 0x4242424242424242424242424242424242424242, deploy_block: 0\nMay 17 18:21:38.963 INFO Hot-Cold DB initialized                 split_state: 0xf5964a4fc3895e9ffeca32f143798203cb0ce8c387300490828cf8ef6215036c, split_slot: 12768, version: 3, service: freezer_db\nMay 17 18:21:38.965 INFO Starting beacon chain                   method: resume, service: beacon\nMay 17 18:21:40.618 INFO Block production enabled                method: json rpc via http, endpoints: [\"http://localhost:7777/\"]\nMay 17 18:21:40.666 INFO Beacon chain initialized                head_slot: 12855, head_block: 0x0dbfâ€¦b294, head_state: 0xe8f5â€¦fc7a, service: beacon\nMay 17 18:21:40.666 INFO Timer service started                   service: node_timer\nMay 17 18:21:40.666 INFO UPnP Attempting to initialise routes    service: UPnP\nMay 17 18:21:40.667 INFO Libp2p Service                          peer_id: 16Uiu2HAmQdsKN8nadDV1txuacrxmqfRNK1Jsf9AEHafEiCuTyEc1, service: libp2p\nMay 17 18:21:40.667 INFO ENR Initialised                         tcp: Some(10000), udp: Some(10000), ip: None, id: 0x3b55..218c, seq: 1, enr: enr:-Kq4QHSs88x0HHJyO6mzCM1K05x8i6h2rr74MlWbua5GatPiWrfSeORc2Ni2Xbwstcz281IS4iXVqn3_RJj0culI3XsBh2F0dG5ldHOIAAAAAAAAAACEZXRoMpDo-ohnAAAHAv__________gmlkgnY0iXNlY3AyNTZrMaEDsgK1uWwbyWrTmoFU3bOPdW_EgDcAq6QXzi-Fe4mJM-KDdGNwgicQg3VkcIInEA, service: libp2p\n```",
        "created_at": "2021-05-17T10:22:32.871000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "`May 17 18:21:38.963 INFO Hot-Cold DB initialized                 split_state: 0xf5964a4fc3895e9ffeca32f143798203cb0ce8c387300490828cf8ef6215036c, split_slot: 12768, version: 3, service: freezer_db`",
        "created_at": "2021-05-17T10:22:48.977000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The \"split\" is between cold (frozen, finalized, whatever you want to call it) and hot data.",
        "created_at": "2021-05-17T10:26:05.119000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So that data dir is not fresh",
        "created_at": "2021-05-17T10:26:20.234000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Meanwhile, \u003c@!402853454126776320\u003e are you going to test this PR https://github.com/ethereum/go-ethereum/pull/22827 ?",
        "created_at": "2021-05-17T10:30:55.788000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!203220829473996800\u003e I set the freezer dir, it works!",
        "created_at": "2021-05-17T10:31:25.964000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!425572898787426305\u003e actually no. Now I am testing the light client part. So that we can run the beacon node + les client as the normal node which only maintains the header chain.",
        "created_at": "2021-05-17T10:32:14.592000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "this PR only contains the full node part. I haven't pushed the light client part to this PR. This one is already big enough, I will prefer to open another one for light client when this one get merged",
        "created_at": "2021-05-17T10:33:52.982000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I see, thanks. Have you tried full node on Nocturne yet?",
        "created_at": "2021-05-17T10:34:38.255000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, since the devnet launch",
        "created_at": "2021-05-17T10:34:50.186000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And it's still running",
        "created_at": "2021-05-17T10:35:05.724000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Sounds great! I am digging into this PR now to understand what changes it brings. Do you have state downloader check in plans?",
        "created_at": "2021-05-17T10:38:35.675000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "In this PR, the transition is also handled. And the block processing is divided into two steps: execute and set head. The missing part is reverse synchronization and the relative trigger.",
        "created_at": "2021-05-17T10:47:30.373000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Peter is working on the sync part.",
        "created_at": "2021-05-17T10:47:38.344000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e The missing part is reverse synchronization and the relative trigger.\nIs this for the block sync?",
        "created_at": "2021-05-17T10:53:08.265000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, block sync and state sync. I think",
        "created_at": "2021-05-17T10:55:48.651000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It is great to have transition code as I am going to work on transition in the post rayonism period. And the fact that we already have it implemented on eth1 side makes it easier",
        "created_at": "2021-05-17T10:59:16.877000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!402853454126776320\u003e to clarify. This PR is running and transition happens on Nocturne with the first `SetHead` received which happens on a block number `1`?",
        "created_at": "2021-05-17T12:09:33.862000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Have you tested block gossip is being turned off?",
        "created_at": "2021-05-17T12:09:56.092000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, the transition happens for the first `SetHead` for block 1.",
        "created_at": "2021-05-17T12:12:08.294000+00:00",
        "attachments": null
    },
    {
        "author": "garyrong",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The block gossip is only turned off when the `FinalisedBlock` event is received.",
        "created_at": "2021-05-17T12:12:34.829000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Sure",
        "created_at": "2021-05-17T12:13:46.110000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Bug with off-by-one voting period happens each time Teku votes first. And apparently it's not about fetching blocks/deposits but related to some error in the voting behaviour. Will try to reproduce",
        "created_at": "2021-05-17T12:32:45.111000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It'd be nice if we could corroborate what \u003c@!489217181104734219\u003e checked by running the latest prysm merge branch: that it does indeed fix the eth1 data behaviour. It seems that shone's node and mine are the only two prysm nodes that are voting correctly now",
        "created_at": "2021-05-17T13:33:55.494000+00:00",
        "attachments": null
    },
    {
        "author": "schone_wizard",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "sorry i was away, what do you need to know about my node? \u003c@!755590043632140352\u003e",
        "created_at": "2021-05-17T14:54:56.281000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Nothing, if it's voting fine I guess it was the resync that did it",
        "created_at": "2021-05-17T15:14:40.027000+00:00",
        "attachments": null
    },
    {
        "author": "schone_wizard",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "could it have something to do with the fact i used only one catalyst that was shared between lighthouse and prysm?",
        "created_at": "2021-05-17T15:16:10.391000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Reminder: office hour call in 1 hour from now. We'll discuss the final things we want to do on Nocturne, and when exactly we'll shut it down (likely this Tue or Wed.).\n\nAlso, we'll look forward to some of the next post-rayonism work; the Merge work continues outside of rayonism, with  a separated consensus API endpoint, and merge transition spec. During that same time, more client resources can focus on Altair/London, and we plan to rebase the Merge work on those updates next. The rayonism project itself will narrow down the scope, so we can focus on the remaining tasks; testing the withdrawals prototype, and continued Sharding work.",
        "created_at": "2021-05-17T16:06:12.502000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Call notes:\n- Nocturne testnet will close this Wed, 12pm UTC (noon). Exactly one week after it started. Thanks everyone for participating!\n- Next steps for Merge: API format and Merge transition spec. We should write down some concrete proposals for the format. REST-JSON and JSON-RPC share the same Json problems for block encoding, and there were previous arguments against gRPC. My proposal is to make more use of the Http header feature to use a binary format when suitable.",
        "created_at": "2021-05-17T17:46:03.544000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "About my JSON REST HTTP proposal: similar to the beacon-state API in the eth2 client, a client can specify which format the inputs and outputs are (Content-type and Accept headers). JSON can be the default everywhere, is nice for debugging, and is fine for 3/4 methods in request format (changing head, changing finality, requesting a block, json works). And fine for 3/4 methods as response format (confirming head was changed, confirming finality was changed, confirming a block was inserted). The block insertion payload, and block retrieval payload would be better to be in binary for efficiency, although not strictly required. So when you want to retrieve/submit an execution payload, we can change the `Content-Type` or `Accept` header to encode it in some binary format (SSZ would work).",
        "created_at": "2021-05-17T17:50:26.482000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It's impressive, since this whole thing started, never managed to listen to a single call, and I even voted for the schedule ðŸ˜‚",
        "created_at": "2021-05-17T23:16:52.592000+00:00",
        "attachments": null
    }
]
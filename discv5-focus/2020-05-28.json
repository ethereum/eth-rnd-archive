[
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!449019668296892420\u003e any news about your QUIC idea?",
        "created_at": "2020-05-28T13:03:18.634000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So who's going to walk through the discv5 protocol to ensure that a multiaddr is sufficient to enter into the protocol with another node?",
        "created_at": "2020-05-28T14:55:56.433000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So I think in part the difficulty comes in the following scenario. Consider Node A has an unsigned ENR or multiaddr of node B and tries to connect. \nA -\u003e Random -\u003e B\nB -\u003e WhoAreYou -\u003e A\nA -\u003e AuthMessage + LocalENR -\u003e B (B has A's ENR, A still only has multi addr and session is established) \nA -\u003e Packets -\u003e B\nA still doesn't have an ENR and shouldn't add B to routing table. If ENR seq start at 0. During a PING A needs to say which seq no it has for B, but it has none. If it says 0, B may not reply right. It could guess a number. \nWe then have sessions established some of which potentially we dont know ENR's of peers.",
        "created_at": "2020-05-28T14:59:41.692000+00:00",
        "attachments": null
    },
    {
        "author": "dryajov",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "shouldn't B's ENR be made mandatory then? A -\u003e Packets -\u003e B, (B -\u003e ENR -\u003e A, [B -\u003e Packets -\u003e A]*), else disconnect",
        "created_at": "2020-05-28T15:03:21.763000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If A is required to have an ENR to connect to B then we dont (if we want to connect via multiaddr, we would need some way to retrieve the ENR  as you suggest)",
        "created_at": "2020-05-28T15:05:01.748000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The wire protocol doesn't forbid using a mulitaddr/enode, although I tried something similar previously but it didnt work. Like you guys have mentioned though it would be odd to have only 2 peers perform a succesful handshake but only 1 peer has the other's ENR",
        "created_at": "2020-05-28T15:13:28.748000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I understand the issue now",
        "created_at": "2020-05-28T15:26:29.475000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ENR seq 0 is special",
        "created_at": "2020-05-28T15:26:40.255000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If you want a node's ENR, just send FINDNODE(0)",
        "created_at": "2020-05-28T15:27:23.097000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This is something you can add in your implementation to resolve this issue: if your local reference to the node is an 'unsigned' ENR you created from the multiaddr, just request the remote ENR after handshake and you'll have the real one.",
        "created_at": "2020-05-28T15:28:46.543000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "In WHOAREYOU, sequence number zero means the same as 'I don't have your ENR'",
        "created_at": "2020-05-28T15:30:11.996000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Sure. This seems do-able. In the rust impl sending messages and establishing sessions require the node's ENR. In principle this could be relaxed to ip/port/key. Does go currently require ENR's to send messages?",
        "created_at": "2020-05-28T15:32:40.316000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Kind of. The Go abstraction for ENR goes like this:",
        "created_at": "2020-05-28T15:33:40.576000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We have a package p2p/enr for the ENR format",
        "created_at": "2020-05-28T15:33:59.650000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We have another package, p2p/enode, which has a representation of a 'validated' ENR, enode.Node",
        "created_at": "2020-05-28T15:34:49.795000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But we also have other ways of creating enode.Node, i.e. from public key + IP + ports",
        "created_at": "2020-05-28T15:35:37.911000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Most code that works with nodes doesn't really care if it came from a signed ENR or not, but the code that does can find out by checking for it.",
        "created_at": "2020-05-28T15:36:32.546000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "For example, I can insert unsigned nodes into the Kademlia table, I just need to take care to filter them out when responding to discv5 FINDNODE",
        "created_at": "2020-05-28T15:37:50.580000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Oh right. What would be the point of an unsigned node in the table?",
        "created_at": "2020-05-28T15:38:25.406000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It can happen if you insert it locally, because it was passed on the command line",
        "created_at": "2020-05-28T15:38:55.370000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I've built it so the rust type system wont allow it. And there's no such thing as an Unsigned ENR.. only invalid binary junk :p",
        "created_at": "2020-05-28T15:39:02.006000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yeah, we reject it straight up",
        "created_at": "2020-05-28T15:39:32.274000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Like in the case we discussed, I mean. I'm pretty sure there is no issue with it in go",
        "created_at": "2020-05-28T15:39:34.349000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ok cool. Well. I can at least see a solution here, just takes a bit more engineering",
        "created_at": "2020-05-28T15:39:56.600000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ultimately it depends on what you want for users",
        "created_at": "2020-05-28T15:40:09.985000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Afri didn't like working with ENRs because they are super opaque",
        "created_at": "2020-05-28T15:40:29.040000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah, I like ENR's but I can see the frustration they can cause",
        "created_at": "2020-05-28T15:41:07.993000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I originally considered defining a readable text encoding for ENR, but didn't do it because you can't modify them and still keep them valid, and also because most K/V pairs will just be binary data.",
        "created_at": "2020-05-28T15:42:30.157000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "That's why I went with the lazy base64 option",
        "created_at": "2020-05-28T15:42:54.362000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah. Fair call.",
        "created_at": "2020-05-28T15:43:03.463000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I half-implemented ed25519. Its good to hear its on the radar. It would be nice for us if the NodeId matched the PeerId.. i.e we use a multihash. I think we actually just use the pubkey (there's no hashing).",
        "created_at": "2020-05-28T15:43:58.952000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yeah, I'll look into it.",
        "created_at": "2020-05-28T15:44:52.632000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I was thinking we could just go with sha256 of the key",
        "created_at": "2020-05-28T15:45:37.479000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think it won't matter. Because we can convert a PeerId to the public key and hence a NodeId whatever the function.",
        "created_at": "2020-05-28T15:45:42.332000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The hash needs to be in there because ID distribution must be uniform, and public keys usually don't have uniform random distribution",
        "created_at": "2020-05-28T15:46:33.364000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "oh yeah, good point",
        "created_at": "2020-05-28T15:46:46.567000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But maybe ed25519 keys are, ol' Bernstein might've thought of that",
        "created_at": "2020-05-28T15:47:08.512000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Will check next week",
        "created_at": "2020-05-28T15:47:36.542000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ahaha ðŸ¤ž",
        "created_at": "2020-05-28T15:48:33.738000+00:00",
        "attachments": null
    },
    {
        "author": "agemanning",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'm off. Cheers \u003c@!194432762315407360\u003e",
        "created_at": "2020-05-28T15:48:48.133000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Have fun :)",
        "created_at": "2020-05-28T15:50:07.304000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003e Curve25519 is constructed such that it avoids many potential implementation pitfalls.[6] By design, it is immune to timing attacks and it accepts any 32-byte string as a valid public key",
        "created_at": "2020-05-28T16:31:02.979000+00:00",
        "attachments": null
    },
    {
        "author": ".fjl",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Looks they did think of that actually",
        "created_at": "2020-05-28T16:31:26.353000+00:00",
        "attachments": null
    }
]
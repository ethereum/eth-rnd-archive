[
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "\u003e I just reorganized some nodes. Can you check again?\n\u003c@!557201004060213248\u003e \n\nok so i pulled down the latest changes and there are definitely still a lot of nodes on the wrong fork.  I can see some overlap between peers being discovered in topaz and schlesi...",
        "created_at": "2020-04-28T00:07:02.144000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "i think some of the peers are appearing in both testnets.  lemme see if i can prove it.  I am pretty sure i have seen: 16Uiu2HAkvLCWwVEfF365ZWXB6siDL1mUpcd1XQ1nSXAHmvM5W7wn in both topaz and schlesi",
        "created_at": "2020-04-28T00:08:46.290000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "i have a little tool to crawl these testnets.  i added fork_digest.  i see a lot of peers with the topaz fork-digest",
        "created_at": "2020-04-28T00:29:02.696000+00:00",
        "attachments": [
            {
                "type": "",
                "origin_name": "schlesi-peers.txt",
                "content": "9eaedd7dc1977b480e6fecddcd7aac298a190a52e5db84b07078fa07e170ee30"
            }
        ]
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "i'm also seeing schlesi-peers on topaz",
        "created_at": "2020-04-28T00:31:25.457000+00:00",
        "attachments": [
            {
                "type": "",
                "origin_name": "topaz-peers.txt",
                "content": "7741ac662726a40f1bcd9aa4f1d4f4f5472ab3ee5d8e59d9197405b5b25958cb"
            }
        ]
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "Thats interesting...",
        "created_at": "2020-04-28T00:34:35.628000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "i can definitely see how this could easily happen, but it is annoying in some respects if we don't want to cross pollinate peers.",
        "created_at": "2020-04-28T00:34:38.012000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "Would explain the wierd fork digests i had been seeing",
        "created_at": "2020-04-28T00:35:10.644000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "In topaz",
        "created_at": "2020-04-28T00:35:19.030000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "ya, i started seeing peers in topaz today that i could have sworn i saw in schlesi",
        "created_at": "2020-04-28T00:35:40.969000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Testing",
        "parent": "",
        "content": "I thought discv5 was supposed to share one big distributed state of peers for lots of things, then pick the ones you care about via ENR (hence the eth2 field).",
        "created_at": "2020-04-28T00:36:13.652000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "ya",
        "created_at": "2020-04-28T00:36:29.330000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "but im wondering what the big advantage is",
        "created_at": "2020-04-28T00:36:54.650000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "it would be nice if we could choose to not save/share peers originating a different genesis",
        "created_at": "2020-04-28T00:36:58.270000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "I guess it was although i dont think the above happening was fully intentional lol",
        "created_at": "2020-04-28T00:37:52.614000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "The prysm nodes might still be connected to the topaz bootnode",
        "created_at": "2020-04-28T00:38:17.512000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "Which would explain the cross pollination",
        "created_at": "2020-04-28T00:38:40.378000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Testing",
        "parent": "",
        "content": "It only takes one node to connect the networks and you're pretty permanently cross pollinated I'd expect.",
        "created_at": "2020-04-28T00:38:51.410000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "it's possible that they are caching the ENRs, then when the testnet is switched...loading the ENRs from the othertestnet and sharing htem",
        "created_at": "2020-04-28T00:39:06.239000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "\u003e It only takes one node to connect the networks and you're pretty permanently cross pollinated I'd expect.\n\u003c@!340345049063882753\u003e \n\nexactly...it's like a virus",
        "created_at": "2020-04-28T00:39:27.306000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Testing",
        "parent": "",
        "content": "It's a good real world test to be able to find good peers among a sea of utter rubbish though.  That's exactly what discovery on ETH1 is like.",
        "created_at": "2020-04-28T00:39:43.992000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "we just want to make sure that we aren't counting peers with the wrong fork_digest towards the max_peer count",
        "created_at": "2020-04-28T00:40:31.694000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "Yeap, its pretty much permanent now . Topaz and schlesi nodes will have each other's enrs now",
        "created_at": "2020-04-28T00:43:03.516000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "\u003e we just want to make sure that we aren't counting peers with the wrong fork_digest towards the max_peer count\n\nWe only count peers with which we can succesfully performing a handshake with. So off the top of my head there are roughly 300 peers in topaz",
        "created_at": "2020-04-28T00:44:16.984000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "Not too sure about schlesi",
        "created_at": "2020-04-28T00:44:32.291000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "you can handshake with peers using a different fork_digest, right?",
        "created_at": "2020-04-28T00:46:48.929000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "A peer with a different digest could open a tcp stream with us and perform a handshake with us. But once we receive their status request, we would disconnect with them due to the different fork digests",
        "created_at": "2020-04-28T00:48:36.806000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "\u003e i think some of the peers are appearing in both testnets.  lemme see if i can prove it.  I am pretty sure i have seen: 16Uiu2HAkvLCWwVEfF365ZWXB6siDL1mUpcd1XQ1nSXAHmvM5W7wn in both topaz and schlesi\n\u003c@!604062686623432740\u003e I'm not running any topaz nodes and I don't think anyone shares my private networking keys. So this might be a bug?",
        "created_at": "2020-04-28T08:52:01.892000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "is there anything we can do to prevent that?",
        "created_at": "2020-04-28T08:53:03.900000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "\u003e or just in general it being an inconvenience dealing with ENRs?\n\u003c@!604062686623432740\u003e Yes, it's a complete mess. There is no way to tell the node which IP to put in the ENR and for some reason it sometimes decides to revert back to the private IP which keeps messing with my bootnodes.",
        "created_at": "2020-04-28T08:54:15.604000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "It would be nice if the ENR at least kept previous known IP addresses and peers could check wether they are available or not",
        "created_at": "2020-04-28T08:55:06.059000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "Or have some logic in the peers to always prefer public IPs over private IPs",
        "created_at": "2020-04-28T08:55:40.525000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "For me as a node operator, it's a constant pain. I keep rewiring nodes manually even though this should be the most basic task of each client - to figure out where the peers are",
        "created_at": "2020-04-28T08:56:16.179000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "And I blame ENR that I cannot simply tell my node that the IP address of that node with this ENR is different than what the ENR tells them",
        "created_at": "2020-04-28T08:56:48.866000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "I seriously don't see any advantage of ENR. ETH1 worked without ENR for 5 years, all you need to connect two peers was pubkey, ip, and port.",
        "created_at": "2020-04-28T08:57:40.908000+00:00",
        "attachments": null
    },
    {
        "author": "deme1744",
        "category": "Testing",
        "parent": "",
        "content": "So I noticed that two of the bootnodes here https://github.com/goerli/schlesi/blob/master/prysm/bootstrap_nodes.txt have local addresses. Is that intentional (like for testing from local ranges?)?",
        "created_at": "2020-04-28T09:53:36.563000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "I'm unable to force the client to use the public IP \u003c@!510413979080720385\u003e - see \u003c#646778960830660623\u003e for discussion",
        "created_at": "2020-04-28T10:44:35.309000+00:00",
        "attachments": null
    },
    {
        "author": "deme1744",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!557201004060213248\u003e fyi, I can confirm that the updated ENRs work.",
        "created_at": "2020-04-28T13:18:49.031000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "thanks",
        "created_at": "2020-04-28T13:59:07.076000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "\u003e \n\u003e \u003c@!604062686623432740\u003e I'm not running any topaz nodes and I don't think anyone shares my private networking keys. So this might be a bug?\nIt's not a bug.  I was just surprised that this happened already.",
        "created_at": "2020-04-28T15:12:10.598000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "Ah yes, I checked my node's configurations and they do indeed talk to the default prysm bootnode. So this might be the reason why they get populated.",
        "created_at": "2020-04-28T15:14:48.157000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "It would be nice to have some kind of abstraction for networks in Prysm. Currently it's designed to serve only one chain.",
        "created_at": "2020-04-28T15:15:21.348000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "\u003e \u003c@!604062686623432740\u003e Yes, it's a complete mess. There is no way to tell the node which IP to put in the ENR and for some reason it sometimes decides to revert back to the private IP which keeps messing with my bootnodes.\n\n\nI understand.   In lighthouse (for example) you should be able to specify the ip-address to begin with with the --listen-address flag.  If you are worried about the enr switching to a private ip then you can set the --enr-update flag to false.",
        "created_at": "2020-04-28T15:16:27.853000+00:00",
        "attachments": null
    },
    {
        "author": "jonny.derp",
        "category": "Testing",
        "parent": "",
        "content": "\u003e Ah yes, I checked my node's configurations and they do indeed talk to the default prysm bootnode. So this might be the reason why they get populated.\n\u003c@!557201004060213248\u003e \n\n\nAh...so even if you specify your own bootnode it still tries to connect to the deafult one?",
        "created_at": "2020-04-28T15:18:32.230000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "yes. I would have to add the no-default-config flag probably",
        "created_at": "2020-04-28T15:45:24.016000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "Lighthouse allows to pin ENR to a specific IP and freeze it to prevent ENR upgrades",
        "created_at": "2020-04-28T15:46:13.217000+00:00",
        "attachments": null
    },
    {
        "author": "donschoe",
        "category": "Testing",
        "parent": "",
        "content": "that's pretty handy",
        "created_at": "2020-04-28T15:46:18.230000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "gregthegreek",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I've slept on this, and im still a bit confused. `eth_estimateGas` returns how much gas will be needed to execute the transaction, why should it care about the gasPrice? It seems like those concerns should be seperated",
        "created_at": "2021-06-24T14:18:01.075000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@322222239850168331\u003e `gasPrice` can be accessed in the tx via the op code, so when explicitly define it it becomes part of the execution context, which is validated against 1559 rules",
        "created_at": "2021-06-24T14:26:49.322000+00:00",
        "attachments": null
    },
    {
        "author": "gregthegreek",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "`eth_estimateGas` is for estimating total gas usage, `eth_gasPrice` is for the `gasPrice`, so im referring to the estimation of the gas usage",
        "created_at": "2021-06-24T14:35:57.376000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think lightclient's point is since your `eth_estimateGas` request included the `gasPrice` field, and that field is accessible via the `GASPRICE` opcode then it needs to be a valid 1559 value for the tx to be accurately simulated to derive a reasonable gas usage estimate.  Otherwise you are asking the EVM to simulate the gas usage of a tx that will never actually be executed (since a tx with gasprice lower than the current base fee will never be mined).  If the RPC did simulate the tx w/o that constraint then it might give totally incorrect estimates depending on whether or not the tx called code that used the `GASPRICE` opcode.",
        "created_at": "2021-06-24T16:39:52.922000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(mainly paraphrasing to make sure *I* understand what's going on, please correct me if I got anything wrong! )",
        "created_at": "2021-06-24T16:40:35.254000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Even if the tx isn't in 1559 format (e.g. is a legacy tx) it still needs to be executed/simulated in a post-1559 execution context, since all txs are beholden to the base fee.",
        "created_at": "2021-06-24T16:43:16.713000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Tangentially related: has there been any discussion to add an override to the current base fee to the possible overrides passed into `eth_call` / `eth_estimateGas`?  I could see a case where someone wants to simulate their tx under different base fees.",
        "created_at": "2021-06-24T16:47:26.336000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "quick question.. we have seen the ropsten gas limit start at the then doubled gas limit of 16MM and in less than one day we are down to 9.6MM... I can only suspect that it is operating as intended as I havent seen folks \"complain\" about it.  that said, I am watching the testing continue (with gas prices now at 2700 gwei)... I would think the gas limit would increase.. am I missing something?",
        "created_at": "2021-06-24T18:20:11.016000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "is there a link avail that could outline the intended gas limit changes?",
        "created_at": "2021-06-24T18:20:32.554000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!496267636082999316\u003e the reason for the gas limit is that miners on Ropsten aren't following the directives listed in here: https://blog.ethereum.org/2021/06/18/london-testnets-announcement/ \n\nre: high fees, there is currently a bot spamming the network to make sure that the 1559 mechanism works as intended",
        "created_at": "2021-06-24T18:23:24.186000+00:00",
        "attachments": null
    },
    {
        "author": "mrabino1",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "so the issue is driven around miners not having doubled their limit.. yes? not sw..",
        "created_at": "2021-06-24T18:25:37.261000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "exactly",
        "created_at": "2021-06-24T18:27:31.122000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "For example, the besu miner on ropsten has double its gas limit target and you can see every block it mines raising the gas limit",
        "created_at": "2021-06-24T18:27:57.836000+00:00",
        "attachments": null
    },
    {
        "author": "gregthegreek",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!552133098075193354\u003e can i have access to the bot? I could use that for some other things ðŸ˜“",
        "created_at": "2021-06-24T19:16:53.555000+00:00",
        "attachments": null
    },
    {
        "author": "gregthegreek",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!388751025789468672\u003e that makes sense, but its still a bit frustrating. So then if the baseFee increases from time of estimation to submission to the mempool will my tx be rejected?",
        "created_at": "2021-06-24T19:27:21.585000+00:00",
        "attachments": null
    },
    {
        "author": "gregthegreek",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!552133098075193354\u003e we talked about htis, how the mempool will disregard txs, does that mean txs under the baseFee will actually be dropped by the mempool and require re-submission?",
        "created_at": "2021-06-24T19:27:58.415000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Itâ€™s open source, \u003c@680337202521440470\u003e can share the exact link",
        "created_at": "2021-06-24T19:31:30.962000+00:00",
        "attachments": null
    },
    {
        "author": "gregthegreek",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "cc: \u003c@!416370369675395072\u003e",
        "created_at": "2021-06-24T19:31:38.107000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I donâ€™t think they drop them by default, but obviously when the txn pool is full, those get dropped first",
        "created_at": "2021-06-24T19:32:13.235000+00:00",
        "attachments": null
    },
    {
        "author": "gregthegreek",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I see, im just thinking about web3.js and whether or not we should pre-populate anything. I think for estimateGas we'll just drop the gasPrice, and let the node handle it.",
        "created_at": "2021-06-24T19:33:41.050000+00:00",
        "attachments": null
    },
    {
        "author": "gregthegreek",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We'll probably also just let the node throw the error for the user if the base fee is too low, rather than be opinionated about it before hand",
        "created_at": "2021-06-24T19:34:05.685000+00:00",
        "attachments": null
    },
    {
        "author": "smixxtape",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Had a quick question, after the London hardfork on Ropsten when a new block header comes in and we fetch certain transactions in those blocks we are seeing an internal error in web3-core-helpers as `gasPrice` appears to be null here: `tx.gasPrice = outputBigNumberFormatter(tx.gasPrice);`\nIf I fetch a transaction that previously threw that error shortly after it has a `gasPrice` so theres no issue, from our logs I can tell that it started immediately after the London hardfork block. It's intermittent though, doesn't happen with all blocks or transactions either. This is happening when calling `web3.eth.getTransaction`",
        "created_at": "2021-06-24T22:09:37.023000+00:00",
        "attachments": null
    }
]
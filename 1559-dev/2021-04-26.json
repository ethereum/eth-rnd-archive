[
    {
        "author": "marekm3498",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yes, we're using 0x04. In source code we have that prefix in:\nP2PMessageCode.AddCapability\nEth62MessageCode.BlockHeaders\nLesMessageCode.GetBlockBodies",
        "created_at": "2021-04-26T09:26:52.806000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Hey guys, could someone help me out? EthereumJS has connected to Aleut, we sync up till block 55 but now we get invalid state root. I think the only parts which could be wrong here are either coinbase or the sender of that EIP1559 transaction. Our gas used is correct, and I manually checked the miner balance and the account balance, they seem correct to me but they probably are not. Could someone report the state of these accounts after executing the block? So the state of these accounts on block 56:\n\n`0xfe3b557e8fb62b89f4916b721be55ceb828dbd73`\n`0x563256a49aaa1e8c985a10bd73222834b3946b54`",
        "created_at": "2021-04-26T10:31:21.141000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Balance for 0xfe is 89999999999937843870800 for us. And the miner gets a tip of 50600",
        "created_at": "2021-04-26T10:33:46.200000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Or if a node could open a RPC endpoint that would also be cool üòÑ",
        "created_at": "2021-04-26T10:35:26.847000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(Can DM me)",
        "created_at": "2021-04-26T10:35:40.175000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We touch this 0x0000..00aaaa account, we delete this account from trie after executing the txs right?",
        "created_at": "2021-04-26T11:37:31.366000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "CC \u003c@!758579010027782144\u003e \u003c@!574864862338088960\u003e",
        "created_at": "2021-04-26T11:52:09.296000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "How do I run Nethermind in aleut mode?",
        "created_at": "2021-04-26T12:19:55.234000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Do you have a documentation for P2PMessageCode.AddCapability somewhere? This is not part of the RLPx spec üôÇ It would be nice to know how to decode this data.",
        "created_at": "2021-04-26T13:26:16.563000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Weird we report the wrong miner",
        "created_at": "2021-04-26T14:30:40.177000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "i think that can happen if the clique seal hash is incorrect?",
        "created_at": "2021-04-26T14:42:33.396000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I pulled the data from turbo geth which seems to sync with both Nethermind and Besu ü§î",
        "created_at": "2021-04-26T15:01:52.931000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "This is clique extra data\n0x00000000000000000000000000000000000000000000000000000000000000004038bec6427396c8f6f4044668543c368ad5acab1eb9d556075816d25ea90b7b17958594cbd8dc5058c280e1286472d784ea89cc92587854cbeae1272567d36400\n\nReported address should be 0x36267c845cc42b57ccb869d655e5d5fb620cc69a",
        "created_at": "2021-04-26T15:02:14.901000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(Which is in fact the only signer available if I'm seeing that correctly)",
        "created_at": "2021-04-26T15:02:37.540000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "that's the signer you're getting?",
        "created_at": "2021-04-26T15:03:33.334000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "No I am getting 0x563256a49aaa1e8c985a10bd73222834b3946b54",
        "created_at": "2021-04-26T15:16:27.031000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But this might have to do with the fact that EIP1559 introduces an extra field on the block",
        "created_at": "2021-04-26T15:16:39.270000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "EIP225 states that this extra field /should/ be hashed to get the right clique hash",
        "created_at": "2021-04-26T15:16:51.728000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "But I can imagine that this is overlooked and instead what is being hashed is not the base fee field, so I will check if that is the case",
        "created_at": "2021-04-26T15:17:02.470000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "(This is the clique EIP)",
        "created_at": "2021-04-26T15:17:27.444000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah wait that's actually what we do üòÇ",
        "created_at": "2021-04-26T15:19:44.009000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "this is how i'm calculating the seal hash: https://github.com/quilt/go-ethereum/blob/259ffe56f42d94c7e4dbb69f5dd69b6e70cbe20e/consensus/clique/clique.go#L714-L738",
        "created_at": "2021-04-26T15:19:51.817000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "`baseFee` as optional element at the end",
        "created_at": "2021-04-26T15:20:24.642000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Yep we are actually not considering baseFee üôÇ I think this might be the problem üëç",
        "created_at": "2021-04-26T15:21:09.762000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "okay üôÇ let us know if that resolves the issue!",
        "created_at": "2021-04-26T15:21:25.693000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Will do üòÑ",
        "created_at": "2021-04-26T15:21:32.317000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Is this buffer unpadded? Or is it always padded to 32 bytes?",
        "created_at": "2021-04-26T15:26:16.197000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@508125616940515329\u003e should be unpadded",
        "created_at": "2021-04-26T15:34:15.369000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I just realized that at least this is correct, since we can download block headers and thus parentHeader fields are valid. I also realized that we actually /do/ add baseFee to the raw RLP (I really need to read more carefully üòÖ ). So I will now try to remove this base fee if I try to calculate the clique msg hash and see what happens",
        "created_at": "2021-04-26T15:35:25.641000+00:00",
        "attachments": []
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Are we far enough along on the consensus side of things of EIP-1559 to start discussing JSONRPC changes?  Namely what will the `maxPriorityFeePerGas, maxFeePerGas` fields from the EIP be called in say `eth_getTransactionByHash` results?",
        "created_at": "2021-04-26T15:52:16.191000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yes i think so",
        "created_at": "2021-04-26T17:05:05.625000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Our issue is an internal one; your implementation also seems correct RE: clique signing hash üôÇ",
        "created_at": "2021-04-26T18:00:05.092000+00:00",
        "attachments": []
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "AFAIK there haven't been any EIPs drafted for the tx changes, only the `baseFee` additions to the block results (EIP-3041 and friends).  _Personally_ I like the `maxFee` and `tip` names used in your geth PR, but IMO I think the field names in the JSONRPC and the EIP itself should match as closely as possible.  That said `maxFeePerGas` and `maxPriorityFeePerGas` aren't the most end-user friendly terms.  Would we consider updating EIP-1559 to use `tip` and `maxFee` terminology?",
        "created_at": "2021-04-26T19:49:12.485000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "fyi i think the latest preferred term for `tip` is priority fee üôÇ",
        "created_at": "2021-04-26T19:50:50.822000+00:00",
        "attachments": []
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I guess the next question is whether the JSONRPC result should contain the \"max\" or \"actual\" ~tip~ priority fee.",
        "created_at": "2021-04-26T19:52:07.376000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "i suggested changing the terms a couple weeks ago, but \u003c@!301186049323958275\u003e made the point that the spec should be as pedantic as possible and we can choose the lay terms external to the spec",
        "created_at": "2021-04-26T19:52:08.281000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yep, good questions",
        "created_at": "2021-04-26T19:53:01.125000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "i don't have a preference, but IMO if the actual tip is included then we should also include the effectiveGasPrice",
        "created_at": "2021-04-26T19:53:25.515000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "since both depend on retrieving the block's base fee from disk",
        "created_at": "2021-04-26T19:53:38.490000+00:00",
        "attachments": []
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ya in my first-pass implementation of the JSONRPC fields I re-used `gasPrice` as the effective gas price for -1559 txs: https://github.com/quilt/go-ethereum/pull/48/commits/7b11019893be78d3797c9ebdd58d7fcfd8ea85bf#diff-c426ecd2f7d247753b9ea8c1cc003f21fa412661c1f967d203d4edf8163da344R1277. I wrestled with making that a new field overloading the existing field felt the most backwards compatible in that if a consumer isn't updated for London they will still get something for `gasPrice`",
        "created_at": "2021-04-26T19:58:07.001000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "i think that makes good sense",
        "created_at": "2021-04-26T19:59:50.567000+00:00",
        "attachments": []
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So maybe we should rename `RPCTransaction.Tip` to `RPCTransaction.PriorityFee` and propose these fields as an EIP?",
        "created_at": "2021-04-26T20:01:17.866000+00:00",
        "attachments": []
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I can take a stab at an initial EIP this afternoon.",
        "created_at": "2021-04-26T20:02:05.315000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "seems good to me - might want to run the draft past the \u003c#804019759934078987\u003e folks",
        "created_at": "2021-04-26T20:02:30.553000+00:00",
        "attachments": []
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ya good idea, will do (once written)",
        "created_at": "2021-04-26T20:02:55.611000+00:00",
        "attachments": []
    },
    {
        "author": "marekm3498",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!508125616940515329\u003e I will DM you with our RPC aleut endpoint",
        "created_at": "2021-04-26T20:05:40.522000+00:00",
        "attachments": []
    },
    {
        "author": "marekm3498",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Now, we can build it from the branch: https://github.com/NethermindEth/nethermind/tree/1559 https://github.com/NethermindEth/nethermind/tree/1559#build-and-run\nAnd then: Nethermind.Runner.exe --config aleut",
        "created_at": "2021-04-26T20:09:02.345000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Cool, thanks üòÑ",
        "created_at": "2021-04-26T20:11:27.113000+00:00",
        "attachments": []
    },
    {
        "author": "marekm3498",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Hmmmm AFAIK we planned names: MaxPriorityFeePerGas and MaxFeePerGas. \u003c@!574864862338088960\u003e , \u003c@!543900561460822016\u003e, \u003c@!508125616940515329\u003e, \u003c@!388751025789468672\u003e Do you agree with that naming?",
        "created_at": "2021-04-26T20:16:36.241000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "imo the \"PerGas\" is more verbose than needed for RPC",
        "created_at": "2021-04-26T20:17:54.406000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "my preference would be `PriorityFee`, `FeeCap` or `MaxFee`, `EffectiveGasPrice`, and `EffectivePriorityFee`",
        "created_at": "2021-04-26T20:19:48.739000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think I like those, but I'd say it would need `MaxPriorityFee` since `PriorityFee` could be interpreted as \"this is the priority fee\" while in practice it could be less than that (hence `Max`)",
        "created_at": "2021-04-26T20:20:41.954000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yeah that's fair",
        "created_at": "2021-04-26T20:21:15.763000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ugh",
        "created_at": "2021-04-26T20:21:19.884000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "would be nice to drop the \"Effective\" or \"Max\" prefix on one of those pairs, it seems unnecessary to be so verbose with both as the use of one should imply the other",
        "created_at": "2021-04-26T20:22:57.764000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "`MaxTip` also sounds nice tbh",
        "created_at": "2021-04-26T20:24:56.586000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And it's shorter üôÇ",
        "created_at": "2021-04-26T20:25:00.425000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "`MaxTip`, `MaxFee`, `EffectiveGasPrice`, `EffectiveTip`",
        "created_at": "2021-04-26T20:25:41.848000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "`Tip`, `FeeCap`, `GasPrice`, `EffectiveTip` üòÑ",
        "created_at": "2021-04-26T20:26:13.484000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah right maybe due to the mechanism `Tip` is also ok",
        "created_at": "2021-04-26T20:27:29.496000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I guess the latter one works, `EffectiveTip` is indeed somewhat excessive",
        "created_at": "2021-04-26T20:28:31.088000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Is there a shorter synonym for `Effective`? lol",
        "created_at": "2021-04-26T20:28:44.379000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Wouldn't just `GasPrice` also work? Currently we know that `GasPrice` is what was actually paid for a single gas unit. So in this context that would be fine too...? The semantics are the same, although it could be somewhat confusing especially with legacy/eip2930 gas price fields",
        "created_at": "2021-04-26T20:29:59.402000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "fine with me",
        "created_at": "2021-04-26T20:31:23.474000+00:00",
        "attachments": []
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So `GasPrice` works since \"price\" is basically a synonym for \"fee per gas\", so what about `MaxPrice` and `MaxTipPrice`?",
        "created_at": "2021-04-26T20:45:24.268000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Sorry to hijack this convo, but our JS node is only connecting to Nethermind. Are the other two bootnodes down? I am assuming not, then it means we have a devp2p issue.",
        "created_at": "2021-04-26T21:10:19.971000+00:00",
        "attachments": []
    },
    {
        "author": "marekm3498",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!508125616940515329\u003e http://eip1559-testnet.ops.pegasys.tech:3001/",
        "created_at": "2021-04-26T21:11:13.107000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Great üòÑ",
        "created_at": "2021-04-26T21:12:23.601000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "i'm running with discovery off",
        "created_at": "2021-04-26T21:20:06.378000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Right, but you are quilt.link right? If I would directly try to connect since I have your identity (bootnode) then I would be able to connect right? Or does discovery off disable all new connections?",
        "created_at": "2021-04-26T21:21:38.483000+00:00",
        "attachments": []
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think disable discover disables new external connections, but would need to double check",
        "created_at": "2021-04-26T21:29:56.320000+00:00",
        "attachments": []
    },
    {
        "author": "ryanleeschneider",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I'll move the JSONRPC discussions over to \u003c#804019759934078987\u003e",
        "created_at": "2021-04-26T22:04:09.744000+00:00",
        "attachments": []
    }
]
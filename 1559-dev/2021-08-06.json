[
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "seems like etherscan shows gas price 0 and max fee 0 for pending 1559 txs",
        "created_at": "2021-08-06T01:49:02.229000+00:00",
        "attachments": null
    },
    {
        "author": "nxs9986",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "was just noticing that - wasn't sure if i screwed something up",
        "created_at": "2021-08-06T09:22:49.797000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "17301 no priority fee txs so far",
        "created_at": "2021-08-06T14:31:28.579000+00:00",
        "attachments": null
    },
    {
        "author": "perama",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I looked at testing the `0x48 BASEFEE` opcode. Solidity PR was waiting to make sure the fork went okay. The other method was to use `verbatim` in Yul, but that is not available as an inline yet.\n\nSo I think you can do it, by deploying a `.yul` contract with the function:\n\n```\n{\n    function basefee() -\u003e out {\n        out := verbatim_0i_1o(hex\"48\")\n    }\n\n    sstore(0, basefee())\n}\n```\n\nhttps://github.com/ethereum/solidity/pull/11647#issuecomment-891805433\n\nWhich I tried to do in Hardhat, but didn't manage to get `.yul` contracts to compile there.",
        "created_at": "2021-08-06T15:08:47.813000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You could just write that as byetcode directly: `48600055`",
        "created_at": "2021-08-06T15:09:53.746000+00:00",
        "attachments": null
    },
    {
        "author": "perama",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Oh, I see. Then it can be as an inline. So you could save the basefee to memory like so?\n\n```\nassembly {48600052}\n```",
        "created_at": "2021-08-06T15:19:13.617000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "No I mean instead of using Solidity just write the byte code üôÇ",
        "created_at": "2021-08-06T15:20:06.654000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I thought you just want a simple test case like above. If you need something more complex, then at least in Solidity you'll need to wait for the next release.",
        "created_at": "2021-08-06T15:20:35.480000+00:00",
        "attachments": null
    },
    {
        "author": "perama",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Okay, great thanks üôÇ",
        "created_at": "2021-08-06T15:25:58.295000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@\u0026652918665943056397\u003e \u003c@\u0026836981603216654336\u003e sorry for the tag, trying to finalize this rpc spec amendment: https://github.com/ethereum/eth1.0-specs/pull/251#pullrequestreview-716283338\n\nWhat do you return for `gasPrice` on pending EIP-1559 transaction? It seems like the options are 1) `maxFeePerGas` or 2) the `effectiveGasPrice` based on the latest block.\n\nIt appears that geth does 2). I can make a PR to change it to do 1), but not sure if others are already doing 2)? If so, could modify the RPC spec.",
        "created_at": "2021-08-06T16:28:32.003000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I thought geth returned `maxFeePerGas` on pending txns?",
        "created_at": "2021-08-06T16:29:47.759000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I also thought this, but it doesn't look to be the case: https://github.com/ethereum/go-ethereum/blob/d3e3a460ec947c9e1e963d1a35f887d95f23f99d/internal/ethapi/api.go#L1333-L1339",
        "created_at": "2021-08-06T16:30:51.186000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ah, actually i'm still misinterpreting it - it passes an empty hash. Let me just make a couple test transaction to see.",
        "created_at": "2021-08-06T16:32:21.322000+00:00",
        "attachments": null
    },
    {
        "author": "suburbandad_",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!543900561460822016\u003e, \u003c@!680337202521440470\u003e has an open pr that has been waiting, pending clarity\nhttps://github.com/hyperledger/besu/pull/2535",
        "created_at": "2021-08-06T16:36:14.238000+00:00",
        "attachments": null
    },
    {
        "author": "suburbandad_",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "it returns effectivePriorityFeePerGas, I believe it is in-line with your proposal.  I am double checking to be sure since Karim is on PTO",
        "created_at": "2021-08-06T16:38:06.567000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "```\n\u003e params = { from: me, to: me, maxFeePerGas: \"0x1000000000\", maxTipPerGas: \"0x0\", gas: \"0x5208\" }\n{\n  from: \"0xc0ffee61108b46c8b84c63df14e3a607ac981e93\",\n  gas: \"0x5208\",\n  maxFeePerGas: \"0x1000000000\",\n  maxTipPerGas: \"0x0\",\n  to: \"0xc0ffee61108b46c8b84c63df14e3a607ac981e93\"\n}\n\u003e personal.sendTransaction(params)\n\"0xd7291f16ce57eb4e6aaae4b3d81f3f16ed947763cbed230eef3d9d1cb395fa5d\"\n\u003e eth.getTransaction(\"0xd7291f16ce57eb4e6aaae4b3d81f3f16ed947763cbed230eef3d9d1cb395fa5d\")\n{\n  accessList: [],\n  blockHash: null,\n  blockNumber: null,\n  chainId: \"0x5\",\n  from: \"0xc0ffee61108b46c8b84c63df14e3a607ac981e93\",\n  gas: 21000,\n  gasPrice: 0,\n  hash: \"0xd7291f16ce57eb4e6aaae4b3d81f3f16ed947763cbed230eef3d9d1cb395fa5d\",\n  input: \"0x\",\n  maxFeePerGas: \"0x1000000000\",\n  maxPriorityFeePerGas: \"0x12a05f1f9\",\n  nonce: 0,\n  r: \"0x10f320d15d1d8c84ae687c9f446379d5c4c76e16146361349002e0af77996fc0\",\n  s: \"0x23c3e3bf21d272a1978f8923603171e462740764f5e03c1ef859f318fc72b34d\",\n  to: \"0xc0ffee61108b46c8b84c63df14e3a607ac981e93\",\n  transactionIndex: null,\n  type: \"0x2\",\n  v: \"0x1\",\n  value: 0\n}\n```\nit looks like the RPC is actually returning `0` for pending txs gas price",
        "created_at": "2021-08-06T16:42:37.556000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "it seems like for pending txs it returns `maxFeePerGas` like 1) above? https://github.com/hyperledger/besu/blob/71ddec15e313709ef27c4cc2028ecb4d00c34360/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/results/TransactionPendingResult.java#L89",
        "created_at": "2021-08-06T16:44:28.298000+00:00",
        "attachments": null
    },
    {
        "author": "suburbandad_",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Ok, we can update the PR to reflect the final.  I think Karim was waiting on consensus about RPC",
        "created_at": "2021-08-06T16:50:04.895000+00:00",
        "attachments": null
    },
    {
        "author": "suburbandad_",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I don't think we have a strong preference in either direction",
        "created_at": "2021-08-06T16:50:46.684000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "unless anyone objects, i think we can go with returning `maxFeePerGas` as `gasPrice` for pending txs",
        "created_at": "2021-08-06T16:51:03.898000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "since that is what the original spec change requested",
        "created_at": "2021-08-06T16:51:21.545000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "and geth is doing neither 1) or 2)",
        "created_at": "2021-08-06T16:51:29.666000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "geth PR to do 1): https://github.com/ethereum/go-ethereum/pull/23345",
        "created_at": "2021-08-06T16:54:43.364000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Should we move this to \u003c#745077610685661265\u003e for more visibility?",
        "created_at": "2021-08-06T16:57:26.835000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "sure",
        "created_at": "2021-08-06T16:57:53.002000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "does etherscan run geth? i wonder if that's why they were seeing this issue",
        "created_at": "2021-08-06T16:58:21.547000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I think they run OpenEthereum, but not sure",
        "created_at": "2021-08-06T17:04:47.533000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "that's what i thought too",
        "created_at": "2021-08-06T17:04:54.792000+00:00",
        "attachments": null
    },
    {
        "author": "trent_vanepps",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "they run both, OE as primary and Geth as backup",
        "created_at": "2021-08-06T17:32:35.192000+00:00",
        "attachments": null
    },
    {
        "author": "marekm3498",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "We're returning maxFeePerGas as GasPrice for pending transactions, so option number 1 üôÇ",
        "created_at": "2021-08-06T17:50:13.562000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "thank you for letting me know üôè",
        "created_at": "2021-08-06T17:56:52.962000+00:00",
        "attachments": null
    },
    {
        "author": ".ethere",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If you hit getTransactionByHash, currently geth returns: \n\nFor mined TX\n * The effective gas price\n\nFor pending TX:\n  * The GasPrice for legacy type0 and type1 Txs, (Legacy)\n\n  * Null for Type2 Txs",
        "created_at": "2021-08-06T20:33:09.156000+00:00",
        "attachments": null
    },
    {
        "author": ".ethere",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "--\n\nThe type field is always there so its an easy fix in the geth consumer side.. if Tx is type 2, then `gasPrice = maxFeePerGas`",
        "created_at": "2021-08-06T20:34:29.106000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!765999676704555080\u003e you mean 0 not null, right?",
        "created_at": "2021-08-06T20:45:56.271000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "actually, now i wonder if it actually is null and the geth console coerced it to 0",
        "created_at": "2021-08-06T20:46:27.617000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "i opened a PR to fix this earlier: https://github.com/ethereum/go-ethereum/pull/23345",
        "created_at": "2021-08-06T20:46:58.050000+00:00",
        "attachments": null
    },
    {
        "author": ".ethere",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "at the time i tried... was null, perhaps they changed that... let me check",
        "created_at": "2021-08-06T20:47:01.014000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "okay yes, it appears `gasPrice` is actually null - thank you for noting this",
        "created_at": "2021-08-06T20:49:04.156000+00:00",
        "attachments": null
    }
]
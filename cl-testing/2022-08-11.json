[
    {
        "author": "ryanleeschneider",
        "category": "Testing",
        "parent": "",
        "content": "Anyone else seeing issues w/ erigon/teku on goerli/prater?  Seems like our pairs are spinning on waiting for each other for something.  Running `thorax/erigon:v2022.07.04` and `teku:22.7.0`\n\nErigon:\n\n```\n[INFO] [08-11|02:07:44.459] RPC Daemon notified of new headers       from=7382819 to=7382820 header sending=13.767Âµs log sending=280ns                                                          [INFO] [08-11|02:07:44.459] [1/16 Headers] Waiting for Beacon Chain... \n```\n\nTeku:\n\n```\n2022-08-11 02:07:40.339 INFO  - Slot Event  *** Slot: 3639638, Block:                                                        ... empty, Justified: 113734, Finalized: 113733, Peers: 70         \n2022-08-11 02:07:44.526 WARN  - Unable to import blocks because execution client is offline.                                                                                                    2022-08-11 02:07:49.615 WARN  - Unable to import blocks because execution client is offline.  \n```",
        "created_at": "2022-08-11T02:10:44.308000+00:00",
        "attachments": null
    },
    {
        "author": "ryanleeschneider",
        "category": "Testing",
        "parent": "",
        "content": "^ FWIW took awhile but started progressing again",
        "created_at": "2022-08-11T02:23:08.283000+00:00",
        "attachments": null
    },
    {
        "author": "schone_wizard",
        "category": "Testing",
        "parent": "",
        "content": "Wonder what client is on a diff fork given the low vote rates",
        "created_at": "2022-08-11T02:57:13.383000+00:00",
        "attachments": null
    },
    {
        "author": "yperbasis",
        "category": "Testing",
        "parent": "",
        "content": "Could you share full Erigon's log please?",
        "created_at": "2022-08-11T10:23:43.695000+00:00",
        "attachments": null
    },
    {
        "author": "yperbasis",
        "category": "Testing",
        "parent": "",
        "content": "Also, there was a bug in Erigon version v2022.07.04. It's better to use v2022.08.01.",
        "created_at": "2022-08-11T10:25:04.818000+00:00",
        "attachments": null
    },
    {
        "author": "yorickdowne",
        "category": "Testing",
        "parent": "",
        "content": "I appear to have proposed an invalid block with a Lighthouse/Erigon combo. Erigon `devel` , `git_branch=alpha git_tag=v2021.10.03-1610-g7dabdc326-dirty git_commit=7dabdc3269f1e3b098fee5ab4d96ec843823a6fd`",
        "created_at": "2022-08-11T10:29:44.519000+00:00",
        "attachments": null
    },
    {
        "author": "yorickdowne",
        "category": "Testing",
        "parent": "",
        "content": "https://goerli.beaconcha.in/block/3639696",
        "created_at": "2022-08-11T10:29:49.344000+00:00",
        "attachments": null
    },
    {
        "author": "yorickdowne",
        "category": "Testing",
        "parent": "",
        "content": "Logs around the time of that block, if I am reading the UTC right",
        "created_at": "2022-08-11T10:30:01.201000+00:00",
        "attachments": null
    },
    {
        "author": "yorickdowne",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2022-08-11T10:30:08.480000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "erigonlogs.txt",
                "content": "f2058ccd2c6ec155608d86effbfb05cd9af5d1e35dafc5f46232499441d5d705"
            }
        ]
    },
    {
        "author": "yperbasis",
        "category": "Testing",
        "parent": "",
        "content": "Erigon had a bug with transaction indexing in v2022.07.04, which we fixed in v2022.08.01.",
        "created_at": "2022-08-11T10:37:04.962000+00:00",
        "attachments": null
    },
    {
        "author": "yperbasis",
        "category": "Testing",
        "parent": "",
        "content": "But your node is v2022.08.01, right?",
        "created_at": "2022-08-11T10:38:23.665000+00:00",
        "attachments": null
    },
    {
        "author": "yorickdowne",
        "category": "Testing",
        "parent": "",
        "content": "Let me just verify that was the actual version. I think it wasn't. One sec. I restarted this a few times, it'd grab from `alpha` each time",
        "created_at": "2022-08-11T10:38:32.618000+00:00",
        "attachments": null
    },
    {
        "author": "yorickdowne",
        "category": "Testing",
        "parent": "",
        "content": "OK yep that was the version, the one linked above. Whatever that commit translates to.",
        "created_at": "2022-08-11T10:39:44.779000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "It is weird that the tag has a date that is almost an year in the past",
        "created_at": "2022-08-11T10:41:25.771000+00:00",
        "attachments": null
    },
    {
        "author": "yorickdowne",
        "category": "Testing",
        "parent": "",
        "content": "I think that's a build artefact with how they do the alpha docker images",
        "created_at": "2022-08-11T10:42:07.084000+00:00",
        "attachments": null
    },
    {
        "author": "yorickdowne",
        "category": "Testing",
        "parent": "",
        "content": "`thorax/erigon                               alpha           b87a9f82686b   5 days ago      643MB`",
        "created_at": "2022-08-11T10:43:56.234000+00:00",
        "attachments": null
    },
    {
        "author": "yorickdowne",
        "category": "Testing",
        "parent": "",
        "content": "So that'd be v2022.08.01, yes",
        "created_at": "2022-08-11T10:44:15.457000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "There is no release with that fix yet",
        "created_at": "2022-08-11T11:03:07.604000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "It was not included",
        "created_at": "2022-08-11T11:03:17.353000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "We decided not to do a released with it since we wanted to test it, and then i think we forgot",
        "created_at": "2022-08-11T11:04:17.396000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@687974325072035882\u003e Can you confirm that the version of Erigon from the Goerli release returns SYNCING if merge transition payload is build atop of a side fork block?",
        "created_at": "2022-08-11T11:10:30.672000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "If with that, you refer to the Terminal block then yes",
        "created_at": "2022-08-11T11:54:55.705000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "Yeah, a terminal block from a side fork, i.e. the one that hasn't been executed. You have mentioned previously that this logic has been patched to be capable of responding VALID/INVALID",
        "created_at": "2022-08-11T11:56:26.644000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "Below PoS we return SYNCING",
        "created_at": "2022-08-11T11:56:34.139000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "No, that was downloading blocks on the fly, that other one is still being worked on",
        "created_at": "2022-08-11T11:57:17.991000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "To clarify:\n```\nA \u003c- CANONICAL_TB // This is the HEAD\n \\\n  \u003c- SIDE_FORK_TB \u003c- TRANSITION_PAYLOAD\n```\n\nWhat Erigon version from the Goerli release respond to `newPayload(TRANSITION_PAYLOAD)` given the above state of the client?",
        "created_at": "2022-08-11T11:58:13.959000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "If PoW block are involved we dont count them as side forks and just return SYNCING/ACCEPTED",
        "created_at": "2022-08-11T11:59:12.036000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "Got it, thanks",
        "created_at": "2022-08-11T12:01:07.185000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "Could that be the reason of the stall btw?",
        "created_at": "2022-08-11T12:08:00.485000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "Erigon process terminal blocks but could not process pos",
        "created_at": "2022-08-11T12:08:21.946000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "Another thing i noticed was that the issue presented with Teku",
        "created_at": "2022-08-11T12:08:52.653000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "Yes, if CL sees SYNCING response on `newPayload(mergeTransitionPayload)` it will wait for 128 slots to call `fcU` with this block and proceed with processing this chain",
        "created_at": "2022-08-11T12:09:16.756000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "What do you mean by \"process terminal blocks\" in this context?",
        "created_at": "2022-08-11T12:10:25.654000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "The last PoW block",
        "created_at": "2022-08-11T12:10:57.055000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "Which should be accessible by all clients pre merge anyway",
        "created_at": "2022-08-11T12:11:12.979000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Perhaps \u003c@687974325072035882\u003e can correct me, but my understanding here is different: erigon sends SYNCING/ACCEPTED for the POW TTD block which is not in PoS. So the CL will not send a `notify_newPayload(terminal_block)` for this block since it is not execution enabled. Then if the CL wants to sync the merge block in that branch it will send a `notify_newPayload(mergeBlock)`, Erigon is stuck cause it hasn't executed the parent TTD block. Do they also return SYNCING here? or is it VALID/INVALID? this is now a PoS block.",
        "created_at": "2022-08-11T12:17:45.738000+00:00",
        "attachments": null
    },
    {
        "author": "funnygiulio",
        "category": "Testing",
        "parent": "",
        "content": "Okay if a side fork have a PoW block in it (like a new terminal block) we dont validate it",
        "created_at": "2022-08-11T12:33:02.719000+00:00",
        "attachments": null
    }
]
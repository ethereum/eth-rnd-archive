[
    {
        "author": "seamonkey82",
        "category": "Testing",
        "parent": "",
        "content": "Looking good here.  Thanks for the fix!",
        "created_at": "2021-12-30T05:42:52.903000+00:00",
        "attachments": null
    },
    {
        "author": "ohraemez",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!654267572107083777\u003e my node is stuck again",
        "created_at": "2021-12-30T05:56:21.273000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "geth.txt",
                "content": "737b96908a2d0e9fa917b529d32e3fd1cf6a35513001d2bc2bc9dcdb5b8326f1"
            }
        ]
    },
    {
        "author": "ohraemez",
        "category": "Testing",
        "parent": "",
        "content": "on the nimbus side it is trying to sync permanently. not sure which part of the log is relevant. cant find the error message",
        "created_at": "2021-12-30T05:57:26.811000+00:00",
        "attachments": null
    },
    {
        "author": "ohraemez",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2021-12-30T05:59:24.473000+00:00",
        "attachments": [
            {
                "type": "text/plain; charset=utf-8",
                "origin_name": "nimbus.txt",
                "content": "a084d5504112d83b361dd17b2d94c91c6c3a82224086a7e4f97c43a85a794b9f"
            }
        ]
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "Are you seeing any \"Block received\", \"Block resolved\", or \"Block processed\" log messages?",
        "created_at": "2021-12-30T06:03:47.423000+00:00",
        "attachments": null
    },
    {
        "author": "ohraemez",
        "category": "Testing",
        "parent": "",
        "content": "no",
        "created_at": "2021-12-30T06:17:46.572000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "What are the most recent few \"Current syncing state\" and \"Requesting blocks from peer\" messages?",
        "created_at": "2021-12-30T06:20:15.651000+00:00",
        "attachments": null
    },
    {
        "author": "ohraemez",
        "category": "Testing",
        "parent": "",
        "content": "DBG 2021-12-30 05:49:30.932+00:00 Current syncing state                      topics=\"beacnde\" workers_map=sssssssPss\nsleeping_workers_count=9 waiting_workers_count=0 pending_workers_count=1 wall_head_slot=98622 local_head_slot=97900 p\nause_time=0ns avg_sync_speed=0.0 ins_sync_speed=0.0 direction=Forward",
        "created_at": "2021-12-30T06:23:46.952000+00:00",
        "attachments": null
    },
    {
        "author": "ohraemez",
        "category": "Testing",
        "parent": "",
        "content": "message is the same for the last 30 mins (that i checked) only the head_slot changes",
        "created_at": "2021-12-30T06:29:06.921000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "and in that time, no \"Requesting blocks from peer\" or \"Creating new request for peer\"?",
        "created_at": "2021-12-30T06:30:12.564000+00:00",
        "attachments": null
    },
    {
        "author": "ohraemez",
        "category": "Testing",
        "parent": "",
        "content": "not a single one",
        "created_at": "2021-12-30T06:32:44.529000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "We've seen this issue periodically. As you noted initially, it's a sync issue",
        "created_at": "2021-12-30T06:37:34.766000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "any \"Peer's syncing status\" or \"Peer status\" messages?",
        "created_at": "2021-12-30T06:40:40.952000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "I'm particularly interested in if their `remote_head_slot` has been changing (i.e. is the node doing anything, even noting changing external conditions, or is it just quiescent)",
        "created_at": "2021-12-30T06:41:44.225000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "e.g., one possibility is that all the peers it's currently trying to sync with/from aren't reporting a (their local/your node's remote) head slot any newer than what your node already has",
        "created_at": "2021-12-30T06:45:26.579000+00:00",
        "attachments": null
    },
    {
        "author": "ohraemez",
        "category": "Testing",
        "parent": "",
        "content": "sorry i restarted nimbus and now the scrollback buffer is gone. does nimbus create a logfile somewhere? if not i will get back to you when it happens again.",
        "created_at": "2021-12-30T06:50:29.018000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "Yeah, restarting's honestly a reasonable action here. It doesn't create one by default. We're a bit in flux there (it used to until 1.5.2 or 1.5.3, maybe 1.5.4, but not 1.5.5). Better to redirect stdout to some file. However, the default display format's not great for later parsing, so I usually add `--log-format=json` to the command line flags to get something machine-readable back.",
        "created_at": "2021-12-30T06:52:10.528000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "and that branch is based on something post-1.5.5",
        "created_at": "2021-12-30T06:52:51.234000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "is it at least syncing again?",
        "created_at": "2021-12-30T06:53:12.459000+00:00",
        "attachments": null
    },
    {
        "author": "ohraemez",
        "category": "Testing",
        "parent": "",
        "content": "ok will do that and redirect to stdout.\nyes, it synced again.",
        "created_at": "2021-12-30T06:54:03.210000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "something else to try, if you haven't already, is to use the `--nat:extip:x.y.z.w` flag to get more peers. It's a bit brute-force, but especially in smaller networks it can help avoid getting stuck",
        "created_at": "2021-12-30T06:59:42.184000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "What you encountered's still a bug; this might just make it less likely to occur",
        "created_at": "2021-12-30T07:00:13.474000+00:00",
        "attachments": null
    },
    {
        "author": "ohraemez",
        "category": "Testing",
        "parent": "",
        "content": "oh i actually limited the amount of peers to 10 per client that i am running, because i am running to many clients and my router seems to just die after a certain amount of peers. that's probably the reason that i trigger this bug so easily?\n\n--nat:extip unfortunatly i have a dynamic ip at home which changes every 24h. so that would advertise the wrong ip after my ip changes, right?",
        "created_at": "2021-12-30T07:08:13.504000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "Yeah, reasonably likely related. Will be interested, if it re-occurs, about the questions above -- is it somehow deadlocked into not being able to launch block requests, or process them, or is it more just that it's unaware of that there are peers with newer heads to request from. The latter would be more likely, in particular, with fewer potential peers (not all of which are going to participate in/cooperate with syncing).\n\nAnd, indeed, sounds likely better to avoid `--nat:extip` in this situation",
        "created_at": "2021-12-30T07:20:25.001000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "I'll be shutting down the `merge-devnet-3` and `pithos` testnets in the next hour. If there is any reason to leave them alone, please do reach out. This doesn't affect Kintsugi in any way. \n\nRepeating that, few older testnets will be destroyed. Kintsugi will stay untouched and function normally for quite a while longer.",
        "created_at": "2021-12-30T12:45:43.604000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!203220829473996800\u003e hi",
        "created_at": "2021-12-30T16:10:10.480000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "i have mutilated your simulator, i'm sorry",
        "created_at": "2021-12-30T16:10:44.117000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "Hahaha, no worries",
        "created_at": "2021-12-30T16:11:22.721000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "Looking into that PR of yours to see what's wrong",
        "created_at": "2021-12-30T16:11:37.428000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "i expect many things",
        "created_at": "2021-12-30T16:11:59.195000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "Does Lighthouse use the new engine RPC port yet? You may have to change some things to connect it properly when using the merge version of lighthouse",
        "created_at": "2021-12-30T16:12:09.281000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "hmm will have to look, was just sort of following how to setup the clients for kintsugi",
        "created_at": "2021-12-30T16:12:34.290000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "I don't think the `--catalyst` flag applies anymore, there is a TTD config var in the geth chain config iirc",
        "created_at": "2021-12-30T16:14:08.633000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "We should probably check the consensus ansible repo from Pari to see the latest params to use",
        "created_at": "2021-12-30T16:14:44.590000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "https://github.com/parithosh/consensus-deployment-ansible/blob/master/kintsugi-testnet/inventory/group_vars/eth1client_geth.yml\nhttps://github.com/parithosh/consensus-deployment-ansible/blob/fd1e4be2a9c8c5d9822987a75f6ebfee0eb6b067/kintsugi-testnet/custom_config_data/genesis.json#L15",
        "created_at": "2021-12-30T16:16:09.467000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "Hope it's ok to ask here, trying to synch the kintsugi test net, after 12 hours have messages  \"Regenerated local transaction journal    transactions=0 accounts=0\" the console says eth.syncing / false. At the beginning, eth.syncing had some output (  currentBlock: 1626, highestBlock: 94925, all others 0). I restarted the whole process from initial state and got the same result (syncing is not false for ca. 5 minutes)",
        "created_at": "2021-12-30T16:16:35.462000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "How to track this down? What is expected?",
        "created_at": "2021-12-30T16:16:58.716000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "\"Regenerated local transaction journal  \" is not an error. I think it happens on a slow interval to clean up previous things",
        "created_at": "2021-12-30T16:18:08.398000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "Should it not sync the whole chain?",
        "created_at": "2021-12-30T16:18:31.049000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "I think it did",
        "created_at": "2021-12-30T16:18:48.832000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "Before starting all the other steps from https://hackmd.io/dFzKxB3ISWO8juUqPpJFfw",
        "created_at": "2021-12-30T16:18:48.837000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "It'll probably take a while to sync, and you need to make  sure it has peers to sync from",
        "created_at": "2021-12-30T16:19:40.085000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "Oh you think syncing completed?",
        "created_at": "2021-12-30T16:20:23.516000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "Maybe, there was no reason to wipe the local state at least. Just let it sync",
        "created_at": "2021-12-30T16:21:29.602000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "How to make sure there are peers?",
        "created_at": "2021-12-30T16:21:36.954000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!915387219169120256\u003e there should be logs (maybe change your logging verbosity to \"debug\" if you can't see any). Try read from the RPC endpoint otherwise",
        "created_at": "2021-12-30T16:29:58.226000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "Read what from RPC endpoint?",
        "created_at": "2021-12-30T16:34:38.679000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "The peers. You can list the peers you have. Logs should tell you it's syncing from them until it reaches the latest block",
        "created_at": "2021-12-30T16:37:12.396000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "admin.peers.length gives 11. But eth.syncing is false",
        "created_at": "2021-12-30T16:40:00.817000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!915387219169120256\u003e And what's the latest block you see? Does it match what the testnet block explorer shares?",
        "created_at": "2021-12-30T16:43:38.898000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "eth.blockNumber = 94946",
        "created_at": "2021-12-30T16:48:17.769000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "https://explorer.kintsugi.themerge.dev/ has 95248",
        "created_at": "2021-12-30T16:50:08.430000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "ðŸ‘‹ \u003c@!543900561460822016\u003e \n\nSo like proto said, latest params are found in the repo he linkedðŸ˜ƒ  \n\nYour `genesis.json` also needs the field `mergeForkBlock` right above TTDs definition. So before TTD happens, the merge epoch should be hit on the CL side and mergeforkblock on the EL side: https://github.com/parithosh/consensus-deployment-ansible/blob/master/kintsugi-testnet/custom_config_data/genesis.json#L14\n\nGlanced through the PR, and `lighthouse_bn.sh` has `--dummy-eth1` set, it needs to be changed to `--eth1`. You already are setting  `  --execution-endpoints={{execution_engine_endpoint}}` on the lighthouse bn, so that should work fine. All lighthouse related flags can be found here: https://github.com/parithosh/consensus-deployment-ansible/blob/fd1e4be2a9c8c5d9822987a75f6ebfee0eb6b067/kintsugi-testnet/inventory/group_vars/eth2client_lighthouse.yml\n\nYour `chainID` is 1, which should be fine and not cause any issues. But for the sake of conformity, it might make sense to set it to something unique? \n\nCould you point me to where the `genesis.ssz` file is created? I can't seem to find the command in the PR",
        "created_at": "2021-12-30T17:11:32.019000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!199561711278227457\u003e\n\u003e Could you point me to where the genesis.ssz file is created? I can't seem to find the command in the PR\nIt's programmatically generated, and \u003c@!543900561460822016\u003e is looking to kickstart it from the Merge on CL (but before transition, and maybe with pre-mined eth1 votes for voting testing), so he may change it. Already gave some pointers in DM, and he can copy/adapt things from the testnet genesis tool. That said, I just updated the testnet-genesis tool to kintsugi: https://github.com/protolambda/eth2-testnet-genesis/pull/3",
        "created_at": "2021-12-30T17:19:05.814000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "ahh got it!\nJust fyi, during amphora we had an issue that nimbus didn't like a merge genesis state and wanted a phase0 state. Not sure if that's still the case. But either ways, looks like lh/geth is first up.",
        "created_at": "2021-12-30T17:22:49.432000+00:00",
        "attachments": null
    },
    {
        "author": "protolambda",
        "category": "Testing",
        "parent": "",
        "content": "Copying from DM with \u003c@!543900561460822016\u003e, summary of things I think we'll need to change to make the PR work:\n- Engine RPC port exposed on geth node\n- Lighthouse node instructed to use that engine RPC port\n- Eth2 config overrides to activate merge on CL (fork epoch == 0, but embedded payload is fully zeroed until TTD transition actually happens)\n- Eth2 genesis state from `merge.BeaconState` instead of `phase0.BeaconState` type (modify genesis generation, similar to that separate tool I shared)\n- If above works, it shouldn't complain about not having eth1 blocks to vote on\n- update geth chain config with TTD and merge fork block\n- ~~remove old catalyst flag~~ (maybe not? see below)",
        "created_at": "2021-12-30T17:25:51.561000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "I'm still using the catalyst flag on my geth nodes, not sure if its already been deprecated. Maybe \u003c@!360491619402776577\u003e can chime in on that?",
        "created_at": "2021-12-30T17:29:25.281000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "At the moment you still need to specify --catalyst",
        "created_at": "2021-12-30T18:18:27.500000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "I think I've found and fixed this one",
        "created_at": "2021-12-30T21:43:43.652000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "as before, `git pull \u0026\u0026 make update`",
        "created_at": "2021-12-30T21:44:24.623000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "Restarted the synching and again , it stopped the process with these messages, DEBUG[12-30|15:30:20.808] Inserted new block                       number=96845 hash=648c67..589dd1 uncles=0 txs=0     gas=0         elapsed=\"674.105Âµs\" root=71c4b5..639af9\nINFO [12-30|15:30:20.808] Imported new chain segment               blocks=2    txs=0     mgas=0.000    elapsed=2.550ms     mgasps=0.000   number=96845 hash=648c67..589dd1 dirty=42.45MiB\nDEBUG[12-30|15:30:20.809] Reinjecting stale transactions           count=0\nDEBUG[12-30|15:30:20.888] No more headers available                peer=0d0b2bbb\nDEBUG[12-30|15:30:20.889] Header download terminated               peer=0d0b2bbb\nDEBUG[12-30|15:30:20.889] Block body download terminated           err=nil\nDEBUG[12-30|15:30:20.889] Receipt download terminated              err=nil\nDEBUG[12-30|15:30:20.889] Synchronisation terminated               elapsed=4m43.898s",
        "created_at": "2021-12-30T23:34:21.364000+00:00",
        "attachments": null
    },
    {
        "author": "powerful_dragon_89378",
        "category": "Testing",
        "parent": "",
        "content": "Why would it not continue? Is it meant to work like this?",
        "created_at": "2021-12-30T23:34:40.830000+00:00",
        "attachments": null
    }
]
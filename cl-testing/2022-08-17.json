[
    {
        "author": "sproul",
        "category": "Testing",
        "parent": "",
        "content": "Yeah, to guard against that and to make the strategy work with execution enabled I've added a new restriction that we only try to re-org if the block arrives locally later than the attestation deadline.\n\nI was forced to adopt this heuristic in addition to the weight check because execution nodes don't like it when you send them fcU for a block and then try to build a payload on its parent (see condition 2 here: https://github.com/ethereum/execution-apis/blob/main/src/engine/specification.md#engine_forkchoiceupdatedv1). So when the re-org strategy is enabled we suppress fcU for blocks that arrive late when we're due to propose the next slot. In the case where a block is late but exceeds the re-org threshold then we'll get a bit screwed because we'll only send the fcU to the EE right when we try to propose, which means the EE won't have had any time to prepare a payload :\\\n\nI think I'll try and muck around with it so we don't suppress the fcU from the run 500ms before the slot starts, because that's the earliest point at which we can dequeue attestations for the current slot and work out whether they constitute enough weight to not re-org the late block.",
        "created_at": "2022-08-17T01:39:13.468000+00:00",
        "attachments": []
    }
]
[
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Question on pectra deposits and effective balance.\n\nI had a validator with a balance of 41.178 ETH and an effective balance of 41 ETH.  I sent in a topup of 1.83 ETH, which brought the balance up to 43.008ETH but this also increased the effective balance to 43 ETH.  Given the effective balance hysteresis I would have expected that this would result in an effective balance of 42 ETH, as it hadn't crossed the 43.25 ETH threshold.\n\nI think that this is a side-effect of how `process_effective_balance_updates` operates with topups, am I correct in how I'm seeing this?",
        "created_at": "2025-03-20T12:25:39.218000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "this logic hasn't been changed in electra. Consider a 2 ETH top-up of 30 ETH validator in deneb, EB would be bumped to 32 ETH in this case. This happens whenever a balance change increases EB for more than 1 ETH",
        "created_at": "2025-03-20T14:14:55.149000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Testing",
        "parent": "",
        "content": "Agree that the logic hasn't changed, but it leads to what I think are undesirable outcomes.\n\nFor example, if you have a compounding validator that reaches 33.01 ETH balance, its effective balance will remain 32 ETH (until it reaches 32.25 ETH balance).  However, the staker could at this point withdraw 1 ETH and then send it back to the same validator, resulting in a faster effective balance increase to 33 ETH.\n\n(Again, I may be reading something wrong but from my read of the specs this seems to be how it's playing out.)",
        "created_at": "2025-03-20T14:46:12.842000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "this is exactly how it will play out, so it is reasonable for a staker to waste churn for this kind of tricks ðŸ¤”",
        "created_at": "2025-03-20T14:49:25.996000+00:00",
        "attachments": null
    }
]
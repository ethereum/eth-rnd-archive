[
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "I'm adding more tests to the Engine API sim in hive, and I noticed that this excerpt from the paris version for `engine_forkchoiceUpdatedV1` is no longer followed by some clients on `engine_forkchoiceUpdatedV3`:\n\u003e the payload is deemed `VALID` and `forkchoiceState` has been applied successfully, but no build process has been started due to invalid `payloadAttributes`\nThat is, the head of the chain is not applied on missing `parentBeaconBlockRoot`.\n\nSo I just wanted to check whether this ok, because on V1, the head was updated, and there is no mention of this changing on the cancun version of the spec\n\n\u003c@758579010027782144\u003e \u003c@543900561460822016\u003e \u003c@508125616940515329\u003e \u003c@827653956955406406\u003e \u003c@583892532644151312\u003e",
        "created_at": "2023-09-06T20:11:29.802000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Testing",
        "parent": "",
        "content": "Which clients do not follow this? I have not thoroughly checked but it seems that Cancun changes do not override the Paris spec (? - please recheck ðŸ™‚ ) -\u003e therefore, clients should follow the spec, or the spec should be updated ðŸ™‚",
        "created_at": "2023-09-06T20:17:14.263000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "I've only tried eth-js and geth, and I'm trying the rest right now, and they return the error but do not apply the head update",
        "created_at": "2023-09-06T20:19:49.852000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "They _do_ apply the head if, for example, what's incorrect is the timestamp (equal to zero or less than the parent on top of which the payload is being built)",
        "created_at": "2023-09-06T20:20:33.892000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Testing",
        "parent": "",
        "content": "I am not 100% certain but I think this is wrong behavior. With wrong `payloadAttributes` we should definitely error (I am not sure what the tests result into)",
        "created_at": "2023-09-06T20:25:23.182000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Testing",
        "parent": "",
        "content": "So I would argue that the original Paris rules are correct. (What does EthJS / Geth return in this scenario?)",
        "created_at": "2023-09-06T20:25:44.168000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Testing",
        "parent": "",
        "content": "(Might also have understood this scenario wrong ðŸ˜… )",
        "created_at": "2023-09-06T20:26:49.536000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Yes, and it does error out in all cases, but the thing is that Paris rules have a case where due to invalid payload attributes, it errors out, and it also updates the forkchoice, so the error is different in the case of the beacon root, but the thing I'm not sure is whether the forkchoice must be applied or not.\n\nMy guess is that it probably should because if the CLs have been making assumptions based on this since the beginning, it would be better not to break them.",
        "created_at": "2023-09-06T20:54:31.741000+00:00",
        "attachments": []
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Although there are two different errors for this:\n- On V1 it's error `-38003`, which is `Invalid payload attributes`\n- On V3 it's error `-32602` due to the missing beacon root",
        "created_at": "2023-09-06T20:58:59.031000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Testing",
        "parent": "",
        "content": "Ok great, thanks ðŸ˜„",
        "created_at": "2023-09-06T21:00:59.926000+00:00",
        "attachments": []
    },
    {
        "author": "jochembrouwer",
        "category": "Testing",
        "parent": "",
        "content": "I will investigate tomorrow ðŸ™‚",
        "created_at": "2023-09-06T21:01:04.410000+00:00",
        "attachments": []
    }
]
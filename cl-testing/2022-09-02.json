[
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "It is expected that a client fully supporting optimistic sync tests ignores the `valid` flag\nThose that are not supporting the format may ignore `on_payload_info` and both will end up with the same fork choice state\n\nBut should we care about those that are not supporting extended format? If not, then we may just omit `valid: false` when the payload is eventually invalid",
        "created_at": "2022-09-02T09:53:32.125000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "But are you going to change as well the forkchoice tests? the thing is that if I want to keep the previous forkchoice test-vectors and these sync vectors in the same code, I would much rather have the meaning of `valid: false` being equivalent to `INVALID`",
        "created_at": "2022-09-02T10:25:44.023000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "Currently the meaning is `valid: true` being equivalent to VALID",
        "created_at": "2022-09-02T10:26:13.680000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "We want this extension to be backward compatible with the format, so, no changes to forkchoice tests should be made. What would be the `valid` bit for SYNCING then?",
        "created_at": "2022-09-02T10:27:51.972000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "So currently for our forkchoice tests we use `valid: false` to be equivalent to the payload being `INVALID`. The sync tests break this",
        "created_at": "2022-09-02T10:28:36.952000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "`valid` flag holds validity status of entire block including payload. The complexity here comes from SYNCING -\u003e INVALID/VALID which makes us think about the third value for a flag OR\nsay that `valid` is strictly about beacon block and payload validity should be derived from its status",
        "created_at": "2022-09-02T10:33:43.128000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "so `valid: true, status: SYNCING` may turn into `valid: true, status: INVALID` which means that the block is invalid",
        "created_at": "2022-09-02T10:36:09.126000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "The semanthics we use is: `valid: true` --\u003e We expect no errror from `on_block`... `valid: false` we expect errors from `on_block`. We do not error on SYNCING blocks.",
        "created_at": "2022-09-02T10:39:01.600000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "Optimistic sync is about \"validity\" not being binary",
        "created_at": "2022-09-02T10:43:39.357000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "There's no intrinsic tension here, just that modeling this as true/false creates a false dichotomy",
        "created_at": "2022-09-02T10:44:23.089000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "We have the full optimistic status from the `status` field.  Let me put it in a different way: If I run testvectors from forkchoice the same vectors, but with some blocks being SYNCING and with this format, I should pass the tests without changing my code. This will not happen because of the `valid` field.  If all testvectors from forkchoice are also changed to conform to this format then I don't mind at all cause I can just ignore the `valid` check and that's it",
        "created_at": "2022-09-02T10:57:03.801000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "Ok, I get it, thanks",
        "created_at": "2022-09-02T11:19:49.239000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Testing",
        "parent": "",
        "content": "Do we need additional `is_payload_eventually_valid` status?",
        "created_at": "2022-09-02T11:20:39.361000+00:00",
        "attachments": null
    },
    {
        "author": "potuz",
        "category": "Testing",
        "parent": "",
        "content": "I don't think so: the payload status has all the information we need",
        "created_at": "2022-09-02T11:45:59.395000+00:00",
        "attachments": null
    }
]
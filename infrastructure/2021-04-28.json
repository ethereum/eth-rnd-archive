[
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You generally shouldn't be holding secrets in your Ethereum client.",
        "created_at": "2021-04-28T00:03:25.281000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Anything with a private key, really. It can be accounts (the keystore that is shipped with geth) or even the node key.",
        "created_at": "2021-04-28T00:04:24.901000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "that said, yes, you can certainly have your accounts managed elsewhere and only send signed transactions.",
        "created_at": "2021-04-28T00:05:11.453000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You very much should not be giving private keys to the client.",
        "created_at": "2021-04-28T00:05:33.161000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "You may also want to have a cert for your http and ws connections.",
        "created_at": "2021-04-28T00:05:35.409000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If it were up to me that \"feature\" would be removed from all clients.",
        "created_at": "2021-04-28T00:05:51.096000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "That's fine. Need a signer next to the client though then.",
        "created_at": "2021-04-28T00:06:32.462000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Do you mean TLS certificate?  If so, I think this should be managed by a reverse proxy.  Do any of the clients actually support TLS natively?",
        "created_at": "2021-04-28T00:06:35.292000+00:00",
        "attachments": null
    },
    {
        "author": "ajsutton",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Besu does.  But I think the point is more that there's a whole bunch of infrastructure around the client itself.",
        "created_at": "2021-04-28T00:07:15.512000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "In the same network perhaps, but I wouldn't put it \"next to\" the client I don't think (that is, not on same machine/container in most cases).",
        "created_at": "2021-04-28T00:07:15.687000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The boundary of the deployment is not just the client, it's also how it can be accessed, etc.",
        "created_at": "2021-04-28T00:07:48.842000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So the proxy would be part of the deployment.",
        "created_at": "2021-04-28T00:07:57.594000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "My preference is docker swarm with swarm secrets.  I wouldn't switch over to kubernetes unless you go over like 100 servers (pretty large deployment).",
        "created_at": "2021-04-28T00:08:37.049000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Prior to that, I don't think the complexity of kubernetes is worth it.",
        "created_at": "2021-04-28T00:08:54.958000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I like traefik for reverse proxy and load balancing, because of its native integration with docker swarm and easy management.",
        "created_at": "2021-04-28T00:10:11.002000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "doesn't look like it will do repudiation, access control, and rotation. Gotta need Vault.",
        "created_at": "2021-04-28T00:10:19.752000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ok let me look at traefik",
        "created_at": "2021-04-28T00:10:38.072000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I use portainer as a UI into docker swarm and it *does* have access control.",
        "created_at": "2021-04-28T00:10:45.755000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So you wouldn't need to give direct access to the swarm to everyone, just Portainer access and then use Portainer's ACL system for limiting who can access what keys.",
        "created_at": "2021-04-28T00:11:39.539000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Note: I haven't used this particular feature of Portainer a lot, so definitely research the limits of its capabilities.",
        "created_at": "2021-04-28T00:12:06.428000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "In my experience, dealing with malicious actors *within* your infrastructure is really hard.  I think in most situations it is more important to limit internal actors' ability to accidentally open security holes than it is to try to prevent them from being able to be malicious.",
        "created_at": "2021-04-28T00:13:44.985000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "yeah, looks like there is ACL with portainer: https://documentation.portainer.io/v2.0/secrets/add/",
        "created_at": "2021-04-28T00:14:21.847000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "For example, making it hard to accidentally expose keys to the internet rather than trying to prevent an internal actor from going out of their way to steal keys.",
        "created_at": "2021-04-28T00:14:27.247000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Of course, if the amount of money at risk is high enough, the calculus changes.",
        "created_at": "2021-04-28T00:15:26.884000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e it's not really up to me how this came about. Kube and Vault are the mandate.",
        "created_at": "2021-04-28T00:15:37.027000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "The big selling point of Vault is that you can request a token for usage that can be rescinded without ever divulging the secret.",
        "created_at": "2021-04-28T00:16:11.988000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "As for k8s, well, that's standard in my world. Our ops are better equipped for this.",
        "created_at": "2021-04-28T00:16:44.522000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I have heard good things about Vault from an Enterprise standpoint.  I never have used it personally though.",
        "created_at": "2021-04-28T00:16:59.284000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "same",
        "created_at": "2021-04-28T00:17:05.797000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "but it's hashicorp, and it's consul++ from what I get.",
        "created_at": "2021-04-28T00:17:07.731000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Anyway. I'll keep your set up in mind for my own server over here ðŸ™‚",
        "created_at": "2021-04-28T00:18:16.598000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "deploying in kubernetes shouldn't require referencing any external project like the helm chart above - there aren't that many things to configure - i can't see what value it would really create that you couldn't pretty easily whip up for your own use-case",
        "created_at": "2021-04-28T00:19:05.804000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "saying that with 5+ years kubernetes full time as a job",
        "created_at": "2021-04-28T00:19:18.403000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "vault integration would be wise - don't use kubernetes secrets directly for anything that is really sensitive",
        "created_at": "2021-04-28T00:19:46.451000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "oh I can do it in 5 minutes, sure.",
        "created_at": "2021-04-28T00:19:48.368000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "That's not really my point. In the video from Peter for example, you can see managing the health of a node is not trivial. I have picked up this little js for example that does something silly, and compare best known block to the best known block of infura: https://github.com/leapdao/eth-node-healthcheck/blob/master/index.js",
        "created_at": "2021-04-28T00:20:42.136000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "That's a sensible way to know if you're up to speed and can be used for querying. The besu nodes use a prometheus metric named in_sync that is set to 1 if there is less than 5 blocks to one of their peers best blocks.",
        "created_at": "2021-04-28T00:21:34.066000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Check the latest block timestamp against now.  If it is more than `n` minutes ago the node is probably unhealthy.",
        "created_at": "2021-04-28T00:21:47.659000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "that seems like a good enough approach",
        "created_at": "2021-04-28T00:22:11.509000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "that's also a good one, but time is not really a good indicator, if you have drift",
        "created_at": "2021-04-28T00:22:14.463000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It lets you know when things are way off.",
        "created_at": "2021-04-28T00:22:35.314000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "It won't give you instant awareness of falling out of sync.",
        "created_at": "2021-04-28T00:22:44.928000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "or worse, you're on a branch, not on head...",
        "created_at": "2021-04-28T00:22:47.542000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "`n` needs to be like 5 minutes.",
        "created_at": "2021-04-28T00:22:53.358000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "A branch of mainnet is unlikely to be able to mine a block every 5 minutes.",
        "created_at": "2021-04-28T00:23:15.340000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "no that's not what I meant",
        "created_at": "2021-04-28T00:23:31.383000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I meant - you get fresh blocks, but infura and the other nodes are on a different head.",
        "created_at": "2021-04-28T00:23:45.077000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "And at some point you're going to merge.",
        "created_at": "2021-04-28T00:23:51.007000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "If you have many nodes of different types, you can compare their heads against each other.  E.g., nethermind+openethereum+Geth+besu.",
        "created_at": "2021-04-28T00:24:00.392000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "your node is being eclipsed! ðŸ™‚",
        "created_at": "2021-04-28T00:24:01.407000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "even same type",
        "created_at": "2021-04-28T00:24:13.572000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "either way - you do need that ðŸ™‚",
        "created_at": "2021-04-28T00:24:39.701000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Then there is a good amount of customization you'd want to apply in terms of security hardening, like CORS, etc. So yes, ideally, because I'm lazy, I want a helm chart that does it all for me. Please don't judge me harshly ðŸ™‚",
        "created_at": "2021-04-28T00:25:01.698000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Are you trying to defend against a state actor level eclipse attack?  Where there is enough hashpower to move the eclipse chain forward?",
        "created_at": "2021-04-28T00:25:02.894000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I wasn't very serious just now? sorry. Internet forums.",
        "created_at": "2021-04-28T00:26:01.373000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "So that's the requirements I have right here. I am looking for a hardened setup for a redundant set of nodes that I can guarantee will run 24/7.",
        "created_at": "2021-04-28T00:26:42.820000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "with max security and kubernetes.",
        "created_at": "2021-04-28T00:27:08.768000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "spare no expense - load balancer in front of RPC serving nodes, advanced health check and health score, backups, secret management, metrics monitoring. What y'all got?",
        "created_at": "2021-04-28T00:28:23.895000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "I wasn't being clear, I realize now. You do need that, you do need this script that checks the timestamp of the head block and compares it to current time. And it needs to report somewhere that is then used to know whether to use that node for traffic. Like an advanced health check.",
        "created_at": "2021-04-28T00:31:55.573000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "What do you need to be doing with these nodes?",
        "created_at": "2021-04-28T02:28:35.572000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "Full nodes for data analysis",
        "created_at": "2021-04-28T02:57:45.068000+00:00",
        "attachments": null
    },
    {
        "author": "atoulme",
        "category": "Channel Graveyard",
        "parent": "",
        "content": "ah, this is cool: https://ethereum.org/en/developers/tutorials/monitoring-geth-with-influxdb-and-grafana/",
        "created_at": "2021-04-28T19:01:19.381000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "I was away and trying to catch up on the `csc` discussions. Following the above thread and the spec PR (#3897), I can't seem to find the reason why `uint8`  was chosen (instead of `uint16` etc), is uint8 enough and we won't ever go above 255 subnets?",
        "created_at": "2024-08-29T05:43:31.512000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "initial discussions started from: https://github.com/ethereum/consensus-specs/pull/3772\n\nhere it didn’t specify that it should be a uint8 but hinted on it (by stating that it would save 7bytes.). I think If we want to increase the possible highest number of subnets we should also look into possibly changing the enr byte limit from 300 bytes to something higher",
        "created_at": "2024-08-29T06:06:49.735000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "the problem was that everyone was interpreting this differently, and that’s why i made the pr to explicitly ask for unint8",
        "created_at": "2024-08-29T06:07:35.898000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "ah yeah, I remember this PR. RLP only consumes bytes if required, and the `uint8` vs `uint64` encoding for a value like 128 is the same, i.e. there's no 0 fills. I think that's why the original PR just only says big endian integer.",
        "created_at": "2024-08-29T06:23:35.062000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "we did find some peers that thought otherwise?",
        "created_at": "2024-08-29T06:24:39.044000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "so the change just put an upper limit on the number, but should have no change on the ENRs, i.e. Lighthouse's ENR should look the same as before",
        "created_at": "2024-08-29T06:25:00.880000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "yeah i think those clients might have SSZ encoded the number? Is this an old version of the client?",
        "created_at": "2024-08-29T06:25:45.831000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "Manu's PR was supposed to address that problem",
        "created_at": "2024-08-29T06:26:06.573000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "e.g",
        "created_at": "2024-08-29T06:26:50.354000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "yeah looking at the chat above, Nimbus and Teku were both using old Prysm",
        "created_at": "2024-08-29T06:26:53.684000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "both teku and nimbus screenshot there are invalid RLP for 128",
        "created_at": "2024-08-29T06:28:31.399000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "oh i could be wrong sorry, checking",
        "created_at": "2024-08-29T06:29:18.407000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "\u003e RLP encoding stores positive integer efficiently. If a positive integer is less than 128 (which is likely to be the case for the subnets count), then the value needs exactly one byte of storage when encoded\nYeah there shouldn't be any leading 0s",
        "created_at": "2024-08-29T06:31:54.861000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "yeah Nimbus's csc value is uint64 in SSZ (little-endian), not sure about the leading 0s in Teku's csc",
        "created_at": "2024-08-29T06:37:06.012000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Hey that was an older image",
        "created_at": "2024-08-29T06:53:55.332000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "We don’t have that right now",
        "created_at": "2024-08-29T06:54:11.550000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Rn it’s uint8 for both csc and custody subnet count (metadata)",
        "created_at": "2024-08-29T06:55:13.094000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "I think what Jimmy is saying that if Nimbus would have used proper rlp encoding with big endian then it could have stayed uint64, and if the integer value is less than 128, then the value would need to be able to fit in a uint8. So its possible that teku/nimbus wasn't using proper RLP encoding of the csc values before we forced the value to be max uint8.",
        "created_at": "2024-08-29T07:07:52.078000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "Yep, not sure if we should put an upper limit to `csc` without any benefits. For`MetaDataV3` the saving for SSZ `u64` vs `u8` over RPC is quite minimal too. It just mean we can't even increase subnets to 256. (not sure if we need 256 but the limit doesn't seem necessary)",
        "created_at": "2024-08-29T07:13:33.890000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "I don’t think for 1d peerdas we need more than 128 max dc subnets",
        "created_at": "2024-08-29T07:14:07.065000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "In 128 max dc subnets, we have atleast 1 data column sidecar per subnet",
        "created_at": "2024-08-29T07:14:38.748000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Yeah I wasn't aware of the RLP encoding enforcement, and thats why it made sense for me to limit it to uint8 to ensure everyone is on the same level.",
        "created_at": "2024-08-29T07:14:47.500000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "All good, i was a bit confused at first too",
        "created_at": "2024-08-29T07:15:16.890000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Else if max dc subnets are greater than 128? Aren’t we giving scope to publish duplicate/malicious data columns. Not sure cc \u003c@520034910149410861\u003e",
        "created_at": "2024-08-29T07:15:52.702000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Given the fact that our Number Of Columns is 128 as well",
        "created_at": "2024-08-29T07:16:25.151000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "It's getting close to end of day for me, I'll catch up on the discussions tomorrow and maybe wait for Pawan to weigh in as well",
        "created_at": "2024-08-29T07:16:29.332000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "Jimmy, do you think it worth reverting the pr and just say it should be big endian representation of uint64? Or should we change the spec when we need to go above 128?",
        "created_at": "2024-08-29T07:16:36.568000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "I think \u003c@520034910149410861\u003e would be the best person to answer this",
        "created_at": "2024-08-29T07:17:06.860000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "for ENR, i think it would be nice to not put the u8 restriction to `csc` , as the encoding is indifferent for the current value (128).\nfor metada, I don't mind having something smaller than `uint64`, but `uint8` is quite a limitation and the cost saving is minimal to justify for having to do a MetaDataV4 to increase it to `uint16`, or even just 256.",
        "created_at": "2024-08-29T07:19:32.304000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "qq:\n\ncan all cl teams set custom private key for their peerid calculations?",
        "created_at": "2024-08-29T09:51:10.726000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "It can be done for prysm",
        "created_at": "2024-08-29T10:27:57.016000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "where was it specified to be RLP? https://github.com/ethereum/consensus-specs/blob/54093964c95fbd2e48be5de672e3baae8531a964/specs/_features/eip7594/p2p-interface.md#custody-subnet-count does not say RLP, it says\n\u003e Custody subnet count, big endian integer",
        "created_at": "2024-08-29T12:32:34.102000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "If I read `custody_subnet_count: uint64` with `big endian integer` in a CL context, I'd go with a fixed-size 8 bytes in big-endian order",
        "created_at": "2024-08-29T12:34:56.126000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "https://github.com/ethereum/consensus-specs/pull/3772 does make this claim of\n\u003e ENR are already RLP encoded, so there is no need to both SSZ and RLP encode.\n\nbut I don't see how this is reflected in the CL specs",
        "created_at": "2024-08-29T12:39:26.192000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "any reason you would go with 8bytes ?",
        "created_at": "2024-08-29T12:44:53.917000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "`uint64`",
        "created_at": "2024-08-29T12:45:17.419000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "I like `uint8` fine too as a type",
        "created_at": "2024-08-29T12:45:29.474000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "but the question was regarding the previous version of the specs, and without further elaboration, default assumption is fixed-size. fixed-size + `uint64` == 8 bytes, always",
        "created_at": "2024-08-29T12:46:08.499000+00:00",
        "attachments": null
    },
    {
        "author": "nashatyrev",
        "category": "Testing",
        "parent": "",
        "content": "`--p2p-private-key-file` option for Teku",
        "created_at": "2024-08-29T13:03:10.584000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "For prysm:\n\n```\n--p2p-priv-key value                           The file containing the private key to use in communications with other peers.\n```",
        "created_at": "2024-08-29T15:03:48.901000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@777935002263617576\u003e \u003c@466006586477772831\u003e",
        "created_at": "2024-08-29T15:11:35.141000+00:00",
        "attachments": null
    },
    {
        "author": "pawandhananjay",
        "category": "Testing",
        "parent": "",
        "content": "we don't have a flag as of now but you can replace the `$datadir/beacon/network/key` file with a valid `secp256k1` key and it will take that",
        "created_at": "2024-08-29T19:00:34.921000+00:00",
        "attachments": null
    },
    {
        "author": "pawandhananjay",
        "category": "Testing",
        "parent": "",
        "content": "I agree. For enrs, we can just say big endian encoding of the of the csc and it gets rlp encoded based on its size. That way if we ever need to go beyond 255 (256 subnets doesn't seem that crazy in the near future), we can do that without any changes to the spec. \nFor metadata, i don't really mind if we set it to u16 or u64, but if we keep it as u8 and need to change it in the future, that would require further coordination among clients",
        "created_at": "2024-08-29T19:14:31.688000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "https://github.com/ethereum/devp2p/blob/master/enr.md#rlp-encoding this specifies that the whole enr is supposed to be RLP encoded",
        "created_at": "2024-08-29T19:31:12.113000+00:00",
        "attachments": null
    },
    {
        "author": "tersec",
        "category": "Testing",
        "parent": "",
        "content": "ok, that does answer this question",
        "created_at": "2024-08-29T21:18:52.950000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "would you mind making a pr with the revert pls?",
        "created_at": "2024-08-29T21:20:50.579000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@199561711278227457\u003e I have an image for the next devnet: https://github.com/prysmaticlabs/prysm/tree/peerDAS-revert-failing-commit-develop\n\nThe name of the branch is strange because this branch contains the `peerDAS` branch + the revert of a commit on our `develop` branch, unrelated to peerDAS but which makes some issues at the Fulu fork. (And because peerDAS runs at the Fulu fork, there is some issues if I don't revert this commit for peerDAS...)\n\nTests done, with **Prysm only**:\n- Standard run starting at Deneb: âœ…\n- Start only three quarters of the nodes for 10 epochs (finalizing devnet), then start the missing quarter and wait all nodes are synced to the head:  âœ…\n- Start only half of the nodes for 10 epochs (**un**finalizing devnet), then start the other half and wait all nodes are synced to the head, and the network is finalizing:  âœ…\n- Run with a node withholding 64 out of 128 columns when proposing a block, forcing other super nodes to reconstruct missing columns: âœ…\n- Run a node which forks itself every 20 slots, then try to rejoin the main fork: (Some orphaned blocks if proposing just after a forced fork, but âœ…)\n\nValidator custody is **not** implemented.\n\nIf other clients have an image I can interop with, please share ðŸ™‚",
        "created_at": "2025-01-15T21:22:47.243000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "My kurtosis config for information:\n```yaml\nparticipants_matrix:\n  el:\n    - el_type: geth\n  cl:\n      - cl_type: prysm\n        cl_image: prysm-bn-custom-image:latest\n        vc_image: prysm-vc-custom-image:latest\n        cl_max_mem: 4096\n        count: 2\n        cl_extra_params:\n          - --minimum-peers-per-subnet=1\n          - --subscribe-all-subnets\n          - --log-format=json\n        vc_extra_params:\n          - --log-format=json\n      - cl_type: prysm\n        count: 1\n        cl_image: prysm-bn-custom-image:latest\n        vc_image: prysm-vc-custom-image:latest\n        cl_max_mem: 4096\n        cl_extra_params:\n          - --minimum-peers-per-subnet=1\n          - --log-format=json\n          - --data-columns-withhold-count=64\n        vc_extra_params:\n          - --log-format=json\n      - cl_type: prysm\n        count: 1\n        cl_image: prysm-bn-custom-image:latest\n        vc_image: prysm-vc-custom-image:latest\n        cl_max_mem: 4096\n        cl_extra_params:\n          - --data-columns-ignore-slot-multiple=20\n          - --minimum-peers-per-subnet=1\n          - --log-format=json\n        vc_extra_params:\n          - --log-format=json\nnetwork_params:\n  seconds_per_slot: 4\n  electra_fork_epoch: 1\n  fulu_fork_epoch: 2\nsnooper_enabled: true\nglobal_log_level: debug\nadditional_services:\n  - dora\n  - spamoor_blob\n  - prometheus_grafana\ndora_params:\n  image: ethpandaops/dora:fulu-support\nethereum_metrics_exporter_enabled: true\n```",
        "created_at": "2025-01-15T21:23:21.856000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "This is amaazingg ðŸ˜„\nShall i also trigger one of our longer range tests? just leave the network up for a few days and see what happens?",
        "created_at": "2025-01-15T21:27:37.502000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "Before launching a new devnet, I think each team should locally test if its own client works with other clients.\n(At least I would like to test locally Prysm+LH, Prysm+Teku, Prysm+Nimbus... before confidently launching a new devnet.)",
        "created_at": "2025-01-15T21:31:02.171000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "ah i meant just a prysm devnet on kurtosis, if i do it on our kubernetes cluster then its not tied to someone turning off their laptop or whatever",
        "created_at": "2025-01-15T21:31:59.316000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "so cost of trying it is negligible",
        "created_at": "2025-01-15T21:32:11.183000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "OK I see. Well, if you wish to do it with Prysm only now I'm happy with that!",
        "created_at": "2025-01-15T21:33:03.030000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Testing",
        "parent": "",
        "content": "But yeah it would indeed be nice to start doing some interop tests too ðŸ˜„",
        "created_at": "2025-01-15T21:34:39.781000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "Note I use `seconds_per_slot: 4` .Not sure we should use that for a long running devnet, but at least, if an issue should happen, it happens faster ðŸ™‚",
        "created_at": "2025-01-15T21:37:47.622000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "So in the kurtosis config for information:\n```\n--data-columns-withhold-count=64\n```\n\nis the \"shoot in my own foot flag #1\": The node will only broadcasts columns 64 to 123, forcing other super nodes to reconstruct.\n\n```\n--data-columns-ignore-slot-multiple=20\n```\n\nis the \"shoot in my own foot flag #2\": At slot 0, 20, 40, 60, .... the node will voluntary ignore all incoming data columns and so consider the block as unavailable.\nIf it has to propose at a slot let say 21, it will probably build its block on the block at slot 19 (because block at slot 20 is unavailable to it.)\nEventually, it will send data columns by root RPC requests, then rejoin the main fork.\n\nHere is an extreme case:",
        "created_at": "2025-01-15T21:47:53.984000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2025-01-15T21:47:56.416000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "ac4ad831faf19c4cfa6d6579e9da7d2e3c927a51a99f93b8f73325b15406d73d"
            }
        ]
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "Data columns at slot 100 are voluntary ignored by node `4-geth-prysm`.\nThis node has to propose 4 blocks in a raw starting at slot 104. It does, but because the first one is based on block at slot 99 (since block at slot 100 is considered unavailable), all these blocks are orphaned.",
        "created_at": "2025-01-15T21:49:21.388000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "Eventually, it rejoins the main fork, and proposes canonical blocks at slots 111 and 113",
        "created_at": "2025-01-15T21:49:56.651000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "Nice, this is a good test for recovery - our devnets forked a few times from this",
        "created_at": "2025-01-15T23:38:57.456000+00:00",
        "attachments": null
    }
]
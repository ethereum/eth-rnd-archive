[
    {
        "author": "samcm",
        "category": "Testing",
        "parent": "",
        "content": "Is there a way to directly access the",
        "created_at": "2024-10-01T00:37:44.100000+00:00",
        "attachments": null
    },
    {
        "author": "samcm",
        "category": "Testing",
        "parent": "",
        "content": "is checkpoint sync working? I'm gettting",
        "created_at": "2024-10-01T00:41:58.940000+00:00",
        "attachments": null
    },
    {
        "author": "jimmygchen",
        "category": "Testing",
        "parent": "",
        "content": "what's the use case of this endpoint? for checkpoint syncing?",
        "created_at": "2024-10-01T04:54:32.735000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "yeah, to avoid downloading deposit receipts",
        "created_at": "2024-10-01T08:03:03.616000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "I forgot that it's not common yeah, and we should work without it",
        "created_at": "2024-10-01T08:03:20.643000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "When trying to sync Prysm super node from scratch, I have some issues:\nExample:\n```\n[2024-10-01 13:04:11.07] DEBUG initial-sync: Peer did not returned all requested data columns missingColumns=[2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127] peer=16Uiu2HAm8D4RoWPbyTMU396VcqqDfGvmwthL2fBtJcL8NHiCpWLq requestedColumns=all requestedCount=64 requestedRoot=0xf2a0be5cdc7e2ec4372965efcd3bc47547153a64f30684948ac1d5211c581e14 requestedStartSlot=896 slot=947\n```\n\n`16Uiu2HAm8D4RoWPbyTMU396VcqqDfGvmwthL2fBtJcL8NHiCpWLq` is `nimbus-geth-5` (super node, currently synced.)\n\nSo, Prysm requests all the 128 columns  to  `nimbus-geth-5` with `columnsByRange`.\nWhen responding, `missingColumns` are missing (everything is missing but columns 0 and 1).\n\nThe parameters of the by range request are `startSlot=896`  (finalized slot) and `count=64`.\n\nAlso, when I try to use the corresponding beacon API:\n```\nhttps://bn.nimbus-geth-5.peerdas-devnet-2.ethpandaops.io/eth/v1/beacon/blob_sidecars/947\n```\n\nI get:\n\n```\n{\n  \"data\": []\n}\n```\n\ncc \u003c@785811170387951616\u003e",
        "created_at": "2024-10-01T11:26:37.639000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Looking into it, currently blob sidecars beacon api won‚Äôt return anything, because it‚Äôs disabled",
        "created_at": "2024-10-01T11:29:12.894000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "So you get 0 1 and thats it right? Okay a similar issue from Lodestar as well. Need to investigate further. Thanks for reporting üôè",
        "created_at": "2024-10-01T11:30:43.351000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "Yes I got 0 and 1 only.",
        "created_at": "2024-10-01T11:31:27.639000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Okay",
        "created_at": "2024-10-01T11:31:34.148000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "I made some changes yesterday I think they haven‚Äôt reflected yet on devnet 2, I‚Äôll try and sync super prysm on an all nimbus supernode network and report back",
        "created_at": "2024-10-01T11:33:14.657000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "There is most likely an issue in the data column grouping conditions I think. Will enable some logging around there",
        "created_at": "2024-10-01T11:35:50.251000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@412614104222531604\u003e i have just build a new lodestar build to add more cleaner and clear debugging logs which can be useful in someone who wants to debug the issues pointed by me, could you update the image on the devnet anyway",
        "created_at": "2024-10-01T12:16:33.454000+00:00",
        "attachments": null
    },
    {
        "author": "barnabasbusa",
        "category": "Testing",
        "parent": "",
        "content": "cce193b is rolling out",
        "created_at": "2024-10-01T12:22:11.818000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "did any of the client teams who retransmitted Grandine's invalid data column sidecars, had kzg inclusion proof verification implemented in gossip validation, and still retransmitted? i notice Nimbus had it implemented for quite some time, and yet it retransmitted. trying to iron out the cause\n\ncc \u003c@792822129019584562\u003e \u003c@425907307621122049\u003e \u003c@466006586477772831\u003e",
        "created_at": "2024-10-01T17:44:08.319000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "we have the validation, also need to check why it happened",
        "created_at": "2024-10-01T17:53:43.886000+00:00",
        "attachments": null
    },
    {
        "author": "g11tech",
        "category": "Testing",
        "parent": "",
        "content": "fyi: have also found an issue in lodestar serving of finalized datacolumns, will fix and update image",
        "created_at": "2024-10-01T19:14:50.626000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "We have all spec validations, no clue why this happened. If anybody have this datacolumnsidecar saved, it would be very helpful. We've added an API to download it next time, but it's already pruned I guess",
        "created_at": "2024-10-01T19:57:33.527000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Then the question is what extra did Prysm check that we didn‚Äôt ü§î because then the network would look totally different",
        "created_at": "2024-10-01T19:58:58.714000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Maybe just checked for zero len before sending for inclusion check",
        "created_at": "2024-10-01T19:59:30.630000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "We implemented the spec.\nThe test which failed when Grandine gossiped a data column sidecar message for an block without a blob was this one:\n\n\u003e [REJECT] The sidecar's `kzg_commitments` field inclusion proof is valid as verified by `verify_data_column_sidecar_inclusion_proof(sidecar)`.",
        "created_at": "2024-10-01T20:00:43.819000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Yes",
        "created_at": "2024-10-01T20:01:04.251000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "The fun fact is all of us wrote that as well",
        "created_at": "2024-10-01T20:01:15.897000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "üòÇüòÇüòÇüòÇ",
        "created_at": "2024-10-01T20:01:20.471000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "Not sure the network would look different. The block itself was totally valid actually.",
        "created_at": "2024-10-01T20:01:33.473000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Because I believe we would all disconnect grandine?",
        "created_at": "2024-10-01T20:02:07.799000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "As in the participation would look different",
        "created_at": "2024-10-01T20:02:21.966000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "Normally in such a case however, Grandine should have been disconnected from all other clients.\nHere, Prysm disconnected all other clients...",
        "created_at": "2024-10-01T20:02:29.597000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Exactly",
        "created_at": "2024-10-01T20:02:38.581000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "we have it for a month\nand there are some reference tests for inclusion proof verification, we pass them all",
        "created_at": "2024-10-01T20:03:26.140000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "e8ebea5e58bc36eaac1f2b86aa62f554d49b2cf71f4157fb2575c8101bb18f58"
            }
        ]
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Same",
        "created_at": "2024-10-01T20:03:39.624000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "Weird",
        "created_at": "2024-10-01T20:03:47.829000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "So, what happened in Prysm during the Grandine issue:\n\nWhen receiving a data column message, spec verifications are executed.\n1. There is one called [SidecarInclusionProven](https://github.com/prysmaticlabs/prysm/blob/96f4b7d8cb178a1457311fe24b7d38f5782cbb72/beacon-chain/verification/data_column.go#L243-L252).\n2. This function calls [VerifyKZGInclusionProofColumn](https://github.com/prysmaticlabs/prysm/blob/96f4b7d8cb178a1457311fe24b7d38f5782cbb72/consensus-types/blocks/kzg.go#L50-L77) with the data column sidecar.\n3. This function calls [leavesFromCommitments](https://github.com/prysmaticlabs/prysm/blob/96f4b7d8cb178a1457311fe24b7d38f5782cbb72/consensus-types/blocks/kzg.go#L141-L150) with the commitments of the data column sidecar.\nThe output of `3.`  (the leaves) what an empty array (or more precisely an empty slice in go jargon).\n\nThe fact that the leaves were empty caused `GeneratTrieFromItems` to return on error, bubbling up to a gossip message rejection.",
        "created_at": "2024-10-01T20:15:42.347000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "Here it is, not pruned yet",
        "created_at": "2024-10-01T20:17:48.294000+00:00",
        "attachments": [
            {
                "type": "application/json; charset=utf-8",
                "origin_name": "slot_37.json",
                "content": "ae1053e5488d646c1301ee88a5e787f0c4f454eb2bdd0b8b5fef54ed887036cb"
            }
        ]
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "```json\n{\n            \"index\": \"0\",\n            \"column\": [],\n            \"kzg_commitments\": [],\n            \"kzg_proofs\": [],\n            \"signed_block_header\": {\n                \"message\": {\n                    \"slot\": \"37\",\n                    \"proposer_index\": \"3426\",\n                    \"parent_root\": \"0x6d3091dae0e2a0251cc2c0d9fef846e1c6e685f18fc8a2c7734f25750c22da36\",\n                    \"state_root\": \"0x715f24108254c3fcbef60c739fe702aed3ee692cb223c884b3db6e041c56c2a6\",\n                    \"body_root\": \"0xbea87258cde49915c8c929b6b91fbbcde004aeaaa08a3ccdc3248dc62b0e682f\"\n                },\n                \"signature\": \"0xb4c313365edbc7cfa9319c54ecba0a8dc54c8537752c72a86c762eb0a81b3ad1eda43f0f3b19a9c9523a6a42450c1d070556e0a443d4733922765764ef5850b41d20b4f6af6cc93a70eb1023cc63473f111de772315a2726406be9dc6cb24e67\"\n            },\n            \"kzg_commitments_inclusion_proof\": [\n                \"0x792930bbd5baac43bcc798ee49aa8185ef76bb3b44ba62b91d86ae569e4bb535\",\n                \"0xcd581849371d5f91b7d02a366b23402397007b50180069584f2bd4e14397540b\",\n                \"0xdb56114e00fdd4c1f85c892bf35ac9a89289aaecb1ebd0a96cde606a748b5d71\",\n                \"0x9535c3eb42aaf182b13b18aacbcbc1df6593ecafd0bf7d5e94fb727b2dc1f265\"\n            ]\n        },\n```\n\nEmpty `column`, empty `kzg_commitments`, empty `kzg_proofs`",
        "created_at": "2024-10-01T20:19:53.425000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "ahh",
        "created_at": "2024-10-01T20:20:26.373000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "awesome",
        "created_at": "2024-10-01T20:20:29.443000+00:00",
        "attachments": null
    },
    {
        "author": "manunlp",
        "category": "Testing",
        "parent": "",
        "content": "(same for indices 1 to 127)",
        "created_at": "2024-10-01T20:20:46.018000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "basically need a zero len check before sending for inclusion proof ver",
        "created_at": "2024-10-01T20:20:56.079000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "this can be modified in the spec",
        "created_at": "2024-10-01T20:21:37.089000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "should be",
        "created_at": "2024-10-01T20:21:42.837000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "and test added",
        "created_at": "2024-10-01T20:22:21.917000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "fixed üôÇ",
        "created_at": "2024-10-01T20:24:58.137000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "do we check kzg proof first or inclusion proof first?",
        "created_at": "2024-10-01T20:26:38.023000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "because if we checked kzg proof first",
        "created_at": "2024-10-01T20:26:52.931000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "then it wouldn't go till inclusion",
        "created_at": "2024-10-01T20:27:04.378000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Testing",
        "parent": "",
        "content": "The spec doesn't define the order of checks",
        "created_at": "2024-10-01T20:28:30.977000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Testing",
        "parent": "",
        "content": "To be clear. It's a list but they are not required to be in that order.",
        "created_at": "2024-10-01T20:29:42.240000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Testing",
        "parent": "",
        "content": "But yeah good idea, if you do the `verify_data_column_sidecar_kzg_proofs` check first I think it will catch this.",
        "created_at": "2024-10-01T20:31:16.585000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "exactly",
        "created_at": "2024-10-01T20:31:28.857000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "if it's rejected on any rule, it's not passed further",
        "created_at": "2024-10-01T20:39:41.871000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "and it fails to pass inclusion prroof in our code",
        "created_at": "2024-10-01T20:39:52.450000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Testing",
        "parent": "",
        "content": "Yeah. `verify_data_column_sidecar_kzg_proofs` needs a another check.",
        "created_at": "2024-10-01T20:39:55.821000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "so it was not verified before distributed",
        "created_at": "2024-10-01T20:40:01.163000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Testing",
        "parent": "",
        "content": "To ensure there's at least one column/commitment/proof.",
        "created_at": "2024-10-01T20:40:11.833000+00:00",
        "attachments": null
    },
    {
        "author": "agnxsh",
        "category": "Testing",
        "parent": "",
        "content": "Exactly",
        "created_at": "2024-10-01T20:40:33.193000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "anyway, this doesn't pass, so we have a bug",
        "created_at": "2024-10-01T20:40:52.399000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "3c45f373777828f0a47699dfffa3559141a5436cb103cf8d781b8c3a4d4f3e36"
            }
        ]
    },
    {
        "author": "jtraglia",
        "category": "Testing",
        "parent": "",
        "content": "Hmm. Could you share the whole thing, just so I can double-check it?",
        "created_at": "2024-10-01T20:46:12.957000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Testing",
        "parent": "",
        "content": "But it's unlikely that you made a copy/paste mistake.",
        "created_at": "2024-10-01T20:46:56.326000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@531934490826768418\u003e would that ~~be true~~ pass for prysm?",
        "created_at": "2024-10-01T20:47:25.299000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "I see that we have only kzg proof check on req/resp, so it arrived on req/resp probably, not by gossip",
        "created_at": "2024-10-01T20:48:01.204000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "https://github.com/zilm13/teku/commit/d7f0db7d1956f657fbceadc0e60a43d4b570c079",
        "created_at": "2024-10-01T20:49:55.582000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Testing",
        "parent": "",
        "content": "Are you saying that your resp handler doesn't check the inclusion proof?",
        "created_at": "2024-10-01T20:50:07.264000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "yeah, only kzg proof\nhttps://github.com/zilm13/teku/blob/506db116a818c6fcb356630708a5b2bfae6feee1/networking/eth2/src/main/java/tech/pegasys/teku/networking/eth2/rpc/beaconchain/methods/DataColumnSidecarsByRootValidator.java#L27",
        "created_at": "2024-10-01T20:51:17.573000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "the question is why did we request it",
        "created_at": "2024-10-01T20:51:27.046000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "when we know that block has 0 commitments",
        "created_at": "2024-10-01T20:51:40.833000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Testing",
        "parent": "",
        "content": "Hmm it _should_ check the inclusion proof though.",
        "created_at": "2024-10-01T20:51:57.557000+00:00",
        "attachments": null
    },
    {
        "author": "jtraglia",
        "category": "Testing",
        "parent": "",
        "content": "",
        "created_at": "2024-10-01T20:51:58.921000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "image.png",
                "content": "8cfbcdb2c3e330c6c1d2f8722a71ae15662ebf324fbf6d639053aca0f275cd2e"
            }
        ]
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "nice storming, thank you!",
        "created_at": "2024-10-01T20:52:37.260000+00:00",
        "attachments": null
    },
    {
        "author": "dmitriishmatko",
        "category": "Testing",
        "parent": "",
        "content": "Still no guess why did we request it, but made pr to fix req/resp validation according to the spec.\nWe had logic that if someone requests DataColumnSidecar from us, and we don't have it, we try to get if from network, but I think we removed it. If not, it's the reason why we decided to request it.",
        "created_at": "2024-10-01T22:01:36.440000+00:00",
        "attachments": null
    },
    {
        "author": "nishant0",
        "category": "Testing",
        "parent": "",
        "content": "We got this in gossip though from teku. Is there a possibility teku will skip validating the inclusion proof if there are no commitments ?",
        "created_at": "2024-10-01T23:09:14.017000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "parithosh",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I'm not super deep in the p2p world, but is there some reason why an ethereum node cannot run over tor?\n\nThe part that breaks would be UDP, but UDP is just used for discovery (atleast in discv5). But you can turn off discovery and set up the node with static peers. Everything else should happen over TCP anyway. You'd probably need to proactively set some flags as to what address to advertise, etc - but that's possible already. \n\nThe other mitigating factor is that a validator process can connect to multiple beacon nodes, if one is down it will fallback to the other. So you could setup 2-3 beacon nodes and be sure that your information gets across despite of ddos attacks on 1-2 of them. You can set bn's to be on remote vps's or add a VPN on top and you'd probably achieve a decent amount of privacy - of course not perfect.",
        "created_at": "2022-08-17T10:21:30.170000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I would tentatively argue that configuring a client in a way like you described above is non-trivial right now.  One could certainly imagine what you described being part of a roadmap toward better node privacy, but I think at the moment anything that requires one to be an expert in operating distributed systems and configuring complex network topologies doesn't count as \"a feature of Ethereum\".",
        "created_at": "2022-08-17T10:28:07.718000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Yea of course, but I also don't see us advertising extreme validator privacy as a feature - but it is possible if required. \n\nre. OPs point about de-anonymizing transactions (in the twitter thread) by tracking which node proposes. That' doesn't really apply. Ethereum nodes gossip transactions, so its hard to pin down the origin node of the tx to begin with, a node proposing a block with a tx tells me nothing about the origin of it. \n\nThe issue of anonymity is knowing where a node is running and being able to DDoS it or $5 dollar wrench attack. That's partially mitigated by using multiple beacon nodes, having one beacon node for attestations and one with moving IPs for proposals, VPN or potentially even a beacon node with Tor. I will concede that it's non-trivial to set these up, It will probably not be a dappnode package default.",
        "created_at": "2022-08-17T10:37:12.878000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "\u003e I also don't see us advertising extreme validator privacy as a feature\nWhy not?",
        "created_at": "2022-08-17T10:38:29.387000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I believe the attack vector that allows associating an IP with a transaction is via a partial eclipse attack, which isn't particularly difficult for a motivated attacker (like a government).",
        "created_at": "2022-08-17T10:39:10.648000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Consensus Layer",
        "parent": "",
        "content": "because we can't advertise what we don't have, by default it is possible to link IPs to validator public keys if you listen to gossip long enough and deploy a wide enough network of listeners",
        "created_at": "2022-08-17T10:39:14.244000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "All you need to do is simulate ~10,000 nodes and you will end up with an incredibly high fidelity view of the network.  Actual number of nodes you need backing that is *much* smaller.",
        "created_at": "2022-08-17T10:39:46.853000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Fair enough, but that is just as possible today as it will be post merge",
        "created_at": "2022-08-17T10:40:32.139000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Consensus Layer",
        "parent": "",
        "content": "we aren't adding a new attack vector",
        "created_at": "2022-08-17T10:40:38.964000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Agreed.  I think \u003c@943912959057461258\u003e's argument is that node operator privacy isn't anywhere on the current roadmap, and they believe it should be.",
        "created_at": "2022-08-17T10:40:59.197000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I'd argue it is part of the roadmap, with:\n- https://ethresear.ch/t/whisk-a-practical-shuffle-based-ssle-protocol-for-ethereum/11763\n- https://twitter.com/vitalikbuterin/status/1510878404626763779?lang=en",
        "created_at": "2022-08-17T10:42:27.654000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I think the recent events are lighting some fires under people to adjust the roadmap because the events increase the probability that we may see a significant amount of government censorship of Ethereum in the near future.",
        "created_at": "2022-08-17T10:42:40.955000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "IIUC, some form of secret leader election definitely helps protect block builders from DoS attacks against them at the time of block building, but it doesn't provide any kind of privacy guarantees?",
        "created_at": "2022-08-17T10:43:37.988000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "If the concern is that your local government will come at you with a wrench if they find out that you are building Ethereum blocks or submitting Ethereum transactions, SLE doesn't protect you.",
        "created_at": "2022-08-17T10:44:37.785000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Ah true, it provides some guarantees against proactive attacks but not against privacy itself.",
        "created_at": "2022-08-17T10:44:47.491000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Yea, agreed. I guess at the point the saviour would need to be some sort of in protocol mixing, or distributed validator tech.",
        "created_at": "2022-08-17T10:45:38.414000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Having a validator split amongst various hosts in different locations, potentially across entities will be a simple-ish way to achieve privacy and resilience.",
        "created_at": "2022-08-17T10:47:17.448000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Or better support for participating in the network over something like Tor or I2P.",
        "created_at": "2022-08-17T10:48:11.379000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "That way we can shove the \"how do you privately access Ethereum from inside a censored country\" problem off onto other protocols who are focusing on this specific problem.",
        "created_at": "2022-08-17T10:49:03.555000+00:00",
        "attachments": null
    },
    {
        "author": "parithosh",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Which is possible, but not a \"by default\" option. That doesn't seem like something the protocol would address anyway, but the implementation or perhaps a wrapper around a client/setup tool.",
        "created_at": "2022-08-17T10:49:07.149000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "It *may* involve network protocol tweaks.  For example, a mechanism for discovery that doesn't depend on UDP.",
        "created_at": "2022-08-17T10:49:34.099000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "But there may be other ways that clients can enable this sort of setup that don't require core protocol changes.",
        "created_at": "2022-08-17T10:49:48.213000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I think getting smart people thinking seriously about this problem and trying to come up with technical solutions is the \"ask\" here, rather than any specific solution.",
        "created_at": "2022-08-17T10:50:25.055000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Like we have smart people solving the secret leader election problem, the specific implementation isn't as critical as just having smart people prioritizing it over other things.",
        "created_at": "2022-08-17T10:50:59.408000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "A sort of tor-lite could be implemented by having known entities (EF, client teams, DeFi teams _etc._) run 'broadcast nodes' that can receive (for example) signed blocks from any server over HTTP(s) and broadcast them on P2P.  Then beacon nodes can select a subset at random each time it needs to send something and obtain a decent level of invisibility in terms of node\u003c-\u003evalidator mapping.",
        "created_at": "2022-08-17T11:52:12.552000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Wouldn't this only provide privacy if *all* of the nodes you select protect your privacy?",
        "created_at": "2022-08-17T11:59:01.193000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Any one of them could identify and report you.",
        "created_at": "2022-08-17T11:59:10.837000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Oh, I think what you are describing is a solution to the DoS of block proposers problem, which is different from privacy against wrench attacks by local governments.",
        "created_at": "2022-08-17T11:59:45.960000+00:00",
        "attachments": null
    },
    {
        "author": "jgm",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Somewhat; it does protect against DoS, but as you say if you select nodes that are privacy-preserving then you have a better chance of being entirely private.  And any tor-like network is always going to have the issue of a government entity (or whomever) flooding the network with intermediate and exit nodes to capture a good view of the network regardless of the supposed privacy.",
        "created_at": "2022-08-17T12:05:29.383000+00:00",
        "attachments": null
    },
    {
        "author": "paulmillr",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Appreciate keeping the discussion up, Micah.",
        "created_at": "2022-08-17T12:20:35.465000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Yeah, partial eclipse attacks are certainly a problem with Tor like designs.  However, I would argue that Tor (and similar) gives significantly more protection than without, and you can boost this a *lot* by having a single trusted public Tor node in your route.",
        "created_at": "2022-08-17T12:21:04.118000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "With Tor (IIUC) only one node in your route needs to be honest, the rest can be malicious and your privacy will be preserved.",
        "created_at": "2022-08-17T12:21:34.236000+00:00",
        "attachments": null
    },
    {
        "author": "asn_d6",
        "category": "Consensus Layer",
        "parent": "",
        "content": "if your entry *and* exit is malicious, you are hosed",
        "created_at": "2022-08-17T20:22:46.564000+00:00",
        "attachments": null
    },
    {
        "author": "asn_d6",
        "category": "Consensus Layer",
        "parent": "",
        "content": "(even if your middle is honest)",
        "created_at": "2022-08-17T20:23:23.619000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Hmm, even if you have an honest participant in the middle?",
        "created_at": "2022-08-17T20:23:25.015000+00:00",
        "attachments": null
    },
    {
        "author": "asn_d6",
        "category": "Consensus Layer",
        "parent": "",
        "content": "yeah",
        "created_at": "2022-08-17T20:23:29.553000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "How is that?",
        "created_at": "2022-08-17T20:23:29.941000+00:00",
        "attachments": null
    },
    {
        "author": "asn_d6",
        "category": "Consensus Layer",
        "parent": "",
        "content": "because they can do end-to-end correlation attacks",
        "created_at": "2022-08-17T20:23:34.237000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Because they can correlate?",
        "created_at": "2022-08-17T20:23:37.307000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Ah, sure.  Unless your middle is unreliably slow.  ðŸ˜„",
        "created_at": "2022-08-17T20:23:54.330000+00:00",
        "attachments": null
    },
    {
        "author": "asn_d6",
        "category": "Consensus Layer",
        "parent": "",
        "content": "statistics go a long way",
        "created_at": "2022-08-17T20:24:07.549000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "Sure, that is why you want unreliably slow.  ðŸ˜„",
        "created_at": "2022-08-17T20:24:17.247000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "So each packet takes a random amount of time, some take minutes and some take milliseconds.",
        "created_at": "2022-08-17T20:24:32.036000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I'm pretty sure I have been connected to Tor nodes like this before.  ðŸ˜¬",
        "created_at": "2022-08-17T20:24:40.609000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Consensus Layer",
        "parent": "",
        "content": "I guess they were protecting me?",
        "created_at": "2022-08-17T20:24:45.164000+00:00",
        "attachments": null
    },
    {
        "author": "asn_d6",
        "category": "Consensus Layer",
        "parent": "",
        "content": "~~entry can also delay packets; and make sure that nothing will get to the other end in milliseconds~~",
        "created_at": "2022-08-17T20:25:20.764000+00:00",
        "attachments": null
    },
    {
        "author": "asn_d6",
        "category": "Consensus Layer",
        "parent": "",
        "content": "ah no that doesn't work lol",
        "created_at": "2022-08-17T20:25:40.264000+00:00",
        "attachments": null
    },
    {
        "author": "asn_d6",
        "category": "Consensus Layer",
        "parent": "",
        "content": "i don't know much about ethereum's networking stack, but i know that bitcoin supports tor onion services as inbound addresses for full nodes",
        "created_at": "2022-08-17T20:27:13.477000+00:00",
        "attachments": null
    },
    {
        "author": "asn_d6",
        "category": "Consensus Layer",
        "parent": "",
        "content": "i also know that ethereum's ENRs do not support onion services",
        "created_at": "2022-08-17T20:27:32.189000+00:00",
        "attachments": null
    }
]
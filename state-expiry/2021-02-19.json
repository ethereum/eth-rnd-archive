[
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!273808422753796097\u003e regarding the removal of ripemd160: one could rewrite it in pure EVM and have it deployed at the precompile address. This would mean no breakage is introduced.\n\nDid a rough calculation and it seems to be possible to implement it for ~7000 gas per word. The current cost is 600+120 per word.",
        "created_at": "2021-02-19T16:31:52.586000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Having ROT/ROR opcodes (which we avoided as part of the bitwise shifting EIP due to lack of interest) would cut this cost by 30%. Rotation opcodes could be useful for any other hash function too (certainly for sha/keccak/blake2 family).",
        "created_at": "2021-02-19T16:34:43.692000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Would we end up gaining from the removal still in this case?",
        "created_at": "2021-02-19T16:35:31.315000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "No precompile. It is just a regular account.",
        "created_at": "2021-02-19T16:35:44.091000+00:00",
        "attachments": []
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I guess the idea is that state already has to be forward ported, and so if that is replaced in state prior to The Merge then it becomes \"free\" to retain it after that (code wise).",
        "created_at": "2021-02-19T16:36:18.111000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Specifically about ripemd160: I do not think it is worth it, as I doubt anyone ever used it. btcrelay did, but it is long dead. \n\nIt is however a very simple one to prototype this concept and/or have discussions around.",
        "created_at": "2021-02-19T16:37:16.877000+00:00",
        "attachments": []
    },
    {
        "author": "pauld.9606",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I have been considering deprecating alt_bn128 precompiles, https://notes.ethereum.org/@poemm/Pre-EIP-deprecate-alt_bn128 . This may take a year.",
        "created_at": "2021-02-19T16:42:40.131000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh fascinating!",
        "created_at": "2021-02-19T17:04:52.089000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The theory would be that once we have EVM256 we could cut down gas costs even further, and this would let us just make an in-place replacement?",
        "created_at": "2021-02-19T17:05:12.686000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\"cut down gas costs\"? People were complaining about the current 3/3/6 and 1/1/3 ðŸ˜‰",
        "created_at": "2021-02-19T17:05:57.253000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh I mean cut down gas costs relative to the current EVM",
        "created_at": "2021-02-19T17:06:25.003000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You mean repricing EVM instructions?",
        "created_at": "2021-02-19T17:06:42.534000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "nono I mean, writing code with EVM256 should be lower-gas-cost than writing the same code using current EVM",
        "created_at": "2021-02-19T17:07:02.685000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because you don't need PUSH and other boilerplate",
        "created_at": "2021-02-19T17:07:10.045000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You certainly need push unless versioning is introduced to allow for immediates.",
        "created_at": "2021-02-19T17:07:31.480000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Doesn't the current proposal already have immediates?",
        "created_at": "2021-02-19T17:07:44.076000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It does a clever thing where it makes the new immediates backwards compatible by wrapping them inside a PUSH9",
        "created_at": "2021-02-19T17:07:59.989000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We always had a version with immediates, but due to the backlash on any proposal using immediates we have been proposing the push version.",
        "created_at": "2021-02-19T17:08:35.770000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh btw \u003c@!682078300234973185\u003e I think we should work on optimizing that. In the medium term future we will need to charge gas per chunk of code accessed, so cutting each coordinate down to 1 byte would be ideal",
        "created_at": "2021-02-19T17:08:38.869000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In any case we have been prototyping variable modulus length versions of the instructions, with a different parameter encoding model. Hoping to release soon.",
        "created_at": "2021-02-19T17:09:09.877000+00:00",
        "attachments": []
    },
    {
        "author": "pauld.9606",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Not true.",
        "created_at": "2021-02-19T17:11:25.745000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Do you mean that pattern `push9 \u003cdata\u003e \u003cop\u003e` could be verified by the evm prior to execution, and consider it as an immedaite? Such proposals were made for subroutines but there was always backlash about it.",
        "created_at": "2021-02-19T17:11:46.876000+00:00",
        "attachments": []
    },
    {
        "author": "pauld.9606",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "No versioning is needed.",
        "created_at": "2021-02-19T17:11:48.346000+00:00",
        "attachments": []
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because the stuff inside push9 is already non-jumpable and skipped, and the push9 is not a valid jump destination",
        "created_at": "2021-02-19T17:12:26.977000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I understand that. The same was proposed for subroutines (eip-615, etc). It boils down to having a verification stage in the EVM to ensure that is case in order to have the optimisations of not taking it as a push. EIP-615 proposed to ensure that by have a verification at contract deploy time, so that EVMs do not need to analyze at execution time.",
        "created_at": "2021-02-19T17:14:02.106000+00:00",
        "attachments": []
    },
    {
        "author": "pauld.9606",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Analysis can be done statically or at runtime. Optimization is up to clients.",
        "created_at": "2021-02-19T17:17:38.220000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What I am saying is that it is not as clear cut saying it is \"up to the clients\". Several similar proposals have been made to take advantage of \"there must be a push preceding this instruction\". Two examples: \"static jumps\" and \"static subroutines\".\n\nWhen the actual clients looked into it, it turned out to be tricky and consensus on the algorithm (*and cost*) is preferred, as opposed to \"up to the clients\".",
        "created_at": "2021-02-19T17:19:52.770000+00:00",
        "attachments": []
    },
    {
        "author": "pauld.9606",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "No, `\u003cop\u003e push9 data`. `push9` is never executed.",
        "created_at": "2021-02-19T17:20:09.516000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You may find details about what I am saying on ethereum magicians, EIPs, and various discussions on discord.",
        "created_at": "2021-02-19T17:20:29.965000+00:00",
        "attachments": []
    },
    {
        "author": "pauld.9606",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It is a clever way to sidestep bytecode versioning.",
        "created_at": "2021-02-19T17:21:58.807000+00:00",
        "attachments": []
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Please re-read what I wrote. I am not arguing it is not sidestepping bytecode versioning. I am arguing it is introducing other problems/questions which can/should not be brushed away. It is not a holy grail.",
        "created_at": "2021-02-19T17:22:21.507000+00:00",
        "attachments": []
    },
    {
        "author": "pauld.9606",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Agreed.",
        "created_at": "2021-02-19T17:31:26.412000+00:00",
        "attachments": []
    },
    {
        "author": "chfast",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The idea seems nice. But there is one more issue witch may be overlooked. The ADDMOD is more generic than EC crypto needs and it hurts it a lot. Not sure about MULMOD.",
        "created_at": "2021-02-19T21:19:09.273000+00:00",
        "attachments": []
    },
    {
        "author": "jwasinger",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "what is this overhead from being more generic?",
        "created_at": "2021-02-19T23:08:07.559000+00:00",
        "attachments": []
    }
]
[
    {
        "author": "Deleted User",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!273808422753796097\u003e I am still thinking about your \"Theory of State Management\" article, specifically about the resurrection conflicts. My current thoughts (also after thinking about this issue for months when researching possible ways of implementing State Rent) is that the main thing that creates a resurrection problem is the fact that \"technically\" storage belongs to a smart contract, but \"actually\" bits and pieces of it belong to someone else who will be unhappy for these bits and pieces to be destroyed. This design also creates an issue with access control. ETH balances in Externally-Owned-Accounts are protected by the access control invariants coded into the Eth clients. However, token balances and other claimed ownership is only enforced by the smart contract code, and that often gets broken (that's why people rightly consider ETH balances to be much more secure than any other ownership \"claims\" in Ethereum). I believe that it is probably not worth the while to try to adjust to that broken model of storage. Instead, a new model of storage (where ownership of storage is 2-dimensional: beneficiary (+rent payer) and operator (smart contract code) would be much better for both security (with access control also enforced by ETH clients) and more straightforward for rent and expiry (without resurrection) when the balance of the owner is zero. I proposed this kind of model in the very first State Rent doc, but I know it is being regarded as \"too radical\". By now I have decided that we have to choose between \"very radical\" and \"very messy\".",
        "created_at": "2021-02-22T08:48:34.177000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is the idea that user accounts (like EOAs or contracts or whatever) would have storage and each contract would be able to write to a \"slice\" of that (essentially)?",
        "created_at": "2021-02-22T16:03:27.627000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Something like account correlated storage access would be something like `hash(contract, slot)`?",
        "created_at": "2021-02-22T16:04:00.982000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Then when a contract wants to write a token balance, they write it in the account's storage tree, rather than the contract's storage tree?",
        "created_at": "2021-02-22T16:04:41.035000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The `contract` part of that hash would be controlled by the EVM, so *only* contract A can read/write to an account's storage slot for contract A?",
        "created_at": "2021-02-22T16:05:29.249000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think the problem is that there are plenty of applications where storage slots do not cleanly map to owners",
        "created_at": "2021-02-22T16:05:49.785000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "or where you have to maintain the integrity of some data structure (eg. a queue)",
        "created_at": "2021-02-22T16:06:00.637000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Presumably this would live side-by-side with contract storage?",
        "created_at": "2021-02-22T16:06:05.709000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For tokens, *most* of the storage would be per-account, and someone who goes on vacation for 5 years can archive their account storage tree and then we can tombstone it.",
        "created_at": "2021-02-22T16:06:41.174000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right, but tokens aren't the only use case",
        "created_at": "2021-02-22T16:07:06.768000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Sure.  I think account storage would be cheaper because it is much more likely that we'll be able to tombstone it eventually, unlike contract storage.",
        "created_at": "2021-02-22T16:07:50.139000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because *people* leave Ethereum wholesale.",
        "created_at": "2021-02-22T16:08:01.442000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Like one whole account will go away (keys lost, person loses interest, person switched accounts, cold storage, etc.)",
        "created_at": "2021-02-22T16:08:06.271000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right, though ideally, for privacy reasons people would use a different account for each token",
        "created_at": "2021-02-22T16:08:23.953000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "we don't actually want to encourage people to have all their activity under one roof",
        "created_at": "2021-02-22T16:08:37.442000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I don't think ~~anyone~~ mayn people *actually* do that?",
        "created_at": "2021-02-22T16:08:39.492000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because the UX isn't there but it should be!",
        "created_at": "2021-02-22T16:08:47.221000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think it comes back to the gas problem.",
        "created_at": "2021-02-22T16:09:07.285000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Having a dozen accounts but all transactions for them are sponsored by the same person doesn't give you real privacy.",
        "created_at": "2021-02-22T16:09:20.173000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right",
        "created_at": "2021-02-22T16:09:33.161000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You can do 3rd party sponsored transactions, in which case you end up paying more for to transact (an already very high fee).",
        "created_at": "2021-02-22T16:09:36.753000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think what it comes down to for me at the moment is that I think the privacy solution benefits don't outweigh the storage cost reduction benefits since we don't really have a full generalized privacy solution.",
        "created_at": "2021-02-22T16:10:53.692000+00:00",
        "attachments": null
    },
    {
        "author": "mightypenguin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Things like airdrops or token decimal rebasing would be much more expensive with this proposal right. (I know airdrops aren't a popular use case, but there are legit uses of them).",
        "created_at": "2021-02-22T16:11:34.387000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Merkle drops are popular these days, and they are basically free to launch.",
        "created_at": "2021-02-22T16:11:59.972000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ðŸ¤” I guess you wouldn't be able to send tokens to a tombstoned account unless you provided a storage proof along with it.  That is an interesting property.",
        "created_at": "2021-02-22T16:13:06.099000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(which means you would have to pay for resurrection)",
        "created_at": "2021-02-22T16:13:21.761000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Maybe you would even have to pay for full resurrection, not partial?  That way we can have entire accounts be tombstoned or not, rather than individual branches (thus greatly simplifying the tombstoning process)?",
        "created_at": "2021-02-22T16:13:45.861000+00:00",
        "attachments": null
    },
    {
        "author": "mightypenguin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This runs the risk of treating all user balances of tokens the same and taking flexibility away from individual tokens.\nThere would need to be some big advantages for most tokens to opt-in to that (e.g. gas costs).",
        "created_at": "2021-02-22T16:17:07.870000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So the problem I see with tombstoning is that ultimately it's still only a partial solution",
        "created_at": "2021-02-22T16:17:49.851000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Unless we can tombstone entire subsets of the account tree, that is",
        "created_at": "2021-02-22T16:17:58.616000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because if it's per-account, right now accounts are 1/6 of the state, and if you're leaving ~1/5 of each account, then there's still 1/30 of the state that's left lying around forever",
        "created_at": "2021-02-22T16:18:45.693000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And if we're okay with things lying around forever, then it's much better to just go the weak statelessness route and let block proposers hold the entire state forever so everyone else can hold nothing",
        "created_at": "2021-02-22T16:19:25.356000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We could tombstone an entire account at once couldn't we?",
        "created_at": "2021-02-22T16:19:37.676000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "sure",
        "created_at": "2021-02-22T16:19:44.058000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But that still leaves this problem",
        "created_at": "2021-02-22T16:19:49.460000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e Because if it's per-account, right now accounts are 1/6 of the state, and if you're leaving ~1/5 of each account, then there's still 1/30 of the state that's left lying around forever",
        "created_at": "2021-02-22T16:19:52.499000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Why would we be leaving 1/5 of each account?",
        "created_at": "2021-02-22T16:20:14.352000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because info-theoretically a tombstone is at least 20 bytes",
        "created_at": "2021-02-22T16:20:25.593000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(the address)",
        "created_at": "2021-02-22T16:20:27.566000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Just the tombstone record you mean?",
        "created_at": "2021-02-22T16:20:28.536000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah",
        "created_at": "2021-02-22T16:20:34.248000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is there *any* solution to the nonce problem of full deletion?",
        "created_at": "2021-02-22T16:20:46.472000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I guess that is what your high bits epoch proposal was?",
        "created_at": "2021-02-22T16:21:01.682000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right",
        "created_at": "2021-02-22T16:21:09.219000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think the very abstract solution is that signatures go bad after a while essentially.",
        "created_at": "2021-02-22T16:21:18.181000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Since nonces are for replay protection, as long as we have something to prevent replays then we can delete nonces.",
        "created_at": "2021-02-22T16:21:53.919000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But this is still ad-hoc; there are plenty of contracts that are O(1)-sized and would be left lying around",
        "created_at": "2021-02-22T16:22:03.741000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(thinking out loud, this may already be known stuff)",
        "created_at": "2021-02-22T16:22:04.180000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Supporting expirable signatures wouldn't achieve the same thing without having to do hacky things with the nonce?",
        "created_at": "2021-02-22T16:22:19.702000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And this would be even more true if people start using these \"token balance holding contracts\"",
        "created_at": "2021-02-22T16:22:39.837000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Would the nonce problem *also* be solved (hypothetically) if all transactions had an epoch associated with them and nonces reset each epoch?",
        "created_at": "2021-02-22T16:23:16.840000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah there's many things in that category that work",
        "created_at": "2021-02-22T16:23:32.895000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So I don't think replay protection is the core problem",
        "created_at": "2021-02-22T16:23:40.836000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is closer to the core problem",
        "created_at": "2021-02-22T16:24:12.600000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "imo we should be careful with things with hard edges, like \"resetting all nonces at once\", it becomes a hard edge case to take into account while building applications",
        "created_at": "2021-02-22T16:24:13.280000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "making it more explicit makes sense from an app dev perspective, you don't have to take into account such events, just \"make your transaction expire, otherwise if you don't they will become valid again if your account ever gets deleted\"",
        "created_at": "2021-02-22T16:25:20.290000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is much easier to shoot yourself in the foot with.  If you forget to handle it, then you get replayed.",
        "created_at": "2021-02-22T16:25:57.096000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Well, there are many ways to shoot yourself in the foot if you are signing transactions manually, it's something that should be backed on the main libraries",
        "created_at": "2021-02-22T16:26:31.727000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "for example: ethers adding an expiration by default to all transactions",
        "created_at": "2021-02-22T16:27:13.710000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What other ways are there to shoot yourself in the foot easily?",
        "created_at": "2021-02-22T16:27:43.374000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "*Forgetting* to do something is generally a very easy way to shoot oneself in foot.",
        "created_at": "2021-02-22T16:27:59.616000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is, it is harder to make a mistake where an active decision was made than when you can passively make a mistake.",
        "created_at": "2021-02-22T16:28:29.297000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Fair enough, but imho still having to account for weird edge cases becomes harder, \"I signed x transactions but it's not valid because I didn't account for the nonce reset\"",
        "created_at": "2021-02-22T16:29:22.017000+00:00",
        "attachments": null
    },
    {
        "author": "agusx1211",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "you could argue \"invalid by default\" it's better than \"valid by default\" but it really depends on the application, it could lead to frozen funds too",
        "created_at": "2021-02-22T16:29:55.342000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is a very fast failure, so doesn't bother me.  Your Ethereum client will just reject it immediately and you can fix your library.",
        "created_at": "2021-02-22T16:30:05.647000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So right now it sounds like we're stuck between:\n\n- expiration but not clearing accounts which results in needing to \"tombstone\" accounts that go cold, shouldering us with an implicit long tail cost where we still have to retain a non-trivial amount of storage dedicated to \"tombstones\" forever.\n- actual account clearing which has a few security issues that are unsolved (such as replaying txns due to nonce being reset or the complexities of resurrection schemes)",
        "created_at": "2021-02-22T16:30:13.653000+00:00",
        "attachments": null
    },
    {
        "author": "mightypenguin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I still like the idea of a gas advantaged storage type for accounts where the ERC20 defines a \"dust\" balance level below which a balance is made 0.\nIt's opt in and configurable per ERC20, not sure if it could be abused though.",
        "created_at": "2021-02-22T16:30:44.215000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I don't think replay protection is the problem.  That is solvable.",
        "created_at": "2021-02-22T16:30:53.809000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There is the third option, which is tree-level tombstoning",
        "created_at": "2021-02-22T16:31:08.661000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So you tombstone entire subsets of the tree that only contain expired accounts",
        "created_at": "2021-02-22T16:31:20.157000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Right, this is effectively an optimzation or \"compression\" scheme that still leaves us with some (maybe non-trivial) amount of tombstone data right?",
        "created_at": "2021-02-22T16:32:01.401000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And resurrection doesn't resurrect that part of the tree, it just creates a copy of the data being resurrected in a live tree right?",
        "created_at": "2021-02-22T16:32:07.224000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Actually no, the amount of tombstone data is bounded by `L * log(d)` where there are `L` live accounts and `d` dead accounts",
        "created_at": "2021-02-22T16:32:35.296000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So there's no long tail that grows forever",
        "created_at": "2021-02-22T16:32:53.747000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That's not intuitive for me.  Supposing that the ordered leaves of the tree were alternating between live and tombstoned accounts, then the storage cost seems like it would be linear because you would have no \"groups\" of tombstone'd accounts so the upper bound seems to be `O(N)`, with the expected case being lower since things are randomly distributed in the trie.",
        "created_at": "2021-02-22T16:35:01.248000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e alternating between live and tombstoned accounts,",
        "created_at": "2021-02-22T16:35:14.964000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So this is the `L = D` case",
        "created_at": "2021-02-22T16:35:18.743000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But in the `D = 1000 * L` case",
        "created_at": "2021-02-22T16:35:35.844000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You can compress the 1000 dead nodes between each live node into log(1000) tombstones",
        "created_at": "2021-02-22T16:35:49.734000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "so *worst* case is that if we have `L` accounts, then we expect no worse than `2 * L * \u003ccost-per-tombstone\u003e`?",
        "created_at": "2021-02-22T16:36:34.789000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh, we aren't talking about \u003c@273808422753796097\u003e's proposal to use the high bits of account addresses to partition the tree by account age?",
        "created_at": "2021-02-22T16:37:11.506000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right",
        "created_at": "2021-02-22T16:37:30.569000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And accounts can be \"moved\" from aged sections of the tree to new ones, and resurrected accounts would resurrect in new sections not old.",
        "created_at": "2021-02-22T16:37:39.601000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think they might be orthogonal...  or have minimal interplay",
        "created_at": "2021-02-22T16:37:41.034000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That proposal is a related proposal, which helps make sure that if we tombstone subsets of the tree there's always some new subset that you can create new accounts in",
        "created_at": "2021-02-22T16:38:03.986000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The tree partitioning should get us nearly perfect deletion shouldn't it?",
        "created_at": "2021-02-22T16:38:17.507000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Though even that proposal is not strictly necessary; a client could just keep track of 1/1000 of the dead tree so they can create new accounts there",
        "created_at": "2021-02-22T16:38:30.855000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is, any account that hasn't been touched in a year would end up in a dead branch together.",
        "created_at": "2021-02-22T16:38:43.752000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah",
        "created_at": "2021-02-22T16:38:48.004000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And that dead branch would have no living parts to it, and the living parts of the tree would have no dead leaves in it.",
        "created_at": "2021-02-22T16:39:14.082000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What is the downside of that strategy?",
        "created_at": "2021-02-22T16:39:23.162000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It seems \"simple\" (conceptually) compared to a lot of other solutions.",
        "created_at": "2021-02-22T16:39:35.992000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I guess we end up with data duplication during that 1 year decay period.",
        "created_at": "2021-02-22T16:39:56.697000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The main downside that I have heard is that it requires adding data to the middle of the tree, which breaks the nice clean abstraction of a tree as being a pure key/value store",
        "created_at": "2021-02-22T16:39:57.745000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But I don't think that this is practically a big deal",
        "created_at": "2021-02-22T16:40:21.182000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It would still be a key value store wouldn't it?  Just where every key is `\u003cepoch\u003e.\u003cpath\u003e` essentially?",
        "created_at": "2021-02-22T16:40:47.369000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Aaaah I see you're talking about my \"1 trillion slices\" proposal",
        "created_at": "2021-02-22T16:41:00.899000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Uhh.... maybe?  ðŸ˜¬",
        "created_at": "2021-02-22T16:41:08.714000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ðŸ¤£",
        "created_at": "2021-02-22T16:41:17.052000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah if you mean the thing I posted on ethresearch",
        "created_at": "2021-02-22T16:41:28.599000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Then no, it would not",
        "created_at": "2021-02-22T16:41:31.394000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm talking about an idea I have in my head that appeared around the time I read a document you wrote.  ðŸ˜†",
        "created_at": "2021-02-22T16:41:35.385000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "becuase you still need to keep track of live nodes inside old epochs",
        "created_at": "2021-02-22T16:41:44.084000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Why?",
        "created_at": "2021-02-22T16:41:49.191000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "because they're live?",
        "created_at": "2021-02-22T16:41:54.734000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Maybe I'm proposing something new.",
        "created_at": "2021-02-22T16:41:56.467000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah maybe",
        "created_at": "2021-02-22T16:42:02.268000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Imagine you have epoch 1, 2, and 3.  We are currently in epoch 3.  Epoch 1 contains only dead nodes.  Epoch 2 contains nodes that haven't been touched in a while, and if they *are* touched (sometime during epoch 3) they get *copied* to the epoch 3 section of the tree.  Any nodes in epoch 2 that aren't touched by epoch 4 will then completely die when epoch 4 starts.",
        "created_at": "2021-02-22T16:43:22.203000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "By \"completely die\" you mean there's no possibility of resurrection?",
        "created_at": "2021-02-22T16:44:00.549000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If so I don't think people would accept that",
        "created_at": "2021-02-22T16:44:08.230000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You can resurrect with a proof, but doing so *copies* to the current epoch.",
        "created_at": "2021-02-22T16:44:13.878000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It doesn't resurrect *inside* epoch 1.",
        "created_at": "2021-02-22T16:44:22.254000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ok but then you have resurrection conflict issues",
        "created_at": "2021-02-22T16:44:22.423000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "How so?",
        "created_at": "2021-02-22T16:44:27.187000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because something new could be created in the exact same position in the current epoch?",
        "created_at": "2021-02-22T16:44:40.660000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah right, that problem.  ðŸ˜–",
        "created_at": "2021-02-22T16:44:57.425000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "*grumble*",
        "created_at": "2021-02-22T16:45:01.795000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or do you mean some different hash key is used to preserve non-collision?",
        "created_at": "2021-02-22T16:45:06.009000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ðŸ¤”",
        "created_at": "2021-02-22T16:45:14.489000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "actually, that could be interesting....",
        "created_at": "2021-02-22T16:45:21.622000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Maybe yes?  Can we just include the epoch in the hash?",
        "created_at": "2021-02-22T16:45:26.072000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right",
        "created_at": "2021-02-22T16:45:29.266000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So essentially we are porting data forward every epoch.",
        "created_at": "2021-02-22T16:45:40.969000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Accounts *created* in epoch `n` would have a different address than accounts created in epoch `m`.",
        "created_at": "2021-02-22T16:46:16.864000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So this does mean that it's going to be not possible to create a new object at an epoch-2 address in epoch 4",
        "created_at": "2021-02-22T16:46:23.387000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(and this would apply to storage slots and not just accounts)",
        "created_at": "2021-02-22T16:46:36.436000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For accounts, I'm okay with accounts having a finite deadline for deployment",
        "created_at": "2021-02-22T16:46:57.834000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is all still a *little* fuzzy in my head, but my gut tells me that this *could* work.",
        "created_at": "2021-02-22T16:47:00.343000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "For storage slots, need to think a bit harder",
        "created_at": "2021-02-22T16:47:07.434000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "At a very abstract level, you can imagine spinning up a new blockchain and then people can migrate their data from old blockchain to new blockchain.  It is one direction, and imported data would live at a different address than native data on the destination chain so there is no conflict.",
        "created_at": "2021-02-22T16:47:48.089000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh another idea of course is that you can always initialize an account to an empty state by just providing a proof that it was empty in the original epoch",
        "created_at": "2021-02-22T16:47:59.627000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think that might actually solve it (well enough)",
        "created_at": "2021-02-22T16:48:12.774000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That would require all account creations to come with proofs from ancient history?",
        "created_at": "2021-02-22T16:48:20.178000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Only account creations at addresses corresponding to stale epochs",
        "created_at": "2021-02-22T16:48:33.686000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So if you want to create an epoch 1 account in epoch 4 you can, but you have to prove that it didn't exist in epoch 1?",
        "created_at": "2021-02-22T16:49:04.219000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right",
        "created_at": "2021-02-22T16:49:07.060000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And if you want to \"cheaply\" create an account, you just create an epoch 4 account.",
        "created_at": "2021-02-22T16:49:17.499000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yep",
        "created_at": "2021-02-22T16:49:21.200000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Interesting.... so we have something equivalent to my proposed solution, but without needing to break the tree abstraction",
        "created_at": "2021-02-22T16:49:23.419000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(the tree abstraction does actually matter because we want to switch to verkle trees and verkle trees work very differently)",
        "created_at": "2021-02-22T16:50:08.364000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh and contract storage could also just have a similar epoch mechanism",
        "created_at": "2021-02-22T16:50:17.264000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Though existing contracts could ignore it by just requiring their users to track that contract's entire storage",
        "created_at": "2021-02-22T16:50:36.745000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Lucky for us, we shaved off 12 bytes of the address!",
        "created_at": "2021-02-22T16:51:55.155000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What great forethought.  ðŸ˜›",
        "created_at": "2021-02-22T16:52:07.223000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We do need to increase address size to 26 byte hashes imo",
        "created_at": "2021-02-22T16:52:11.119000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(+ 4 bytes for an epoch + 2 more bytes if we want to add shard numbers in the future to make 32)",
        "created_at": "2021-02-22T16:52:29.929000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "2**80 collision-resistance is just not good enough going forward",
        "created_at": "2021-02-22T16:52:36.422000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "4 bytes for an epoch?",
        "created_at": "2021-02-22T16:53:58.293000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we do annual epochs we could get away with a handful of bits.  ðŸ˜„",
        "created_at": "2021-02-22T16:54:07.897000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "sure, but I think 26 is the good place to trade off one kind of future proofness against the other",
        "created_at": "2021-02-22T16:54:27.461000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ðŸ˜‹",
        "created_at": "2021-02-22T16:54:31.797000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "2 bytes would get us 65k epochs, which is 5500 years with monthly epochs.",
        "created_at": "2021-02-22T16:56:10.362000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Unless we think there is value in doing them more frequently?",
        "created_at": "2021-02-22T16:56:17.638000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Even weekly would still be 1200 years.",
        "created_at": "2021-02-22T16:56:27.319000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The rest of the system can survive around 100k years iirc",
        "created_at": "2021-02-22T16:56:29.677000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ðŸ¤£",
        "created_at": "2021-02-22T16:56:34.166000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You are... optimistic...  ðŸ˜›",
        "created_at": "2021-02-22T16:56:39.148000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, this is not the solution to all possible applications, but to many that we know about. In applications like token, exchanges, ENS, there is always an owner. I would say in this case it is better to learn one lesson at a time than to try to dream a completely perfect solution for everything",
        "created_at": "2021-02-22T16:56:50.382000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'll write up what Micah and I just figured out and put it on ethresear.ch for easier reference today",
        "created_at": "2021-02-22T16:57:27.769000+00:00",
        "attachments": null
    },
    {
        "author": "mightypenguin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Is there a way to estimate the real advantages of state storage aging with these types of approaches?\n\"Someone\" has to still store all of this old state still, so it's not really going away.\nWould this further centralize usage of ETH API (Infura) services?\nWould this make things faster for development or lower memory usage for clients?\nIt would be a shame if most clients end up having to store this old data anyway.",
        "created_at": "2021-02-22T16:57:48.875000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "*New* participants in the network would not need ancient state to participate.  Only old clients would need to save off (or delegate the saving of) their old state.",
        "created_at": "2021-02-22T16:59:13.938000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "One win is that things that no one cares about can go away and even if no one saves it that is fine.",
        "created_at": "2021-02-22T16:59:35.043000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Right now, there are a *lot* of accounts (for example) that will never be touched again (e.g., lost/forgotten keys, empty burned accounts, etc.).  Those live with us forever at the moment.",
        "created_at": "2021-02-22T17:00:05.860000+00:00",
        "attachments": null
    },
    {
        "author": "mightypenguin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So if I generate a wallet, deposit 2 eth, and then come back in 5 years, will I not be sure that my balance is still there unless I backup some state data at the time I create my wallet or deposit my ETH?",
        "created_at": "2021-02-22T17:03:24.947000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "BTW, Rootstook's state rent scheme also uses timestamps for individual storage slots. But instead of removing things from the state, it just makes them more expensive to access the \"older\" they are",
        "created_at": "2021-02-22T17:04:25.415000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "How does that help with cleaning up old state if they never remove them?",
        "created_at": "2021-02-22T17:05:57.432000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I guess it lets you move some state to slower disks?",
        "created_at": "2021-02-22T17:06:15.724000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I suppose",
        "created_at": "2021-02-22T17:07:01.294000+00:00",
        "attachments": null
    },
    {
        "author": "mightypenguin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You could \"age out\" balances that are considered dust.\nThey are still there if someone wants to pay a higher, constant gas fee to bring them back? (e.g. for ETH balances)\nCreate a storage type that uses this same mechanism for balance tracking with ERC20 contracts?",
        "created_at": "2021-02-22T17:13:03.143000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Has there been a clean solution proposed that deals with resurrection conflicts in a scenario where we are actually clearing expired accounts?",
        "created_at": "2021-02-22T17:13:57.191000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "See the upcoming ethresear.ch post.  ðŸ˜œ \nhttps://discord.com/channels/595666850260713488/739145593762611250/813454423308501022",
        "created_at": "2021-02-22T17:23:01.387000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(or read the conversation that lead up to that comment)",
        "created_at": "2021-02-22T17:23:07.739000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That solution, if it doesn't end up having big holes, would let us fully delete old data (anything not touched since epoch) and it would be resurrected (in a special way) by providing proof of the old data.",
        "created_at": "2021-02-22T17:24:08.598000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah, I mean that if account X was zero'd at some point, resurrected, and then zero'd and then resurrected again, what's the mechanism for easily knowing that you are always resurrecting the \"latest\" version.  Not clear to me that the discussion above covers this case... but I haven't examined it closely.",
        "created_at": "2021-02-22T17:24:54.454000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So created in epoch 1, tombstoned at end of epoch 2, resurrected in epoch 3, tombstoned in epoch 4, then resurrected in epoch 5... how do we ensure that they are resurrecting the one from epoch 3 rather than the one from epoch 1?",
        "created_at": "2021-02-22T17:33:41.589000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The very naive solution is to only allow moving forward one epoch at a time.  If you want to go from 1 to 5 then you have to do 1 =\u003e 2 =\u003e 3 =\u003e 4 =\u003e 5.",
        "created_at": "2021-02-22T17:34:03.564000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In other words, if you want to resurrect 1 in 5 you have to prove that it doesn't exist in 2, 3, or 4.",
        "created_at": "2021-02-22T17:34:27.912000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Such a strategy would *strongly* prefer very long epochs (1 year).",
        "created_at": "2021-02-22T17:34:40.081000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "and things can't get tombstone'd more than once per epoch?",
        "created_at": "2021-02-22T17:34:44.360000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah.  Whole epochs die at once.",
        "created_at": "2021-02-22T17:34:52.624000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "When epoch 3 starts, all of epoch 1 dies (deleted off full nodes, proofs required to resurrect).",
        "created_at": "2021-02-22T17:35:05.288000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm always really hopeful when we're chipping away at the corners of promising new-ish solution spaces",
        "created_at": "2021-02-22T17:35:36.515000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I feel like 1 year epochs would be \"good enough\" to address a lot of the problems we want to address, and would be long enough that having to resurrect through each epoch to get current wouldn't be a big problem.",
        "created_at": "2021-02-22T17:36:41.865000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It means it gets more and more expensive to resurrect stuff over time, but that isn't a problem.",
        "created_at": "2021-02-22T17:37:06.615000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Everything expiring all at once seems potentially problematic (similar to how self destruct is problematic in being able to wipe large parts of the state).  Similar to things behaving weirdly across epoch boundaries.",
        "created_at": "2021-02-22T17:37:57.113000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "All expiring at once is problematic even if it is all once giant branch of a tree?",
        "created_at": "2021-02-22T17:57:45.033000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Re boundary, the first blocks of a new epoch would have a flurry of migrations, and gas costs would be high during that time.  We could perhaps spread this out by having some function that makes it so what is migrated and what isn't is random (based on its hash or something) for the first half of the epoch if we want to avoid this big \"burst\".",
        "created_at": "2021-02-22T17:58:58.639000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(trivial) example to illustrate: any addresses starting with 00001 bits touched in the first block would get migrated in the first block.  Any un-migrated addresses starting with 00001 or 00010 touched in the second block would would get migrated in the second block, any un-migrated addresses starting with 00001, 00010, or 00011 touched in the third block would get migrated in the third block, etc.",
        "created_at": "2021-02-22T18:00:57.254000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And we can spread that out over the first 6 months of an epoch.",
        "created_at": "2021-02-22T18:01:16.877000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The latter 6 months of the epoch would migrate all touched addresses to the next epoch.",
        "created_at": "2021-02-22T18:01:53.908000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Then at the end of the epoch, any addresses that weren't migrated in the epoch would need a proof to migrate forward and we start the process again.",
        "created_at": "2021-02-22T18:02:17.675000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Someone *could* miss migration if they get touched early on (before their migration time has come) and then don't get touched at all after their migration time, but I think that is fine.  This still auto-migrates everyone who is touched once per 6 months.",
        "created_at": "2021-02-22T18:03:13.313000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And anyone who is touched once per 6-12 months *may* auto-migrate, and everyone else has to migrate via proofs (bring your own data).",
        "created_at": "2021-02-22T18:03:40.005000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(I'll admit that I'm a little lost due to splitting my attention between this and other things, gonna let this settle into my brain, read any write-ups that get published, and try to spend a little bit of time in the meantime trying to better define some of the terminology we're settling on there and update the glossary document to try and capture some of these concepts.)",
        "created_at": "2021-02-22T18:04:51.225000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I am making all of this up as I go, assume all terminology is poorly chosen!",
        "created_at": "2021-02-22T18:08:02.401000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm more referring to stuff like \"tombstone\" vs actually zeroing state",
        "created_at": "2021-02-22T18:09:23.250000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Tombstone vs delete (for terminology)?",
        "created_at": "2021-02-22T18:32:26.839000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "delete is misleading because information-theoretic deletion would not be able to prevent resurrection conflicts",
        "created_at": "2021-02-22T18:32:50.785000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "There is still *something* in the state that says \"you can't build here anymore\"",
        "created_at": "2021-02-22T18:33:02.084000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Tombstoned vs Pruned?",
        "created_at": "2021-02-22T18:34:03.605000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "pruned still feels like deleted",
        "created_at": "2021-02-22T18:34:12.920000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I prefer terminology that reflects that there's something still there",
        "created_at": "2021-02-22T18:34:20.818000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(unless the system is designed so that there isn't)",
        "created_at": "2021-02-22T18:34:30.370000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\"there is something there\" I don't think is quite right.",
        "created_at": "2021-02-22T18:34:39.696000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Its more that \"the data is no longer valid in the new system\".",
        "created_at": "2021-02-22T18:35:11.243000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "the state is on \"hibernation\" (eh?)",
        "created_at": "2021-02-22T18:35:30.285000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm thinking of this from the point of view of a full node, which really only cares about whether or not it needs to keep *any* information around about a particular address.",
        "created_at": "2021-02-22T18:36:14.645000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "In the tombstone solutions, it needs to keep a tiny little bit of metadata about each address.  In the \"delete\" situation it doesn't need to retain *any* information per address.  And of course in the current situation it needs to keep *all* information per address.",
        "created_at": "2021-02-22T18:36:35.330000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I feel like in all cases the data is in \"hibernation\"?",
        "created_at": "2021-02-22T18:37:42.865000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah, doesn't provide the distinction between the two",
        "created_at": "2021-02-22T18:38:01.763000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The question of terminology revolves more around what parts have to remain \"unhibernated\".",
        "created_at": "2021-02-22T18:38:20.746000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Are we talking about those fish that can actually be fully frozen and then \"resurrect\", or about bears who are mostly shutdown, but keep some systems running so they can be woken back up.",
        "created_at": "2021-02-22T18:38:59.308000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "haa",
        "created_at": "2021-02-22T18:40:22.167000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "bear vs fish",
        "created_at": "2021-02-22T18:40:25.189000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Water Bears (tardigrades) or Black Bears?  ðŸ˜„",
        "created_at": "2021-02-22T18:40:37.074000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(TIL: tardigrades can be resurrected after being frozen for 30 years)",
        "created_at": "2021-02-22T18:41:08.103000+00:00",
        "attachments": null
    },
    {
        "author": "mightypenguin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Re: the hibernation being disruptive. If you hibernated data that was 1 block old that might be disruptive.\nSo maybe you only hibernate a year's worth of data starting from 3-6 months back?",
        "created_at": "2021-02-22T19:07:03.971000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That is approximately what my current line of thinking is.",
        "created_at": "2021-02-22T19:16:54.310000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We would kill off an entire year's worth of untouched state all at once, and this would happen once a year.",
        "created_at": "2021-02-22T19:17:14.922000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And it would happen to state that hasn't been touched in the past 6-12 months (or maybe just 12 months back, depends whether we want to do a migration smoothing strategy like I described above)..",
        "created_at": "2021-02-22T19:17:37.900000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e I just wrote it up here:",
        "created_at": "2021-02-22T19:28:19.791000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://ethresear.ch/t/resurrection-conflict-minimized-state-bounding-take-2/8739",
        "created_at": "2021-02-22T19:28:20.258000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Minor note:\n\u003e Alice simply sends her transaction as is, and the block producer will add the witness\nThis will need whatever stateless gossip solution we end up with, which in the absence of a solution would require all full nodes to store S7.",
        "created_at": "2021-02-22T19:38:42.958000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah yes fair",
        "created_at": "2021-02-22T19:38:55.682000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think this is totally fine/reasonable, just wanted to make sure we are all on the same page about it.",
        "created_at": "2021-02-22T19:39:03.629000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Requiring all full nodes to store S7 is not that bad either, right?",
        "created_at": "2021-02-22T19:39:05.401000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Just means we have 2 years of touched state instead of 1 in full nodes.  Still a huge win over today where we have all the years.",
        "created_at": "2021-02-22T19:39:26.308000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or rather 1.5 instead of 1 on average",
        "created_at": "2021-02-22T19:39:59.502000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Technically if everyone stores S7 you could also just not bother with the witnesses",
        "created_at": "2021-02-22T19:40:16.573000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I like the idea of thinking it like witnesses because if we *do* solve the stateless witness problem in some way then we gain additional benefits.",
        "created_at": "2021-02-22T19:40:53.342000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think it is a good mental model.",
        "created_at": "2021-02-22T19:40:58.441000+00:00",
        "attachments": null
    },
    {
        "author": "jwasinger",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ah yes.  it was late when I wrote that message.  addmod384 **is** generic",
        "created_at": "2021-02-22T21:47:45.232000+00:00",
        "attachments": null
    }
]
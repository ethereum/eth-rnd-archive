[
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "https://hackmd.io/@HWeNw8hNRimMm2m2GH56Cw/state_expiry_paths",
        "created_at": "2021-03-04T15:51:46.298000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!301186049323958275\u003e and others, is this what you were looking for when you wanted a doc to make state expiry and statelessness more concrete?",
        "created_at": "2021-03-04T15:52:07.692000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also \u003c@!555483069038198827\u003e \u003c@456226577798135808\u003e \u003c@!206016661470314496\u003e",
        "created_at": "2021-03-04T15:52:17.378000+00:00",
        "attachments": null
    },
    {
        "author": "Deleted User",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'll check it out, thank you",
        "created_at": "2021-03-04T15:54:50.486000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "oh, option 3 is interesting.\n\none downside here is that MPT verification must remain in the head code of a client forever because there is always a chance things from epoch 0 need to be revived forever in the future",
        "created_at": "2021-03-04T15:57:39.960000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "true, though one pure function is not too bad (it's just branch verification, not adding/editing/deleting)",
        "created_at": "2021-03-04T15:59:03.090000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right",
        "created_at": "2021-03-04T15:59:18.995000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It has lots of pictures, so üíØ‚ùó",
        "created_at": "2021-03-04T16:04:05.428000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Read over it and I like it.  You may want to consider either adding reasons why we *shouldn't* do option 3, or changing it from \"option 1,2,3\" to \"historic idea 1, historic idea 2, current proposal\" to make it more clear that \"Option 3\" is what is really being proposed here.  That way we hopefully spend less time debating with each other about \"which option should we chose\" and we can skip to \"do we like option 3?\".",
        "created_at": "2021-03-04T16:16:06.007000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we were all computers this wouldn't be necessary, but as humans I suspect having a more clear \"the author thinks this one is obviously better\" helps to give a nice schelling point to start discussion from.",
        "created_at": "2021-03-04T16:16:41.006000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also, we should bring this up to ACD ASAP so we can start developing a concrete plan and roadmap (e.g., set of EIPs, long term planning and estimation, etc.)",
        "created_at": "2021-03-04T16:17:06.840000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The option 2 proposal for state expiry is looking really nice, complete, viable, actionable.  That's awesome.",
        "created_at": "2021-03-04T16:22:45.465000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You don't like option 3?",
        "created_at": "2021-03-04T16:25:23.393000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hadn't gotten to it yet.  I love option 3",
        "created_at": "2021-03-04T16:25:32.302000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Pondering if there is a good ü•ï that could be dangled in front of any of the client teams to get them to run with this.",
        "created_at": "2021-03-04T16:26:23.975000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We'll start looking at our plans for \u003c#796057759858425866\u003e to be sure we can easily support this new multi-trie scheme.",
        "created_at": "2021-03-04T16:27:18.378000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This would affect consensus, so are you just thinking of prototyping it in order to look for hidden gotchas?",
        "created_at": "2021-03-04T16:31:24.841000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm happy to present ACD; though \u003c@!552133098075193354\u003e I wonder, is tomorrow a bit soon, especially since there's possible Berlin fireworks? The 19th could work too, and perhaps could be better at getting people's attention as berlin would be more behind us from an implementation perspective? What do you think?",
        "created_at": "2021-03-04T16:41:09.192000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, spec and implementation would likely inform each other and it's going to take a client team to \"shake\" the idea thoroughly enough for it to move forward since this will touch both the EVM semantics, consensus rules, and networking protocols (sync).",
        "created_at": "2021-03-04T16:43:10.766000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I wonder if it would be valuable to get a call with interested parties outside of ACD to try to flesh out details?  e.g., 1 or 2 client devs rather than all of them.",
        "created_at": "2021-03-04T16:45:54.747000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Would also allow us to move forward on a shorter time scale rather than waiting for an ACD before taking any next steps.",
        "created_at": "2021-03-04T16:46:17.908000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I like that, avoid trying to get everyone to agree on the path, focus on finding interested parties and enabling them to do the work.",
        "created_at": "2021-03-04T16:46:35.254000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Can't you avoid this problem if you first do a verkle transition, keep that as epoch 0, and then do option 2?",
        "created_at": "2021-03-04T16:53:17.955000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, but that requires going through option 1 which is a pretty big undertaking (engineering wise).",
        "created_at": "2021-03-04T16:54:22.555000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Last I remember the binary transition was supposed to only take a matter of days. Or could be done in a matter of few hours with a chain halt. I would assume the verkle transition wouldn't be significantly worse?",
        "created_at": "2021-03-04T16:54:47.124000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It is the engineering cost involved that worries me more, not the time.",
        "created_at": "2021-03-04T16:55:07.770000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Hypothetically, I think we could actually convert epoch 0 to a verkle tree sometime later (say epoch 5) and still benefit (be able to drop merkle trees)?",
        "created_at": "2021-03-04T16:55:14.664000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Actually, couldn't one just go with a special version of option 3: epoch 1 is a full copy of epoch 0 with verkle trees.",
        "created_at": "2021-03-04T16:56:07.780000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "And the new rules of expiry start applying from epoch 2 onwards.",
        "created_at": "2021-03-04T16:56:27.856000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The migration from epoch 0 to 1 currently is slated to happen as transactions happen.  When would \"the rest\" be migrated?",
        "created_at": "2021-03-04T16:57:24.491000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is only a random idea, but I would imagine somehow similarly how to the overlay method in the binary transition works.",
        "created_at": "2021-03-04T16:57:58.032000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, that makes sense. We can schedule an off-schedule call to just discuss this and then bring it up at the ACD on the 19th. I don't think we can have a good discussion about it on tomorrow's call given the other agenda items üòÖ",
        "created_at": "2021-03-04T16:57:58.710000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I *think* it would effectively reduce to the overlay solution?",
        "created_at": "2021-03-04T16:58:17.615000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "sounds good",
        "created_at": "2021-03-04T16:58:41.594000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Likely, though I could imagine nodes to do it directly on epoch 2 and not via an overlay. So each block would have X amount of processing time reserved for moving data over. Anything which has been proven via user transactions, would not need to be moved over.",
        "created_at": "2021-03-04T16:59:50.785000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'll be out next week, but happy to setup a call. I may even be able to generate a zoom link that works without me being present.  \n\nHere's a quick poll to see what times would work best for people: https://doodle.com/poll/7x959c4t6k2swhr3?utm_source=poll\u0026utm_medium=link",
        "created_at": "2021-03-04T17:23:17.312000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we agree to a time that works for most people here, we can mention it on ACD to see if any other core devs want to join üëç",
        "created_at": "2021-03-04T17:24:10.777000+00:00",
        "attachments": null
    },
    {
        "author": "pauld.9606",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Good idea to have two active regenesis periods.",
        "created_at": "2021-03-04T23:04:27.523000+00:00",
        "attachments": null
    },
    {
        "author": "pauld.9606",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Perhaps epoch 2 should be special: clients are required to hold state for epochs 0, 1, and 2, with epoch 0 frozen but accessible without witness. During epoch 2, there could be a merkle-\u003everkle transition of frozen epoch 0 state.\n\nWitnesses start in epoch 3.",
        "created_at": "2021-03-04T23:04:56.316000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The two periods ensures that if you touch things at least once a period you never need to provide witnesses at all, which is nice",
        "created_at": "2021-03-04T23:04:59.604000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So merging #3 and #1? Interesting",
        "created_at": "2021-03-04T23:05:16.947000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I guess a tree transition would be easier if the tree is static",
        "created_at": "2021-03-04T23:05:37.184000+00:00",
        "attachments": null
    },
    {
        "author": "pauld.9606",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes. #1 during epoch 2.",
        "created_at": "2021-03-04T23:05:43.715000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You don't even need clients to do the transition, you can just hardcode the root, and release a separate script for validating the transition",
        "created_at": "2021-03-04T23:06:02.466000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Which reduces the complexity *a lot*",
        "created_at": "2021-03-04T23:06:11.189000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I asked the viability of a similar effort above (without much thought put into it, but driven by the hope to get rid of mpt entirely). I wonder though why do propose to do the verkle at epoch 2 and not epoch 1?",
        "created_at": "2021-03-04T23:14:07.868000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think the reason may be to avoid the trade off of keeping too much data along.\n\nIf it is done at epoch 1, that means epoch 0 and 1 are special cases. As mentioned above one potential option is that in each block there‚Äôs some time spent on moving parts of the state of epoch 0 over (those which were not submitted yet as user transactions). This however means that at the end of epoch 1, the node needs to keep both states fully alive.\n\nIf it is done at epoch 2, then epoch 0 is not needed to be kept alive, so the state storage requirement is smaller.",
        "created_at": "2021-03-04T23:26:29.277000+00:00",
        "attachments": null
    },
    {
        "author": "pauld.9606",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "You are right. Thank you for pushing getting rid of mpt. Your text inspired what I wrote. We can do merkle-\u003everkle at various early epochs, and with epoch 0 frozen or not. I think all options are open. No matter what, there will be some strangeness in the early epochs.",
        "created_at": "2021-03-04T23:26:35.419000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e  I wonder though why do propose to do the verkle at epoch 2 and not epoch 1?",
        "created_at": "2021-03-04T23:26:54.775000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "My proposal was verkle at epoch 1!",
        "created_at": "2021-03-04T23:26:59.996000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah sorry I mean, the state tree S_1 is a verkle tree",
        "created_at": "2021-03-04T23:27:20.703000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "hmm, the transition just needs time to finish",
        "created_at": "2021-03-04T23:27:30.744000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So it could be done eg. 30 days into epoch 1 if we want",
        "created_at": "2021-03-04T23:27:37.015000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e If it is done at epoch 2, then epoch 0 is not needed to be kept alive, so the state storage requirement is smaller.\n\nActually this is wrong, could do at epoch 3 as then epoch 0 is in the cold, so one wont arrive at having to store two complete versions of the state.",
        "created_at": "2021-03-04T23:28:04.270000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Just enough time for anyone who wants to to calculate that the proposed epoch 0 verkle root is for the same state as the previous epoch 0 hexary root",
        "created_at": "2021-03-04T23:28:10.571000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah, this way you can just hard-fork in the modified 0 epoch verkle root",
        "created_at": "2021-03-04T23:33:58.273000+00:00",
        "attachments": null
    },
    {
        "author": "djrtwo",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "instead of a live transition?",
        "created_at": "2021-03-04T23:34:03.014000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah",
        "created_at": "2021-03-04T23:34:04.576000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Do we have a hunch on the storage space requirements and database lookup speed of the complete verkle state?",
        "created_at": "2021-03-04T23:34:14.824000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The state as a whole is 35 GB right now, I can't imagine the verkle tree adding more than ~0.5x overhead",
        "created_at": "2021-03-04T23:34:44.514000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i.e. would clients have a problem to have both the complete mpt and the verkle tree at the same time",
        "created_at": "2021-03-04T23:34:53.534000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "but if we do the hard fork thing, they don't need to üòÜ",
        "created_at": "2021-03-04T23:35:12.907000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Are you saying that during some early time in epoch 1, there is a hard fork which brings in the verkle root. Up until the hard fork, epoch 1 is built using the regular rules (using mpt proofs). After the hardfork it is possible to submit verkle proofs of epoch 0? Can they submit mpt proofs still?",
        "created_at": "2021-03-04T23:36:48.001000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e \n\u003e Are you saying that during some early time in epoch 1, there is a hard fork which brings in the verkle root.",
        "created_at": "2021-03-04T23:37:09.784000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "yeah",
        "created_at": "2021-03-04T23:37:10.607000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e Up until the hard fork, epoch 1 is built using the regular rules (using mpt proofs). After the hardfork it is possible to submit verkle proofs of epoch 0? Can they submit mpt proofs still?",
        "created_at": "2021-03-04T23:37:19.440000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I guess we can do it either way",
        "created_at": "2021-03-04T23:37:22.722000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We could just do verkle proofs only",
        "created_at": "2021-03-04T23:37:29.179000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Aaah I remember; we want to do it during epoch 2 so that by then clients don't have to store anything by the root",
        "created_at": "2021-03-04T23:38:04.369000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "But even we do it in epoch 1",
        "created_at": "2021-03-04T23:38:23.987000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Clients would still have the same state cache",
        "created_at": "2021-03-04T23:38:30.330000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "that does not need to be updated for the verkle tree introduction",
        "created_at": "2021-03-04T23:38:46.733000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Where I was coming from is that epoch are 8 months (in the document), so waiting till epoch 2 to get rid of mpt means like up to 24 months waiting time. That is a lot of time to get mpt and epoch rules calcified even more. If there is any way to have some special early, shorter epochs to deal with the \"beautifying\" aspect, that could be a win.",
        "created_at": "2021-03-04T23:40:05.925000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Fair! I'd be okay with epoch 1 being compressed down to 0 blocks",
        "created_at": "2021-03-04T23:40:45.698000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "üòÜ",
        "created_at": "2021-03-04T23:41:03.320000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "On the epoch-based address space, that would mean addresses become longer than 160-bits, or we truncate the hash even more and squeeze the epoch number into the 160-bits?",
        "created_at": "2021-03-04T23:43:26.991000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh we actually need to increase address length regardless",
        "created_at": "2021-03-04T23:43:43.104000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "We should talk about this at some point",
        "created_at": "2021-03-04T23:43:47.890000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "160 bits is not safe",
        "created_at": "2021-03-04T23:43:52.082000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "My proposal is to go up to 208 bits, so we get \u003e100 bits of collision resistance, which should be enough for the foreseeable future",
        "created_at": "2021-03-04T23:44:25.881000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So that could be a problem. Solidity assumes addresses are 160-bit and the optimiser removes some masking because of this -- which is good, as it won't truncate addresses. However when inserted into storage, they may get truncated or may overwite other packed data.",
        "created_at": "2021-03-04T23:45:14.201000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Just flagging this early, it may turn out to be not a problem, but worth keeping in mind.",
        "created_at": "2021-03-04T23:45:51.778000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yeah, that's good to flag",
        "created_at": "2021-03-04T23:46:50.891000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we disregard this issue for a second, and for the sake of conversation claim that epoch is part of 160-bits (unsafe).\n\nIs the only reason for having epoch numbers in to avoid the need to submit proofs that some address does not exists in the cold tree?",
        "created_at": "2021-03-04T23:49:21.216000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or is it just an easy way to tell what epoch something was created in and where to find it?",
        "created_at": "2021-03-04T23:52:21.596000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The point of having different address spaces is so that there's always some address space in which you can create new state objects without providing a witness",
        "created_at": "2021-03-04T23:52:56.417000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "That was my understanding and wasn't sure if there is any other motive I'm missing",
        "created_at": "2021-03-04T23:53:32.378000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If in the worst case it turns out we can not bump addresses over 160-bits, could addresses displayed to the EVM still retain 160-bits and the keys in the tree contain the epoch number?",
        "created_at": "2021-03-04T23:55:04.356000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or potentially that would mean EVM gets epoch-0 addresses the current ones, and any further epoch address for the EVM would be calculated as `keccak256(epoch || address)[12..32]`?",
        "created_at": "2021-03-04T23:57:21.769000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So solidity would definitely need some significant rearchitecting, because a well-designed contract would want to delegate storage related to objects in newer address spaces in a child contract that is in that address space",
        "created_at": "2021-03-04T23:58:23.392000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I'm more concerned about existing contracts",
        "created_at": "2021-03-04T23:58:41.847000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "As in, how existing contracts would respond to getting called by contracts from newer epochs?",
        "created_at": "2021-03-04T23:59:00.073000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "hmm",
        "created_at": "2021-03-04T23:59:16.710000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or them calling newer addresses.",
        "created_at": "2021-03-04T23:59:18.775000+00:00",
        "attachments": null
    }
]
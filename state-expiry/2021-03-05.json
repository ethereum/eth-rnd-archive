[
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Also since EOAs do not need to exists in the state tree in order to \"exists\" (i.e. having a valid private key). Does that mean they are somewhat exempt of the epoch rule? They can make up an address for whichever epoch.",
        "created_at": "2021-03-05T00:00:11.732000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah they just couldn't receive any value to an old address unless proving it?",
        "created_at": "2021-03-05T00:00:53.352000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I guess the transaction would include a \"sender epoch\" variable",
        "created_at": "2021-03-05T00:00:56.611000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "agree that this is a challenge (and it's not epoch-specific; it's a challenge for any scheme that expands the address space)",
        "created_at": "2021-03-05T00:01:58.302000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh, so challenge wise we are kind of getting into sharding and some proposals explored during the EE-times üò¨",
        "created_at": "2021-03-05T00:05:55.235000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Why would it matter moving data to a closer epoch? If you can move the data that means likely you can prove the original contract, i.e. it has been moved to the current epoch.",
        "created_at": "2021-03-05T00:07:03.275000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e Why would it matter moving data to a closer epoch?",
        "created_at": "2021-03-05T00:07:18.266000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "So that you can create storage slots without providing a witness",
        "created_at": "2021-03-05T00:07:25.381000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "",
        "created_at": "2021-03-05T00:08:21.531000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "Screenshot_2021-03-05_at_00.08.16.png",
                "content": "e138eb2b40bf6656b77fcc027ade0828533b6a94d89abd99072946b8fa146912"
            }
        ]
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(Numbering these rules may be nice!)",
        "created_at": "2021-03-05T00:08:31.534000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Doesn't rule 3 means that once it is moved into the current epoch there's no other witness requirement?",
        "created_at": "2021-03-05T00:08:52.556000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It's per-state-object, not per-account",
        "created_at": "2021-03-05T00:09:09.399000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "hmm, I guess you could have a mechanism where you count how many storage slots you resurrected, and if you resurrect every storage slot to the current epoch, then you can make new storage slots",
        "created_at": "2021-03-05T00:11:21.258000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I just read it more carefully this time, I admit I only skipped through the rules a few hours ago üò¨",
        "created_at": "2021-03-05T00:19:54.226000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I see now the tree is flattened so `s` is `address || \u003ckind\u003e || storagekey` in case of storage leafs.",
        "created_at": "2021-03-05T00:20:32.363000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right, that's the goal",
        "created_at": "2021-03-05T00:20:44.586000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I was wondering if a special case would be useful for having the ability to resurrect an entire account, with all its keys, and having it marked so. This would mean those contract wouldn't need to be rearchitected.\n\nBut then thinking about actual contracts, maybe they wouldn't even need this, and the original goal of not carrying baggage along can be kept.\n\nWallets are probably fine with just submitting witnesses all the time. Most defi projects are about exchanges, those don't have much long-term useful state. Tokens is the only use case with a lot of legacy leafs to prove.",
        "created_at": "2021-03-05T00:29:06.984000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "you'd still need rearchitecting to expand the address space",
        "created_at": "2021-03-05T00:31:39.636000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "(which as I said before I think we *have to* do eventually regardless of what state solution we use, because 80 bits is unsafe)",
        "created_at": "2021-03-05T00:31:57.167000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Very likely, but we may as well be lucky üôÇ",
        "created_at": "2021-03-05T00:34:47.538000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The main culprit is packed datatypes (such as pending transactions in multisig wallets). Tokens for example which use \"mappings\" would not really be affected by larger addresses.",
        "created_at": "2021-03-05T00:35:47.643000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Actually, mappings would be affected in general because the address you put in would not arrive at the same hash (i.e. `balances[sender]`). So for running epoch-0 contracts existing contracts must receive an old-style address (for constructs like `balances[this]`).",
        "created_at": "2021-03-05T00:36:44.905000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "To me now the addressing scheme and compatibility with old contracts seems like the most unclear part of this.\n\nI may be imagining this, but if we do not want to break existing contracts, perhaps we have to keep legacy contracts in a special address space (their old non-epoch based address). New contracts (this could coincide with ‚Äúversioning‚Äù) would follow new rules and the new addressing scheme. This would allow epoch-0 contracts to exist and operate among themselves (with constantly submitting proofs in later epochs).\n\nThe big question is how an old contract can talk to a new one or how to move data out of epoch-0. Maybe some kind of solution could be to have the ability of ‚Äúreplacing‚Äù code of the old account by proving its entire state and running a new initcode (which may or may not translate it, and would insert new code replacing the old one).",
        "created_at": "2021-03-05T00:47:44.196000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is a very rough idea, but to clarify the replacing part, I could imagine it as follows:\n- There is a contract version key, `address || version`, which does not exists in epoch-0\n- When the replacement mechanism is invoked, the entire account must either exists at its legacy address (with code, storage, etc.) or the transaction must include the complete proof\n- The replacement mechanism would execute a new initcode (submitted as part of the transaction) which can modify the storage, at the end return a new code which replaces the old one, **and** creates the `address || version` key set to 1.\n\nNow I am wondering how to avoid the case that legacy contract is resurrected and replaced in multiple epochs. Is the solution as simple as replaced legacy contracts keeping their original non-epoch based address?  So the above process boils doing to them having the ability to replace their code, which operates on the new opcodes.",
        "created_at": "2021-03-05T01:03:04.338000+00:00",
        "attachments": null
    },
    {
        "author": "axic3354",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "The problem with keeping the old legacy address is that after the epoch it was replaced in gets cold, one can prove either versions of the account. The problem with having a new epoch based address for the replaced contract, is that the legacy version can indefinitely be resurrected and replaced. üò¨",
        "created_at": "2021-03-05T01:08:37.860000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I think that as long as we have *a* path away from MPT proofs we don't need to be in a hurry.  We can hard fork replace epoch 0 MPT root with a Verkle root anytime after the start of epoch 2 without clients needing to do anything other than swap a number, but I don't think we need to worry about exactly when we make that transition.",
        "created_at": "2021-03-05T05:21:49.501000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Monday seems like the most popular day for a call here, I'll open up an agenda issue üòÑ I can probably make it too üëç",
        "created_at": "2021-03-05T18:10:02.241000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Call agenda: https://github.com/ethereum/pm/issues/268",
        "created_at": "2021-03-05T18:19:00.948000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If you want a calendar invite, DM me your email !",
        "created_at": "2021-03-05T18:19:10.442000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003c@!552133098075193354\u003e would love a calendar invite",
        "created_at": "2021-03-05T18:32:32.736000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "also - is there value in reviving the ethereum core calendar?",
        "created_at": "2021-03-05T18:32:51.840000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Sent",
        "created_at": "2021-03-05T18:52:20.871000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Maybe - the challenge is they quickly become out of date if people don't maintain them and then are useless. I'm not willing to commit to maintaining one right now üòÖ",
        "created_at": "2021-03-05T18:53:06.052000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "i would be happy to maintain it",
        "created_at": "2021-03-05T18:53:49.576000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Oh, nice! With help, I think I can do it üòõ I can look into it over hte next week or two. About to head out for ~1 week and I think we should be good until next ACD üôÇ",
        "created_at": "2021-03-05T18:56:58.402000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "you know where to find me üôÇ",
        "created_at": "2021-03-05T18:57:18.752000+00:00",
        "attachments": null
    }
]
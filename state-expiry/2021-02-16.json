[
    {
        "author": "samwilsn",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Removing gas observability would probably break a bunch of account abstraction use cases (or at least ones where the AA account pays for an untrusted call)",
        "created_at": "2021-02-16T01:09:39.224000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "IMHO, it would be better to start ship these and probably other breaking changes before the merge to avoid their concentration at a single upgrade. For instance, if the merge will happen after sharding there will be a time for doing one or two upgrades on the mainnet. If we decide to ship all at once it will increase the complexity of the upgrade and required time for a proper preparations to be done as the merge itself introduces a few unavoidable breaking changes.",
        "created_at": "2021-02-16T07:32:38.563000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "What if we have a couple of upgrades _after_ the merge that will potentially have breaking changes and clearly communicate that to the community? Developers of new clients from scratch will be able to start working on them once such upgrades are done, it should be clear enough by the time of the updates.",
        "created_at": "2021-02-16T07:34:58.708000+00:00",
        "attachments": null
    },
    {
        "author": "dkdkdkdkdkdk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "\u003e (Technically, even clients built post-merge could be designed to only process the chain starting from 1-2 hardforks in the past, but it seems likely that not bothering to process the distant past will be an easier sell when it‚Äôs ‚Äúa separate chain‚Äù)\ndid you mean \"pre-merge\" here?",
        "created_at": "2021-02-16T13:49:04.116000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I guess this is about clients that will potentially be built post-merge. They won't have to support all the historical hard forks which makes the implementation easier.",
        "created_at": "2021-02-16T14:03:55.297000+00:00",
        "attachments": null
    },
    {
        "author": "dkdkdkdkdkdk",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "well it discusses clients built post-merge in a preceding sentence",
        "created_at": "2021-02-16T14:07:07.033000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It's worth noting that we probably have ~3 updates left after Berlin on mainnet before the merge. Nothing stops us from doing more, but looking at our historical shipping cadence, and the relative complexity of stateless/regenesis/state rent relative to, say, adding precompiles, I doubt we can safely ship these types of change *and* increase our velocity significantly.",
        "created_at": "2021-02-16T15:36:47.483000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Got it! What if we plan some breaking changes for those updates? ü§î I would try to avoid adding more complexity to the merge than we have to pass it through. Also, introducing some breaking changes before the merge would make it a little bit easier to introduce them during the merge itself. btw, what is the current pace of upgrades on mainnet?",
        "created_at": "2021-02-16T15:58:43.898000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, I think we should aim to do those breaking changes before the merge too, to enable people to write post-merge only clients üëç",
        "created_at": "2021-02-16T16:00:44.407000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Historically, we've done updates in the 6-12 month range. I'm hoping I can get us at a 6 month cadence, which means we get London this summer, Shanghai (?) right before/after the holidays, and Cancun (?) next spring/summer, which I assume may be The Merge?",
        "created_at": "2021-02-16T16:01:48.214000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Yes, it definitely may be! If you're aiming 6 month cadence you're risking to run out of names pretty soon. Potential workaround is to have devcon twice a year.",
        "created_at": "2021-02-16T16:08:09.734000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Other than that, it would be great to have mainnet update each 6 months",
        "created_at": "2021-02-16T16:10:44.237000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Ah yes it should be pre-merge",
        "created_at": "2021-02-16T16:11:20.070000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "hmm I doubt we'll have more than 5 hard forks before and including the merge",
        "created_at": "2021-02-16T16:11:41.868000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "After that there's the eth2 naming scheme (currently under discussion https://github.com/ethereum/eth2.0-pm/issues/202 )",
        "created_at": "2021-02-16T16:12:01.813000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "wait, what are examples of use cases where the AA account pays for an untrusted call?",
        "created_at": "2021-02-16T16:12:42.559000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "OH btw speaking of breaking changes, one important thing regarding the merge is that with either binary trees or verkle trees, we're breaking the tree and witness structure anyway, so I don't think there's actually much value in maintaining an eth1-style RLP blockchash in the post-merge eth1 engine spec",
        "created_at": "2021-02-16T16:13:58.069000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "5? more like 2 üòÖ",
        "created_at": "2021-02-16T16:17:02.100000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "eth1 styled block hash _may_ be used by some apps to prove receipt inclusion in a particular block",
        "created_at": "2021-02-16T16:18:11.616000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "hmm",
        "created_at": "2021-02-16T16:18:27.200000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Though surely we want to replace the receipt hexary tree with binary trees too?",
        "created_at": "2021-02-16T16:18:42.832000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Or even a Kate commitment",
        "created_at": "2021-02-16T16:19:05.571000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "It probably won't make sense to replace the scheme for the state tree and leave receipts unchanged",
        "created_at": "2021-02-16T16:20:14.498000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right",
        "created_at": "2021-02-16T16:20:24.803000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "Because changing the scheme for the state tree is breaking in so many ways. Need to think more about it, but it general it seems reasonable to replace MPT in all places at once. Moreover, getting rid of MPT for the state tree is needed for statelessness.",
        "created_at": "2021-02-16T16:23:17.583000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "btw, isn't it similar to verkle trees?",
        "created_at": "2021-02-16T16:23:39.870000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "a Kate commitment is just a single-layer verkle tree ü§£",
        "created_at": "2021-02-16T16:23:53.614000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "got it! With pure Kate commitment you have to re-compute the whole polynomial on each update. But with verkle trees the cost of update could be reduced. Is this the right direction of thoughts? Though, there might be some other optimisations to address the same problem with pure Kate commitments",
        "created_at": "2021-02-16T16:27:14.300000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "If we get rid of requirement to support blockhashes then we can replace them with randao mixes in the EVM to preserve randomness for dapps that rely on it. Also, it allows for getting rid of eth1-styled block structure at all",
        "created_at": "2021-02-16T16:29:43.898000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "No app should be relying on blockhashes for randomness.",
        "created_at": "2021-02-16T16:34:08.448000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "This is for the legacy only, I guess there are some dapps that use it anyway. Or do you mean we could break it as well? After the merge there will be `RANDOM` opcode that returns the most recent randao mix that is available by the time of the execution.",
        "created_at": "2021-02-16T16:35:57.502000+00:00",
        "attachments": null
    },
    {
        "author": "sky.cactus",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "I would not feel bad breaking apps that use blockhash for randomness.",
        "created_at": "2021-02-16T16:37:22.044000+00:00",
        "attachments": null
    },
    {
        "author": "m.kalinin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "From YP:\n\u003e In order to make it hard for malicious miners to control those values, one should use the `BLOCKHASH` operation in order to use hashes of the previous 256 blocks as pseudo-random numbers\n\nThere should be a number of apps that took this advise",
        "created_at": "2021-02-16T17:06:44.435000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "right",
        "created_at": "2021-02-16T18:03:27.582000+00:00",
        "attachments": null
    },
    {
        "author": ".vbuterin",
        "category": "Execution R\u0026D",
        "parent": "",
        "content": "ooh that's interesting! So if we have to break compatibility for all the merkle use cases, we may as well preserve some level of compatibility for the random stuff",
        "created_at": "2021-02-16T18:04:40.566000+00:00",
        "attachments": null
    }
]
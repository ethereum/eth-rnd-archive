[
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "I don't think any of those deleted.  All had nonce=1 which leaves a zero length code account, not an empty account.",
        "created_at": "2023-07-31T01:39:16.451000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "Only since EIP-158 (https://eips.ethereum.org/EIPS/eip-158) are contracts created with nonce=1",
        "created_at": "2023-07-31T07:40:57.371000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "I guess what I'm saying is, that if indeed those 'empty' accounts that \u003c@243183686562873344\u003e is referring to _had_ nonzero-nonce, then they were either not created in frontier, _or_ they also created something else (during ctor execution, thus bumping the nonce).",
        "created_at": "2023-07-31T07:44:29.757000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "Might be a case of etherscan being wrong, too (?)",
        "created_at": "2023-07-31T07:45:20.686000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "But it does look like that tx was basically a no-op",
        "created_at": "2023-07-31T07:47:00.169000+00:00",
        "attachments": [
            {
                "type": "image/png",
                "origin_name": "Screenshot_2023-07-31_at_09-46-29_Ethereum_Transaction_Hash_Txhash_Details_Etherscan.png",
                "content": "0575c6ec35800b8fa7090b7d5588fd22cdcc541f5da31f1e7fba3f3ab7a1095e"
            }
        ]
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "I looked into one of them (https://etherscan.io/address/0xfcde1c261eb257e14491b4e7cb1949a7623c00c5) . Indeed, it was created _before_ eip-158 (`2_675_000`) , at block `226_164`, using `CREATE`. Etherscan marks it as if it were created with `nonce=1`, which does not make sense to me.\n\nI suspect Etherscan is wrong",
        "created_at": "2023-07-31T07:54:14.869000+00:00",
        "attachments": null
    },
    {
        "author": "yperbasis",
        "category": "Testing",
        "parent": "",
        "content": "But such accounts are not a problem if we extend the empty rule to require empty storage. Currently such accounts (with zero balance, nonce, code, but non-empty storage) are formally considered empty, but that's OK because EIP-161 tolerates existence of previously created empty accounts. With the proposed change in the empty rule such accounts will be formally non-empty.",
        "created_at": "2023-07-31T08:24:43.143000+00:00",
        "attachments": null
    },
    {
        "author": "yperbasis",
        "category": "Testing",
        "parent": "",
        "content": "And we can send a transaction before Cancun to touch and delete them if we want to clean them up.",
        "created_at": "2023-07-31T08:28:20.514000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "Right, it's not a problem, but it also means we can't make it a retroactive rule. So possible alternatives that it 'work' are\n- At `cancun` blocknumber, add 'storage must be empty' as precondition for `emptiness`.\n- When updating the storage for the precompile, set `nonce=1` iff `nonce==0`. \n- At `cancun` blocknumber, set`nonce=1 iff nonce==0` for the precompile. \n- At `cancun` blocknumber, set`nonce=1 iff nonce==0` for all accounts \u003c `0xff`.",
        "created_at": "2023-07-31T08:44:48.236000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "That's what \u003c@243183686562873344\u003e already did, IIUC",
        "created_at": "2023-07-31T08:46:01.377000+00:00",
        "attachments": null
    },
    {
        "author": "yperbasis",
        "category": "Testing",
        "parent": "",
        "content": "Yes, I agree that it should be an explicit change introduced in Cancun (perhaps as part of EIP-4788).",
        "created_at": "2023-07-31T08:47:30.334000+00:00",
        "attachments": null
    },
    {
        "author": "yperbasis",
        "category": "Testing",
        "parent": "",
        "content": "Could you please rename dataGas to blobGas in fields like `dataGasUsed`, `excessDataGas`, `maxFeePerDataGas` (e.g. in EIPTests/BlockchainTests/bcEIP4844-blobtransactions/blockWithAllTransactionTypes.json)",
        "created_at": "2023-07-31T10:08:05.312000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Testing",
        "parent": "",
        "content": "Yes thats in the progress. I have geth t8n crashing on blob txs.",
        "created_at": "2023-07-31T10:10:32.063000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "I like the precompile setting the nonce solution the most.  It puts the change entirely within the precompile logic.",
        "created_at": "2023-07-31T13:34:59.896000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "Me too. Although, from a pure _implementation_ perspective, 2 and 3 are identical and a client can implement either as they see fit, but the definition on `2` is perhaps the most self-contained. The differences that could occur in obscure / test-specific wonky scenarios might impact the implementation though",
        "created_at": "2023-07-31T13:38:37.769000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "A transition state migration would have similar test-specific changes, from my perspective.",
        "created_at": "2023-07-31T15:07:33.752000+00:00",
        "attachments": null
    },
    {
        "author": "peter.davies",
        "category": "Testing",
        "parent": "",
        "content": "We could do \"At Cancun blocknumber disable all clearing of empty accounts\"? That would get rid of massive number of wonky edge cases in the test suite. Might cause problems if clients have implemented \"don't create new empty accounts\" by creating them and letting them get cleared.",
        "created_at": "2023-07-31T16:14:56.274000+00:00",
        "attachments": null
    },
    {
        "author": "chfast",
        "category": "Testing",
        "parent": "",
        "content": "We added some kind of precompiles support to evmone (including `evmone-t8n`). https://github.com/ethereum/evmone#precompiles",
        "created_at": "2023-07-31T16:36:06.113000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "I have nothing against that in theory, but in practice it seems a pretty large feature-change that affects quite a lot of things, and it might be better suited to it's own EIP instead of being a sidecar of 4788. My 2c is that I'd rather do something smaller",
        "created_at": "2023-07-31T16:47:40.941000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "I tested the 'minimal' approach in the geth PR: https://github.com/ethereum/go-ethereum/pull/27289/commits/2ce4c013b6c28b6ee9bee36e11de38e2a7b7536b . (I'm not trying to force that solution, just wanted to test it out and make it available for test generation. I'm open to using whatever fix we decide on)",
        "created_at": "2023-07-31T17:34:58.720000+00:00",
        "attachments": null
    },
    {
        "author": "rjected",
        "category": "Testing",
        "parent": "",
        "content": "Is there any plan to eventually remove hive tests that depend on live merge transition logic?",
        "created_at": "2023-07-31T17:58:21.539000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "We added 1 Wei to the precompile address on all tests just for devnet 8, and to wait for consensus on which solution to use in the long term",
        "created_at": "2023-07-31T18:13:01.629000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "We started removing them here: https://github.com/ethereum/hive/pull/795\nAt least for the engine API tests",
        "created_at": "2023-07-31T18:13:54.343000+00:00",
        "attachments": null
    },
    {
        "author": "rjected",
        "category": "Testing",
        "parent": "",
        "content": "awesome - not sure how I missed this, thanks!",
        "created_at": "2023-07-31T18:16:48.999000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "We can use this as well to fill tests if everyone agrees for devnet 8 I'm up for either ðŸ™Œ",
        "created_at": "2023-07-31T19:14:21.641000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "would you be interested in championing such an eip?",
        "created_at": "2023-07-31T20:59:39.280000+00:00",
        "attachments": null
    },
    {
        "author": "lightclient",
        "category": "Testing",
        "parent": "",
        "content": "ultimately this only affects tests and new networks though, correct?",
        "created_at": "2023-07-31T21:02:28.563000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Is anybody having issues with the storage for the 4788 precompile being deleted because it's considered an empty account by EIP-158 standards?",
        "created_at": "2023-07-29T00:15:14.878000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "From the yellow paper:\n\u003e An account is empty when it has no code, zero nonce\n\u003e and zero balance:\n\u003e (14) EMPTY(σ, a) ≡ σ[a]c = KEC(())\u0001∧σ[a]n = 0∧σ[a]b = 0\n\u003e Even callable precompiled contracts can have an empty\n\u003e account state. This is because their account states do not\n\u003e usually contain the code describing its behavior.\nSo 0xb being empty should have zero impact on the precompile being callable.  I always thought it was only old builds of parity that had that issue.",
        "created_at": "2023-07-29T20:47:16.843000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@892053833121923094\u003e from what i have been told, you need to send 1 wei to the contract before anyone touches it on your test chain (to get around this behavior)",
        "created_at": "2023-07-29T20:47:51.569000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "But it should gains storage so it should not be empty either on first use.",
        "created_at": "2023-07-29T20:47:56.308000+00:00",
        "attachments": null
    },
    {
        "author": "ralexstokes",
        "category": "Testing",
        "parent": "",
        "content": "this should be fine on mainnet bc there is already ETH there, but something to keep in mind for testnets (sepolia, goerli)",
        "created_at": "2023-07-29T20:49:25.961000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Geth seems to be deleting the account's storage after the block execution. During execution, the precompile only works ok for the current block, but if you query the storage e.g. Using \"eth_getStorage\", it's always empty.",
        "created_at": "2023-07-29T21:03:44.752000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "Would it be an option to exempt this address from deletion? It could be a problem for example for the ephemeral testnets, and any devnet must have this in the Genesis before the fork (1 Wei at the precompile address)",
        "created_at": "2023-07-29T21:05:12.243000+00:00",
        "attachments": null
    },
    {
        "author": "marioevz",
        "category": "Testing",
        "parent": "",
        "content": "For this and all stateful precompiles on future forks",
        "created_at": "2023-07-29T21:06:20.274000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "hmm... per the spec it should be deleted even with storage if nonce and balance are zero... so a balance of one gwei solves that",
        "created_at": "2023-07-29T21:23:43.405000+00:00",
        "attachments": null
    },
    {
        "author": "_shemnon",
        "category": "Testing",
        "parent": "",
        "content": "Or we could add empty storage to the empty account rule.",
        "created_at": "2023-07-29T21:24:09.137000+00:00",
        "attachments": null
    }
]
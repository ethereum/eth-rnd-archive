[
    {
        "author": "yperbasis",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!393119312350543872\u003e Works fine for Silkworm, thanks a lot!",
        "created_at": "2021-06-07T08:01:05.172000+00:00",
        "attachments": null
    },
    {
        "author": "mariusvanderwijden",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@!393119312350543872\u003e I want to change the prestate of  a couple of state tests. Is there a script/utility to automatically create the poststates of existing test after you modified the prestate?",
        "created_at": "2021-06-07T10:05:15.321000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Testing",
        "parent": "",
        "content": "https://github.com/ethereum/retesteth/",
        "created_at": "2021-06-07T10:18:00.680000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "Been fuzzing geth vs \u003c@\u0026836981603216654336\u003e and \u003c@\u0026652918665943056397\u003e . It seems that when basefee is not specified, in london, besu and nethermind assumes a baseFee of `0`. However, when I implemented support for the london statetests, I found that those statetests assume a basefee of `0x10` in genesis, so `0x0a` for the first block. Hence that's what geth uses. So -- how can besu and nethermind pass the statetests if that is not implemented?",
        "created_at": "2021-06-07T17:00:37.128000+00:00",
        "attachments": null
    },
    {
        "author": "suburbandad_",
        "category": "Testing",
        "parent": "",
        "content": "if an initial basefee is not specified and 1559 forkblock is 0, besu assumes 1000000000L.  Is there a different case you are referring to where besu is assuming 0 ?",
        "created_at": "2021-06-07T17:07:12.497000+00:00",
        "attachments": null
    },
    {
        "author": "suburbandad_",
        "category": "Testing",
        "parent": "",
        "content": "we can change the default base fee value, I don't think there is any particular reason for it to be 1 gwei",
        "created_at": "2021-06-07T17:09:08.689000+00:00",
        "attachments": null
    },
    {
        "author": "timbeiko",
        "category": "Testing",
        "parent": "",
        "content": "Doesn't the EIP specify this?\n\u003e INITIAL_BASE_FEE = 1000000000",
        "created_at": "2021-06-07T17:13:12.587000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "See here: https://gist.github.com/holiman/13045f0576256a69a6e594f8bb65700c . The `gasPrice` is `1`, so it must be that you're using `0`. And when I set geth to use `0`, I get the same root",
        "created_at": "2021-06-07T17:25:14.168000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "So it's not about a particular forkBlock -- it's simply a statetest on `london` fork.",
        "created_at": "2021-06-07T17:25:48.938000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "And the statetest _should_ IMO explicitly state the basefee, since it's an important part of the context, but ISTR that the ethereum/tests do not all contain a specific `baseFee`.",
        "created_at": "2021-06-07T17:26:56.266000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "https://github.com/ethereum/tests/releases/tag/9.0.0: \n\n\u003e Treat legacy blockheader as 1559 with baseFee 10 on London",
        "created_at": "2021-06-07T17:28:28.017000+00:00",
        "attachments": null
    },
    {
        "author": "suburbandad_",
        "category": "Testing",
        "parent": "",
        "content": "are you running the state tests against besu with retesteth? or hive?  or?\n\nAll of the London state tests, when run via retesteth against besu are specifying baseFee via test_setChainParams rpc - presumably due to the default you linked",
        "created_at": "2021-06-07T17:35:08.480000+00:00",
        "attachments": null
    },
    {
        "author": "suburbandad_",
        "category": "Testing",
        "parent": "",
        "content": "I haven't looked at hive for reference testing yet, but I did just see this comment from lightclient regarding it:\nhttps://github.com/ethereum/eth1.0-specs/issues/208#issuecomment-855921337",
        "created_at": "2021-06-07T17:38:10.633000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Testing",
        "parent": "",
        "content": "That's due to formula not allowing base fee to drop below 7.\nCould update all tests to have baseFee explicitly written in env section, but then on legacy network ignore it",
        "created_at": "2021-06-07T17:43:21.204000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "I'm using the `evmtool` that I get from `/gradlew --parallel ethereum:evmtool:installDist`",
        "created_at": "2021-06-07T17:43:34.019000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Testing",
        "parent": "",
        "content": "Also is basefee \u003c 7 illigal?",
        "created_at": "2021-06-07T17:43:44.671000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "I'm not sure if it's illegal -- it doesn't explicitly say so. It cannot ever go below 7 though, and it could not ever go up again from that",
        "created_at": "2021-06-07T17:44:22.749000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "Theoretically, a basefee of `0` should be \"legal\", but it would be stuck at `0` forever",
        "created_at": "2021-06-07T17:44:41.610000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Testing",
        "parent": "",
        "content": "So to stay safe  I put number 10. As it looks like it might get illegal  if basefee \u003c 10 just like contracts sending transactions",
        "created_at": "2021-06-07T17:53:40.372000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "yeah 10 was a sane choice, I have nothing against that, really (but it would be even nicer if it was explicitly stated in the env)",
        "created_at": "2021-06-07T18:03:27.849000+00:00",
        "attachments": null
    },
    {
        "author": "dimitry8570",
        "category": "Testing",
        "parent": "",
        "content": "That would require all test files update",
        "created_at": "2021-06-07T18:16:19.166000+00:00",
        "attachments": null
    },
    {
        "author": "suburbandad_",
        "category": "Testing",
        "parent": "",
        "content": "I can confirm, the besu evmtool has no treatment for initial basefee at all.  This is an oversight.  Is there consensus that we should default basefee to some value (0x10 or 1gwei or x) when the base fee is otherwise unspecified?",
        "created_at": "2021-06-07T18:32:16.717000+00:00",
        "attachments": null
    },
    {
        "author": "holiman",
        "category": "Testing",
        "parent": "",
        "content": "Well, it should behave like whatever your normal statetest executor does (do you have one?)",
        "created_at": "2021-06-07T19:04:59.856000+00:00",
        "attachments": null
    }
]
[
    {
        "author": "hmijail",
        "category": "Testing",
        "parent": "",
        "content": "Hi. My team is writing a verified EVM, we can compile it to various languages, and we'd like to test it as any other mainnet client EVM. We thought that the best way to do it would be reusing existing infrastructure: compiling to Go and plugging into Geth's evm runner to run the reference tests, or compiling to Java and plugging into Besu's evmtool, etc.\nI've been looking at the reference tests and retesteth, and at how they are used by both clients, and I'm trying to make sense of the panorama. \nIs it accurate to say that retesteth and its RPC are deprecated, and that t8ntool is the way forward for EVM-level testing? I guess this would rather mean going with Geth...",
        "created_at": "2022-07-14T07:37:42.357000+00:00",
        "attachments": []
    },
    {
        "author": "hmijail",
        "category": "Testing",
        "parent": "",
        "content": "Also: while developing our EVM we'll want to see how our results differ from the tests' expected storage, etc, so we can debug more easily; maybe we'll write some additional tests too. But the `expect` fields are present only in the fillers for the reference tests, not in the filled tests; so it looks like we'll have to write a filler, then fill it with a client, then run the test against our EVM. Is that right? Or am I missing some easier option to run the filler directly?",
        "created_at": "2022-07-14T07:57:49.029000+00:00",
        "attachments": []
    },
    {
        "author": "hmijail",
        "category": "Testing",
        "parent": "",
        "content": "Of course, there's also the possibility of ignoring existing clients and infrastructure and just deal with the .json files directly... but that doesn't feel very constructive?",
        "created_at": "2022-07-14T12:07:36.012000+00:00",
        "attachments": []
    },
    {
        "author": "daniellehrner",
        "category": "Testing",
        "parent": "",
        "content": "Lately we have mainly worked with the Hive test harness: https://github.com/ethereum/hive\n\nIt contains the reference tests as well (in Hive its called consensus simulator): https://github.com/ethereum/hive/tree/master/simulators/ethereum/consensus\n\nAll the Hive test are run regularly and the results can be seen here: https://hivetests.ethdevops.io/",
        "created_at": "2022-07-14T12:13:07.005000+00:00",
        "attachments": []
    },
    {
        "author": "hmijail",
        "category": "Testing",
        "parent": "",
        "content": "\u003c@393119312350543872\u003e I see you addressed very similar questions in this GitHub issue, though that was 18 months ago; and that you have some familiarity with Geth and Besu. Would you have some opinion/recommendation on how to go about testing our EVM?\nhttps://github.com/ethereumjs/ethereumjs-monorepo/issues/954#issuecomment-734423381",
        "created_at": "2022-07-14T12:13:07.537000+00:00",
        "attachments": []
    },
    {
        "author": "hmijail",
        "category": "Testing",
        "parent": "",
        "content": "But Hive runs at the client level, right? If I only have a half-implemented EVM, it's too high level for me",
        "created_at": "2022-07-14T12:17:24.929000+00:00",
        "attachments": []
    },
    {
        "author": "daniellehrner",
        "category": "Testing",
        "parent": "",
        "content": "Yes, you are correct. I thought you wanted to replace the EVM in the different clients. But testing directly against an EVM is not possible with it.",
        "created_at": "2022-07-14T12:19:55.221000+00:00",
        "attachments": []
    },
    {
        "author": "hmijail",
        "category": "Testing",
        "parent": "",
        "content": "at some future point, maybe. But first we need to implement, and test while implementing.",
        "created_at": "2022-07-14T12:20:59.396000+00:00",
        "attachments": []
    },
    {
        "author": "zsharifian5619",
        "category": "Testing",
        "parent": "",
        "content": "I need run #test-beacon (beacon) on some node in my lab and have the view off them or #simulate-beacon-network in as a PC simulator. Of course, I saw the previous messages, but is it possible to give more precise guidance?üôè",
        "created_at": "2022-07-14T13:52:23.945000+00:00",
        "attachments": []
    },
    {
        "author": "dimitry8570",
        "category": "Testing",
        "parent": "",
        "content": "We have transition tool protocol. It is when you export at least some of the evm so we can run tests against it",
        "created_at": "2022-07-14T14:33:30.512000+00:00",
        "attachments": []
    },
    {
        "author": "dimitry8570",
        "category": "Testing",
        "parent": "",
        "content": "Transition tool takes transactions, environment variables (current block number/difficulty/ etc), state1  and then execute transactions to produce state2. This is enough to run the tests. I even implemented blockchain logic, so you don't have to export it",
        "created_at": "2022-07-14T14:35:33.603000+00:00",
        "attachments": []
    },
    {
        "author": "dimitry8570",
        "category": "Testing",
        "parent": "",
        "content": "You do not need expect section to run the test. Your evm must end up in the same post state hash, if not you need to compare vm traces to investigate the issue, using filler as a clue.\n\nAlso all the tests are present in blockchain form with post state exported",
        "created_at": "2022-07-14T14:38:32.278000+00:00",
        "attachments": []
    }
]
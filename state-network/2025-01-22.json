[
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "State go bur",
        "created_at": "2025-01-22T16:12:42.103000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Hello! What is the state of the state network?",
        "created_at": "2025-01-22T16:19:23.049000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "I am bridging state diffs from block 21 million to a latest with delay of 8 blocks.",
        "created_at": "2025-01-22T16:22:05.037000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "But I need to make some optimizations to Trin so we can sustain the load of gossiping the data on the network. As currently the nodes running the State Network are at their rate limit, so they are declining new content being gossiped",
        "created_at": "2025-01-22T16:22:45.217000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "I am looking to 10x the performance of Trin",
        "created_at": "2025-01-22T16:23:19.649000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "\u003c@240180844130598912\u003e in theory, is it possibly to query state from block `21 million exactly`",
        "created_at": "2025-01-22T16:26:27.638000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "That depends if the big storage nodes are online yet, \u003c@261161007982968833\u003e could comment if they are online or not",
        "created_at": "2025-01-22T16:27:04.763000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Anyone who wants to test state queries can also do anything on blocks `0 - 1 million` as that's been live for a while.  Trin can do `eth_call` against this data.",
        "created_at": "2025-01-22T16:27:26.318000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Oh nice, what would the delay be with a 10x improvement?",
        "created_at": "2025-01-22T16:41:54.468000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Also what are the plans for integrating this?",
        "created_at": "2025-01-22T16:42:16.663000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "The delay is due to the engine api and re-org support not being finished for Trin Execution which is our execution client which we use to gossip latest state, because of this we gossip at a delay to avoid re-orgs",
        "created_at": "2025-01-22T16:43:42.785000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "By a 10x performance improvement I am referring to wanting to 10x the throughput of network bandwidth Trin can handle",
        "created_at": "2025-01-22T16:44:20.505000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Ah okay makes sense -- so in the future there will be no delays",
        "created_at": "2025-01-22T16:44:47.128000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "What do you also envision the use cases for querying the state from blocks very old blocks are?",
        "created_at": "2025-01-22T16:44:52.088000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Ideally I want Trin to be able to saturate a networks bandwidth",
        "created_at": "2025-01-22T16:45:04.773000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "I am more focused on providing access to latest state",
        "created_at": "2025-01-22T16:45:30.219000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "\u003c@364458974906548225\u003e can respond querying old state",
        "created_at": "2025-01-22T16:45:37.613000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Yeah this makes sense -- this is useful for not needing the state at all",
        "created_at": "2025-01-22T16:45:54.087000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Global archive node.  Currently access to an archive node is expensive.  I envision supporting for archive state to reduce the barriers to entry for those that want to do any form of research that requires old state.  The ability to re-execute old blocks directly from the network without needing huge amounts of local storage.",
        "created_at": "2025-01-22T16:46:46.109000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "For the latest state, is it similar to portal network where a client can choose to contribute 1GB to the state network?",
        "created_at": "2025-01-22T16:46:54.101000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Makes sense! -- I was wondering if there was another usecase apart from archive nodes (this is also valid)",
        "created_at": "2025-01-22T16:47:20.763000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Correct.  Individual clients will always be able to tune how much storage they provide to any of the networks.",
        "created_at": "2025-01-22T16:47:23.209000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Do you need certain nodes in the network to store large amounts of data?",
        "created_at": "2025-01-22T16:48:19.068000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "I guess this is also dependent on the number of nodes in the network?",
        "created_at": "2025-01-22T16:48:58.568000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "I would think of it in terms of network capacity and total storage required to store the data",
        "created_at": "2025-01-22T16:49:18.363000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "At present, we're working on a hybrid approach to bootstrap things that includes a few large nodes that store a disporpotionate amount of data.  Longer term it's unclear exactly how the distribution will look.",
        "created_at": "2025-01-22T16:49:23.255000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Core requirment will still be that lightweight nodes can exist on the network and have access to the data.",
        "created_at": "2025-01-22T16:50:04.483000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Ah makes sense -- what would be the next steps for integrating this?",
        "created_at": "2025-01-22T16:50:17.122000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "When you say integrating, what do you mean?",
        "created_at": "2025-01-22T16:51:16.302000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "In my head, I'm thinking on the lines of a EL node that:\n\n- use history network for block history\n- uses state network for the latest perhaps 256 state diffs",
        "created_at": "2025-01-22T16:51:40.512000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "So in the end we could have a full node, that only uses 256GB or less of storage and only uses RAM to perhaps cache state for performance purposes",
        "created_at": "2025-01-22T16:53:54.646000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "We have two state storage models.  A: stores individual trie nodes B: flat storage that does leaf-level storage\n\nB is not live in any form yet in the network and depends on A being live first\n\nA is going live right now, in a limited format, going forward from block 21-million.  The snapshot from 21-million is mostly deployed.  Next step is to get the gossip mechanism live that walks forward from 21-million to HEAD.  We hit a throughput bottleneck that is currently being addressed in our clients, after which, this step will proceed.  This will get us to having live state in model A roughly on an 8-block lag from the HEAD of the chain.  That 8-block is for re-org protection.  Once our clients can handle re-orgs, the 8-block lag goes away and we should have HEAD state live.\n\nOnce A is live at HEAD or the 8-block lag, I think that the gates are open for people to run with stateless experiments.\n\nModel B would in-theory start going live once A is done.  We expect the 8-block lag model of A to be done within a short timeline (end of Q1 or Q2).",
        "created_at": "2025-01-22T16:57:32.393000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "I think that experiments can be run on model A, but the real power will probably be locked behind model B going live because flat state storage is just way-better/faster",
        "created_at": "2025-01-22T16:58:28.579000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "There would still be a lag of 4/3 blocks due to the delay from utilizing sync committees if they are using a Beacon Light client to follow the head",
        "created_at": "2025-01-22T17:01:41.032000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Thanks for the explanation! \n\nIt seems that we could perhaps integrate with A (even with the 8 block lag) and then once B is live with re-org protection, it will be a performance increase?",
        "created_at": "2025-01-22T17:02:10.469000+00:00",
        "attachments": null
    },
    {
        "author": "kolbyml",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "[Add EIP: Delayed Execution Layer State Root](\u003chttps://github.com/ethereum/EIPs/pull/9241\u003e)\n\nIf this EIP is deployed our network would have a delay of accesing state of 2 slots",
        "created_at": "2025-01-22T17:02:37.443000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "\u003c@364458974906548225\u003e When you say stateless here, how does it differ from what we are calling stateless in verkle land?",
        "created_at": "2025-01-22T17:57:23.209000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Out-of-protocol stateless that isn't viable for in-protocol use cases like staking because it is subject to network latency when fetching state data from the network.",
        "created_at": "2025-01-22T17:58:12.019000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "So, an execution client that does stateless execution by fetching data live from the network as fast as it can, maybe with a small local cache of recent state.",
        "created_at": "2025-01-22T17:58:50.256000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Does this come accompanied with a proof that the state that was fetched is _correct_ ?",
        "created_at": "2025-01-22T18:01:22.416000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Yes.  All data from any of Portal network is always cryptographically anchored.",
        "created_at": "2025-01-22T18:01:56.387000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "And to be clear.  This is a theoretical use case that needs someone to experiment with it and it's going to have engineering problems that need solving... like being able to fetch enough of the state fast enough.... etc.",
        "created_at": "2025-01-22T18:02:46.782000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Is there somewhere where I can find out the size of these proofs?",
        "created_at": "2025-01-22T18:05:49.716000+00:00",
        "attachments": null
    },
    {
        "author": "kevaundray",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "I'm guessing they are MPT proofs, so would be interested in the network latency/bandwidth needed to fetch state.\n\nI imagine the stateless client pipeline here would be:\n\n1. Receive a block (without verkle)\n2. Start executing the transactions in that block\n3. Whenever a state read is made, it will make a request to the state network, if the client does not have that piece of state in memory",
        "created_at": "2025-01-22T18:09:51.626000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Standard MPT proofs for Model B.  For Model A you're doing trie-walking so the hash you request proves the response data.",
        "created_at": "2025-01-22T18:11:39.208000+00:00",
        "attachments": null
    },
    {
        "author": "pipermerriam",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Spec here: https://github.com/ethereum/portal-network-specs/blob/master/state/state-network.md",
        "created_at": "2025-01-22T18:12:28.689000+00:00",
        "attachments": null
    },
    {
        "author": "milos88",
        "category": "Portal R\u0026D",
        "parent": "",
        "content": "Not yet. I expect that to be possible in a week or so",
        "created_at": "2025-01-22T20:39:08.745000+00:00",
        "attachments": null
    }
]